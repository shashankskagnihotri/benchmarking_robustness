Started at Fri Nov 15 04:26:56 CET 2024
Processing corruption type: gaussian_noise
11/15 04:28:32 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 532886760
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 532886760
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 04:28:32 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='gaussian_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/gaussian_noise'

Number of parameters:  163407980
11/15 04:29:18 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 04:29:18 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 04:29:19 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 04:29:24 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 04:31:03 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:04:01  time: 0.4301  data_time: 0.0017  memory: 26008  
11/15 04:31:23 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:37:31  time: 0.4139  data_time: 0.0018  memory: 2338  
11/15 04:31:42 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:28:17  time: 0.3982  data_time: 0.0017  memory: 2271  
11/15 04:32:02 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:23:41  time: 0.4084  data_time: 0.0017  memory: 2434  
11/15 04:32:21 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:20:36  time: 0.3915  data_time: 0.0017  memory: 2489  
11/15 04:32:40 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:18:29  time: 0.4097  data_time: 0.0018  memory: 2330  
11/15 04:33:00 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:16:56  time: 0.3703  data_time: 0.0017  memory: 2330  
11/15 04:33:19 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:15:39  time: 0.4075  data_time: 0.0016  memory: 2334  
11/15 04:33:36 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:14:27  time: 0.3690  data_time: 0.0017  memory: 2268  
11/15 04:33:55 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:13:33  time: 0.3712  data_time: 0.0017  memory: 2272  
11/15 04:34:16 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:12:49  time: 0.4280  data_time: 0.0017  memory: 2325  
11/15 04:34:35 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:12:05  time: 0.4091  data_time: 0.0018  memory: 2333  
11/15 04:34:54 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:25  time: 0.3896  data_time: 0.0016  memory: 2353  
11/15 04:35:15 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:51  time: 0.4108  data_time: 0.0018  memory: 2349  
11/15 04:35:35 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:18  time: 0.4063  data_time: 0.0017  memory: 2363  
11/15 04:35:53 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:09:42  time: 0.4058  data_time: 0.0018  memory: 2273  
11/15 04:36:13 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:13  time: 0.4096  data_time: 0.0018  memory: 2262  
11/15 04:36:30 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:40  time: 0.3343  data_time: 0.0016  memory: 2295  
11/15 04:36:50 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:12  time: 0.3734  data_time: 0.0017  memory: 2319  
11/15 04:37:08 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:44  time: 0.3704  data_time: 0.0017  memory: 2323  
11/15 04:37:29 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:18  time: 0.4283  data_time: 0.0017  memory: 2368  
11/15 04:37:49 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:53  time: 0.3752  data_time: 0.0018  memory: 2309  
11/15 04:38:08 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:27  time: 0.3962  data_time: 0.0017  memory: 2302  
11/15 04:38:28 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:02  time: 0.3719  data_time: 0.0017  memory: 2608  
11/15 04:38:46 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:36  time: 0.3720  data_time: 0.0017  memory: 2290  
11/15 04:39:03 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:11  time: 0.3902  data_time: 0.0017  memory: 2263  
11/15 04:39:22 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:47  time: 0.3500  data_time: 0.0017  memory: 2264  
11/15 04:39:41 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:24  time: 0.4124  data_time: 0.0017  memory: 2322  
11/15 04:39:59 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:00  time: 0.4144  data_time: 0.0017  memory: 2320  
11/15 04:40:17 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:37  time: 0.3535  data_time: 0.0017  memory: 2263  
11/15 04:40:37 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:15  time: 0.3929  data_time: 0.0018  memory: 2311  
11/15 04:40:56 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:53  time: 0.3908  data_time: 0.0019  memory: 2261  
11/15 04:41:14 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:30  time: 0.3371  data_time: 0.0017  memory: 2444  
11/15 04:41:35 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:08  time: 0.3928  data_time: 0.0019  memory: 2319  
11/15 04:41:55 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:47  time: 0.3787  data_time: 0.0017  memory: 2327  
11/15 04:42:13 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:25  time: 0.4103  data_time: 0.0019  memory: 2277  
11/15 04:42:33 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:03  time: 0.4077  data_time: 0.0019  memory: 2223  
11/15 04:42:51 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:42  time: 0.3601  data_time: 0.0018  memory: 2348  
11/15 04:43:10 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:21  time: 0.3718  data_time: 0.0017  memory: 2479  
11/15 04:43:29 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.3484  data_time: 0.0028  memory: 2357  
11/15 04:43:29 - mmengine - INFO - per class results:
11/15 04:43:29 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.79 | 88.54 |
|       building      | 79.86 | 93.58 |
|         sky         | 92.91 | 97.72 |
|        floor        |  75.9 | 91.13 |
|         tree        | 69.89 | 87.56 |
|       ceiling       | 78.31 | 86.88 |
|         road        | 80.48 | 87.54 |
|         bed         | 87.18 | 94.14 |
|      windowpane     | 59.31 | 71.04 |
|        grass        | 67.02 | 86.24 |
|       cabinet       | 56.09 | 66.74 |
|       sidewalk      | 59.28 | 76.97 |
|        person       | 79.59 |  92.2 |
|        earth        | 31.88 | 51.01 |
|         door        | 38.75 | 49.11 |
|        table        | 58.38 | 72.54 |
|       mountain      | 55.52 | 66.07 |
|        plant        | 45.66 |  52.9 |
|       curtain       |  62.1 | 70.23 |
|        chair        | 53.21 | 64.76 |
|         car         | 82.69 | 92.06 |
|        water        | 54.37 | 71.14 |
|       painting      | 69.33 | 81.32 |
|         sofa        |  69.6 | 84.47 |
|        shelf        |  39.9 | 57.31 |
|        house        | 37.41 | 44.76 |
|         sea         |  50.1 | 65.36 |
|        mirror       | 60.42 | 64.59 |
|         rug         |  48.2 | 50.12 |
|        field        | 28.75 | 36.28 |
|       armchair      | 46.19 | 64.96 |
|         seat        | 52.75 | 69.77 |
|        fence        | 35.32 | 41.92 |
|         desk        | 48.48 | 67.98 |
|         rock        | 45.16 | 73.06 |
|       wardrobe      |  46.2 | 68.72 |
|         lamp        | 59.83 | 66.26 |
|       bathtub       | 70.67 | 76.23 |
|       railing       | 28.41 | 34.06 |
|       cushion       | 52.65 | 62.71 |
|         base        | 20.85 | 27.62 |
|         box         | 23.12 | 33.29 |
|        column       | 44.98 | 57.41 |
|      signboard      | 35.34 | 46.98 |
|   chest of drawers  | 43.04 | 62.15 |
|       counter       | 29.25 | 34.16 |
|         sand        | 36.04 | 57.43 |
|         sink        | 67.94 |  74.0 |
|      skyscraper     |  50.1 | 61.52 |
|      fireplace      | 75.04 | 86.68 |
|     refrigerator    | 70.35 | 78.83 |
|      grandstand     |  44.2 | 72.03 |
|         path        | 23.24 | 32.15 |
|        stairs       | 26.63 | 30.13 |
|        runway       | 66.98 | 85.08 |
|         case        | 37.83 | 44.81 |
|      pool table     | 91.12 | 92.73 |
|        pillow       | 50.74 | 64.07 |
|     screen door     | 41.85 | 42.53 |
|       stairway      | 33.75 | 42.11 |
|        river        | 14.94 | 20.92 |
|        bridge       | 50.16 | 53.53 |
|       bookcase      | 37.54 | 50.51 |
|        blind        | 24.22 | 25.03 |
|     coffee table    |  65.2 | 75.38 |
|        toilet       | 79.59 |  85.1 |
|        flower       | 37.71 | 55.36 |
|         book        | 46.01 | 59.56 |
|         hill        |  4.71 |  6.96 |
|        bench        | 40.45 | 48.12 |
|      countertop     | 51.86 | 60.29 |
|        stove        | 69.09 | 76.09 |
|         palm        |  48.8 | 62.72 |
|    kitchen island   | 33.69 | 48.61 |
|       computer      | 60.97 | 72.57 |
|     swivel chair    | 35.31 | 48.11 |
|         boat        | 53.17 | 59.78 |
|         bar         | 24.07 | 26.38 |
|    arcade machine   |  21.3 | 21.71 |
|        hovel        | 33.82 | 40.71 |
|         bus         | 86.98 | 93.03 |
|        towel        | 55.02 | 66.25 |
|        light        | 42.41 | 45.11 |
|        truck        | 31.66 | 41.84 |
|        tower        |  5.8  |  7.62 |
|      chandelier     | 62.51 | 72.25 |
|        awning       | 22.39 | 24.86 |
|     streetlight     | 27.53 | 32.75 |
|        booth        | 42.41 | 47.58 |
| television receiver | 56.75 | 65.68 |
|       airplane      | 63.83 | 74.55 |
|      dirt track     | 11.23 | 16.76 |
|       apparel       | 30.97 | 48.16 |
|         pole        | 23.04 | 37.63 |
|         land        |  1.7  |  2.29 |
|      bannister      |  10.2 | 14.28 |
|      escalator      | 24.27 | 29.15 |
|       ottoman       | 46.43 | 67.53 |
|        bottle       | 38.61 | 58.81 |
|        buffet       | 39.77 | 46.06 |
|        poster       |  29.1 | 42.81 |
|        stage        |  7.81 | 11.43 |
|         van         | 41.17 | 59.44 |
|         ship        | 11.56 | 14.86 |
|       fountain      | 30.17 |  31.0 |
|    conveyer belt    | 70.69 | 87.47 |
|        canopy       | 17.06 |  18.1 |
|        washer       |  72.6 | 75.87 |
|      plaything      | 21.69 | 31.54 |
|    swimming pool    | 56.22 | 57.67 |
|        stool        | 39.28 | 58.32 |
|        barrel       | 23.04 | 41.07 |
|        basket       |  27.0 | 33.97 |
|      waterfall      | 35.95 |  40.5 |
|         tent        | 89.46 | 98.42 |
|         bag         |  15.2 | 22.83 |
|       minibike      | 68.16 | 85.14 |
|        cradle       | 79.31 | 93.15 |
|         oven        | 28.75 | 58.08 |
|         ball        | 45.58 | 67.94 |
|         food        | 54.21 | 76.69 |
|         step        |  2.41 |  2.98 |
|         tank        | 34.81 | 35.85 |
|      trade name     |  25.7 | 29.06 |
|      microwave      | 36.92 | 38.36 |
|         pot         | 36.55 | 42.03 |
|        animal       | 61.92 |  65.1 |
|       bicycle       | 58.45 | 76.86 |
|         lake        | 56.61 | 56.78 |
|      dishwasher     | 57.85 | 60.31 |
|        screen       | 64.48 | 84.83 |
|       blanket       | 12.23 | 14.25 |
|      sculpture      | 60.21 | 81.92 |
|         hood        | 45.12 | 46.56 |
|        sconce       |  40.7 | 43.83 |
|         vase        | 39.38 | 50.73 |
|    traffic light    | 32.31 | 47.99 |
|         tray        | 12.38 |  17.4 |
|        ashcan       | 30.39 | 37.98 |
|         fan         | 59.17 | 70.23 |
|         pier        | 31.14 | 39.75 |
|      crt screen     |  6.46 | 10.46 |
|        plate        | 52.45 | 72.07 |
|       monitor       | 25.96 | 29.76 |
|    bulletin board   | 39.01 | 51.68 |
|        shower       |  2.57 |  8.35 |
|       radiator      | 26.49 | 27.36 |
|        glass        |  13.7 | 14.42 |
|        clock        | 34.74 | 37.98 |
|         flag        | 59.22 | 72.04 |
+---------------------+-------+-------+
11/15 04:43:29 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.5900  mIoU: 44.8200  mAcc: 54.7200  data_time: 0.0028  time: 0.4222
Finished processing corruption type: gaussian_noise
Processing corruption type: shot_noise
11/15 04:43:55 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 211611595
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 211611595
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 04:43:55 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='shot_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/shot_noise'

Number of parameters:  163407980
11/15 04:44:01 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 04:44:01 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 04:44:02 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 04:44:03 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 04:44:36 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:21:16  time: 0.5731  data_time: 0.0019  memory: 26008  
11/15 04:45:02 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:18:47  time: 0.5455  data_time: 0.0018  memory: 2338  
11/15 04:45:28 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:17:26  time: 0.5279  data_time: 0.0018  memory: 2271  
11/15 04:45:55 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:48  time: 0.5441  data_time: 0.0018  memory: 2434  
11/15 04:46:20 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:59  time: 0.5211  data_time: 0.0017  memory: 2489  
11/15 04:46:46 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:15:22  time: 0.5453  data_time: 0.0018  memory: 2330  
11/15 04:47:12 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:14:50  time: 0.4994  data_time: 0.0017  memory: 2330  
11/15 04:47:38 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:14:20  time: 0.5421  data_time: 0.0017  memory: 2334  
11/15 04:48:01 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:13:39  time: 0.4901  data_time: 0.0017  memory: 2268  
11/15 04:48:27 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:13:11  time: 0.4988  data_time: 0.0017  memory: 2272  
11/15 04:48:54 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:12:47  time: 0.5663  data_time: 0.0018  memory: 2325  
11/15 04:49:20 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:12:20  time: 0.5494  data_time: 0.0021  memory: 2333  
11/15 04:49:46 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:52  time: 0.5239  data_time: 0.0017  memory: 2353  
11/15 04:50:14 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:28  time: 0.5449  data_time: 0.0020  memory: 2349  
11/15 04:50:40 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:02  time: 0.5338  data_time: 0.0017  memory: 2363  
11/15 04:51:04 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:31  time: 0.5416  data_time: 0.0018  memory: 2273  
11/15 04:51:31 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:06  time: 0.5483  data_time: 0.0019  memory: 2262  
11/15 04:51:54 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:36  time: 0.4475  data_time: 0.0017  memory: 2295  
11/15 04:52:21 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:09:10  time: 0.5003  data_time: 0.0018  memory: 2319  
11/15 04:52:45 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:42  time: 0.4927  data_time: 0.0018  memory: 2323  
11/15 04:53:13 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:08:17  time: 0.5591  data_time: 0.0018  memory: 2368  
11/15 04:53:39 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:51  time: 0.5002  data_time: 0.0018  memory: 2309  
11/15 04:54:05 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:24  time: 0.5250  data_time: 0.0018  memory: 2302  
11/15 04:54:31 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:58  time: 0.5003  data_time: 0.0017  memory: 2608  
11/15 04:54:55 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:31  time: 0.4993  data_time: 0.0017  memory: 2290  
11/15 04:55:18 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:03  time: 0.5213  data_time: 0.0017  memory: 2263  
11/15 04:55:44 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:37  time: 0.4752  data_time: 0.0017  memory: 2264  
11/15 04:56:09 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:11  time: 0.5494  data_time: 0.0017  memory: 2322  
11/15 04:56:33 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:44  time: 0.5483  data_time: 0.0017  memory: 2320  
11/15 04:56:58 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:18  time: 0.4734  data_time: 0.0018  memory: 2263  
11/15 04:57:25 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:52  time: 0.5293  data_time: 0.0019  memory: 2311  
11/15 04:57:50 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:26  time: 0.5201  data_time: 0.0019  memory: 2261  
11/15 04:58:14 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:03:00  time: 0.4537  data_time: 0.0017  memory: 2444  
11/15 04:58:41 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:34  time: 0.5300  data_time: 0.0019  memory: 2319  
11/15 04:59:08 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:09  time: 0.5054  data_time: 0.0017  memory: 2327  
11/15 04:59:32 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:43  time: 0.5464  data_time: 0.0019  memory: 2277  
11/15 04:59:59 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:17  time: 0.5442  data_time: 0.0019  memory: 2223  
11/15 05:00:22 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:51  time: 0.4771  data_time: 0.0017  memory: 2348  
11/15 05:00:49 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:25  time: 0.5031  data_time: 0.0017  memory: 2479  
11/15 05:01:13 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.4671  data_time: 0.0016  memory: 2357  
11/15 05:01:13 - mmengine - INFO - per class results:
11/15 05:01:13 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  72.0 | 88.66 |
|       building      | 79.96 | 93.56 |
|         sky         | 92.86 | 97.76 |
|        floor        | 76.69 | 91.11 |
|         tree        | 70.96 | 86.89 |
|       ceiling       | 76.31 | 85.45 |
|         road        | 81.45 | 88.83 |
|         bed         | 87.87 |  95.0 |
|      windowpane     | 58.03 | 68.75 |
|        grass        | 65.52 | 83.97 |
|       cabinet       | 56.11 | 66.87 |
|       sidewalk      | 58.09 | 76.51 |
|        person       | 80.73 | 92.47 |
|        earth        | 32.94 | 52.23 |
|         door        |  38.6 | 48.13 |
|        table        | 59.07 | 73.71 |
|       mountain      | 55.59 | 64.66 |
|        plant        | 46.57 | 53.85 |
|       curtain       | 60.29 | 69.01 |
|        chair        | 55.89 | 67.32 |
|         car         | 83.52 | 92.51 |
|        water        | 55.59 | 71.95 |
|       painting      | 69.57 |  82.2 |
|         sofa        |  68.3 | 82.62 |
|        shelf        | 37.84 | 53.57 |
|        house        |  36.0 | 43.66 |
|         sea         | 52.85 | 69.14 |
|        mirror       | 57.74 | 61.27 |
|         rug         | 44.91 | 46.73 |
|        field        | 27.69 | 36.51 |
|       armchair      | 47.19 | 65.47 |
|         seat        | 54.72 | 72.99 |
|        fence        | 36.74 | 44.37 |
|         desk        | 48.47 | 69.53 |
|         rock        | 45.74 | 75.83 |
|       wardrobe      | 46.84 | 68.73 |
|         lamp        |  57.3 | 63.62 |
|       bathtub       | 63.06 | 69.08 |
|       railing       |  28.7 | 33.71 |
|       cushion       | 53.15 | 63.77 |
|         base        | 22.01 | 28.71 |
|         box         | 23.11 | 34.31 |
|        column       | 44.68 | 56.79 |
|      signboard      | 34.32 | 46.42 |
|   chest of drawers  | 42.88 | 63.68 |
|       counter       | 28.26 |  32.6 |
|         sand        | 38.86 | 60.97 |
|         sink        | 66.34 |  73.1 |
|      skyscraper     | 52.21 | 64.77 |
|      fireplace      | 73.89 | 85.37 |
|     refrigerator    |  69.0 | 76.07 |
|      grandstand     | 43.59 | 70.03 |
|         path        | 22.03 | 30.27 |
|        stairs       | 26.78 | 30.93 |
|        runway       | 68.45 | 86.05 |
|         case        | 36.75 |  45.7 |
|      pool table     | 93.04 | 94.99 |
|        pillow       | 50.69 |  62.6 |
|     screen door     | 46.53 | 47.75 |
|       stairway      | 35.78 | 43.24 |
|        river        | 15.21 | 21.59 |
|        bridge       | 48.68 | 52.63 |
|       bookcase      | 36.08 |  48.3 |
|        blind        | 24.03 | 24.98 |
|     coffee table    | 63.54 |  74.4 |
|        toilet       | 73.67 |  79.6 |
|        flower       | 33.66 | 50.37 |
|         book        | 46.33 |  60.8 |
|         hill        |  4.3  |  7.14 |
|        bench        | 40.49 | 48.18 |
|      countertop     | 51.07 | 59.06 |
|        stove        | 69.43 | 76.14 |
|         palm        | 51.61 |  66.8 |
|    kitchen island   | 32.72 | 50.42 |
|       computer      | 62.59 | 75.27 |
|     swivel chair    | 36.11 | 52.66 |
|         boat        | 54.59 | 61.55 |
|         bar         | 29.31 | 32.26 |
|    arcade machine   | 21.39 |  21.9 |
|        hovel        |  32.5 | 39.66 |
|         bus         | 84.67 | 92.67 |
|        towel        | 46.55 | 55.29 |
|        light        | 36.24 | 38.22 |
|        truck        | 33.35 | 45.09 |
|        tower        |  5.63 |  7.68 |
|      chandelier     | 56.94 |  65.2 |
|        awning       | 23.53 | 26.05 |
|     streetlight     | 26.89 | 32.54 |
|        booth        | 39.06 | 46.69 |
| television receiver | 65.02 | 71.23 |
|       airplane      | 71.62 | 84.89 |
|      dirt track     | 11.14 | 17.28 |
|       apparel       | 30.88 | 46.89 |
|         pole        | 23.29 | 37.97 |
|         land        |  0.0  |  0.0  |
|      bannister      |  8.09 | 10.63 |
|      escalator      | 23.08 | 27.09 |
|       ottoman       | 47.42 | 67.39 |
|        bottle       | 39.28 | 60.62 |
|        buffet       | 52.67 | 58.54 |
|        poster       | 29.27 | 42.17 |
|        stage        |  8.43 | 12.71 |
|         van         | 42.91 | 60.05 |
|         ship        | 13.86 | 17.51 |
|       fountain      | 24.13 | 24.64 |
|    conveyer belt    | 66.75 | 85.86 |
|        canopy       | 14.98 | 15.84 |
|        washer       | 70.41 | 71.25 |
|      plaything      | 21.61 | 29.42 |
|    swimming pool    | 58.14 | 59.91 |
|        stool        | 45.81 | 62.51 |
|        barrel       | 45.27 | 71.65 |
|        basket       | 35.02 | 43.61 |
|      waterfall      |  36.9 | 39.93 |
|         tent        |  91.2 | 98.45 |
|         bag         | 17.12 | 24.15 |
|       minibike      | 71.79 |  87.5 |
|        cradle       | 80.36 | 93.48 |
|         oven        | 35.22 | 71.81 |
|         ball        | 45.83 | 68.39 |
|         food        | 52.35 | 74.82 |
|         step        |  1.13 |  1.35 |
|         tank        | 36.05 | 37.06 |
|      trade name     | 23.41 | 26.51 |
|      microwave      | 45.41 | 47.84 |
|         pot         | 43.23 | 49.71 |
|        animal       | 62.01 | 65.25 |
|       bicycle       | 59.31 | 78.83 |
|         lake        | 54.93 | 55.04 |
|      dishwasher     | 55.62 | 63.62 |
|        screen       | 66.13 | 83.94 |
|       blanket       | 11.11 | 12.79 |
|      sculpture      | 60.57 | 78.56 |
|         hood        | 41.47 | 42.11 |
|        sconce       | 32.88 | 35.14 |
|         vase        |  37.0 | 49.47 |
|    traffic light    | 32.96 | 49.39 |
|         tray        | 12.53 |  19.6 |
|        ashcan       | 38.47 | 48.19 |
|         fan         | 56.48 | 66.64 |
|         pier        | 31.54 | 41.25 |
|      crt screen     |  5.54 |  9.65 |
|        plate        | 51.23 | 70.81 |
|       monitor       | 32.43 | 38.66 |
|    bulletin board   | 35.74 | 47.79 |
|        shower       |  2.05 |  4.6  |
|       radiator      | 27.92 |  28.7 |
|        glass        | 13.13 | 13.74 |
|        clock        | 35.49 | 38.82 |
|         flag        | 62.68 | 73.37 |
+---------------------+-------+-------+
11/15 05:01:13 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.5300  mIoU: 45.1300  mAcc: 55.1700  data_time: 0.0021  time: 0.5149
Finished processing corruption type: shot_noise
Processing corruption type: impulse_noise
11/15 05:01:16 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 750904781
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 750904781
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 05:01:17 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='impulse_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/impulse_noise'

Number of parameters:  163407980
11/15 05:01:23 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 05:01:23 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 05:01:23 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 05:01:24 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 05:01:49 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:16:18  time: 0.4117  data_time: 0.0019  memory: 26008  
11/15 05:02:08 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:14:02  time: 0.3938  data_time: 0.0034  memory: 2338  
11/15 05:02:27 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:12:49  time: 0.3769  data_time: 0.0031  memory: 2271  
11/15 05:02:46 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:12:15  time: 0.3892  data_time: 0.0017  memory: 2434  
11/15 05:03:04 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:11:36  time: 0.3739  data_time: 0.0018  memory: 2489  
11/15 05:03:22 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:11:07  time: 0.3916  data_time: 0.0019  memory: 2330  
11/15 05:03:41 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:10:43  time: 0.3538  data_time: 0.0017  memory: 2330  
11/15 05:03:59 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:10:19  time: 0.3892  data_time: 0.0017  memory: 2334  
11/15 05:04:15 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:09:48  time: 0.3489  data_time: 0.0017  memory: 2268  
11/15 05:04:33 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:27  time: 0.3538  data_time: 0.0017  memory: 2272  
11/15 05:04:53 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:10  time: 0.4084  data_time: 0.0018  memory: 2325  
11/15 05:05:11 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:50  time: 0.3922  data_time: 0.0019  memory: 2333  
11/15 05:05:29 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:08:29  time: 0.3709  data_time: 0.0017  memory: 2353  
11/15 05:05:49 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:08:12  time: 0.3903  data_time: 0.0018  memory: 2349  
11/15 05:06:08 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:53  time: 0.3853  data_time: 0.0017  memory: 2363  
11/15 05:06:25 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:07:31  time: 0.3902  data_time: 0.0019  memory: 2273  
11/15 05:06:45 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:07:13  time: 0.3912  data_time: 0.0019  memory: 2262  
11/15 05:07:01 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:06:51  time: 0.3145  data_time: 0.0017  memory: 2295  
11/15 05:07:20 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:06:32  time: 0.3534  data_time: 0.0018  memory: 2319  
11/15 05:07:37 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:12  time: 0.3525  data_time: 0.0018  memory: 2323  
11/15 05:07:57 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:05:54  time: 0.4079  data_time: 0.0017  memory: 2368  
11/15 05:08:16 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:36  time: 0.3555  data_time: 0.0018  memory: 2309  
11/15 05:08:34 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:17  time: 0.3739  data_time: 0.0017  memory: 2302  
11/15 05:08:53 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:58  time: 0.3541  data_time: 0.0017  memory: 2608  
11/15 05:09:09 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:39  time: 0.3552  data_time: 0.0017  memory: 2290  
11/15 05:09:26 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:19  time: 0.3725  data_time: 0.0017  memory: 2263  
11/15 05:09:44 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:00  time: 0.3351  data_time: 0.0017  memory: 2264  
11/15 05:10:02 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:41  time: 0.3904  data_time: 0.0017  memory: 2322  
11/15 05:10:18 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:22  time: 0.3927  data_time: 0.0017  memory: 2320  
11/15 05:10:36 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:04  time: 0.3342  data_time: 0.0017  memory: 2263  
11/15 05:10:55 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:45  time: 0.3763  data_time: 0.0018  memory: 2311  
11/15 05:11:13 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:27  time: 0.3717  data_time: 0.0019  memory: 2261  
11/15 05:11:30 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:08  time: 0.3169  data_time: 0.0017  memory: 2444  
11/15 05:11:50 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:50  time: 0.3755  data_time: 0.0022  memory: 2319  
11/15 05:12:09 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:32  time: 0.3550  data_time: 0.0017  memory: 2327  
11/15 05:12:26 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:13  time: 0.3947  data_time: 0.0020  memory: 2277  
11/15 05:12:45 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:55  time: 0.3925  data_time: 0.0020  memory: 2223  
11/15 05:13:02 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:36  time: 0.3363  data_time: 0.0018  memory: 2348  
11/15 05:13:20 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:18  time: 0.3546  data_time: 0.0018  memory: 2479  
11/15 05:13:38 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.3318  data_time: 0.0016  memory: 2357  
11/15 05:13:38 - mmengine - INFO - per class results:
11/15 05:13:38 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 71.71 |  88.3 |
|       building      |  79.9 | 93.39 |
|         sky         | 93.04 | 97.45 |
|        floor        |  74.0 | 91.33 |
|         tree        | 69.41 | 87.58 |
|       ceiling       | 78.04 | 86.96 |
|         road        | 79.72 |  87.6 |
|         bed         | 86.18 | 92.97 |
|      windowpane     | 60.33 | 71.46 |
|        grass        | 64.18 | 82.61 |
|       cabinet       |  54.3 | 65.19 |
|       sidewalk      | 57.62 | 76.62 |
|        person       | 78.04 | 91.23 |
|        earth        | 32.31 | 50.51 |
|         door        | 38.21 | 49.39 |
|        table        |  55.8 | 71.11 |
|       mountain      | 52.41 |  62.6 |
|        plant        | 44.36 | 50.42 |
|       curtain       | 61.13 | 70.06 |
|        chair        | 51.16 |  61.2 |
|         car         | 81.77 | 92.11 |
|        water        | 55.35 | 75.18 |
|       painting      | 67.28 |  81.2 |
|         sofa        | 68.74 | 83.81 |
|        shelf        | 37.61 | 55.04 |
|        house        | 36.59 | 43.86 |
|         sea         | 56.05 | 74.82 |
|        mirror       | 61.97 | 66.64 |
|         rug         |  35.7 | 37.05 |
|        field        | 25.41 | 34.51 |
|       armchair      | 43.83 | 58.73 |
|         seat        | 48.97 | 66.94 |
|        fence        | 39.84 | 48.85 |
|         desk        | 47.55 | 66.86 |
|         rock        | 46.13 | 75.92 |
|       wardrobe      | 41.04 | 59.86 |
|         lamp        | 56.42 | 61.39 |
|       bathtub       | 65.81 | 69.91 |
|       railing       | 25.53 | 30.13 |
|       cushion       | 52.56 | 61.06 |
|         base        | 19.78 | 26.29 |
|         box         | 20.65 | 31.03 |
|        column       |  39.8 | 50.37 |
|      signboard      | 33.97 | 47.15 |
|   chest of drawers  | 44.47 | 66.58 |
|       counter       | 32.94 | 37.25 |
|         sand        | 34.81 | 51.22 |
|         sink        | 65.66 | 75.53 |
|      skyscraper     | 50.87 | 61.74 |
|      fireplace      |  74.5 | 85.99 |
|     refrigerator    | 66.61 | 75.83 |
|      grandstand     | 47.28 | 75.05 |
|         path        | 21.98 | 28.31 |
|        stairs       | 27.14 | 30.12 |
|        runway       | 68.06 | 83.38 |
|         case        | 35.22 | 45.37 |
|      pool table     | 91.79 | 93.46 |
|        pillow       | 50.49 | 61.91 |
|     screen door     | 45.59 | 46.87 |
|       stairway      | 34.47 |  40.3 |
|        river        | 11.76 | 14.76 |
|        bridge       | 53.01 | 57.04 |
|       bookcase      |  35.8 | 44.72 |
|        blind        |  18.3 | 19.32 |
|     coffee table    |  61.2 | 70.62 |
|        toilet       | 74.86 | 78.75 |
|        flower       | 33.57 |  48.5 |
|         book        | 43.38 | 56.01 |
|         hill        |  4.43 |  6.11 |
|        bench        | 40.41 | 44.92 |
|      countertop     | 50.72 | 57.13 |
|        stove        | 66.24 | 75.13 |
|         palm        | 49.62 | 65.93 |
|    kitchen island   | 30.71 | 45.83 |
|       computer      |  58.6 | 73.36 |
|     swivel chair    | 31.54 | 42.03 |
|         boat        |  52.0 | 58.34 |
|         bar         |  21.4 | 22.33 |
|    arcade machine   | 31.79 | 32.41 |
|        hovel        | 34.26 | 40.84 |
|         bus         | 85.65 | 92.87 |
|        towel        | 49.16 | 54.56 |
|        light        | 40.19 | 42.56 |
|        truck        | 32.78 | 42.03 |
|        tower        |  6.56 |  9.09 |
|      chandelier     | 57.96 | 65.61 |
|        awning       | 22.23 | 24.54 |
|     streetlight     | 27.52 | 31.48 |
|        booth        | 41.46 | 42.78 |
| television receiver | 51.44 | 62.14 |
|       airplane      | 66.11 | 79.92 |
|      dirt track     | 11.73 |  13.4 |
|       apparel       |  32.3 |  45.3 |
|         pole        | 21.71 |  34.2 |
|         land        |  0.38 |  0.52 |
|      bannister      |  9.48 | 12.61 |
|      escalator      | 33.03 | 40.12 |
|       ottoman       | 45.65 | 64.46 |
|        bottle       | 38.42 | 60.43 |
|        buffet       | 51.79 | 61.13 |
|        poster       | 32.23 |  42.9 |
|        stage        |  8.13 | 11.71 |
|         van         | 41.91 | 58.29 |
|         ship        | 10.68 | 13.43 |
|       fountain      | 22.74 | 24.25 |
|    conveyer belt    | 65.19 | 85.08 |
|        canopy       | 14.53 | 16.02 |
|        washer       | 67.94 | 71.97 |
|      plaything      | 20.15 | 27.65 |
|    swimming pool    | 55.19 | 58.05 |
|        stool        | 38.09 | 56.04 |
|        barrel       | 31.02 | 31.18 |
|        basket       | 27.98 | 33.85 |
|      waterfall      | 33.61 | 37.46 |
|         tent        | 88.99 | 98.99 |
|         bag         | 12.97 | 18.65 |
|       minibike      | 65.99 | 85.33 |
|        cradle       | 78.36 | 92.38 |
|         oven        |  31.6 |  39.8 |
|         ball        | 43.12 | 62.75 |
|         food        | 53.29 | 78.32 |
|         step        |  2.25 |  2.74 |
|         tank        |  41.0 | 42.63 |
|      trade name     | 22.12 | 25.12 |
|      microwave      | 34.37 | 37.38 |
|         pot         | 37.41 | 42.48 |
|        animal       |  59.1 | 61.48 |
|       bicycle       | 55.33 | 73.07 |
|         lake        | 62.55 | 62.79 |
|      dishwasher     | 58.38 | 64.45 |
|        screen       | 59.47 | 84.37 |
|       blanket       |  8.92 | 10.16 |
|      sculpture      | 60.97 | 76.47 |
|         hood        | 49.28 |  51.5 |
|        sconce       | 34.69 | 37.18 |
|         vase        | 38.98 | 47.74 |
|    traffic light    | 31.79 | 49.51 |
|         tray        | 13.09 | 20.51 |
|        ashcan       | 28.36 | 34.86 |
|         fan         | 58.08 | 67.47 |
|         pier        | 29.54 | 44.56 |
|      crt screen     |  6.46 | 11.14 |
|        plate        | 52.94 | 71.44 |
|       monitor       |  17.9 | 19.75 |
|    bulletin board   | 32.34 |  49.5 |
|        shower       |  1.65 |  4.94 |
|       radiator      | 23.23 | 23.79 |
|        glass        | 12.28 | 12.81 |
|        clock        | 30.94 | 35.98 |
|         flag        | 54.54 | 65.58 |
+---------------------+-------+-------+
11/15 05:13:38 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.9700  mIoU: 43.8200  mAcc: 53.3000  data_time: 0.0021  time: 0.3667
Finished processing corruption type: impulse_noise
Processing corruption type: defocus_blur
11/15 05:13:41 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 356454171
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 356454171
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 05:13:41 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='defocus_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/defocus_blur'

Number of parameters:  163407980
11/15 05:13:48 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 05:13:48 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 05:13:48 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 05:13:49 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 05:14:15 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:17:10  time: 0.4187  data_time: 0.0018  memory: 26008  
11/15 05:14:35 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:14:34  time: 0.4036  data_time: 0.0019  memory: 2338  
11/15 05:14:54 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:13:16  time: 0.3884  data_time: 0.0019  memory: 2271  
11/15 05:15:13 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:12:39  time: 0.3964  data_time: 0.0018  memory: 2434  
11/15 05:15:31 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:11:57  time: 0.3802  data_time: 0.0018  memory: 2489  
11/15 05:15:50 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:11:27  time: 0.4006  data_time: 0.0020  memory: 2330  
11/15 05:16:09 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:11:01  time: 0.3594  data_time: 0.0018  memory: 2330  
11/15 05:16:28 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:10:36  time: 0.3986  data_time: 0.0017  memory: 2334  
11/15 05:16:45 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:04  time: 0.3575  data_time: 0.0017  memory: 2268  
11/15 05:17:03 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:43  time: 0.3565  data_time: 0.0017  memory: 2272  
11/15 05:17:23 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:24  time: 0.4154  data_time: 0.0018  memory: 2325  
11/15 05:17:42 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:09:03  time: 0.4029  data_time: 0.0020  memory: 2333  
11/15 05:18:01 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:08:42  time: 0.3829  data_time: 0.0017  memory: 2353  
11/15 05:18:21 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:08:24  time: 0.3963  data_time: 0.0019  memory: 2349  
11/15 05:18:40 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:08:05  time: 0.3941  data_time: 0.0017  memory: 2363  
11/15 05:18:57 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:07:42  time: 0.3905  data_time: 0.0020  memory: 2273  
11/15 05:19:17 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:07:23  time: 0.3909  data_time: 0.0020  memory: 2262  
11/15 05:19:33 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:00  time: 0.3215  data_time: 0.0017  memory: 2295  
11/15 05:19:52 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:06:41  time: 0.3639  data_time: 0.0019  memory: 2319  
11/15 05:20:10 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:21  time: 0.3639  data_time: 0.0019  memory: 2323  
11/15 05:20:30 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:03  time: 0.4144  data_time: 0.0017  memory: 2368  
11/15 05:20:50 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:44  time: 0.3579  data_time: 0.0019  memory: 2309  
11/15 05:21:08 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:24  time: 0.3796  data_time: 0.0018  memory: 2302  
11/15 05:21:27 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:05  time: 0.3616  data_time: 0.0017  memory: 2608  
11/15 05:21:44 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:45  time: 0.3598  data_time: 0.0018  memory: 2290  
11/15 05:22:01 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:24  time: 0.3762  data_time: 0.0017  memory: 2263  
11/15 05:22:19 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:05  time: 0.3382  data_time: 0.0018  memory: 2264  
11/15 05:22:38 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:46  time: 0.3989  data_time: 0.0018  memory: 2322  
11/15 05:22:55 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:26  time: 0.3989  data_time: 0.0018  memory: 2320  
11/15 05:23:13 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:07  time: 0.3415  data_time: 0.0018  memory: 2263  
11/15 05:23:32 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:49  time: 0.3839  data_time: 0.0018  memory: 2311  
11/15 05:23:51 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:30  time: 0.3814  data_time: 0.0020  memory: 2261  
11/15 05:24:08 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:11  time: 0.3241  data_time: 0.0017  memory: 2444  
11/15 05:24:28 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:52  time: 0.3848  data_time: 0.0020  memory: 2319  
11/15 05:24:47 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:34  time: 0.3628  data_time: 0.0017  memory: 2327  
11/15 05:25:05 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:15  time: 0.4004  data_time: 0.0020  memory: 2277  
11/15 05:25:25 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:56  time: 0.4000  data_time: 0.0019  memory: 2223  
11/15 05:25:42 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:37  time: 0.3456  data_time: 0.0017  memory: 2348  
11/15 05:26:01 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:18  time: 0.3619  data_time: 0.0017  memory: 2479  
11/15 05:26:18 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.3393  data_time: 0.0029  memory: 2357  
11/15 05:26:18 - mmengine - INFO - per class results:
11/15 05:26:18 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 78.72 | 88.54 |
|       building      | 82.42 | 93.81 |
|         sky         | 94.15 | 97.33 |
|        floor        | 81.61 | 90.94 |
|         tree        | 73.59 | 86.61 |
|       ceiling       | 85.17 | 93.17 |
|         road        | 83.84 | 91.47 |
|         bed         | 89.89 | 96.75 |
|      windowpane     | 62.51 | 79.11 |
|        grass        | 68.75 | 84.54 |
|       cabinet       | 60.75 | 72.88 |
|       sidewalk      | 64.18 | 78.85 |
|        person       | 81.02 | 92.96 |
|        earth        | 35.07 | 45.86 |
|         door        | 49.32 | 62.64 |
|        table        | 63.19 | 78.79 |
|       mountain      | 61.29 | 72.55 |
|        plant        | 51.79 | 64.94 |
|       curtain       | 75.71 | 88.76 |
|        chair        |  60.0 | 75.38 |
|         car         |  84.5 | 94.13 |
|        water        | 59.51 | 78.03 |
|       painting      | 73.68 | 85.89 |
|         sofa        | 72.22 | 83.12 |
|        shelf        | 43.84 | 61.85 |
|        house        | 39.41 | 46.65 |
|         sea         |  71.0 | 79.55 |
|        mirror       | 71.62 | 82.43 |
|         rug         | 63.92 | 72.66 |
|        field        | 35.99 | 58.22 |
|       armchair      | 52.82 | 73.54 |
|         seat        |  59.9 | 79.73 |
|        fence        | 43.35 | 58.01 |
|         desk        | 51.93 | 73.06 |
|         rock        | 50.15 |  80.7 |
|       wardrobe      | 50.69 | 64.13 |
|         lamp        | 64.38 | 78.66 |
|       bathtub       | 84.16 | 87.97 |
|       railing       | 36.31 | 49.92 |
|       cushion       |  61.8 | 71.16 |
|         base        | 30.91 | 44.65 |
|         box         |  30.4 | 41.02 |
|        column       |  46.8 | 59.58 |
|      signboard      | 35.58 | 47.86 |
|   chest of drawers  | 37.26 | 60.32 |
|       counter       | 23.15 | 28.82 |
|         sand        | 51.43 | 75.47 |
|         sink        | 73.14 | 79.29 |
|      skyscraper     | 52.19 | 62.91 |
|      fireplace      | 78.79 | 91.71 |
|     refrigerator    | 70.31 | 78.87 |
|      grandstand     | 48.42 | 75.97 |
|         path        | 22.97 | 32.25 |
|        stairs       | 22.18 | 25.22 |
|        runway       | 69.89 | 90.49 |
|         case        | 48.57 | 61.18 |
|      pool table     | 93.73 | 97.51 |
|        pillow       |  56.9 | 66.87 |
|     screen door     | 78.18 | 81.67 |
|       stairway      | 30.68 | 43.16 |
|        river        | 11.47 |  25.0 |
|        bridge       | 62.58 | 71.72 |
|       bookcase      | 42.89 | 64.61 |
|        blind        | 33.69 | 36.51 |
|     coffee table    | 62.46 | 82.92 |
|        toilet       | 85.29 | 91.18 |
|        flower       | 42.45 | 65.57 |
|         book        | 44.41 | 60.81 |
|         hill        | 10.92 | 17.11 |
|        bench        | 40.04 | 48.28 |
|      countertop     | 58.53 | 78.94 |
|        stove        | 76.44 | 87.32 |
|         palm        | 46.26 | 65.72 |
|    kitchen island   |  45.5 | 77.46 |
|       computer      | 78.53 | 91.25 |
|     swivel chair    | 44.42 |  68.7 |
|         boat        | 62.55 | 74.76 |
|         bar         | 52.56 | 64.29 |
|    arcade machine   | 61.08 | 65.41 |
|        hovel        | 44.75 | 47.64 |
|         bus         | 76.68 | 91.93 |
|        towel        | 66.81 | 79.13 |
|        light        | 53.74 | 61.11 |
|        truck        |  39.6 | 48.55 |
|        tower        | 15.83 | 20.13 |
|      chandelier     | 67.28 | 79.57 |
|        awning       | 32.88 | 40.53 |
|     streetlight     | 28.19 | 37.21 |
|        booth        | 52.94 |  59.9 |
| television receiver | 73.67 | 85.01 |
|       airplane      |  63.2 | 70.41 |
|      dirt track     |  6.94 | 17.36 |
|       apparel       | 33.82 | 47.24 |
|         pole        | 19.13 | 23.33 |
|         land        |  3.25 |  5.77 |
|      bannister      |  9.95 | 12.71 |
|      escalator      | 37.02 | 46.36 |
|       ottoman       | 45.17 | 56.42 |
|        bottle       | 36.48 | 58.33 |
|        buffet       | 48.83 | 53.21 |
|        poster       | 27.16 | 35.83 |
|        stage        |  18.0 | 31.62 |
|         van         | 39.12 | 48.51 |
|         ship        | 12.36 | 15.03 |
|       fountain      | 33.29 | 33.96 |
|    conveyer belt    | 73.37 | 91.19 |
|        canopy       | 34.82 | 46.95 |
|        washer       | 76.97 | 79.61 |
|      plaything      | 28.65 | 45.39 |
|    swimming pool    | 81.03 | 92.27 |
|        stool        | 45.95 | 60.08 |
|        barrel       | 61.61 | 71.93 |
|        basket       | 25.14 | 29.39 |
|      waterfall      | 41.51 | 59.33 |
|         tent        | 90.77 | 99.18 |
|         bag         |  8.7  |  9.65 |
|       minibike      | 67.51 | 84.77 |
|        cradle       | 75.14 | 97.19 |
|         oven        | 66.28 | 79.09 |
|         ball        | 53.31 | 65.53 |
|         food        | 45.33 |  54.5 |
|         step        |  8.91 |  9.54 |
|         tank        | 65.26 | 68.27 |
|      trade name     | 21.57 | 24.77 |
|      microwave      | 84.34 | 91.86 |
|         pot         | 47.16 | 53.68 |
|        animal       | 56.12 | 57.61 |
|       bicycle       | 53.58 | 72.85 |
|         lake        | 47.65 | 63.86 |
|      dishwasher     | 62.75 | 75.75 |
|        screen       | 60.06 | 88.97 |
|       blanket       | 11.52 | 13.32 |
|      sculpture      | 64.65 | 78.68 |
|         hood        | 63.37 | 67.66 |
|        sconce       | 44.87 | 56.84 |
|         vase        | 39.91 | 52.91 |
|    traffic light    | 34.26 | 57.14 |
|         tray        |  6.98 | 12.63 |
|        ashcan       | 42.28 |  55.9 |
|         fan         | 62.06 | 75.49 |
|         pier        | 25.15 |  29.4 |
|      crt screen     |  13.7 | 18.98 |
|        plate        |  49.5 | 72.17 |
|       monitor       | 57.19 | 71.65 |
|    bulletin board   | 38.08 | 47.65 |
|        shower       |  4.6  |  6.79 |
|       radiator      | 51.52 | 54.75 |
|        glass        | 13.28 | 14.05 |
|        clock        |  43.4 | 51.82 |
|         flag        |  61.9 | 68.34 |
+---------------------+-------+-------+
11/15 05:26:18 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 83.7200  mIoU: 50.9000  mAcc: 62.4300  data_time: 0.0021  time: 0.3745
Finished processing corruption type: defocus_blur
Processing corruption type: glass_blur
11/15 05:26:22 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 219257955
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 219257955
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 05:26:22 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='glass_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/glass_blur'

Number of parameters:  163407980
11/15 05:26:28 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 05:26:28 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 05:26:29 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 05:26:29 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 05:35:40 - mmengine - INFO - Iter(test) [  50/2000]    eta: 5:57:43  time: 11.4681  data_time: 0.0019  memory: 26008  
11/15 05:44:37 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 5:44:27  time: 11.2507  data_time: 0.0020  memory: 2338  
11/15 05:53:38 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 5:34:48  time: 10.9674  data_time: 0.0019  memory: 2271  
11/15 06:02:48 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 5:26:44  time: 10.7769  data_time: 0.0019  memory: 2434  
11/15 06:11:29 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 5:14:54  time: 10.5763  data_time: 0.0019  memory: 2489  
11/15 06:20:11 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 5:04:16  time: 10.9867  data_time: 0.0019  memory: 2330  
11/15 06:29:08 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 4:55:19  time: 10.1764  data_time: 0.0018  memory: 2330  
11/15 06:38:11 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 4:46:47  time: 11.0560  data_time: 0.0017  memory: 2334  
11/15 06:46:14 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 4:34:40  time: 9.6676  data_time: 0.0017  memory: 2268  
11/15 06:54:53 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 4:25:09  time: 10.1764  data_time: 0.0018  memory: 2272  
11/15 07:04:06 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 4:17:19  time: 11.0409  data_time: 0.0019  memory: 2325  
11/15 07:12:46 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 4:07:58  time: 10.8656  data_time: 0.0019  memory: 2333  
11/15 07:21:31 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 3:58:54  time: 10.6810  data_time: 0.0017  memory: 2353  
11/15 07:30:40 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 3:50:36  time: 10.7187  data_time: 0.0019  memory: 2349  
11/15 07:39:40 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 3:41:56  time: 10.3440  data_time: 0.0018  memory: 2363  
11/15 07:47:51 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 3:32:02  time: 10.5103  data_time: 0.0019  memory: 2273  
11/15 07:56:44 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 3:23:15  time: 10.7731  data_time: 0.0019  memory: 2262  
11/15 08:04:49 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 3:13:29  time: 9.3402  data_time: 0.0018  memory: 2295  
11/15 08:13:43 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 3:04:49  time: 10.3152  data_time: 0.0018  memory: 2319  
11/15 08:22:08 - mmengine - INFO - Iter(test) [1000/2000]    eta: 2:55:38  time: 10.1305  data_time: 0.0017  memory: 2323  
11/15 08:31:08 - mmengine - INFO - Iter(test) [1050/2000]    eta: 2:47:03  time: 11.0190  data_time: 0.0018  memory: 2368  
11/15 08:39:59 - mmengine - INFO - Iter(test) [1100/2000]    eta: 2:38:19  time: 10.4528  data_time: 0.0018  memory: 2309  
11/15 08:48:47 - mmengine - INFO - Iter(test) [1150/2000]    eta: 2:29:31  time: 10.8166  data_time: 0.0020  memory: 2302  
11/15 08:57:55 - mmengine - INFO - Iter(test) [1200/2000]    eta: 2:20:56  time: 10.5801  data_time: 0.0018  memory: 2608  
11/15 09:06:32 - mmengine - INFO - Iter(test) [1250/2000]    eta: 2:12:01  time: 10.4212  data_time: 0.0018  memory: 2290  
11/15 09:14:50 - mmengine - INFO - Iter(test) [1300/2000]    eta: 2:02:57  time: 10.7403  data_time: 0.0018  memory: 2263  
11/15 09:23:35 - mmengine - INFO - Iter(test) [1350/2000]    eta: 1:54:09  time: 9.8484  data_time: 0.0018  memory: 2264  
11/15 09:32:21 - mmengine - INFO - Iter(test) [1400/2000]    eta: 1:45:22  time: 11.0352  data_time: 0.0018  memory: 2322  
11/15 09:40:50 - mmengine - INFO - Iter(test) [1450/2000]    eta: 1:36:28  time: 11.0751  data_time: 0.0018  memory: 2320  
11/15 09:49:23 - mmengine - INFO - Iter(test) [1500/2000]    eta: 1:27:37  time: 9.7951  data_time: 0.0017  memory: 2263  
11/15 09:58:35 - mmengine - INFO - Iter(test) [1550/2000]    eta: 1:18:59  time: 10.7971  data_time: 0.0018  memory: 2311  
11/15 10:07:06 - mmengine - INFO - Iter(test) [1600/2000]    eta: 1:10:08  time: 10.4796  data_time: 0.0020  memory: 2261  
11/15 10:15:47 - mmengine - INFO - Iter(test) [1650/2000]    eta: 1:01:21  time: 9.8588  data_time: 0.0017  memory: 2444  
11/15 10:24:42 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:52:37  time: 10.5973  data_time: 0.0030  memory: 2319  
11/15 10:33:44 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:43:53  time: 10.5453  data_time: 0.0019  memory: 2327  
11/15 10:42:10 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:35:04  time: 10.7957  data_time: 0.0020  memory: 2277  
11/15 10:51:09 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:26:19  time: 10.7112  data_time: 0.0021  memory: 2223  
11/15 10:59:30 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:17:31  time: 10.3807  data_time: 0.0018  memory: 2348  
11/15 11:08:31 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:08:46  time: 10.4089  data_time: 0.0017  memory: 2479  
11/15 11:16:59 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 9.6810  data_time: 0.0016  memory: 2357  
11/15 11:16:59 - mmengine - INFO - per class results:
11/15 11:16:59 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  77.6 | 89.73 |
|       building      | 82.73 | 93.59 |
|         sky         | 94.02 | 97.75 |
|        floor        | 81.11 |  90.8 |
|         tree        | 73.01 | 86.51 |
|       ceiling       | 84.97 | 93.65 |
|         road        | 83.75 | 90.13 |
|         bed         | 89.83 | 96.13 |
|      windowpane     | 62.93 |  77.5 |
|        grass        | 65.77 | 83.89 |
|       cabinet       | 59.58 | 69.05 |
|       sidewalk      | 66.16 | 80.23 |
|        person       | 81.32 | 92.45 |
|        earth        | 35.75 | 48.79 |
|         door        | 48.28 | 60.02 |
|        table        | 60.85 | 75.45 |
|       mountain      | 61.09 | 71.53 |
|        plant        | 49.91 | 60.37 |
|       curtain       |  70.9 | 86.23 |
|        chair        | 60.18 | 75.05 |
|         car         | 84.88 | 93.12 |
|        water        | 62.36 |  82.4 |
|       painting      | 72.48 | 86.14 |
|         sofa        | 71.08 | 85.98 |
|        shelf        | 46.01 | 63.52 |
|        house        | 47.78 | 61.78 |
|         sea         | 66.62 |  81.6 |
|        mirror       | 66.98 | 80.17 |
|         rug         | 62.23 | 74.06 |
|        field        |  26.3 | 45.83 |
|       armchair      | 50.27 | 63.51 |
|         seat        | 57.85 | 79.53 |
|        fence        |  44.5 | 61.45 |
|         desk        | 53.58 | 70.34 |
|         rock        |  47.1 | 69.94 |
|       wardrobe      | 47.55 | 57.32 |
|         lamp        | 64.38 | 76.13 |
|       bathtub       | 79.42 | 83.42 |
|       railing       | 35.27 | 46.76 |
|       cushion       | 58.34 | 69.28 |
|         base        | 27.03 | 36.74 |
|         box         | 27.17 | 35.02 |
|        column       | 44.14 | 54.32 |
|      signboard      | 35.83 | 47.93 |
|   chest of drawers  | 32.91 | 61.82 |
|       counter       | 22.84 | 28.56 |
|         sand        | 47.49 |  71.5 |
|         sink        | 71.76 | 78.28 |
|      skyscraper     | 57.12 | 69.37 |
|      fireplace      | 73.69 | 89.93 |
|     refrigerator    | 69.77 | 77.15 |
|      grandstand     | 46.68 | 79.77 |
|         path        | 19.19 | 25.65 |
|        stairs       | 32.24 | 39.34 |
|        runway       | 72.01 | 88.92 |
|         case        | 47.72 | 60.94 |
|      pool table     | 93.83 | 96.33 |
|        pillow       | 53.11 | 61.82 |
|     screen door     | 74.55 | 77.29 |
|       stairway      |  37.2 | 42.62 |
|        river        |  16.1 |  25.0 |
|        bridge       |  56.6 | 61.45 |
|       bookcase      | 38.19 | 57.34 |
|        blind        | 24.85 | 25.51 |
|     coffee table    | 56.74 | 80.01 |
|        toilet       | 84.59 | 89.75 |
|        flower       | 38.11 | 64.58 |
|         book        |  43.3 | 53.79 |
|         hill        | 12.31 | 20.78 |
|        bench        | 40.58 | 45.49 |
|      countertop     | 57.45 | 73.49 |
|        stove        | 71.48 | 81.82 |
|         palm        | 48.35 |  66.8 |
|    kitchen island   | 50.21 | 83.69 |
|       computer      | 77.37 |  90.5 |
|     swivel chair    | 43.79 |  58.7 |
|         boat        | 57.82 | 63.45 |
|         bar         | 38.22 |  47.5 |
|    arcade machine   | 55.71 | 58.62 |
|        hovel        | 19.95 | 21.23 |
|         bus         | 82.93 | 92.07 |
|        towel        | 67.31 | 78.69 |
|        light        | 52.21 | 58.23 |
|        truck        | 35.84 | 50.14 |
|        tower        |  9.12 | 11.46 |
|      chandelier     | 68.44 |  82.8 |
|        awning       | 37.79 | 45.81 |
|     streetlight     | 27.94 | 35.67 |
|        booth        | 42.51 | 45.94 |
| television receiver | 72.36 | 77.35 |
|       airplane      | 63.72 | 70.22 |
|      dirt track     |  4.6  | 17.74 |
|       apparel       | 29.85 | 44.74 |
|         pole        | 24.09 | 31.14 |
|         land        |  3.7  |  5.81 |
|      bannister      |  7.02 |  8.53 |
|      escalator      | 33.33 | 40.92 |
|       ottoman       | 51.87 | 66.71 |
|        bottle       | 38.53 | 56.93 |
|        buffet       | 42.91 | 45.65 |
|        poster       | 27.53 | 36.23 |
|        stage        | 19.14 | 31.54 |
|         van         | 45.21 | 57.71 |
|         ship        |  7.84 |  10.4 |
|       fountain      | 31.94 | 33.64 |
|    conveyer belt    | 70.76 | 86.47 |
|        canopy       | 25.18 | 32.48 |
|        washer       | 64.62 |  64.9 |
|      plaything      | 25.44 | 39.28 |
|    swimming pool    | 78.34 | 93.21 |
|        stool        |  46.6 | 64.44 |
|        barrel       | 56.36 | 71.75 |
|        basket       | 34.57 |  40.0 |
|      waterfall      | 43.28 | 56.94 |
|         tent        | 93.14 | 98.91 |
|         bag         | 12.77 | 13.57 |
|       minibike      | 71.88 |  83.9 |
|        cradle       |  73.5 | 96.81 |
|         oven        | 51.24 | 77.03 |
|         ball        | 54.82 | 67.73 |
|         food        | 46.23 | 58.59 |
|         step        |  9.03 |  9.66 |
|         tank        | 64.24 | 65.78 |
|      trade name     | 16.41 | 17.92 |
|      microwave      | 71.35 | 75.96 |
|         pot         | 44.75 | 49.68 |
|        animal       | 60.33 | 61.95 |
|       bicycle       | 53.06 | 69.17 |
|         lake        | 59.98 |  63.6 |
|      dishwasher     | 58.71 | 74.42 |
|        screen       | 66.56 | 86.86 |
|       blanket       | 10.36 | 11.85 |
|      sculpture      | 64.95 | 72.71 |
|         hood        | 60.18 | 62.86 |
|        sconce       |  43.3 | 48.69 |
|         vase        | 41.15 | 52.98 |
|    traffic light    |  37.4 |  56.9 |
|         tray        |  6.76 | 12.46 |
|        ashcan       | 44.37 |  53.2 |
|         fan         | 61.45 | 73.08 |
|         pier        | 29.77 | 31.95 |
|      crt screen     | 15.73 | 25.67 |
|        plate        | 51.32 | 68.27 |
|       monitor       | 46.41 | 58.05 |
|    bulletin board   | 39.15 | 48.95 |
|        shower       |  2.07 |  2.29 |
|       radiator      | 59.07 | 63.07 |
|        glass        | 11.82 | 12.23 |
|        clock        | 42.71 | 49.41 |
|         flag        | 56.37 | 60.06 |
+---------------------+-------+-------+
11/15 11:16:59 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 83.3200  mIoU: 49.7200  mAcc: 60.4400  data_time: 0.0031  time: 10.5148
Finished processing corruption type: glass_blur
Processing corruption type: motion_blur
11/15 11:18:29 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1680359769
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1680359769
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 11:18:30 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='motion_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/motion_blur'

Number of parameters:  163407980
11/15 11:19:10 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 11:19:10 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 11:19:11 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 11:19:15 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 11:21:47 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:38:47  time: 1.7177  data_time: 0.0018  memory: 26008  
11/15 11:23:10 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:14:10  time: 1.7061  data_time: 0.0018  memory: 2338  
11/15 11:24:30 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:04:44  time: 1.6323  data_time: 0.0017  memory: 2271  
11/15 11:25:55 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:59:57  time: 1.6725  data_time: 0.0018  memory: 2434  
11/15 11:27:16 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:56:03  time: 1.6426  data_time: 0.0017  memory: 2489  
11/15 11:28:37 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:53:02  time: 1.7364  data_time: 0.0019  memory: 2330  
11/15 11:29:58 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:50:31  time: 1.5739  data_time: 0.0017  memory: 2330  
11/15 11:31:21 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:48:21  time: 1.6964  data_time: 0.0017  memory: 2334  
11/15 11:32:34 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:45:49  time: 1.5292  data_time: 0.0017  memory: 2268  
11/15 11:33:55 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:43:58  time: 1.5447  data_time: 0.0017  memory: 2272  
11/15 11:35:19 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:42:21  time: 1.7181  data_time: 0.0018  memory: 2325  
11/15 11:36:37 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:40:31  time: 1.6019  data_time: 0.0018  memory: 2333  
11/15 11:37:57 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:38:48  time: 1.6066  data_time: 0.0017  memory: 2353  
11/15 11:39:22 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:37:20  time: 1.6639  data_time: 0.0019  memory: 2349  
11/15 11:40:45 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:35:49  time: 1.6212  data_time: 0.0018  memory: 2363  
11/15 11:42:00 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:34:07  time: 1.6024  data_time: 0.0019  memory: 2273  
11/15 11:43:22 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:32:36  time: 1.6381  data_time: 0.0019  memory: 2262  
11/15 11:44:36 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:30:58  time: 1.4371  data_time: 0.0017  memory: 2295  
11/15 11:45:58 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:29:31  time: 1.6193  data_time: 0.0017  memory: 2319  
11/15 11:47:17 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:28:01  time: 1.5504  data_time: 0.0018  memory: 2323  
11/15 11:48:40 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:26:36  time: 1.7320  data_time: 0.0017  memory: 2368  
11/15 11:50:02 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:25:10  time: 1.5940  data_time: 0.0018  memory: 2309  
11/15 11:51:22 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:23:44  time: 1.6199  data_time: 0.0018  memory: 2302  
11/15 11:52:45 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:22:19  time: 1.5884  data_time: 0.0029  memory: 2608  
11/15 11:54:04 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:20:52  time: 1.5849  data_time: 0.0017  memory: 2290  
11/15 11:55:19 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:19:24  time: 1.5956  data_time: 0.0017  memory: 2263  
11/15 11:56:39 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:18:00  time: 1.4818  data_time: 0.0017  memory: 2264  
11/15 11:58:00 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:16:36  time: 1.7148  data_time: 0.0018  memory: 2322  
11/15 11:59:16 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:15:10  time: 1.6842  data_time: 0.0018  memory: 2320  
11/15 12:00:33 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:13:45  time: 1.4444  data_time: 0.0017  memory: 2263  
11/15 12:01:57 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:12:23  time: 1.7744  data_time: 0.0018  memory: 2311  
11/15 12:03:19 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:11:00  time: 1.6718  data_time: 0.0020  memory: 2261  
11/15 12:04:44 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:09:38  time: 1.6005  data_time: 0.0017  memory: 2444  
11/15 12:06:13 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:08:17  time: 1.8219  data_time: 0.0020  memory: 2319  
11/15 12:07:42 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:06:55  time: 1.8058  data_time: 0.0017  memory: 2327  
11/15 12:09:06 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:05:32  time: 1.7983  data_time: 0.0021  memory: 2277  
11/15 12:10:33 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:04:09  time: 1.7393  data_time: 0.0020  memory: 2223  
11/15 12:11:54 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:02:46  time: 1.6714  data_time: 0.0019  memory: 2348  
11/15 12:13:24 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:23  time: 1.7552  data_time: 0.0018  memory: 2479  
11/15 12:14:47 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 1.5381  data_time: 0.0017  memory: 2357  
11/15 12:14:47 - mmengine - INFO - per class results:
11/15 12:14:47 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 78.46 | 88.27 |
|       building      | 82.36 | 93.84 |
|         sky         | 94.19 | 97.35 |
|        floor        | 82.06 | 91.26 |
|         tree        | 73.51 | 85.98 |
|       ceiling       | 84.46 | 94.01 |
|         road        | 82.84 | 89.17 |
|         bed         | 89.88 | 97.08 |
|      windowpane     | 63.11 | 78.74 |
|        grass        | 68.27 | 87.56 |
|       cabinet       | 61.91 | 73.27 |
|       sidewalk      | 67.59 |  82.0 |
|        person       | 81.95 | 92.68 |
|        earth        | 37.67 | 50.69 |
|         door        |  50.1 | 62.57 |
|        table        | 61.35 |  76.7 |
|       mountain      | 58.84 | 70.31 |
|        plant        | 51.99 | 65.14 |
|       curtain       | 73.78 | 86.95 |
|        chair        | 60.67 | 76.67 |
|         car         | 84.86 | 94.21 |
|        water        | 61.63 | 80.41 |
|       painting      | 73.42 | 85.77 |
|         sofa        | 73.97 | 86.34 |
|        shelf        | 45.67 | 63.86 |
|        house        | 42.67 | 51.44 |
|         sea         | 70.32 | 83.21 |
|        mirror       | 71.19 | 79.55 |
|         rug         | 64.32 | 73.87 |
|        field        | 30.89 | 45.33 |
|       armchair      | 52.94 | 69.02 |
|         seat        | 59.77 | 80.27 |
|        fence        | 44.46 | 58.21 |
|         desk        | 52.01 | 73.28 |
|         rock        | 50.59 |  79.3 |
|       wardrobe      | 49.01 | 63.62 |
|         lamp        | 63.93 | 77.41 |
|       bathtub       | 83.78 | 87.52 |
|       railing       |  36.4 | 51.05 |
|       cushion       | 61.21 | 70.18 |
|         base        | 32.08 | 46.29 |
|         box         | 29.06 | 38.14 |
|        column       | 47.76 | 61.68 |
|      signboard      | 36.77 | 51.38 |
|   chest of drawers  | 41.75 | 65.42 |
|       counter       | 21.08 | 26.05 |
|         sand        | 48.63 | 73.18 |
|         sink        | 74.09 | 80.85 |
|      skyscraper     | 49.03 | 57.48 |
|      fireplace      | 76.66 | 92.81 |
|     refrigerator    | 72.24 | 79.24 |
|      grandstand     | 54.86 | 74.95 |
|         path        | 22.24 | 36.59 |
|        stairs       | 25.75 |  29.7 |
|        runway       | 68.38 | 89.82 |
|         case        | 45.42 | 60.99 |
|      pool table     | 93.63 | 96.87 |
|        pillow       | 60.97 | 72.98 |
|     screen door     |  76.5 | 80.96 |
|       stairway      | 30.18 | 43.65 |
|        river        | 13.23 | 21.74 |
|        bridge       | 64.74 | 72.66 |
|       bookcase      | 43.04 | 59.98 |
|        blind        | 41.29 | 45.26 |
|     coffee table    | 57.05 | 81.29 |
|        toilet       | 85.62 | 90.85 |
|        flower       | 40.77 | 57.81 |
|         book        | 46.31 | 63.01 |
|         hill        |  7.11 | 11.43 |
|        bench        | 42.41 | 50.06 |
|      countertop     | 61.16 | 81.21 |
|        stove        | 77.79 | 88.05 |
|         palm        |  48.6 | 70.63 |
|    kitchen island   | 47.97 | 83.14 |
|       computer      | 78.71 |  92.4 |
|     swivel chair    | 45.28 | 62.69 |
|         boat        | 72.13 |  86.9 |
|         bar         | 53.36 | 62.77 |
|    arcade machine   | 36.85 | 38.86 |
|        hovel        | 34.14 | 36.14 |
|         bus         |  80.0 | 94.36 |
|        towel        | 65.27 | 75.79 |
|        light        | 55.45 | 63.51 |
|        truck        | 41.35 | 53.52 |
|        tower        |  8.03 |  9.78 |
|      chandelier     | 65.94 | 78.67 |
|        awning       |  35.6 | 44.49 |
|     streetlight     | 27.49 | 35.43 |
|        booth        | 47.96 | 54.36 |
| television receiver | 77.04 | 85.16 |
|       airplane      | 67.68 | 75.93 |
|      dirt track     |  7.43 | 20.73 |
|       apparel       | 31.49 | 42.65 |
|         pole        | 21.58 | 28.72 |
|         land        |  4.05 |  5.04 |
|      bannister      |  10.2 | 12.98 |
|      escalator      | 34.15 | 41.76 |
|       ottoman       | 51.05 |  65.7 |
|        bottle       |  39.9 | 63.37 |
|        buffet       | 52.11 | 59.59 |
|        poster       | 28.49 | 39.06 |
|        stage        | 20.57 | 32.46 |
|         van         |  41.8 | 51.71 |
|         ship        | 14.66 | 16.66 |
|       fountain      | 23.96 | 24.35 |
|    conveyer belt    | 73.21 | 92.14 |
|        canopy       | 36.05 | 46.04 |
|        washer       | 79.15 | 81.62 |
|      plaything      | 25.05 | 37.74 |
|    swimming pool    | 81.18 | 90.14 |
|        stool        | 45.42 | 58.14 |
|        barrel       | 54.21 | 71.93 |
|        basket       |  30.0 | 42.92 |
|      waterfall      | 48.49 |  56.4 |
|         tent        | 93.18 | 99.27 |
|         bag         | 10.26 | 12.15 |
|       minibike      | 70.35 | 85.73 |
|        cradle       | 77.81 | 96.31 |
|         oven        | 58.64 | 78.96 |
|         ball        | 54.69 |  71.2 |
|         food        | 43.43 | 55.03 |
|         step        |  8.37 |  9.0  |
|         tank        | 63.68 | 66.33 |
|      trade name     | 25.76 | 31.19 |
|      microwave      |  83.2 | 89.21 |
|         pot         |  46.3 | 52.61 |
|        animal       | 60.47 |  62.3 |
|       bicycle       | 53.28 | 77.77 |
|         lake        | 57.63 |  63.7 |
|      dishwasher     | 64.21 | 75.64 |
|        screen       | 68.81 | 88.67 |
|       blanket       | 14.96 | 17.17 |
|      sculpture      | 60.24 | 67.46 |
|         hood        | 61.89 | 66.03 |
|        sconce       | 49.95 | 61.18 |
|         vase        |  40.6 | 50.52 |
|    traffic light    | 35.22 | 56.55 |
|         tray        |  9.57 | 16.08 |
|        ashcan       | 43.83 |  58.8 |
|         fan         | 62.42 | 78.22 |
|         pier        | 27.97 | 32.67 |
|      crt screen     | 10.46 | 17.08 |
|        plate        | 47.76 | 75.83 |
|       monitor       | 43.41 | 52.28 |
|    bulletin board   | 37.94 | 49.27 |
|        shower       |  6.99 |  8.01 |
|       radiator      | 62.23 | 66.43 |
|        glass        | 14.81 | 15.64 |
|        clock        | 44.73 | 52.35 |
|         flag        | 61.93 | 68.47 |
+---------------------+-------+-------+
11/15 12:14:47 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 83.8100  mIoU: 51.2400  mAcc: 62.5900  data_time: 0.0023  time: 1.6659
Finished processing corruption type: motion_blur
Processing corruption type: zoom_blur
11/15 12:14:52 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1494520847
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1494520847
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 12:14:52 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='zoom_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/zoom_blur'

Number of parameters:  163407980
11/15 12:14:58 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 12:14:58 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 12:14:59 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 12:15:00 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 12:16:31 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:59:17  time: 1.8085  data_time: 0.0020  memory: 26008  
11/15 12:17:56 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:55:37  time: 1.7555  data_time: 0.0019  memory: 2338  
11/15 12:19:19 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:53:14  time: 1.7141  data_time: 0.0019  memory: 2271  
11/15 12:20:45 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:51:43  time: 1.6954  data_time: 0.0019  memory: 2434  
11/15 12:22:06 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:49:42  time: 1.6538  data_time: 0.0018  memory: 2489  
11/15 12:23:28 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:47:57  time: 1.7207  data_time: 0.0019  memory: 2330  
11/15 12:24:51 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:46:28  time: 1.5958  data_time: 0.0018  memory: 2330  
11/15 12:26:14 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:44:57  time: 1.7150  data_time: 0.0018  memory: 2334  
11/15 12:27:29 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:43:00  time: 1.5449  data_time: 0.0018  memory: 2268  
11/15 12:28:52 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:41:36  time: 1.6147  data_time: 0.0018  memory: 2272  
11/15 12:30:20 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:40:26  time: 1.7773  data_time: 0.0019  memory: 2325  
11/15 12:31:43 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:39:00  time: 1.7350  data_time: 0.0020  memory: 2333  
11/15 12:33:05 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:37:33  time: 1.6784  data_time: 0.0018  memory: 2353  
11/15 12:34:33 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:36:19  time: 1.7445  data_time: 0.0020  memory: 2349  
11/15 12:35:59 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:34:58  time: 1.6643  data_time: 0.0019  memory: 2363  
11/15 12:37:17 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:33:25  time: 1.7029  data_time: 0.0021  memory: 2273  
11/15 12:38:43 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:32:04  time: 1.7286  data_time: 0.0022  memory: 2262  
11/15 12:39:59 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:30:32  time: 1.4832  data_time: 0.0018  memory: 2295  
11/15 12:41:25 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:29:11  time: 1.6350  data_time: 0.0019  memory: 2319  
11/15 12:42:45 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:27:45  time: 1.6092  data_time: 0.0019  memory: 2323  
11/15 12:44:12 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:26:25  time: 1.7829  data_time: 0.0019  memory: 2368  
11/15 12:45:37 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:25:03  time: 1.6523  data_time: 0.0019  memory: 2309  
11/15 12:47:00 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:23:38  time: 1.6983  data_time: 0.0019  memory: 2302  
11/15 12:48:25 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:22:16  time: 1.6405  data_time: 0.0019  memory: 2608  
11/15 12:49:45 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:20:51  time: 1.6260  data_time: 0.0019  memory: 2290  
11/15 12:51:03 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:19:24  time: 1.6904  data_time: 0.0019  memory: 2263  
11/15 12:52:26 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:18:01  time: 1.5503  data_time: 0.0019  memory: 2264  
11/15 12:53:49 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:16:38  time: 1.7622  data_time: 0.0019  memory: 2322  
11/15 12:55:08 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:15:13  time: 1.7428  data_time: 0.0019  memory: 2320  
11/15 12:56:29 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:13:49  time: 1.5521  data_time: 0.0018  memory: 2263  
11/15 12:57:56 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:12:27  time: 1.7123  data_time: 0.0019  memory: 2311  
11/15 12:59:18 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:11:04  time: 1.6780  data_time: 0.0021  memory: 2261  
11/15 13:00:39 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:09:41  time: 1.5293  data_time: 0.0018  memory: 2444  
11/15 13:02:05 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:08:18  time: 1.6928  data_time: 0.0021  memory: 2319  
11/15 13:03:31 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:06:55  time: 1.6530  data_time: 0.0018  memory: 2327  
11/15 13:04:50 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:05:32  time: 1.7225  data_time: 0.0021  memory: 2277  
11/15 13:06:16 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:04:09  time: 1.7108  data_time: 0.0020  memory: 2223  
11/15 13:07:34 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:02:45  time: 1.6029  data_time: 0.0018  memory: 2348  
11/15 13:08:58 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:23  time: 1.6304  data_time: 0.0018  memory: 2479  
11/15 13:10:18 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 1.5191  data_time: 0.0017  memory: 2357  
11/15 13:10:18 - mmengine - INFO - per class results:
11/15 13:10:19 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 60.96 | 83.74 |
|       building      |  69.1 | 90.74 |
|         sky         | 86.34 |  90.6 |
|        floor        | 62.17 | 83.64 |
|         tree        | 50.79 | 59.94 |
|       ceiling       | 67.67 | 90.53 |
|         road        | 55.37 | 60.92 |
|         bed         | 76.89 | 90.11 |
|      windowpane     | 47.96 | 68.95 |
|        grass        | 44.82 | 70.44 |
|       cabinet       | 47.02 |  55.8 |
|       sidewalk      |  34.5 | 63.22 |
|        person       | 59.05 | 76.15 |
|        earth        | 21.18 | 30.19 |
|         door        | 24.51 | 30.36 |
|        table        | 42.51 | 56.14 |
|       mountain      |  34.3 | 39.54 |
|        plant        |  26.0 | 32.77 |
|       curtain       | 46.19 |  57.4 |
|        chair        | 37.44 | 48.53 |
|         car         | 65.58 | 81.57 |
|        water        | 41.42 | 55.82 |
|       painting      |  51.7 | 74.09 |
|         sofa        | 44.58 | 57.69 |
|        shelf        | 25.62 | 42.22 |
|        house        |  20.5 |  22.9 |
|         sea         | 41.73 |  50.2 |
|        mirror       | 50.61 | 57.18 |
|         rug         | 15.99 |  16.5 |
|        field        | 19.89 | 49.04 |
|       armchair      | 27.21 | 50.57 |
|         seat        | 33.87 | 45.95 |
|        fence        | 19.67 |  31.1 |
|         desk        | 32.26 | 45.32 |
|         rock        | 26.07 | 41.13 |
|       wardrobe      | 33.92 |  42.5 |
|         lamp        |  34.7 | 47.45 |
|       bathtub       |  67.6 | 76.89 |
|       railing       | 15.43 | 18.39 |
|       cushion       | 34.79 |  41.0 |
|         base        | 16.89 | 26.27 |
|         box         |  6.53 |  8.21 |
|        column       | 21.13 | 27.32 |
|      signboard      | 19.39 | 23.72 |
|   chest of drawers  | 38.08 | 48.87 |
|       counter       |  16.1 | 23.22 |
|         sand        | 23.37 | 44.76 |
|         sink        | 46.76 | 57.99 |
|      skyscraper     | 30.58 | 36.18 |
|      fireplace      | 55.06 | 75.64 |
|     refrigerator    |  59.3 | 68.71 |
|      grandstand     | 22.96 | 29.21 |
|         path        |  6.14 |  8.12 |
|        stairs       |  7.52 |  8.68 |
|        runway       | 65.13 | 86.87 |
|         case        | 23.17 |  26.6 |
|      pool table     | 83.12 | 92.56 |
|        pillow       | 41.29 | 54.84 |
|     screen door     | 41.11 | 44.39 |
|       stairway      | 20.68 | 25.04 |
|        river        | 10.72 | 13.89 |
|        bridge       | 32.72 | 43.45 |
|       bookcase      | 25.13 | 38.99 |
|        blind        | 17.38 | 19.88 |
|     coffee table    | 38.15 | 48.59 |
|        toilet       | 65.27 | 75.16 |
|        flower       | 18.06 | 32.11 |
|         book        |  23.2 | 31.22 |
|         hill        |  2.1  |  4.25 |
|        bench        | 30.16 | 35.37 |
|      countertop     | 44.08 | 59.28 |
|        stove        | 60.66 | 69.08 |
|         palm        | 10.84 | 42.25 |
|    kitchen island   | 27.03 | 34.99 |
|       computer      | 47.69 | 53.78 |
|     swivel chair    | 17.48 | 25.03 |
|         boat        | 32.44 | 36.98 |
|         bar         | 26.23 | 31.64 |
|    arcade machine   | 23.57 | 24.46 |
|        hovel        |  4.69 |  4.86 |
|         bus         | 65.82 | 80.41 |
|        towel        | 30.51 | 41.57 |
|        light        | 17.26 | 23.07 |
|        truck        |  10.5 | 14.73 |
|        tower        |  4.58 |  5.34 |
|      chandelier     | 23.29 | 24.69 |
|        awning       | 20.02 | 22.42 |
|     streetlight     |  2.94 |  3.11 |
|        booth        | 36.07 | 38.38 |
| television receiver | 43.83 | 57.87 |
|       airplane      | 42.21 | 58.39 |
|      dirt track     |  0.0  |  0.0  |
|       apparel       | 16.14 | 28.83 |
|         pole        |  7.44 |  8.75 |
|         land        |  3.02 |  3.83 |
|      bannister      |  3.93 |  5.31 |
|      escalator      | 12.65 | 15.62 |
|       ottoman       | 27.87 | 34.45 |
|        bottle       | 18.17 | 19.64 |
|        buffet       | 26.06 | 27.42 |
|        poster       |  8.29 | 10.57 |
|        stage        |  9.14 | 12.13 |
|         van         | 26.03 | 30.36 |
|         ship        |  1.54 |  2.05 |
|       fountain      |  17.5 |  19.6 |
|    conveyer belt    | 26.33 | 28.67 |
|        canopy       |  8.87 |  9.05 |
|        washer       | 71.97 | 84.04 |
|      plaything      | 10.88 | 13.41 |
|    swimming pool    |  76.1 | 95.21 |
|        stool        | 27.02 | 40.21 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 17.49 | 23.02 |
|      waterfall      | 30.64 | 84.17 |
|         tent        | 74.79 | 99.66 |
|         bag         |  2.0  |  2.35 |
|       minibike      | 26.97 | 40.51 |
|        cradle       | 62.73 | 78.22 |
|         oven        | 39.99 | 53.12 |
|         ball        |  9.6  | 12.94 |
|         food        |  36.3 | 43.52 |
|         step        |  6.43 |  7.21 |
|         tank        |  34.7 | 37.15 |
|      trade name     | 13.38 | 14.05 |
|      microwave      | 29.93 | 33.69 |
|         pot         | 10.57 | 11.76 |
|        animal       |  47.9 | 59.16 |
|       bicycle       | 14.61 | 30.33 |
|         lake        | 10.15 | 16.38 |
|      dishwasher     | 26.79 | 34.02 |
|        screen       | 53.35 | 86.04 |
|       blanket       |  6.99 |  8.8  |
|      sculpture      |  33.3 | 41.35 |
|         hood        | 46.51 | 51.45 |
|        sconce       | 17.72 | 22.09 |
|         vase        |  8.47 | 10.02 |
|    traffic light    |  14.6 | 16.56 |
|         tray        |  3.76 |  4.8  |
|        ashcan       | 15.65 | 21.35 |
|         fan         | 30.95 | 49.32 |
|         pier        | 28.55 |  36.7 |
|      crt screen     |  8.48 |  9.64 |
|        plate        | 32.53 | 48.08 |
|       monitor       | 12.66 | 15.54 |
|    bulletin board   | 23.49 | 28.42 |
|        shower       |  0.83 |  1.25 |
|       radiator      |  23.4 | 32.51 |
|        glass        |  1.78 |  1.81 |
|        clock        |  6.53 |  7.73 |
|         flag        | 20.35 | 23.13 |
+---------------------+-------+-------+
11/15 13:10:19 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 69.9200  mIoU: 29.8700  mAcc: 38.8400  data_time: 0.0023  time: 1.6592
Finished processing corruption type: zoom_blur
Processing corruption type: snow
11/15 13:10:23 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1493016586
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1493016586
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 13:10:23 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='snow',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/snow'

Number of parameters:  163407980
11/15 13:10:30 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 13:10:30 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 13:10:30 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 13:10:31 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 13:11:18 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:30:12  time: 0.8580  data_time: 0.0019  memory: 26008  
11/15 13:11:58 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:27:23  time: 0.8418  data_time: 0.0019  memory: 2338  
11/15 13:12:37 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:25:46  time: 0.8042  data_time: 0.0019  memory: 2271  
11/15 13:13:17 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:24:51  time: 0.7991  data_time: 0.0019  memory: 2434  
11/15 13:13:55 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:23:45  time: 0.7748  data_time: 0.0018  memory: 2489  
11/15 13:14:33 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:22:53  time: 0.8151  data_time: 0.0019  memory: 2330  
11/15 13:15:13 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:08  time: 0.7491  data_time: 0.0018  memory: 2330  
11/15 13:15:52 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:22  time: 0.8112  data_time: 0.0018  memory: 2334  
11/15 13:16:27 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:20:25  time: 0.7329  data_time: 0.0018  memory: 2268  
11/15 13:17:06 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:19:43  time: 0.7558  data_time: 0.0018  memory: 2272  
11/15 13:17:47 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:19:08  time: 0.8411  data_time: 0.0019  memory: 2325  
11/15 13:18:26 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:18:27  time: 0.8165  data_time: 0.0020  memory: 2333  
11/15 13:19:04 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:17:45  time: 0.7863  data_time: 0.0017  memory: 2353  
11/15 13:19:46 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:17:09  time: 0.8122  data_time: 0.0019  memory: 2349  
11/15 13:20:25 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:16:30  time: 0.7902  data_time: 0.0018  memory: 2363  
11/15 13:21:01 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:15:45  time: 0.7951  data_time: 0.0019  memory: 2273  
11/15 13:21:41 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:15:06  time: 0.8068  data_time: 0.0021  memory: 2262  
11/15 13:22:17 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:14:22  time: 0.6847  data_time: 0.0017  memory: 2295  
11/15 13:22:56 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:13:43  time: 0.7573  data_time: 0.0019  memory: 2319  
11/15 13:23:34 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:13:02  time: 0.7483  data_time: 0.0019  memory: 2323  
11/15 13:24:14 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:12:24  time: 0.8340  data_time: 0.0019  memory: 2368  
11/15 13:24:54 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:11:45  time: 0.7612  data_time: 0.0020  memory: 2309  
11/15 13:25:32 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:11:05  time: 0.7909  data_time: 0.0019  memory: 2302  
11/15 13:26:12 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:10:26  time: 0.7539  data_time: 0.0019  memory: 2608  
11/15 13:26:48 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:09:46  time: 0.7486  data_time: 0.0019  memory: 2290  
11/15 13:27:24 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:09:05  time: 0.7834  data_time: 0.0019  memory: 2263  
11/15 13:28:02 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:08:25  time: 0.7155  data_time: 0.0019  memory: 2264  
11/15 13:28:41 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:07:46  time: 0.8243  data_time: 0.0018  memory: 2322  
11/15 13:29:17 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:07:06  time: 0.8134  data_time: 0.0018  memory: 2320  
11/15 13:29:54 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:06:27  time: 0.7190  data_time: 0.0018  memory: 2263  
11/15 13:30:34 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:05:49  time: 0.7845  data_time: 0.0019  memory: 2311  
11/15 13:31:12 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:10  time: 0.7712  data_time: 0.0019  memory: 2261  
11/15 13:31:49 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:04:31  time: 0.6958  data_time: 0.0017  memory: 2444  
11/15 13:32:29 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:52  time: 0.7787  data_time: 0.0020  memory: 2319  
11/15 13:33:09 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:13  time: 0.7627  data_time: 0.0018  memory: 2327  
11/15 13:33:46 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:34  time: 0.8009  data_time: 0.0020  memory: 2277  
11/15 13:34:26 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:56  time: 0.8065  data_time: 0.0019  memory: 2223  
11/15 13:35:02 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:17  time: 0.7369  data_time: 0.0019  memory: 2348  
11/15 13:35:41 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:38  time: 0.7495  data_time: 0.0018  memory: 2479  
11/15 13:36:18 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7019  data_time: 0.0017  memory: 2357  
11/15 13:36:18 - mmengine - INFO - per class results:
11/15 13:36:18 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 68.53 | 88.65 |
|       building      | 77.73 |  93.6 |
|         sky         | 91.31 | 95.07 |
|        floor        | 71.32 | 89.19 |
|         tree        | 71.08 | 86.29 |
|       ceiling       | 72.79 | 79.43 |
|         road        | 71.25 | 77.58 |
|         bed         | 82.92 | 90.59 |
|      windowpane     | 55.78 | 70.77 |
|        grass        | 62.44 | 89.69 |
|       cabinet       | 50.51 | 62.62 |
|       sidewalk      | 49.77 | 73.32 |
|        person       | 73.55 | 91.54 |
|        earth        | 28.28 | 33.62 |
|         door        | 26.97 | 32.56 |
|        table        | 54.29 | 68.87 |
|       mountain      |  48.3 | 57.19 |
|        plant        | 45.79 | 53.17 |
|       curtain       | 60.11 | 74.18 |
|        chair        | 52.32 | 62.88 |
|         car         | 80.95 | 92.39 |
|        water        |  38.2 | 72.12 |
|       painting      | 66.35 | 84.47 |
|         sofa        | 61.51 | 72.54 |
|        shelf        | 34.07 | 54.09 |
|        house        | 32.17 | 36.91 |
|         sea         | 53.74 | 86.84 |
|        mirror       | 62.42 | 78.98 |
|         rug         | 33.59 | 34.36 |
|        field        | 24.04 | 40.95 |
|       armchair      | 43.29 | 59.97 |
|         seat        | 40.61 | 61.01 |
|        fence        | 35.49 | 55.72 |
|         desk        | 39.89 |  48.5 |
|         rock        | 41.75 | 60.15 |
|       wardrobe      | 38.98 | 43.05 |
|         lamp        | 56.71 | 61.84 |
|       bathtub       | 59.06 | 63.86 |
|       railing       | 22.57 | 26.98 |
|       cushion       | 43.76 | 48.16 |
|         base        | 22.38 | 41.33 |
|         box         | 21.73 | 33.59 |
|        column       |  36.2 | 45.24 |
|      signboard      | 32.39 | 43.58 |
|   chest of drawers  |  32.3 | 58.21 |
|       counter       | 30.69 | 41.68 |
|         sand        | 13.94 | 20.85 |
|         sink        | 58.82 | 66.45 |
|      skyscraper     | 28.81 | 33.74 |
|      fireplace      | 63.32 | 68.46 |
|     refrigerator    | 66.32 | 73.11 |
|      grandstand     | 37.39 | 68.28 |
|         path        | 10.59 | 13.26 |
|        stairs       | 32.13 | 39.81 |
|        runway       | 58.36 | 65.78 |
|         case        | 37.14 | 47.72 |
|      pool table     | 90.36 | 91.52 |
|        pillow       | 45.41 | 55.28 |
|     screen door     | 59.68 | 69.99 |
|       stairway      |  29.8 | 33.22 |
|        river        | 21.88 | 27.39 |
|        bridge       |  42.3 |  44.6 |
|       bookcase      | 10.71 | 11.92 |
|        blind        | 21.99 | 23.74 |
|     coffee table    | 57.46 | 66.46 |
|        toilet       | 68.26 | 70.64 |
|        flower       | 36.15 | 55.22 |
|         book        |  26.8 | 32.27 |
|         hill        |  4.55 |  5.95 |
|        bench        | 29.41 | 31.99 |
|      countertop     | 44.33 | 54.41 |
|        stove        |  55.5 | 61.56 |
|         palm        | 46.79 | 58.99 |
|    kitchen island   | 26.42 | 36.98 |
|       computer      | 54.34 | 63.67 |
|     swivel chair    | 43.05 | 55.06 |
|         boat        | 41.29 | 44.83 |
|         bar         |  21.6 | 23.59 |
|    arcade machine   |  43.6 | 45.92 |
|        hovel        | 45.78 | 49.91 |
|         bus         | 83.12 | 93.73 |
|        towel        | 35.32 | 37.39 |
|        light        | 38.75 | 41.31 |
|        truck        | 35.72 | 45.21 |
|        tower        | 25.97 | 39.33 |
|      chandelier     | 54.98 | 61.29 |
|        awning       | 16.91 | 17.47 |
|     streetlight     | 24.19 | 28.54 |
|        booth        | 36.86 | 39.26 |
| television receiver | 39.71 | 43.13 |
|       airplane      | 56.05 | 64.42 |
|      dirt track     |  0.0  |  0.0  |
|       apparel       | 24.42 | 33.67 |
|         pole        | 22.49 | 31.62 |
|         land        |  0.34 |  0.38 |
|      bannister      |  5.07 |  6.21 |
|      escalator      |  9.43 | 10.19 |
|       ottoman       | 38.13 | 43.96 |
|        bottle       | 33.54 | 56.82 |
|        buffet       | 47.18 | 49.35 |
|        poster       | 10.26 | 11.98 |
|        stage        | 14.79 | 23.48 |
|         van         | 42.11 |  56.3 |
|         ship        |  8.65 | 12.16 |
|       fountain      | 11.43 | 22.66 |
|    conveyer belt    | 65.72 | 78.11 |
|        canopy       | 14.26 | 15.71 |
|        washer       | 71.55 | 73.92 |
|      plaything      | 18.72 | 30.48 |
|    swimming pool    |  77.9 | 92.48 |
|        stool        | 36.98 | 50.05 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 20.78 | 27.25 |
|      waterfall      |  43.3 | 48.54 |
|         tent        | 94.22 | 97.95 |
|         bag         |  7.77 |  8.66 |
|       minibike      | 67.91 | 75.62 |
|        cradle       | 65.02 | 81.33 |
|         oven        | 45.65 | 53.79 |
|         ball        |  32.3 | 40.78 |
|         food        | 54.41 | 67.26 |
|         step        |  0.35 |  0.4  |
|         tank        | 38.01 | 42.23 |
|      trade name     |  9.95 | 10.86 |
|      microwave      |  35.4 | 37.66 |
|         pot         | 28.46 |  31.0 |
|        animal       | 54.19 | 55.89 |
|       bicycle       | 48.85 | 78.72 |
|         lake        | 47.14 |  47.9 |
|      dishwasher     | 24.33 | 24.78 |
|        screen       | 55.93 | 80.49 |
|       blanket       |  1.4  |  1.45 |
|      sculpture      |  52.4 | 65.32 |
|         hood        | 28.75 |  29.9 |
|        sconce       | 32.81 | 39.32 |
|         vase        | 35.51 | 44.91 |
|    traffic light    | 32.96 | 50.83 |
|         tray        |  8.54 | 13.41 |
|        ashcan       | 26.03 | 29.47 |
|         fan         | 55.75 | 65.95 |
|         pier        | 21.01 | 22.22 |
|      crt screen     |  2.57 |  7.67 |
|        plate        |  53.0 | 66.68 |
|       monitor       |  5.97 |  7.26 |
|    bulletin board   | 35.57 | 46.11 |
|        shower       |  4.19 |  5.81 |
|       radiator      | 10.88 |  10.9 |
|        glass        |  9.95 | 10.62 |
|        clock        | 20.59 | 28.76 |
|         flag        | 47.02 | 54.12 |
+---------------------+-------+-------+
11/15 13:36:18 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 77.5200  mIoU: 39.5600  mAcc: 48.3500  data_time: 0.0022  time: 0.7731
Finished processing corruption type: snow
Processing corruption type: frost
11/15 13:36:21 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 349576695
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 349576695
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 13:36:21 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='frost',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/frost'

Number of parameters:  163407980
11/15 13:36:28 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 13:36:28 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 13:36:29 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 13:36:29 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 13:36:54 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:16:08  time: 0.3982  data_time: 0.0020  memory: 26008  
11/15 13:37:13 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:13:43  time: 0.3764  data_time: 0.0020  memory: 2338  
11/15 13:37:30 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:12:29  time: 0.3630  data_time: 0.0020  memory: 2271  
11/15 13:37:49 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:11:55  time: 0.3771  data_time: 0.0020  memory: 2434  
11/15 13:38:06 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:11:15  time: 0.3564  data_time: 0.0018  memory: 2489  
11/15 13:38:24 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:47  time: 0.3751  data_time: 0.0019  memory: 2330  
11/15 13:38:42 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:10:23  time: 0.3417  data_time: 0.0019  memory: 2330  
11/15 13:38:59 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:09:59  time: 0.3719  data_time: 0.0018  memory: 2334  
11/15 13:39:15 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:09:29  time: 0.3372  data_time: 0.0018  memory: 2268  
11/15 13:39:33 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:09  time: 0.3417  data_time: 0.0018  memory: 2272  
11/15 13:39:51 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:52  time: 0.3922  data_time: 0.0020  memory: 2325  
11/15 13:40:09 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:32  time: 0.3780  data_time: 0.0021  memory: 2333  
11/15 13:40:27 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:08:12  time: 0.3614  data_time: 0.0036  memory: 2353  
11/15 13:40:46 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:56  time: 0.3760  data_time: 0.0020  memory: 2349  
11/15 13:41:04 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:37  time: 0.3729  data_time: 0.0018  memory: 2363  
11/15 13:41:20 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:07:16  time: 0.3741  data_time: 0.0020  memory: 2273  
11/15 13:41:39 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:58  time: 0.3746  data_time: 0.0020  memory: 2262  
11/15 13:41:55 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:06:37  time: 0.3067  data_time: 0.0018  memory: 2295  
11/15 13:42:13 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:06:19  time: 0.3440  data_time: 0.0019  memory: 2319  
11/15 13:42:30 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:00  time: 0.3400  data_time: 0.0018  memory: 2323  
11/15 13:42:48 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:05:42  time: 0.3910  data_time: 0.0019  memory: 2368  
11/15 13:43:07 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:24  time: 0.3400  data_time: 0.0019  memory: 2309  
11/15 13:43:24 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:06  time: 0.3563  data_time: 0.0018  memory: 2302  
11/15 13:43:42 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:48  time: 0.3415  data_time: 0.0018  memory: 2608  
11/15 13:43:58 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:29  time: 0.3381  data_time: 0.0018  memory: 2290  
11/15 13:44:14 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:10  time: 0.3578  data_time: 0.0018  memory: 2263  
11/15 13:44:32 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:52  time: 0.3199  data_time: 0.0018  memory: 2264  
11/15 13:44:49 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:34  time: 0.3816  data_time: 0.0026  memory: 2322  
11/15 13:45:05 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:15  time: 0.3750  data_time: 0.0018  memory: 2320  
11/15 13:45:23 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:57  time: 0.3242  data_time: 0.0017  memory: 2263  
11/15 13:45:41 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:39  time: 0.3579  data_time: 0.0019  memory: 2311  
11/15 13:45:58 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:22  time: 0.3626  data_time: 0.0020  memory: 2261  
11/15 13:46:14 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:04  time: 0.3061  data_time: 0.0018  memory: 2444  
11/15 13:46:33 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:46  time: 0.3615  data_time: 0.0021  memory: 2319  
11/15 13:46:51 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:28  time: 0.3412  data_time: 0.0018  memory: 2327  
11/15 13:47:08 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:10  time: 0.3776  data_time: 0.0021  memory: 2277  
11/15 13:47:27 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:53  time: 0.3770  data_time: 0.0022  memory: 2223  
11/15 13:47:42 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:35  time: 0.3245  data_time: 0.0020  memory: 2348  
11/15 13:48:00 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.3429  data_time: 0.0019  memory: 2479  
11/15 13:48:17 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.3200  data_time: 0.0017  memory: 2357  
11/15 13:48:17 - mmengine - INFO - per class results:
11/15 13:48:17 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 71.78 | 89.51 |
|       building      | 81.88 | 93.62 |
|         sky         | 69.45 | 71.74 |
|        floor        | 76.14 | 90.16 |
|         tree        | 70.13 |  86.5 |
|       ceiling       | 75.01 | 84.33 |
|         road        | 78.01 | 85.21 |
|         bed         | 87.75 | 93.88 |
|      windowpane     | 59.48 | 73.43 |
|        grass        | 67.44 | 86.05 |
|       cabinet       | 53.63 | 62.08 |
|       sidewalk      | 59.12 | 72.05 |
|        person       | 78.61 | 90.74 |
|        earth        | 35.31 | 51.62 |
|         door        | 39.02 | 48.91 |
|        table        | 57.08 | 76.62 |
|       mountain      | 25.18 | 75.87 |
|        plant        |  48.1 | 57.03 |
|       curtain       |  60.5 | 71.64 |
|        chair        | 58.45 | 71.63 |
|         car         | 84.41 | 93.11 |
|        water        | 58.06 | 81.01 |
|       painting      | 67.13 | 85.34 |
|         sofa        | 66.96 | 78.05 |
|        shelf        | 37.12 | 52.48 |
|        house        | 46.12 | 58.48 |
|         sea         | 53.17 | 64.03 |
|        mirror       | 64.17 |  74.0 |
|         rug         | 51.65 | 58.11 |
|        field        | 25.97 | 37.29 |
|       armchair      | 49.36 | 69.39 |
|         seat        | 58.34 |  77.4 |
|        fence        | 40.01 | 56.74 |
|         desk        | 38.14 | 45.34 |
|         rock        |  46.9 | 68.66 |
|       wardrobe      | 31.55 | 40.43 |
|         lamp        | 60.96 | 69.87 |
|       bathtub       |  68.9 | 77.49 |
|       railing       | 37.06 | 48.23 |
|       cushion       | 57.82 | 69.64 |
|         base        |  27.0 | 33.76 |
|         box         | 25.67 | 33.13 |
|        column       |  41.8 | 53.81 |
|      signboard      | 35.05 | 43.97 |
|   chest of drawers  | 41.25 | 58.22 |
|       counter       | 24.34 | 31.75 |
|         sand        |  42.5 | 58.02 |
|         sink        | 65.56 | 71.55 |
|      skyscraper     | 49.94 | 61.53 |
|      fireplace      | 68.45 | 81.79 |
|     refrigerator    | 72.34 | 74.78 |
|      grandstand     | 44.91 | 71.09 |
|         path        |  17.5 | 28.04 |
|        stairs       |  31.8 |  40.5 |
|        runway       | 67.65 | 77.29 |
|         case        | 42.62 | 57.56 |
|      pool table     | 92.75 |  95.1 |
|        pillow       | 53.62 | 63.06 |
|     screen door     | 58.87 | 73.09 |
|       stairway      | 32.88 | 40.45 |
|        river        | 14.34 | 19.82 |
|        bridge       | 59.32 | 65.74 |
|       bookcase      | 40.86 | 54.46 |
|        blind        | 24.09 | 25.23 |
|     coffee table    | 57.95 | 72.72 |
|        toilet       | 74.65 | 78.24 |
|        flower       | 45.28 | 62.19 |
|         book        | 40.49 | 55.53 |
|         hill        |  5.93 |  8.32 |
|        bench        | 38.67 | 46.17 |
|      countertop     | 47.73 | 68.37 |
|        stove        | 62.25 | 67.46 |
|         palm        | 51.73 |  71.9 |
|    kitchen island   | 47.69 | 77.05 |
|       computer      | 53.66 | 59.96 |
|     swivel chair    |  40.7 | 48.73 |
|         boat        | 42.62 | 54.45 |
|         bar         |  26.7 | 33.34 |
|    arcade machine   | 20.83 | 21.21 |
|        hovel        | 43.77 |  47.1 |
|         bus         | 86.78 | 93.37 |
|        towel        | 49.92 | 59.95 |
|        light        | 46.02 | 50.56 |
|        truck        | 30.58 | 38.72 |
|        tower        |  8.56 | 11.14 |
|      chandelier     | 64.34 | 77.21 |
|        awning       | 30.67 |  35.3 |
|     streetlight     | 28.07 | 32.74 |
|        booth        | 64.35 | 74.58 |
| television receiver |  63.6 | 69.31 |
|       airplane      | 57.34 | 66.21 |
|      dirt track     |  4.38 | 20.11 |
|       apparel       | 31.29 | 40.66 |
|         pole        | 21.55 | 31.95 |
|         land        |  0.18 |  0.24 |
|      bannister      |  9.4  | 11.79 |
|      escalator      | 23.21 | 26.21 |
|       ottoman       | 44.02 | 57.67 |
|        bottle       | 38.82 | 58.31 |
|        buffet       | 39.23 |  43.4 |
|        poster       | 16.41 | 20.95 |
|        stage        | 11.38 | 14.55 |
|         van         | 44.58 | 57.65 |
|         ship        | 12.61 | 18.37 |
|       fountain      | 22.46 | 23.33 |
|    conveyer belt    | 74.65 | 79.78 |
|        canopy       | 41.65 | 47.61 |
|        washer       | 65.55 | 65.92 |
|      plaything      | 27.11 |  35.7 |
|    swimming pool    | 79.57 | 85.55 |
|        stool        | 42.88 | 58.91 |
|        barrel       | 37.07 | 40.41 |
|        basket       | 35.83 | 44.98 |
|      waterfall      | 38.89 |  44.6 |
|         tent        | 94.66 |  98.9 |
|         bag         | 12.68 | 14.39 |
|       minibike      | 70.96 | 80.19 |
|        cradle       | 70.41 | 81.78 |
|         oven        |  49.1 | 68.02 |
|         ball        | 48.42 | 64.05 |
|         food        | 52.25 | 67.42 |
|         step        |  6.91 |  8.28 |
|         tank        |  51.4 | 52.84 |
|      trade name     | 14.79 | 16.77 |
|      microwave      | 43.81 | 46.01 |
|         pot         | 37.49 | 41.43 |
|        animal       |  61.5 | 63.96 |
|       bicycle       | 52.75 | 72.82 |
|         lake        | 57.31 | 63.44 |
|      dishwasher     | 54.04 | 59.54 |
|        screen       | 78.85 | 85.84 |
|       blanket       | 15.18 |  17.5 |
|      sculpture      |  44.6 | 73.91 |
|         hood        | 50.38 | 55.59 |
|        sconce       |  38.7 |  45.3 |
|         vase        | 40.57 | 55.74 |
|    traffic light    |  33.2 | 43.74 |
|         tray        |  7.35 | 12.51 |
|        ashcan       | 28.31 | 32.62 |
|         fan         | 60.61 | 71.34 |
|         pier        | 35.57 | 39.53 |
|      crt screen     |  0.83 |  1.4  |
|        plate        | 55.17 | 71.89 |
|       monitor       | 21.58 | 23.09 |
|    bulletin board   |  41.6 | 48.34 |
|        shower       |  3.19 |  4.75 |
|       radiator      | 49.33 | 50.82 |
|        glass        | 14.72 | 15.67 |
|        clock        | 32.21 | 34.29 |
|         flag        | 39.56 | 44.68 |
+---------------------+-------+-------+
11/15 13:48:17 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.5400  mIoU: 45.5600  mAcc: 55.2700  data_time: 0.0023  time: 0.3537
Finished processing corruption type: frost
Processing corruption type: fog
11/15 13:48:21 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1434199644
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1434199644
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 13:48:21 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='fog',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/fog'

Number of parameters:  163407980
11/15 13:48:28 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 13:48:28 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 13:48:28 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 13:48:29 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 13:49:01 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:20:52  time: 0.5500  data_time: 0.0021  memory: 26008  
11/15 13:49:27 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:18:28  time: 0.5341  data_time: 0.0020  memory: 2338  
11/15 13:49:53 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:17:08  time: 0.5171  data_time: 0.0020  memory: 2271  
11/15 13:50:19 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:28  time: 0.5291  data_time: 0.0020  memory: 2434  
11/15 13:50:43 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:39  time: 0.5037  data_time: 0.0018  memory: 2489  
11/15 13:51:08 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:15:01  time: 0.5224  data_time: 0.0019  memory: 2330  
11/15 13:51:34 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:14:29  time: 0.4853  data_time: 0.0018  memory: 2330  
11/15 13:51:58 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:13:57  time: 0.5181  data_time: 0.0018  memory: 2334  
11/15 13:52:21 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:13:19  time: 0.4854  data_time: 0.0018  memory: 2268  
11/15 13:52:46 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:12:51  time: 0.4884  data_time: 0.0018  memory: 2272  
11/15 13:53:12 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:12:26  time: 0.5394  data_time: 0.0019  memory: 2325  
11/15 13:53:38 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:12:00  time: 0.5350  data_time: 0.0020  memory: 2333  
11/15 13:54:03 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:32  time: 0.5031  data_time: 0.0017  memory: 2353  
11/15 13:54:29 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:08  time: 0.5267  data_time: 0.0020  memory: 2349  
11/15 13:54:55 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:43  time: 0.5187  data_time: 0.0019  memory: 2363  
11/15 13:55:18 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:13  time: 0.5186  data_time: 0.0021  memory: 2273  
11/15 13:55:44 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:48  time: 0.5200  data_time: 0.0021  memory: 2262  
11/15 13:56:07 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:20  time: 0.4511  data_time: 0.0019  memory: 2295  
11/15 13:56:33 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:54  time: 0.4893  data_time: 0.0019  memory: 2319  
11/15 13:56:57 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:27  time: 0.4878  data_time: 0.0019  memory: 2323  
11/15 13:57:23 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:08:03  time: 0.5376  data_time: 0.0019  memory: 2368  
11/15 13:57:49 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:37  time: 0.4893  data_time: 0.0019  memory: 2309  
11/15 13:58:14 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:11  time: 0.5056  data_time: 0.0019  memory: 2302  
11/15 13:58:39 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:46  time: 0.4980  data_time: 0.0019  memory: 2608  
11/15 13:59:03 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:20  time: 0.4887  data_time: 0.0019  memory: 2290  
11/15 13:59:26 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:53  time: 0.5087  data_time: 0.0020  memory: 2263  
11/15 13:59:51 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:28  time: 0.4665  data_time: 0.0020  memory: 2264  
11/15 14:00:16 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:02  time: 0.5246  data_time: 0.0020  memory: 2322  
11/15 14:00:40 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:37  time: 0.5247  data_time: 0.0019  memory: 2320  
11/15 14:01:04 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:11  time: 0.4669  data_time: 0.0019  memory: 2263  
11/15 14:01:30 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:46  time: 0.5075  data_time: 0.0020  memory: 2311  
11/15 14:01:54 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:21  time: 0.5017  data_time: 0.0021  memory: 2261  
11/15 14:02:18 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:55  time: 0.4531  data_time: 0.0018  memory: 2444  
11/15 14:02:44 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:30  time: 0.5149  data_time: 0.0021  memory: 2319  
11/15 14:03:10 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:05  time: 0.4978  data_time: 0.0019  memory: 2327  
11/15 14:03:34 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:40  time: 0.5338  data_time: 0.0022  memory: 2277  
11/15 14:04:01 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:15  time: 0.5355  data_time: 0.0028  memory: 2223  
11/15 14:04:25 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:50  time: 0.4772  data_time: 0.0020  memory: 2348  
11/15 14:04:50 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:25  time: 0.4962  data_time: 0.0019  memory: 2479  
11/15 14:05:14 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.4697  data_time: 0.0017  memory: 2357  
11/15 14:05:14 - mmengine - INFO - per class results:
11/15 14:05:14 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 78.51 | 89.85 |
|       building      | 82.95 | 93.96 |
|         sky         | 94.25 |  97.5 |
|        floor        | 81.18 | 90.88 |
|         tree        | 74.51 | 87.56 |
|       ceiling       | 84.93 | 93.28 |
|         road        | 83.93 | 90.21 |
|         bed         |  90.8 | 96.65 |
|      windowpane     | 63.36 | 76.55 |
|        grass        |  66.5 | 80.53 |
|       cabinet       | 61.81 | 74.15 |
|       sidewalk      | 68.44 | 83.15 |
|        person       | 82.59 | 93.43 |
|        earth        | 36.35 | 51.74 |
|         door        | 48.03 | 60.24 |
|        table        | 62.99 | 77.73 |
|       mountain      | 61.23 | 76.44 |
|        plant        |  51.4 | 62.52 |
|       curtain       | 74.37 | 84.98 |
|        chair        | 61.12 | 76.82 |
|         car         | 86.53 | 93.19 |
|        water        | 58.68 | 78.41 |
|       painting      | 74.81 | 89.07 |
|         sofa        | 72.92 | 83.86 |
|        shelf        | 43.62 | 58.93 |
|        house        | 40.44 | 50.22 |
|         sea         | 66.19 | 85.17 |
|        mirror       | 69.89 | 77.79 |
|         rug         |  60.8 | 70.28 |
|        field        | 30.19 | 45.08 |
|       armchair      | 52.41 | 69.93 |
|         seat        | 56.64 | 76.04 |
|        fence        | 44.55 | 59.03 |
|         desk        | 50.39 | 62.62 |
|         rock        | 50.14 |  69.9 |
|       wardrobe      | 43.32 | 58.51 |
|         lamp        | 67.08 | 79.06 |
|       bathtub       | 79.32 | 83.59 |
|       railing       | 36.99 | 50.51 |
|       cushion       | 60.09 | 72.73 |
|         base        | 26.44 | 34.57 |
|         box         | 30.81 | 41.67 |
|        column       | 49.58 | 60.51 |
|      signboard      | 38.36 | 52.53 |
|   chest of drawers  | 39.46 | 63.25 |
|       counter       | 23.75 | 34.61 |
|         sand        |  48.4 | 71.46 |
|         sink        | 73.59 | 80.28 |
|      skyscraper     | 50.14 | 61.94 |
|      fireplace      | 79.65 | 90.88 |
|     refrigerator    | 76.53 | 83.06 |
|      grandstand     | 51.46 | 83.15 |
|         path        | 19.55 | 27.79 |
|        stairs       | 28.98 | 35.41 |
|        runway       |  68.7 | 93.19 |
|         case        | 48.31 | 65.24 |
|      pool table     | 94.32 | 97.49 |
|        pillow       |  61.1 |  73.6 |
|     screen door     | 78.02 | 84.09 |
|       stairway      |  35.6 | 46.56 |
|        river        | 13.19 |  21.3 |
|        bridge       | 70.45 | 80.14 |
|       bookcase      | 43.37 | 65.59 |
|        blind        | 44.21 | 48.45 |
|     coffee table    | 62.38 | 81.25 |
|        toilet       | 85.75 |  90.6 |
|        flower       | 38.12 | 54.09 |
|         book        | 45.94 | 61.97 |
|         hill        |  7.52 |  9.41 |
|        bench        |  40.7 | 49.51 |
|      countertop     | 60.13 | 76.04 |
|        stove        | 77.42 | 82.76 |
|         palm        | 53.02 |  73.8 |
|    kitchen island   | 50.62 |  78.9 |
|       computer      | 77.78 | 90.67 |
|     swivel chair    | 44.77 | 54.08 |
|         boat        | 48.42 | 56.07 |
|         bar         | 38.83 | 44.92 |
|    arcade machine   |  59.9 | 63.06 |
|        hovel        | 16.48 | 17.29 |
|         bus         | 85.33 | 95.79 |
|        towel        | 71.12 | 83.41 |
|        light        | 52.06 | 58.28 |
|        truck        | 40.58 | 51.13 |
|        tower        | 13.97 | 18.29 |
|      chandelier     | 66.25 | 76.24 |
|        awning       | 30.29 | 34.77 |
|     streetlight     | 32.42 | 42.08 |
|        booth        | 46.56 | 55.28 |
| television receiver | 74.72 | 80.53 |
|       airplane      | 66.03 | 71.11 |
|      dirt track     |  4.72 | 20.62 |
|       apparel       | 38.63 | 54.39 |
|         pole        | 23.97 |  32.0 |
|         land        |  3.96 |  5.69 |
|      bannister      |  15.6 |  21.4 |
|      escalator      | 39.22 |  43.5 |
|       ottoman       | 49.27 | 62.72 |
|        bottle       |  38.2 | 53.59 |
|        buffet       | 48.83 | 54.03 |
|        poster       | 27.89 | 39.76 |
|        stage        | 11.89 | 14.96 |
|         van         | 43.62 |  59.4 |
|         ship        |  8.3  |  12.4 |
|       fountain      | 22.32 | 22.66 |
|    conveyer belt    | 80.65 |  91.0 |
|        canopy       | 31.29 | 37.05 |
|        washer       | 71.76 | 72.22 |
|      plaything      | 25.03 | 38.02 |
|    swimming pool    | 75.39 | 90.99 |
|        stool        | 47.14 | 61.98 |
|        barrel       | 60.46 | 71.18 |
|        basket       | 34.92 | 42.67 |
|      waterfall      | 52.11 | 58.37 |
|         tent        | 92.16 |  99.2 |
|         bag         | 18.19 |  20.3 |
|       minibike      | 72.17 | 81.97 |
|        cradle       |  81.4 | 96.72 |
|         oven        | 51.79 |  72.4 |
|         ball        | 43.62 | 50.33 |
|         food        | 45.62 | 57.93 |
|         step        | 10.24 |  12.6 |
|         tank        | 62.33 | 65.58 |
|      trade name     | 20.76 | 22.95 |
|      microwave      | 82.76 | 87.51 |
|         pot         |  46.4 | 53.09 |
|        animal       | 59.45 | 61.38 |
|       bicycle       | 54.04 | 75.54 |
|         lake        | 61.97 | 63.53 |
|      dishwasher     | 62.31 |  76.9 |
|        screen       | 69.33 |  88.2 |
|       blanket       | 19.36 | 22.22 |
|      sculpture      |  65.7 | 79.11 |
|         hood        | 60.89 | 64.98 |
|        sconce       | 53.53 | 62.09 |
|         vase        |  45.7 | 60.48 |
|    traffic light    | 35.83 |  56.8 |
|         tray        | 10.63 |  17.3 |
|        ashcan       | 41.01 | 54.88 |
|         fan         | 65.34 | 78.77 |
|         pier        | 36.79 | 44.43 |
|      crt screen     |  7.79 | 18.01 |
|        plate        | 52.72 | 74.44 |
|       monitor       | 15.94 | 21.11 |
|    bulletin board   | 41.58 | 55.92 |
|        shower       |  8.01 |  9.39 |
|       radiator      | 59.57 | 62.97 |
|        glass        | 16.87 | 18.05 |
|        clock        | 38.17 | 43.71 |
|         flag        | 57.25 | 62.65 |
+---------------------+-------+-------+
11/15 14:05:14 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 83.8100  mIoU: 51.0500  mAcc: 61.7000  data_time: 0.0023  time: 0.5026
Finished processing corruption type: fog
Processing corruption type: brightness
11/15 14:05:18 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1572749611
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1572749611
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 14:05:18 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='brightness',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/brightness'

Number of parameters:  163407980
11/15 14:05:25 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 14:05:25 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 14:05:25 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 14:05:26 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 14:06:04 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:24:31  time: 0.6790  data_time: 0.0020  memory: 26008  
11/15 14:06:36 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:21:58  time: 0.6513  data_time: 0.0020  memory: 2338  
11/15 14:07:06 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:20:33  time: 0.6350  data_time: 0.0020  memory: 2271  
11/15 14:07:39 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:19:50  time: 0.6407  data_time: 0.0020  memory: 2434  
11/15 14:08:09 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:18:55  time: 0.6164  data_time: 0.0019  memory: 2489  
11/15 14:08:39 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:18:11  time: 0.6451  data_time: 0.0020  memory: 2330  
11/15 14:09:10 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:17:34  time: 0.5894  data_time: 0.0019  memory: 2330  
11/15 14:09:41 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:16:57  time: 0.6428  data_time: 0.0019  memory: 2334  
11/15 14:10:08 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:16:10  time: 0.5763  data_time: 0.0018  memory: 2268  
11/15 14:10:39 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:15:37  time: 0.5940  data_time: 0.0019  memory: 2272  
11/15 14:11:11 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:08  time: 0.6618  data_time: 0.0020  memory: 2325  
11/15 14:11:42 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:35  time: 0.6441  data_time: 0.0021  memory: 2333  
11/15 14:12:12 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:14:02  time: 0.6197  data_time: 0.0018  memory: 2353  
11/15 14:12:45 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:13:33  time: 0.6430  data_time: 0.0020  memory: 2349  
11/15 14:13:16 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:13:02  time: 0.6293  data_time: 0.0019  memory: 2363  
11/15 14:13:45 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:12:27  time: 0.6338  data_time: 0.0021  memory: 2273  
11/15 14:14:16 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:11:57  time: 0.6425  data_time: 0.0021  memory: 2262  
11/15 14:14:44 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:21  time: 0.5371  data_time: 0.0018  memory: 2295  
11/15 14:15:16 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:51  time: 0.5964  data_time: 0.0020  memory: 2319  
11/15 14:15:45 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:10:18  time: 0.5900  data_time: 0.0018  memory: 2323  
11/15 14:16:17 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:48  time: 0.6608  data_time: 0.0019  memory: 2368  
11/15 14:16:48 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:09:17  time: 0.5959  data_time: 0.0019  memory: 2309  
11/15 14:17:18 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:08:46  time: 0.6183  data_time: 0.0019  memory: 2302  
11/15 14:17:50 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:08:15  time: 0.5948  data_time: 0.0019  memory: 2608  
11/15 14:18:18 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:07:43  time: 0.5912  data_time: 0.0018  memory: 2290  
11/15 14:18:46 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:07:10  time: 0.6193  data_time: 0.0018  memory: 2263  
11/15 14:19:16 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:06:39  time: 0.5636  data_time: 0.0018  memory: 2264  
11/15 14:19:47 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:06:08  time: 0.6458  data_time: 0.0018  memory: 2322  
11/15 14:20:15 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:05:37  time: 0.6420  data_time: 0.0018  memory: 2320  
11/15 14:20:45 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:05:06  time: 0.5638  data_time: 0.0018  memory: 2263  
11/15 14:21:16 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:04:35  time: 0.6237  data_time: 0.0018  memory: 2311  
11/15 14:21:46 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:04:04  time: 0.6153  data_time: 0.0020  memory: 2261  
11/15 14:22:15 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:03:34  time: 0.5462  data_time: 0.0017  memory: 2444  
11/15 14:22:47 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:03  time: 0.6169  data_time: 0.0020  memory: 2319  
11/15 14:23:18 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:33  time: 0.5985  data_time: 0.0017  memory: 2327  
11/15 14:23:47 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:02  time: 0.6423  data_time: 0.0020  memory: 2277  
11/15 14:24:19 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:31  time: 0.6420  data_time: 0.0019  memory: 2223  
11/15 14:24:47 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:01  time: 0.5759  data_time: 0.0018  memory: 2348  
11/15 14:25:19 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:30  time: 0.5925  data_time: 0.0018  memory: 2479  
11/15 14:25:48 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.5657  data_time: 0.0017  memory: 2357  
11/15 14:25:48 - mmengine - INFO - per class results:
11/15 14:25:48 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 79.32 | 89.65 |
|       building      | 83.67 | 93.83 |
|         sky         | 94.24 | 97.71 |
|        floor        | 82.76 | 91.73 |
|         tree        | 75.16 |  87.6 |
|       ceiling       | 85.79 | 93.62 |
|         road        | 85.03 | 90.77 |
|         bed         | 91.23 | 96.94 |
|      windowpane     | 63.86 | 79.04 |
|        grass        |  68.3 | 85.11 |
|       cabinet       | 62.81 | 73.81 |
|       sidewalk      | 68.85 | 83.21 |
|        person       | 83.44 | 93.75 |
|        earth        | 37.11 | 49.69 |
|         door        | 49.22 | 63.64 |
|        table        | 64.15 | 77.88 |
|       mountain      | 61.27 | 74.75 |
|        plant        | 51.06 | 61.77 |
|       curtain       | 75.53 | 86.41 |
|        chair        | 61.99 | 76.05 |
|         car         | 86.69 | 93.85 |
|        water        | 61.39 | 78.75 |
|       painting      | 75.71 | 88.38 |
|         sofa        | 73.72 | 85.75 |
|        shelf        | 46.33 | 62.89 |
|        house        |  44.8 | 55.87 |
|         sea         |  68.6 | 83.01 |
|        mirror       | 71.04 |  78.8 |
|         rug         | 64.94 | 75.06 |
|        field        | 30.54 | 47.47 |
|       armchair      |  52.6 |  71.3 |
|         seat        | 61.13 | 82.52 |
|        fence        | 48.71 | 62.83 |
|         desk        | 55.51 | 70.58 |
|         rock        | 49.41 |  73.7 |
|       wardrobe      | 47.03 | 64.81 |
|         lamp        | 65.88 | 77.76 |
|       bathtub       | 80.97 | 84.32 |
|       railing       | 39.27 | 52.88 |
|       cushion       | 62.95 |  75.3 |
|         base        | 33.77 | 42.79 |
|         box         | 32.79 | 43.52 |
|        column       | 49.59 | 59.13 |
|      signboard      | 39.88 | 53.14 |
|   chest of drawers  |  40.9 | 60.69 |
|       counter       | 28.23 | 38.95 |
|         sand        | 48.03 | 74.39 |
|         sink        | 73.19 | 80.97 |
|      skyscraper     | 55.98 | 68.29 |
|      fireplace      | 80.13 |  92.0 |
|     refrigerator    | 77.91 | 85.97 |
|      grandstand     | 52.93 | 80.72 |
|         path        | 21.37 | 31.31 |
|        stairs       | 30.99 |  37.5 |
|        runway       | 71.15 | 93.21 |
|         case        | 47.44 | 64.07 |
|      pool table     | 94.86 | 97.49 |
|        pillow       | 59.35 | 69.49 |
|     screen door     |  77.7 |  85.6 |
|       stairway      | 35.96 | 46.41 |
|        river        |  17.1 | 34.59 |
|        bridge       | 67.43 | 73.79 |
|       bookcase      | 42.82 | 63.12 |
|        blind        |  41.6 | 46.78 |
|     coffee table    | 59.48 | 81.87 |
|        toilet       | 86.48 |  91.2 |
|        flower       | 41.62 | 60.22 |
|         book        | 47.88 |  66.9 |
|         hill        |  6.71 |  8.68 |
|        bench        | 44.52 | 51.82 |
|      countertop     | 61.12 | 77.67 |
|        stove        | 77.16 | 86.04 |
|         palm        | 55.38 | 78.01 |
|    kitchen island   | 52.21 | 85.14 |
|       computer      | 78.75 | 92.47 |
|     swivel chair    | 44.21 | 57.32 |
|         boat        | 50.47 | 57.77 |
|         bar         |  41.7 |  50.1 |
|    arcade machine   | 45.52 | 47.23 |
|        hovel        | 38.92 | 41.33 |
|         bus         | 84.69 | 96.57 |
|        towel        | 69.85 |  81.3 |
|        light        | 56.81 | 64.11 |
|        truck        |  44.1 | 53.35 |
|        tower        | 20.69 | 27.86 |
|      chandelier     | 68.59 | 81.91 |
|        awning       | 32.12 | 38.39 |
|     streetlight     | 32.59 | 41.65 |
|        booth        | 53.05 |  61.8 |
| television receiver |  78.6 | 86.59 |
|       airplane      | 68.58 | 75.21 |
|      dirt track     |  5.01 | 24.56 |
|       apparel       | 36.81 | 51.36 |
|         pole        | 26.93 | 37.41 |
|         land        |  4.4  |  6.1  |
|      bannister      | 14.27 | 18.69 |
|      escalator      | 36.33 | 42.81 |
|       ottoman       | 46.58 | 61.72 |
|        bottle       | 37.13 | 53.85 |
|        buffet       | 47.97 | 53.42 |
|        poster       | 29.57 | 38.16 |
|        stage        | 11.97 | 17.88 |
|         van         | 45.76 | 59.29 |
|         ship        | 14.65 |  21.1 |
|       fountain      | 32.79 | 33.63 |
|    conveyer belt    | 66.09 | 91.01 |
|        canopy       | 38.98 | 46.44 |
|        washer       | 76.26 | 77.24 |
|      plaything      | 31.92 | 48.26 |
|    swimming pool    | 77.91 | 91.19 |
|        stool        | 48.18 | 63.16 |
|        barrel       | 59.34 | 73.67 |
|        basket       | 35.68 | 47.75 |
|      waterfall      |  50.1 | 58.53 |
|         tent        |  94.9 |  99.1 |
|         bag         | 16.73 | 18.78 |
|       minibike      | 72.63 | 84.88 |
|        cradle       | 80.28 | 97.21 |
|         oven        | 57.36 | 79.43 |
|         ball        | 54.35 | 65.66 |
|         food        | 53.85 | 66.98 |
|         step        |  10.9 | 12.58 |
|         tank        | 63.83 | 66.46 |
|      trade name     | 25.95 | 29.23 |
|      microwave      | 82.87 |  88.6 |
|         pot         |  45.8 | 51.64 |
|        animal       | 60.32 | 62.61 |
|       bicycle       | 56.63 | 75.69 |
|         lake        | 63.08 | 63.57 |
|      dishwasher     |  64.4 | 79.42 |
|        screen       | 67.46 |  87.2 |
|       blanket       | 16.39 | 19.33 |
|      sculpture      | 66.55 | 80.14 |
|         hood        | 59.84 | 64.17 |
|        sconce       | 52.45 | 63.29 |
|         vase        | 46.01 | 62.06 |
|    traffic light    |  39.1 | 58.74 |
|         tray        |  8.84 | 16.61 |
|        ashcan       | 47.91 | 60.99 |
|         fan         | 65.91 |  79.3 |
|         pier        | 35.18 | 46.05 |
|      crt screen     |  7.31 | 15.23 |
|        plate        | 56.52 |  75.5 |
|       monitor       | 29.63 | 34.75 |
|    bulletin board   | 37.64 |  47.7 |
|        shower       |  7.7  | 10.71 |
|       radiator      | 64.07 | 69.33 |
|        glass        | 18.22 | 19.63 |
|        clock        | 43.24 |  49.5 |
|         flag        | 61.88 | 68.03 |
+---------------------+-------+-------+
11/15 14:25:48 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 84.4600  mIoU: 52.5700  mAcc: 63.7800  data_time: 0.0022  time: 0.6105
Finished processing corruption type: brightness
Processing corruption type: contrast
11/15 14:25:52 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1660992425
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1660992425
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 14:25:52 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='contrast',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/contrast'

Number of parameters:  163407980
11/15 14:25:59 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 14:25:59 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 14:25:59 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 14:26:00 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 14:26:25 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:16:11  time: 0.4099  data_time: 0.0020  memory: 26008  
11/15 14:26:44 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:13:54  time: 0.3895  data_time: 0.0019  memory: 2338  
11/15 14:27:02 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:12:41  time: 0.3736  data_time: 0.0019  memory: 2271  
11/15 14:27:21 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:12:08  time: 0.3869  data_time: 0.0019  memory: 2434  
11/15 14:27:39 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:11:27  time: 0.3629  data_time: 0.0019  memory: 2489  
11/15 14:27:57 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:58  time: 0.3802  data_time: 0.0020  memory: 2330  
11/15 14:28:15 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:10:33  time: 0.3441  data_time: 0.0018  memory: 2330  
11/15 14:28:33 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:10:09  time: 0.3800  data_time: 0.0018  memory: 2334  
11/15 14:28:49 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:09:39  time: 0.3444  data_time: 0.0018  memory: 2268  
11/15 14:29:07 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:18  time: 0.3444  data_time: 0.0018  memory: 2272  
11/15 14:29:26 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:00  time: 0.3986  data_time: 0.0019  memory: 2325  
11/15 14:29:44 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:40  time: 0.3824  data_time: 0.0020  memory: 2333  
11/15 14:30:01 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:08:20  time: 0.3632  data_time: 0.0017  memory: 2353  
11/15 14:30:21 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:08:03  time: 0.3825  data_time: 0.0020  memory: 2349  
11/15 14:30:39 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:44  time: 0.3766  data_time: 0.0018  memory: 2363  
11/15 14:30:56 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:07:22  time: 0.3786  data_time: 0.0020  memory: 2273  
11/15 14:31:15 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:07:05  time: 0.3810  data_time: 0.0021  memory: 2262  
11/15 14:31:31 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:06:43  time: 0.3081  data_time: 0.0018  memory: 2295  
11/15 14:31:49 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:06:25  time: 0.3472  data_time: 0.0019  memory: 2319  
11/15 14:32:06 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:05  time: 0.3441  data_time: 0.0018  memory: 2323  
11/15 14:32:25 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:05:47  time: 0.3964  data_time: 0.0019  memory: 2368  
11/15 14:32:44 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:29  time: 0.3477  data_time: 0.0019  memory: 2309  
11/15 14:33:01 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:11  time: 0.3657  data_time: 0.0019  memory: 2302  
11/15 14:33:20 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:52  time: 0.3457  data_time: 0.0019  memory: 2608  
11/15 14:33:36 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:33  time: 0.3470  data_time: 0.0023  memory: 2290  
11/15 14:33:52 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:14  time: 0.3649  data_time: 0.0019  memory: 2263  
11/15 14:34:10 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:55  time: 0.3252  data_time: 0.0019  memory: 2264  
11/15 14:34:28 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:37  time: 0.3850  data_time: 0.0018  memory: 2322  
11/15 14:34:44 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:18  time: 0.3835  data_time: 0.0018  memory: 2320  
11/15 14:35:02 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:00  time: 0.3266  data_time: 0.0018  memory: 2263  
11/15 14:35:20 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:42  time: 0.3639  data_time: 0.0019  memory: 2311  
11/15 14:35:38 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:24  time: 0.3610  data_time: 0.0020  memory: 2261  
11/15 14:35:54 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:05  time: 0.3094  data_time: 0.0018  memory: 2444  
11/15 14:36:13 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:48  time: 0.3638  data_time: 0.0020  memory: 2319  
11/15 14:36:32 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:30  time: 0.3497  data_time: 0.0018  memory: 2327  
11/15 14:36:48 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:11  time: 0.3821  data_time: 0.0021  memory: 2277  
11/15 14:37:07 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:54  time: 0.3783  data_time: 0.0021  memory: 2223  
11/15 14:37:23 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:35  time: 0.3303  data_time: 0.0020  memory: 2348  
11/15 14:37:42 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.3443  data_time: 0.0018  memory: 2479  
11/15 14:37:58 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.3256  data_time: 0.0017  memory: 2357  
11/15 14:37:58 - mmengine - INFO - per class results:
11/15 14:37:58 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 79.29 | 89.76 |
|       building      | 83.53 | 93.63 |
|         sky         | 94.62 | 97.74 |
|        floor        | 82.79 | 91.83 |
|         tree        | 74.89 | 88.43 |
|       ceiling       | 85.81 | 93.71 |
|         road        | 84.21 |  90.8 |
|         bed         | 91.26 |  96.8 |
|      windowpane     | 64.32 |  78.8 |
|        grass        | 67.49 | 84.29 |
|       cabinet       |  63.1 | 76.07 |
|       sidewalk      |  67.7 | 82.76 |
|        person       | 83.37 | 93.17 |
|        earth        | 37.96 | 50.79 |
|         door        | 49.96 | 63.22 |
|        table        | 63.82 | 77.92 |
|       mountain      | 60.74 | 74.23 |
|        plant        | 51.27 | 59.74 |
|       curtain       | 75.59 | 86.78 |
|        chair        | 62.48 | 77.21 |
|         car         | 86.74 | 93.52 |
|        water        | 60.86 | 78.65 |
|       painting      | 74.99 | 88.78 |
|         sofa        | 75.07 | 85.54 |
|        shelf        | 44.93 | 60.48 |
|        house        |  43.6 |  56.5 |
|         sea         | 69.01 | 84.38 |
|        mirror       | 70.49 | 78.07 |
|         rug         | 65.68 | 74.34 |
|        field        | 29.58 | 48.17 |
|       armchair      | 54.47 | 72.93 |
|         seat        | 60.08 | 80.65 |
|        fence        | 46.87 | 60.79 |
|         desk        | 53.04 | 67.96 |
|         rock        | 50.12 | 73.01 |
|       wardrobe      | 46.57 | 59.43 |
|         lamp        | 67.23 | 78.56 |
|       bathtub       | 79.72 | 83.45 |
|       railing       | 38.02 | 51.87 |
|       cushion       |  61.1 | 73.68 |
|         base        | 33.13 | 42.98 |
|         box         | 32.23 | 41.88 |
|        column       | 49.74 |  59.3 |
|      signboard      | 39.79 | 53.22 |
|   chest of drawers  | 40.59 | 63.13 |
|       counter       | 28.23 | 39.87 |
|         sand        | 50.54 | 72.62 |
|         sink        | 73.37 | 80.79 |
|      skyscraper     | 56.35 | 70.62 |
|      fireplace      | 79.33 | 90.92 |
|     refrigerator    | 77.79 | 83.35 |
|      grandstand     | 48.39 | 78.05 |
|         path        | 20.45 | 29.48 |
|        stairs       | 28.64 | 34.15 |
|        runway       | 69.84 |  93.5 |
|         case        | 45.61 | 65.46 |
|      pool table     | 94.78 | 97.53 |
|        pillow       | 60.53 | 71.94 |
|     screen door     | 78.43 | 84.92 |
|       stairway      | 36.13 | 47.19 |
|        river        |  18.2 | 36.83 |
|        bridge       | 68.45 | 77.76 |
|       bookcase      |  40.8 | 62.38 |
|        blind        | 43.51 | 47.96 |
|     coffee table    | 60.47 | 82.31 |
|        toilet       | 83.48 | 90.71 |
|        flower       | 42.01 | 58.33 |
|         book        | 46.97 | 66.58 |
|         hill        |  6.94 |  9.58 |
|        bench        | 43.27 |  51.2 |
|      countertop     | 59.35 | 75.27 |
|        stove        | 75.51 | 81.49 |
|         palm        | 54.25 | 74.74 |
|    kitchen island   | 50.52 | 80.79 |
|       computer      | 78.69 | 92.14 |
|     swivel chair    | 42.45 | 53.64 |
|         boat        | 48.19 | 55.62 |
|         bar         |  41.3 | 47.45 |
|    arcade machine   | 58.34 | 60.12 |
|        hovel        | 16.58 | 17.37 |
|         bus         | 83.11 | 96.78 |
|        towel        | 72.13 | 83.91 |
|        light        | 56.37 | 62.84 |
|        truck        | 41.01 | 49.78 |
|        tower        | 11.18 | 14.55 |
|      chandelier     | 69.67 | 82.05 |
|        awning       | 31.61 | 38.77 |
|     streetlight     |  33.2 | 43.14 |
|        booth        | 53.46 |  62.8 |
| television receiver | 74.54 | 81.19 |
|       airplane      | 68.83 | 74.52 |
|      dirt track     |  4.33 | 18.97 |
|       apparel       | 36.39 | 51.51 |
|         pole        | 25.52 | 34.98 |
|         land        |  4.29 |  6.9  |
|      bannister      | 13.98 | 18.61 |
|      escalator      | 41.54 | 48.88 |
|       ottoman       | 49.25 | 66.79 |
|        bottle       | 38.77 | 55.89 |
|        buffet       | 44.71 | 50.75 |
|        poster       |  31.1 | 42.95 |
|        stage        | 16.13 | 21.16 |
|         van         | 43.45 | 59.09 |
|         ship        | 13.26 | 19.71 |
|       fountain      | 28.64 | 29.22 |
|    conveyer belt    | 72.54 | 91.48 |
|        canopy       | 33.43 | 42.75 |
|        washer       | 72.02 | 72.92 |
|      plaything      | 24.71 | 37.05 |
|    swimming pool    | 73.36 | 90.92 |
|        stool        | 49.39 | 64.14 |
|        barrel       |  57.6 | 73.28 |
|        basket       | 31.35 | 42.61 |
|      waterfall      | 47.48 | 55.81 |
|         tent        | 95.67 | 99.02 |
|         bag         |  18.4 | 20.56 |
|       minibike      | 73.57 | 83.81 |
|        cradle       |  80.2 | 97.08 |
|         oven        | 51.86 | 77.13 |
|         ball        | 56.11 | 67.22 |
|         food        | 51.85 | 62.95 |
|         step        | 11.29 | 13.78 |
|         tank        | 63.45 | 65.87 |
|      trade name     | 24.08 | 27.29 |
|      microwave      | 83.67 | 88.58 |
|         pot         | 46.29 |  52.2 |
|        animal       | 59.87 | 61.89 |
|       bicycle       | 56.97 | 76.73 |
|         lake        | 63.04 | 63.57 |
|      dishwasher     | 69.88 |  77.9 |
|        screen       | 69.78 | 87.22 |
|       blanket       | 17.89 | 20.76 |
|      sculpture      | 67.48 | 78.83 |
|         hood        | 62.14 | 64.55 |
|        sconce       | 53.94 | 62.51 |
|         vase        | 46.08 | 61.42 |
|    traffic light    | 38.39 | 58.45 |
|         tray        |  8.02 | 13.01 |
|        ashcan       | 46.93 | 57.84 |
|         fan         |  65.7 | 78.47 |
|         pier        | 37.42 | 45.78 |
|      crt screen     |  1.4  |  2.79 |
|        plate        | 57.31 | 74.23 |
|       monitor       | 32.09 | 36.82 |
|    bulletin board   | 41.33 | 52.71 |
|        shower       |  8.17 |  9.74 |
|       radiator      | 64.68 | 68.71 |
|        glass        | 17.59 | 18.82 |
|        clock        | 42.54 | 48.63 |
|         flag        | 56.93 |  63.5 |
+---------------------+-------+-------+
11/15 14:37:58 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 84.3700  mIoU: 52.1100  mAcc: 62.9900  data_time: 0.0022  time: 0.3589
Finished processing corruption type: contrast
Processing corruption type: elastic_transform
11/15 14:38:02 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1132856376
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1132856376
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 14:38:02 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/elastic_transform'

Number of parameters:  163407980
11/15 14:38:09 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 14:38:09 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 14:38:09 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 14:38:10 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 14:40:03 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:13:07  time: 2.2519  data_time: 0.0020  memory: 26008  
11/15 14:41:48 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:08:51  time: 2.1759  data_time: 0.0020  memory: 2338  
11/15 14:43:32 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:06:03  time: 2.1381  data_time: 0.0019  memory: 2271  
11/15 14:45:19 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 1:04:13  time: 2.1007  data_time: 0.0024  memory: 2434  
11/15 14:47:00 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 1:01:43  time: 2.0566  data_time: 0.0020  memory: 2489  
11/15 14:48:41 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:59:32  time: 2.1393  data_time: 0.0021  memory: 2330  
11/15 14:50:24 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:57:38  time: 1.9672  data_time: 0.0020  memory: 2330  
11/15 14:52:07 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:55:45  time: 2.1233  data_time: 0.0019  memory: 2334  
11/15 14:53:40 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:53:22  time: 1.9174  data_time: 0.0018  memory: 2268  
11/15 14:55:23 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:51:36  time: 1.9963  data_time: 0.0020  memory: 2272  
11/15 14:57:12 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:50:08  time: 2.1889  data_time: 0.0021  memory: 2325  
11/15 14:58:54 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:48:21  time: 2.1389  data_time: 0.0022  memory: 2333  
11/15 15:00:36 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:46:34  time: 2.0765  data_time: 0.0019  memory: 2353  
11/15 15:02:24 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:44:59  time: 2.1453  data_time: 0.0021  memory: 2349  
11/15 15:04:09 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:43:17  time: 2.0433  data_time: 0.0019  memory: 2363  
11/15 15:05:46 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:41:22  time: 2.0792  data_time: 0.0020  memory: 2273  
11/15 15:07:30 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:39:40  time: 2.1105  data_time: 0.0020  memory: 2262  
11/15 15:09:05 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:37:46  time: 1.8299  data_time: 0.0017  memory: 2295  
11/15 15:10:50 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:36:05  time: 2.0173  data_time: 0.0019  memory: 2319  
11/15 15:12:28 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:34:17  time: 1.9762  data_time: 0.0018  memory: 2323  
11/15 15:14:15 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:32:37  time: 2.1645  data_time: 0.0018  memory: 2368  
11/15 15:15:58 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:30:55  time: 2.0221  data_time: 0.0019  memory: 2309  
11/15 15:17:39 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:29:10  time: 2.0676  data_time: 0.0019  memory: 2302  
11/15 15:19:24 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:27:29  time: 2.0048  data_time: 0.0019  memory: 2608  
11/15 15:21:02 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:25:43  time: 1.9895  data_time: 0.0018  memory: 2290  
11/15 15:22:38 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:23:56  time: 2.0673  data_time: 0.0019  memory: 2263  
11/15 15:24:19 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:22:13  time: 1.8980  data_time: 0.0018  memory: 2264  
11/15 15:26:01 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:20:30  time: 2.1545  data_time: 0.0018  memory: 2322  
11/15 15:27:38 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:18:45  time: 2.1394  data_time: 0.0018  memory: 2320  
11/15 15:29:17 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:17:02  time: 1.9038  data_time: 0.0018  memory: 2263  
11/15 15:31:04 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:15:21  time: 2.0938  data_time: 0.0018  memory: 2311  
11/15 15:32:44 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:13:38  time: 2.0352  data_time: 0.0020  memory: 2261  
11/15 15:34:24 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:11:55  time: 1.8780  data_time: 0.0018  memory: 2444  
11/15 15:36:08 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:10:13  time: 2.0698  data_time: 0.0021  memory: 2319  
11/15 15:37:53 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:08:31  time: 2.0291  data_time: 0.0018  memory: 2327  
11/15 15:39:31 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:06:48  time: 2.1077  data_time: 0.0020  memory: 2277  
11/15 15:41:15 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:05:06  time: 2.0849  data_time: 0.0020  memory: 2223  
11/15 15:42:51 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:03:24  time: 1.9758  data_time: 0.0019  memory: 2348  
11/15 15:44:51 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:42  time: 1.9877  data_time: 0.0019  memory: 2479  
11/15 15:46:29 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 1.8599  data_time: 0.0017  memory: 2357  
11/15 15:46:29 - mmengine - INFO - per class results:
11/15 15:46:29 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 67.73 |  81.4 |
|       building      |  76.9 | 89.86 |
|         sky         |  86.2 | 92.76 |
|        floor        | 71.52 | 84.15 |
|         tree        | 66.09 | 81.73 |
|       ceiling       | 74.01 | 86.76 |
|         road        | 78.33 | 87.25 |
|         bed         | 80.22 | 90.09 |
|      windowpane     | 52.58 | 70.27 |
|        grass        | 62.96 | 80.35 |
|       cabinet       | 52.92 | 66.32 |
|       sidewalk      | 56.12 | 72.35 |
|        person       | 65.98 |  82.0 |
|        earth        | 36.29 | 49.02 |
|         door        | 40.92 | 53.55 |
|        table        | 47.92 | 66.11 |
|       mountain      | 55.92 | 69.65 |
|        plant        |  44.4 | 56.55 |
|       curtain       | 56.81 | 75.11 |
|        chair        | 45.84 | 63.21 |
|         car         | 68.19 | 82.18 |
|        water        | 58.98 | 77.69 |
|       painting      | 53.36 | 70.73 |
|         sofa        | 62.03 | 77.08 |
|        shelf        | 41.03 | 57.42 |
|        house        | 42.05 | 51.51 |
|         sea         | 64.16 | 78.23 |
|        mirror       | 61.11 | 72.72 |
|         rug         | 53.35 | 66.91 |
|        field        | 28.83 | 45.85 |
|       armchair      | 43.02 | 61.34 |
|         seat        | 55.26 | 76.84 |
|        fence        | 39.27 | 54.24 |
|         desk        | 44.67 | 61.53 |
|         rock        | 44.35 | 69.43 |
|       wardrobe      | 42.36 | 59.68 |
|         lamp        | 35.24 | 53.05 |
|       bathtub       | 66.85 | 74.77 |
|       railing       | 32.51 | 46.96 |
|       cushion       |  44.3 | 58.52 |
|         base        | 31.85 | 43.66 |
|         box         | 25.87 | 38.01 |
|        column       | 36.99 | 50.93 |
|      signboard      |  26.0 | 39.45 |
|   chest of drawers  | 37.27 |  55.4 |
|       counter       | 24.59 | 32.68 |
|         sand        | 47.68 | 72.33 |
|         sink        | 52.42 | 64.63 |
|      skyscraper     | 50.96 | 64.66 |
|      fireplace      | 69.86 | 85.37 |
|     refrigerator    | 65.16 | 74.94 |
|      grandstand     | 47.92 | 76.51 |
|         path        | 19.39 | 28.64 |
|        stairs       | 26.88 | 34.01 |
|        runway       | 64.88 | 85.12 |
|         case        |  45.4 | 58.87 |
|      pool table     | 77.91 | 87.84 |
|        pillow       | 46.66 | 60.36 |
|     screen door     | 71.28 | 80.55 |
|       stairway      | 30.31 | 39.14 |
|        river        |  14.8 | 29.68 |
|        bridge       | 55.61 | 65.26 |
|       bookcase      | 32.89 | 54.12 |
|        blind        | 35.46 | 41.13 |
|     coffee table    | 48.83 | 69.01 |
|        toilet       | 62.61 | 76.06 |
|        flower       | 29.84 | 50.29 |
|         book        | 34.16 | 51.77 |
|         hill        |  6.41 |  9.13 |
|        bench        | 39.26 | 48.42 |
|      countertop     | 44.65 | 65.97 |
|        stove        | 64.57 | 78.18 |
|         palm        | 40.65 | 61.74 |
|    kitchen island   | 41.46 | 72.53 |
|       computer      | 67.63 | 85.68 |
|     swivel chair    | 35.92 |  51.7 |
|         boat        | 48.61 | 60.52 |
|         bar         |  44.5 |  57.0 |
|    arcade machine   | 52.59 | 58.62 |
|        hovel        | 36.33 | 38.83 |
|         bus         | 71.21 |  90.1 |
|        towel        | 48.95 | 66.24 |
|        light        | 18.27 | 27.92 |
|        truck        | 33.81 | 46.57 |
|        tower        | 15.68 | 21.69 |
|      chandelier     | 45.31 | 63.73 |
|        awning       | 25.05 | 31.74 |
|     streetlight     | 10.69 |  17.2 |
|        booth        | 46.28 | 55.17 |
| television receiver | 56.73 | 72.28 |
|       airplane      | 48.37 | 60.63 |
|      dirt track     |  6.01 | 26.07 |
|       apparel       | 26.46 |  42.4 |
|         pole        | 13.01 |  19.8 |
|         land        |  3.22 |  4.93 |
|      bannister      |  7.17 |  9.88 |
|      escalator      | 28.89 |  35.1 |
|       ottoman       | 40.84 | 56.26 |
|        bottle       | 28.94 | 47.84 |
|        buffet       | 40.78 | 46.82 |
|        poster       | 27.13 | 38.12 |
|        stage        | 17.26 | 28.58 |
|         van         | 36.17 | 46.98 |
|         ship        | 18.82 |  25.7 |
|       fountain      | 30.94 | 32.61 |
|    conveyer belt    | 66.53 | 88.37 |
|        canopy       | 36.32 | 48.03 |
|        washer       |  70.5 | 73.19 |
|      plaything      | 21.31 | 33.42 |
|    swimming pool    | 78.39 | 90.36 |
|        stool        | 25.17 | 39.44 |
|        barrel       | 49.54 | 71.16 |
|        basket       | 27.06 | 37.36 |
|      waterfall      |  43.6 | 55.71 |
|         tent        | 88.77 | 96.21 |
|         bag         | 12.77 | 15.86 |
|       minibike      |  56.2 | 75.44 |
|        cradle       |  70.8 | 91.39 |
|         oven        | 46.68 | 63.39 |
|         ball        | 39.81 | 54.07 |
|         food        | 44.23 | 58.78 |
|         step        |  8.33 |  9.32 |
|         tank        | 59.34 | 64.44 |
|      trade name     | 15.51 | 18.68 |
|      microwave      | 73.61 | 83.06 |
|         pot         | 28.05 | 37.47 |
|        animal       | 50.15 | 55.83 |
|       bicycle       | 41.09 | 62.57 |
|         lake        | 61.16 | 63.45 |
|      dishwasher     | 53.47 |  67.6 |
|        screen       | 54.54 | 75.84 |
|       blanket       |  15.3 | 18.88 |
|      sculpture      | 55.84 | 73.64 |
|         hood        | 44.58 | 54.98 |
|        sconce       | 24.78 | 37.02 |
|         vase        | 22.21 | 37.52 |
|    traffic light    | 19.51 | 35.65 |
|         tray        |  7.07 | 12.98 |
|        ashcan       | 27.58 | 43.17 |
|         fan         | 29.13 | 45.43 |
|         pier        | 27.67 | 35.38 |
|      crt screen     |  8.15 | 15.33 |
|        plate        | 40.51 | 59.86 |
|       monitor       | 33.93 | 43.03 |
|    bulletin board   | 37.53 | 49.54 |
|        shower       |  0.85 |  1.39 |
|       radiator      | 44.36 | 55.85 |
|        glass        | 11.11 | 12.89 |
|        clock        | 25.47 | 34.65 |
|         flag        | 41.97 | 53.86 |
+---------------------+-------+-------+
11/15 15:46:29 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 77.5900  mIoU: 42.8200  mAcc: 55.7300  data_time: 0.0027  time: 2.0490
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
11/15 15:48:21 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1255195028
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1255195028
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 15:48:21 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/pixelate'

Number of parameters:  163407980
11/15 15:49:09 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 15:49:09 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 15:49:10 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 15:49:15 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 15:50:34 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:50:55  time: 0.3687  data_time: 0.0018  memory: 26008  
11/15 15:50:51 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:30:14  time: 0.3529  data_time: 0.0020  memory: 2338  
11/15 15:51:07 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:22:56  time: 0.3346  data_time: 0.0019  memory: 2271  
11/15 15:51:24 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:19:20  time: 0.3486  data_time: 0.0018  memory: 2434  
11/15 15:51:40 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:16:53  time: 0.3342  data_time: 0.0017  memory: 2489  
11/15 15:51:56 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:15:13  time: 0.3497  data_time: 0.0019  memory: 2330  
11/15 15:52:13 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:59  time: 0.3162  data_time: 0.0017  memory: 2330  
11/15 15:52:30 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:58  time: 0.3494  data_time: 0.0017  memory: 2334  
11/15 15:52:44 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:11:59  time: 0.3148  data_time: 0.0018  memory: 2268  
11/15 15:53:01 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:11:16  time: 0.3188  data_time: 0.0019  memory: 2272  
11/15 15:53:18 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:10:40  time: 0.3682  data_time: 0.0019  memory: 2325  
11/15 15:53:35 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:10:05  time: 0.3527  data_time: 0.0019  memory: 2333  
11/15 15:53:51 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:09:32  time: 0.3350  data_time: 0.0017  memory: 2353  
11/15 15:54:09 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:09:05  time: 0.3524  data_time: 0.0019  memory: 2349  
11/15 15:54:26 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:08:38  time: 0.3502  data_time: 0.0018  memory: 2363  
11/15 15:54:41 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:08:08  time: 0.3521  data_time: 0.0020  memory: 2273  
11/15 15:54:59 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:07:44  time: 0.3534  data_time: 0.0020  memory: 2262  
11/15 15:55:13 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:17  time: 0.2840  data_time: 0.0018  memory: 2295  
11/15 15:55:30 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:06:54  time: 0.3181  data_time: 0.0019  memory: 2319  
11/15 15:55:46 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:30  time: 0.3174  data_time: 0.0018  memory: 2323  
11/15 15:56:04 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:09  time: 0.3680  data_time: 0.0018  memory: 2368  
11/15 15:56:21 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:48  time: 0.3170  data_time: 0.0019  memory: 2309  
11/15 15:56:37 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:26  time: 0.3339  data_time: 0.0018  memory: 2302  
11/15 15:56:54 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:05  time: 0.3152  data_time: 0.0018  memory: 2608  
11/15 15:57:09 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:44  time: 0.3191  data_time: 0.0019  memory: 2290  
11/15 15:57:24 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:22  time: 0.3371  data_time: 0.0019  memory: 2263  
11/15 15:57:40 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:02  time: 0.3013  data_time: 0.0019  memory: 2264  
11/15 15:57:56 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:43  time: 0.3533  data_time: 0.0019  memory: 2322  
11/15 15:58:11 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:23  time: 0.3533  data_time: 0.0018  memory: 2320  
11/15 15:58:27 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:03  time: 0.3035  data_time: 0.0036  memory: 2263  
11/15 15:58:44 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:45  time: 0.3361  data_time: 0.0019  memory: 2311  
11/15 15:59:00 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:26  time: 0.3352  data_time: 0.0020  memory: 2261  
11/15 15:59:16 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:07  time: 0.2848  data_time: 0.0018  memory: 2444  
11/15 15:59:33 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:48  time: 0.3354  data_time: 0.0019  memory: 2319  
11/15 15:59:50 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:30  time: 0.3187  data_time: 0.0018  memory: 2327  
11/15 16:00:06 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:12  time: 0.3520  data_time: 0.0020  memory: 2277  
11/15 16:00:23 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:54  time: 0.3538  data_time: 0.0020  memory: 2223  
11/15 16:00:38 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:35  time: 0.3042  data_time: 0.0019  memory: 2348  
11/15 16:00:55 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.3187  data_time: 0.0019  memory: 2479  
11/15 16:01:10 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2989  data_time: 0.0017  memory: 2357  
11/15 16:01:10 - mmengine - INFO - per class results:
11/15 16:01:10 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  78.5 | 89.27 |
|       building      | 81.99 | 94.91 |
|         sky         | 94.05 | 97.79 |
|        floor        | 81.71 | 92.34 |
|         tree        | 73.54 | 86.65 |
|       ceiling       | 85.17 |  93.3 |
|         road        | 84.59 | 90.66 |
|         bed         | 91.34 | 96.52 |
|      windowpane     | 63.71 | 77.65 |
|        grass        | 65.84 | 81.08 |
|       cabinet       | 61.05 |  72.8 |
|       sidewalk      | 67.39 | 82.93 |
|        person       | 82.86 | 93.28 |
|        earth        | 35.93 | 49.72 |
|         door        | 47.88 |  59.9 |
|        table        | 63.23 | 77.96 |
|       mountain      | 64.56 | 74.86 |
|        plant        | 50.34 | 62.33 |
|       curtain       | 74.75 | 86.25 |
|        chair        | 61.45 |  75.6 |
|         car         | 85.46 | 92.15 |
|        water        | 61.72 | 76.35 |
|       painting      | 74.96 | 87.72 |
|         sofa        | 73.13 | 87.45 |
|        shelf        |  45.9 | 63.26 |
|        house        | 35.32 | 40.17 |
|         sea         | 70.27 | 83.34 |
|        mirror       | 69.27 | 76.11 |
|         rug         | 60.28 | 67.52 |
|        field        | 26.43 | 43.61 |
|       armchair      | 51.19 | 66.19 |
|         seat        | 59.35 | 80.78 |
|        fence        | 45.27 |  57.6 |
|         desk        |  55.3 | 69.15 |
|         rock        | 50.38 | 79.82 |
|       wardrobe      | 47.78 | 66.09 |
|         lamp        |  66.4 | 75.47 |
|       bathtub       | 82.41 | 86.28 |
|       railing       | 37.51 | 50.15 |
|       cushion       | 62.65 | 74.73 |
|         base        | 34.08 | 47.69 |
|         box         | 29.71 |  40.1 |
|        column       | 46.54 | 55.81 |
|      signboard      | 39.41 | 50.02 |
|   chest of drawers  | 44.12 | 67.01 |
|       counter       | 30.25 | 39.91 |
|         sand        |  41.0 | 58.84 |
|         sink        |  72.1 | 80.27 |
|      skyscraper     | 51.61 |  57.8 |
|      fireplace      | 80.57 | 92.44 |
|     refrigerator    | 74.64 | 83.73 |
|      grandstand     | 47.61 | 76.62 |
|         path        | 17.99 | 24.98 |
|        stairs       | 30.73 | 37.86 |
|        runway       | 71.37 | 92.98 |
|         case        | 46.73 | 57.86 |
|      pool table     | 94.26 | 96.77 |
|        pillow       | 61.53 | 72.41 |
|     screen door     | 74.77 |  79.1 |
|       stairway      | 33.53 | 43.92 |
|        river        | 16.51 | 34.82 |
|        bridge       | 60.06 |  64.4 |
|       bookcase      | 42.73 | 64.53 |
|        blind        | 38.39 | 42.13 |
|     coffee table    | 64.35 | 79.63 |
|        toilet       | 86.87 | 90.76 |
|        flower       | 41.23 | 57.14 |
|         book        | 47.82 | 62.45 |
|         hill        |  7.17 |  8.83 |
|        bench        | 43.84 | 52.93 |
|      countertop     |  55.9 | 69.87 |
|        stove        | 74.78 | 85.96 |
|         palm        | 55.29 | 76.45 |
|    kitchen island   | 50.36 |  79.7 |
|       computer      | 79.36 | 91.82 |
|     swivel chair    | 45.74 | 58.43 |
|         boat        | 55.42 | 60.81 |
|         bar         | 40.07 | 47.07 |
|    arcade machine   | 45.52 | 47.27 |
|        hovel        | 26.28 | 27.14 |
|         bus         | 85.89 |  96.2 |
|        towel        | 70.42 | 80.32 |
|        light        | 54.71 | 61.06 |
|        truck        | 38.63 | 57.27 |
|        tower        |  7.21 | 10.19 |
|      chandelier     | 67.75 | 82.07 |
|        awning       | 29.56 | 33.26 |
|     streetlight     | 30.61 | 37.81 |
|        booth        | 47.43 |  53.5 |
| television receiver |  76.1 | 86.02 |
|       airplane      | 59.86 | 63.57 |
|      dirt track     | 15.61 | 24.36 |
|       apparel       | 34.65 | 49.86 |
|         pole        | 26.95 | 39.12 |
|         land        |  4.43 |  7.72 |
|      bannister      | 14.89 | 18.65 |
|      escalator      | 29.61 | 33.19 |
|       ottoman       | 52.14 | 67.77 |
|        bottle       | 35.02 | 49.49 |
|        buffet       | 48.82 | 54.16 |
|        poster       | 30.27 | 41.76 |
|        stage        | 15.36 | 24.23 |
|         van         | 41.93 | 61.85 |
|         ship        | 12.33 | 16.56 |
|       fountain      | 26.65 | 27.29 |
|    conveyer belt    | 72.16 | 83.77 |
|        canopy       | 30.33 |  36.8 |
|        washer       | 71.98 | 72.59 |
|      plaything      | 25.06 | 45.09 |
|    swimming pool    | 80.87 | 90.08 |
|        stool        | 49.73 | 64.94 |
|        barrel       | 44.39 | 73.44 |
|        basket       | 37.05 | 47.19 |
|      waterfall      |  53.2 | 76.78 |
|         tent        | 95.04 | 99.04 |
|         bag         | 13.31 | 15.81 |
|       minibike      |  73.0 |  83.4 |
|        cradle       | 78.94 | 97.26 |
|         oven        | 36.33 | 76.55 |
|         ball        | 54.13 | 66.26 |
|         food        | 51.11 | 65.88 |
|         step        | 14.71 | 16.61 |
|         tank        | 62.34 | 65.69 |
|      trade name     | 26.16 |  30.0 |
|      microwave      | 59.43 | 63.33 |
|         pot         | 45.91 | 53.04 |
|        animal       | 58.61 | 60.69 |
|       bicycle       | 53.89 | 66.75 |
|         lake        | 62.31 | 63.17 |
|      dishwasher     | 66.27 | 76.62 |
|        screen       | 63.29 | 88.69 |
|       blanket       | 12.04 | 13.64 |
|      sculpture      | 67.27 | 83.15 |
|         hood        | 67.19 | 70.97 |
|        sconce       |  54.8 | 65.11 |
|         vase        | 43.32 | 58.77 |
|    traffic light    | 36.07 | 57.44 |
|         tray        | 12.82 | 17.79 |
|        ashcan       | 45.33 | 58.95 |
|         fan         | 63.96 | 76.64 |
|         pier        | 36.78 | 48.47 |
|      crt screen     |  8.75 | 14.48 |
|        plate        | 55.22 | 73.35 |
|       monitor       | 43.27 | 50.41 |
|    bulletin board   | 37.59 |  46.5 |
|        shower       |  6.51 |  8.25 |
|       radiator      | 65.63 | 69.23 |
|        glass        | 15.85 | 16.82 |
|        clock        |  40.1 | 46.57 |
|         flag        | 59.98 | 64.78 |
+---------------------+-------+-------+
11/15 16:01:10 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 83.8200  mIoU: 51.2000  mAcc: 62.1100  data_time: 0.0024  time: 0.3574
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
11/15 16:01:14 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 84124714
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 84124714
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 16:01:14 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=768,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        embed_dims=768,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=0.1,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=12,
        num_layers=12,
        out_indices=(
            3,
            5,
            7,
            11,
        ),
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=768,
        dropout_ratio=0.1,
        in_channels=[
            768,
            768,
            768,
            768,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=768, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_base_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=3e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.9, num_layers=12),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-base_upernet_8xb2-160k_ade20k-640x640/jpeg_compression'

Number of parameters:  163407980
11/15 16:01:21 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 16:01:21 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 16:01:21 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
11/15 16:01:22 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-base_8x2_640x640_160k_ade20k-eead221d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 16:01:46 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:15:33  time: 0.3813  data_time: 0.0019  memory: 26008  
11/15 16:02:04 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:13:12  time: 0.3645  data_time: 0.0020  memory: 2338  
11/15 16:02:21 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:12:00  time: 0.3461  data_time: 0.0018  memory: 2271  
11/15 16:02:39 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:11:28  time: 0.3641  data_time: 0.0019  memory: 2434  
11/15 16:02:55 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:10:50  time: 0.3455  data_time: 0.0018  memory: 2489  
11/15 16:03:12 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:23  time: 0.3644  data_time: 0.0020  memory: 2330  
11/15 16:03:30 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:10:01  time: 0.3278  data_time: 0.0018  memory: 2330  
11/15 16:03:47 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:09:38  time: 0.3655  data_time: 0.0018  memory: 2334  
11/15 16:04:02 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:09:09  time: 0.3269  data_time: 0.0018  memory: 2268  
11/15 16:04:19 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:08:50  time: 0.3303  data_time: 0.0029  memory: 2272  
11/15 16:04:37 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:33  time: 0.3807  data_time: 0.0019  memory: 2325  
11/15 16:04:54 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:14  time: 0.3644  data_time: 0.0020  memory: 2333  
11/15 16:05:11 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:54  time: 0.3450  data_time: 0.0017  memory: 2353  
11/15 16:05:29 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:38  time: 0.3634  data_time: 0.0020  memory: 2349  
11/15 16:05:47 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:21  time: 0.3603  data_time: 0.0018  memory: 2363  
11/15 16:06:03 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:07:00  time: 0.3645  data_time: 0.0020  memory: 2273  
11/15 16:06:21 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:44  time: 0.3664  data_time: 0.0020  memory: 2262  
11/15 16:06:36 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:06:23  time: 0.2939  data_time: 0.0018  memory: 2295  
11/15 16:06:54 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:06:06  time: 0.3301  data_time: 0.0019  memory: 2319  
11/15 16:07:10 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:47  time: 0.3294  data_time: 0.0019  memory: 2323  
11/15 16:07:28 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:05:30  time: 0.3831  data_time: 0.0020  memory: 2368  
11/15 16:07:46 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:13  time: 0.3296  data_time: 0.0019  memory: 2309  
11/15 16:08:03 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:55  time: 0.3449  data_time: 0.0018  memory: 2302  
11/15 16:08:20 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:38  time: 0.3289  data_time: 0.0018  memory: 2608  
11/15 16:08:36 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:19  time: 0.3296  data_time: 0.0018  memory: 2290  
11/15 16:08:51 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:01  time: 0.3467  data_time: 0.0018  memory: 2263  
11/15 16:09:08 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:44  time: 0.3105  data_time: 0.0018  memory: 2264  
11/15 16:09:24 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:26  time: 0.3631  data_time: 0.0018  memory: 2322  
11/15 16:09:40 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:08  time: 0.3629  data_time: 0.0018  memory: 2320  
11/15 16:09:57 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:51  time: 0.3119  data_time: 0.0018  memory: 2263  
11/15 16:10:14 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:34  time: 0.3484  data_time: 0.0019  memory: 2311  
11/15 16:10:31 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:17  time: 0.3465  data_time: 0.0020  memory: 2261  
11/15 16:10:47 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:59  time: 0.2956  data_time: 0.0018  memory: 2444  
11/15 16:11:04 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:42  time: 0.3472  data_time: 0.0021  memory: 2319  
11/15 16:11:22 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:25  time: 0.3292  data_time: 0.0018  memory: 2327  
11/15 16:11:38 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:08  time: 0.3646  data_time: 0.0020  memory: 2277  
11/15 16:11:56 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:51  time: 0.3646  data_time: 0.0020  memory: 2223  
11/15 16:12:12 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:34  time: 0.3124  data_time: 0.0018  memory: 2348  
11/15 16:12:29 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.3304  data_time: 0.0019  memory: 2479  
11/15 16:12:45 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.3082  data_time: 0.0017  memory: 2357  
11/15 16:12:45 - mmengine - INFO - per class results:
11/15 16:12:45 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 77.81 | 90.03 |
|       building      | 83.16 | 93.54 |
|         sky         | 94.35 | 97.52 |
|        floor        | 81.02 | 92.41 |
|         tree        | 74.82 | 88.59 |
|       ceiling       | 84.52 | 92.65 |
|         road        | 82.72 |  88.9 |
|         bed         | 90.13 | 96.09 |
|      windowpane     | 62.46 | 77.13 |
|        grass        |  67.8 | 83.42 |
|       cabinet       | 59.78 | 70.94 |
|       sidewalk      | 64.96 | 83.54 |
|        person       | 82.22 | 92.72 |
|        earth        | 34.94 | 50.95 |
|         door        | 45.96 | 59.62 |
|        table        | 62.14 | 76.41 |
|       mountain      |  62.4 | 72.37 |
|        plant        | 51.28 |  58.9 |
|       curtain       |  73.4 | 85.63 |
|        chair        | 59.49 | 71.33 |
|         car         | 85.94 | 92.95 |
|        water        | 57.08 |  72.2 |
|       painting      | 73.81 |  84.2 |
|         sofa        | 71.87 | 83.73 |
|        shelf        | 44.86 |  63.0 |
|        house        | 50.86 | 63.56 |
|         sea         | 66.84 | 87.12 |
|        mirror       | 69.25 | 76.14 |
|         rug         | 59.29 | 65.12 |
|        field        | 30.05 | 47.97 |
|       armchair      | 51.07 | 69.83 |
|         seat        |  58.4 | 82.12 |
|        fence        | 47.45 | 61.21 |
|         desk        |  53.7 | 67.61 |
|         rock        | 47.29 | 70.33 |
|       wardrobe      | 43.09 | 61.76 |
|         lamp        |  65.1 | 75.05 |
|       bathtub       |  81.4 | 85.83 |
|       railing       | 37.62 | 49.13 |
|       cushion       | 60.08 | 71.06 |
|         base        | 29.81 |  40.8 |
|         box         | 29.03 | 36.77 |
|        column       | 47.59 |  57.7 |
|      signboard      | 38.38 | 48.24 |
|   chest of drawers  | 45.58 | 68.38 |
|       counter       |  25.4 | 32.76 |
|         sand        | 38.04 | 55.03 |
|         sink        | 71.38 | 79.98 |
|      skyscraper     |  56.4 | 70.03 |
|      fireplace      | 78.35 | 92.03 |
|     refrigerator    | 77.24 | 87.95 |
|      grandstand     |  49.2 | 73.85 |
|         path        | 16.92 | 23.26 |
|        stairs       | 27.59 | 32.19 |
|        runway       | 70.84 | 92.06 |
|         case        | 45.84 |  61.0 |
|      pool table     |  94.6 | 97.24 |
|        pillow       | 52.41 | 59.95 |
|     screen door     | 77.49 | 81.22 |
|       stairway      | 32.36 |  44.6 |
|        river        | 16.78 | 34.94 |
|        bridge       | 58.25 |  65.0 |
|       bookcase      | 46.82 | 64.71 |
|        blind        |  29.3 |  30.4 |
|     coffee table    | 65.26 | 80.21 |
|        toilet       | 84.92 | 90.17 |
|        flower       | 38.26 | 51.01 |
|         book        | 47.12 | 62.88 |
|         hill        | 10.94 | 15.54 |
|        bench        | 44.78 | 51.75 |
|      countertop     | 54.33 | 64.73 |
|        stove        | 75.51 | 86.72 |
|         palm        | 52.17 | 71.08 |
|    kitchen island   | 43.34 | 74.35 |
|       computer      | 77.58 | 89.08 |
|     swivel chair    | 43.67 | 56.85 |
|         boat        | 52.56 | 62.52 |
|         bar         | 44.74 | 52.37 |
|    arcade machine   | 64.72 | 66.52 |
|        hovel        | 31.55 | 33.08 |
|         bus         | 85.71 | 96.15 |
|        towel        | 69.89 |  74.6 |
|        light        |  52.3 | 57.97 |
|        truck        | 39.79 | 50.28 |
|        tower        | 21.09 | 29.01 |
|      chandelier     | 66.59 |  78.6 |
|        awning       | 30.84 | 34.49 |
|     streetlight     | 31.05 | 39.08 |
|        booth        | 52.25 | 60.35 |
| television receiver | 71.91 | 83.38 |
|       airplane      | 65.86 | 72.37 |
|      dirt track     | 12.81 | 21.27 |
|       apparel       |  32.3 | 43.23 |
|         pole        | 24.72 | 34.41 |
|         land        |  4.13 |  5.95 |
|      bannister      | 15.45 | 20.59 |
|      escalator      | 39.15 | 46.24 |
|       ottoman       | 44.68 |  59.0 |
|        bottle       | 32.28 | 40.85 |
|        buffet       | 49.06 | 55.64 |
|        poster       | 25.64 | 34.18 |
|        stage        | 12.42 | 20.25 |
|         van         | 43.12 | 58.04 |
|         ship        | 47.69 | 64.28 |
|       fountain      | 33.73 | 34.43 |
|    conveyer belt    | 75.56 | 89.37 |
|        canopy       | 36.42 | 45.07 |
|        washer       | 82.88 | 85.65 |
|      plaything      | 31.94 | 47.38 |
|    swimming pool    | 77.28 | 89.98 |
|        stool        | 46.28 | 58.85 |
|        barrel       | 59.28 | 70.95 |
|        basket       | 32.99 |  43.3 |
|      waterfall      |  46.9 | 56.37 |
|         tent        | 95.76 | 99.04 |
|         bag         | 12.27 | 13.66 |
|       minibike      | 72.31 | 82.71 |
|        cradle       | 77.54 | 96.74 |
|         oven        | 50.63 | 76.66 |
|         ball        | 50.04 | 58.79 |
|         food        | 49.98 | 60.33 |
|         step        |  9.6  | 10.62 |
|         tank        | 62.73 | 65.25 |
|      trade name     | 19.36 | 21.69 |
|      microwave      | 72.22 | 78.31 |
|         pot         | 46.62 | 51.98 |
|        animal       | 57.33 |  58.8 |
|       bicycle       | 56.75 | 72.94 |
|         lake        | 56.24 | 56.33 |
|      dishwasher     | 63.05 | 73.63 |
|        screen       | 64.93 |  86.5 |
|       blanket       |  9.22 | 10.24 |
|      sculpture      | 69.07 |  79.5 |
|         hood        | 55.72 | 58.88 |
|        sconce       | 48.63 | 56.72 |
|         vase        | 42.86 | 53.89 |
|    traffic light    | 36.62 | 55.03 |
|         tray        |  8.56 | 14.95 |
|        ashcan       | 46.03 | 56.33 |
|         fan         | 63.95 | 76.66 |
|         pier        | 32.33 |  42.2 |
|      crt screen     |  1.03 |  1.87 |
|        plate        |  53.6 |  72.6 |
|       monitor       | 35.97 | 43.58 |
|    bulletin board   | 39.32 | 45.83 |
|        shower       |  7.67 |  9.13 |
|       radiator      | 60.99 | 63.72 |
|        glass        | 14.34 | 15.01 |
|        clock        | 37.35 | 39.71 |
|         flag        | 59.32 | 64.83 |
+---------------------+-------+-------+
11/15 16:12:45 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 83.6000  mIoU: 51.1400  mAcc: 61.4500  data_time: 0.0022  time: 0.3413
Finished processing corruption type: jpeg_compression
Runtime: 1731683566

============================= JOB FEEDBACK =============================

NodeName=uc2n488
Job ID: 24674735
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 6
CPU Utilized: 11:38:44
CPU Efficiency: 16.49% of 2-22:38:06 core-walltime
Job Wall-clock time: 11:46:21
Memory Utilized: 4.02 GB
Memory Efficiency: 40.21% of 10.00 GB
