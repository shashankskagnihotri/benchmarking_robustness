Started at Fri Sep 20 10:24:21 CEST 2024
Processing corruption type: gaussian_noise
09/20 10:26:36 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1955035415
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1955035415
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 10:26:36 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='gaussian_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/gaussian_noise'

09/20 10:27:49 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 10:27:50 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 10:27:51 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 10:27:52 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 10:30:43 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:51:29  time: 0.7565  data_time: 0.0014  memory: 17152  
09/20 10:31:24 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:07:00  time: 0.9446  data_time: 0.0016  memory: 16931  
09/20 10:31:45 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:47:55  time: 0.4559  data_time: 0.0024  memory: 16924  
09/20 10:32:17 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:39:45  time: 0.5664  data_time: 0.0015  memory: 16933  
09/20 10:32:46 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:34:18  time: 0.3709  data_time: 0.0014  memory: 16932  
09/20 10:33:10 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:30:02  time: 0.1021  data_time: 0.0015  memory: 16928  
09/20 10:33:40 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:27:20  time: 0.4191  data_time: 0.0014  memory: 16932  
09/20 10:34:03 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:24:45  time: 0.4890  data_time: 0.0013  memory: 16929  
09/20 10:34:12 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:21:50  time: 0.2263  data_time: 0.0013  memory: 16854  
09/20 10:34:23 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:19:33  time: 0.0956  data_time: 0.0013  memory: 16912  
09/20 10:34:36 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:17:44  time: 0.4822  data_time: 0.0015  memory: 16932  
09/20 10:34:44 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:16:01  time: 0.2804  data_time: 0.0015  memory: 16860  
09/20 10:35:01 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:14:51  time: 0.4951  data_time: 0.0013  memory: 16934  
09/20 10:35:21 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:13:54  time: 0.1038  data_time: 0.0016  memory: 16934  
09/20 10:35:42 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:13:03  time: 0.9261  data_time: 0.0014  memory: 16937  
09/20 10:35:50 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:57  time: 0.0965  data_time: 0.0016  memory: 16925  
09/20 10:35:55 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:53  time: 0.0933  data_time: 0.0016  memory: 628  
09/20 10:36:03 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:10:00  time: 0.2117  data_time: 0.0013  memory: 16850  
09/20 10:36:22 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:09:23  time: 0.3456  data_time: 0.0014  memory: 16932  
09/20 10:36:33 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:40  time: 0.0881  data_time: 0.0014  memory: 16908  
09/20 10:36:49 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:08:05  time: 0.6233  data_time: 0.0016  memory: 16935  
09/20 10:37:02 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:29  time: 0.0922  data_time: 0.0014  memory: 16921  
09/20 10:37:11 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:53  time: 0.2220  data_time: 0.0013  memory: 16913  
09/20 10:37:16 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:15  time: 0.0914  data_time: 0.0014  memory: 1824  
09/20 10:37:26 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:44  time: 0.2235  data_time: 0.0013  memory: 16925  
09/20 10:37:30 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:11  time: 0.0923  data_time: 0.0013  memory: 1463  
09/20 10:37:38 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:41  time: 0.0868  data_time: 0.0013  memory: 16910  
09/20 10:37:55 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:18  time: 0.4491  data_time: 0.0013  memory: 16928  
09/20 10:38:04 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:52  time: 0.3872  data_time: 0.0013  memory: 16917  
09/20 10:38:09 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:25  time: 0.0863  data_time: 0.0012  memory: 628  
09/20 10:38:15 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:00  time: 0.0952  data_time: 0.0014  memory: 16859  
09/20 10:38:20 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:36  time: 0.0917  data_time: 0.0014  memory: 1507  
09/20 10:38:31 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:15  time: 0.0862  data_time: 0.0012  memory: 16931  
09/20 10:38:42 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:54  time: 0.0924  data_time: 0.0014  memory: 16922  
09/20 10:38:52 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:34  time: 0.0971  data_time: 0.0013  memory: 16911  
09/20 10:39:00 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:14  time: 0.0938  data_time: 0.0015  memory: 16911  
09/20 10:39:04 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:54  time: 0.0917  data_time: 0.0015  memory: 578  
09/20 10:39:12 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:35  time: 0.0965  data_time: 0.0013  memory: 16935  
09/20 10:39:22 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.0890  data_time: 0.0013  memory: 16916  
09/20 10:39:30 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0855  data_time: 0.0012  memory: 16864  
09/20 10:39:32 - mmengine - INFO - per class results:
09/20 10:39:32 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 61.06 |  87.7 |
|       building      | 75.06 | 88.72 |
|         sky         | 88.17 | 92.55 |
|        floor        | 67.39 | 85.13 |
|         tree        | 65.59 |  85.6 |
|       ceiling       | 70.32 | 80.22 |
|         road        | 64.59 | 72.99 |
|         bed         | 77.11 | 89.51 |
|      windowpane     | 43.69 | 52.84 |
|        grass        | 51.52 | 78.08 |
|       cabinet       | 44.39 | 55.28 |
|       sidewalk      | 32.89 |  36.0 |
|        person       |  67.3 | 81.96 |
|        earth        | 20.61 | 57.88 |
|         door        | 25.16 | 38.17 |
|        table        | 45.96 |  64.7 |
|       mountain      | 41.26 | 52.81 |
|        plant        | 41.45 |  59.5 |
|       curtain       | 47.69 | 55.35 |
|        chair        | 44.82 | 57.36 |
|         car         | 74.96 | 84.22 |
|        water        | 36.45 | 51.71 |
|       painting      | 62.56 |  70.5 |
|         sofa        | 50.94 | 63.45 |
|        shelf        | 27.96 | 39.91 |
|        house        | 32.44 | 39.56 |
|         sea         | 22.65 | 34.19 |
|        mirror       |  37.4 | 40.05 |
|         rug         | 22.73 | 23.18 |
|        field        |  9.43 | 13.15 |
|       armchair      | 31.34 | 47.87 |
|         seat        | 42.69 | 46.42 |
|        fence        |  24.5 | 40.24 |
|         desk        |  32.5 | 51.91 |
|         rock        | 29.96 | 47.44 |
|       wardrobe      | 20.21 | 24.43 |
|         lamp        | 51.86 | 62.34 |
|       bathtub       | 24.43 | 26.11 |
|       railing       | 24.32 | 30.95 |
|       cushion       | 34.78 | 41.13 |
|         base        |  7.0  |  8.26 |
|         box         | 14.03 | 20.61 |
|        column       | 32.34 | 46.95 |
|      signboard      |  31.2 | 40.75 |
|   chest of drawers  | 32.44 | 51.38 |
|       counter       |  16.8 | 23.32 |
|         sand        |  6.49 |  7.47 |
|         sink        | 37.26 | 51.04 |
|      skyscraper     | 30.13 | 36.52 |
|      fireplace      |  43.4 | 47.06 |
|     refrigerator    | 36.42 |  38.2 |
|      grandstand     | 26.24 |  62.3 |
|         path        | 14.24 | 21.59 |
|        stairs       | 25.26 | 36.86 |
|        runway       |  0.14 |  0.14 |
|         case        | 33.35 | 41.24 |
|      pool table     | 86.28 | 91.54 |
|        pillow       | 32.79 | 37.06 |
|     screen door     |  6.15 |  6.45 |
|       stairway      | 19.56 | 28.64 |
|        river        |  1.21 |  1.35 |
|        bridge       | 35.53 | 36.89 |
|       bookcase      | 16.49 | 17.69 |
|        blind        | 18.64 | 19.47 |
|     coffee table    | 45.74 | 52.19 |
|        toilet       | 51.88 | 52.83 |
|        flower       | 21.58 | 35.41 |
|         book        | 34.21 | 44.46 |
|         hill        |  3.43 |  6.16 |
|        bench        | 20.93 | 23.28 |
|      countertop     | 37.74 | 45.82 |
|        stove        |  45.7 | 47.86 |
|         palm        | 39.83 | 47.12 |
|    kitchen island   | 28.43 | 43.37 |
|       computer      | 28.47 | 29.55 |
|     swivel chair    | 27.33 | 31.26 |
|         boat        | 17.62 | 18.14 |
|         bar         | 28.51 | 38.79 |
|    arcade machine   | 14.76 |  16.8 |
|        hovel        | 33.02 | 36.61 |
|         bus         | 32.15 | 32.55 |
|        towel        | 13.17 | 13.59 |
|        light        | 24.85 | 26.56 |
|        truck        |  3.26 |  4.29 |
|        tower        | 19.91 | 50.61 |
|      chandelier     | 54.66 | 65.35 |
|        awning       |  3.45 |  3.56 |
|     streetlight     | 14.82 | 16.19 |
|        booth        | 19.66 |  29.5 |
| television receiver | 18.71 | 19.15 |
|       airplane      |  18.8 | 19.55 |
|      dirt track     |  4.21 | 17.65 |
|       apparel       | 13.72 | 16.19 |
|         pole        |  16.3 | 25.37 |
|         land        |  0.14 |  0.14 |
|      bannister      |  5.3  |  6.11 |
|      escalator      |  0.29 |  0.3  |
|       ottoman       | 29.11 | 33.54 |
|        bottle       | 12.19 |  13.9 |
|        buffet       |  3.49 |  3.82 |
|        poster       |  8.09 | 10.05 |
|        stage        |  7.65 |  8.61 |
|         van         | 36.96 | 44.47 |
|         ship        |  0.94 |  0.94 |
|       fountain      |  1.45 |  1.69 |
|    conveyer belt    | 38.18 | 38.43 |
|        canopy       |  0.04 |  0.04 |
|        washer       | 20.62 | 20.64 |
|      plaything      | 16.53 | 19.65 |
|    swimming pool    | 16.75 | 19.11 |
|        stool        | 21.82 | 34.58 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 13.26 | 16.44 |
|      waterfall      | 56.65 | 66.46 |
|         tent        |  1.59 |  1.6  |
|         bag         |  1.06 |  1.09 |
|       minibike      | 23.84 | 25.97 |
|        cradle       | 52.78 | 69.26 |
|         oven        |  7.9  | 10.81 |
|         ball        | 37.71 | 65.86 |
|         food        | 43.96 | 65.01 |
|         step        |  0.02 |  0.02 |
|         tank        | 12.72 | 16.49 |
|      trade name     | 12.38 | 12.94 |
|      microwave      | 18.24 | 18.41 |
|         pot         | 18.88 | 20.01 |
|        animal       | 25.79 | 27.35 |
|       bicycle       | 36.14 | 62.43 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 38.92 | 39.28 |
|        screen       | 34.23 | 38.41 |
|       blanket       |  1.86 |  1.95 |
|      sculpture      | 22.28 | 27.44 |
|         hood        | 17.95 | 18.01 |
|        sconce       | 16.41 | 17.27 |
|         vase        |  30.6 | 37.91 |
|    traffic light    |  8.43 |  8.7  |
|         tray        |  2.3  |  3.01 |
|        ashcan       | 22.16 |  23.5 |
|         fan         | 34.94 | 37.25 |
|         pier        |  0.48 |  0.49 |
|      crt screen     |  2.7  |  3.51 |
|        plate        | 35.02 | 38.98 |
|       monitor       |  5.73 |  6.22 |
|    bulletin board   | 20.19 | 23.86 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  6.95 |  7.02 |
|        glass        |  5.2  |  5.37 |
|        clock        | 18.36 | 20.62 |
|         flag        | 12.67 | 12.93 |
+---------------------+-------+-------+
09/20 10:39:32 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 71.5800  mIoU: 26.8700  mAcc: 33.6100  data_time: 0.0025  time: 0.3492
Finished processing corruption type: gaussian_noise
Processing corruption type: shot_noise
09/20 10:39:45 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 638264037
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 638264037
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 10:39:45 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='shot_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/shot_noise'

09/20 10:39:49 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 10:39:49 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 10:39:49 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 10:39:50 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 10:41:09 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:51:22  time: 0.9002  data_time: 0.0015  memory: 17152  
09/20 10:41:54 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:39:20  time: 1.0291  data_time: 0.0027  memory: 16931  
09/20 10:42:19 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:30:44  time: 0.5334  data_time: 0.0016  memory: 16924  
09/20 10:42:55 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:27:48  time: 0.6380  data_time: 0.0016  memory: 16933  
09/20 10:43:28 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:25:26  time: 0.4448  data_time: 0.0015  memory: 16932  
09/20 10:43:55 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:12  time: 0.1747  data_time: 0.0016  memory: 16928  
09/20 10:44:29 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:21:55  time: 0.4905  data_time: 0.0015  memory: 16932  
09/20 10:44:56 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:25  time: 0.5634  data_time: 0.0031  memory: 16929  
09/20 10:45:08 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:17  time: 0.2961  data_time: 0.0014  memory: 16854  
09/20 10:45:23 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:38  time: 0.1632  data_time: 0.0014  memory: 16912  
09/20 10:45:40 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:24  time: 0.5759  data_time: 0.0016  memory: 16932  
09/20 10:45:53 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:06  time: 0.3653  data_time: 0.0016  memory: 16860  
09/20 10:46:14 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:17  time: 0.5738  data_time: 0.0013  memory: 16934  
09/20 10:46:38 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:37  time: 0.1800  data_time: 0.0016  memory: 16934  
09/20 10:47:02 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:01  time: 0.9747  data_time: 0.0015  memory: 16937  
09/20 10:47:14 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:06  time: 0.1696  data_time: 0.0016  memory: 16925  
09/20 10:47:23 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:12  time: 0.1736  data_time: 0.0016  memory: 628  
09/20 10:47:35 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:29  time: 0.2905  data_time: 0.0016  memory: 16850  
09/20 10:47:59 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:09:00  time: 0.4179  data_time: 0.0016  memory: 16932  
09/20 10:48:13 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:23  time: 0.1588  data_time: 0.0015  memory: 16908  
09/20 10:48:33 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:53  time: 0.7027  data_time: 0.0017  memory: 16935  
09/20 10:48:50 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:21  time: 0.1696  data_time: 0.0015  memory: 16921  
09/20 10:49:03 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:48  time: 0.2984  data_time: 0.0015  memory: 16913  
09/20 10:49:12 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:14  time: 0.1736  data_time: 0.0028  memory: 1824  
09/20 10:49:25 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:45  time: 0.2997  data_time: 0.0015  memory: 16925  
09/20 10:49:34 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:14  time: 0.1716  data_time: 0.0015  memory: 1463  
09/20 10:49:45 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:46  time: 0.1547  data_time: 0.0014  memory: 16910  
09/20 10:50:07 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:24  time: 0.5358  data_time: 0.0014  memory: 16928  
09/20 10:50:19 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:58  time: 0.4686  data_time: 0.0014  memory: 16917  
09/20 10:50:27 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:32  time: 0.1498  data_time: 0.0014  memory: 628  
09/20 10:50:38 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:08  time: 0.1745  data_time: 0.0014  memory: 16859  
09/20 10:50:46 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:44  time: 0.1610  data_time: 0.0015  memory: 1507  
09/20 10:51:01 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:22  time: 0.1586  data_time: 0.0037  memory: 16931  
09/20 10:51:16 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:01  time: 0.1743  data_time: 0.0016  memory: 16922  
09/20 10:51:30 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:40  time: 0.1792  data_time: 0.0014  memory: 16911  
09/20 10:51:42 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:19  time: 0.1750  data_time: 0.0019  memory: 16911  
09/20 10:51:50 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:58  time: 0.1705  data_time: 0.0016  memory: 578  
09/20 10:52:02 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:38  time: 0.1699  data_time: 0.0014  memory: 16935  
09/20 10:52:15 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:19  time: 0.1677  data_time: 0.0014  memory: 16916  
09/20 10:52:28 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1503  data_time: 0.0014  memory: 16864  
09/20 10:52:28 - mmengine - INFO - per class results:
09/20 10:52:28 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 60.09 | 87.27 |
|       building      | 74.87 | 88.85 |
|         sky         | 84.76 | 88.13 |
|        floor        | 68.07 | 86.01 |
|         tree        |  64.4 | 86.57 |
|       ceiling       |  66.7 | 76.84 |
|         road        | 63.86 | 71.69 |
|         bed         | 75.84 | 90.26 |
|      windowpane     | 41.05 | 49.64 |
|        grass        |  53.4 | 81.67 |
|       cabinet       | 45.27 |  56.9 |
|       sidewalk      | 28.67 | 31.34 |
|        person       | 68.67 |  83.3 |
|        earth        | 21.48 | 58.68 |
|         door        | 24.75 | 38.67 |
|        table        | 47.08 | 66.74 |
|       mountain      | 37.46 | 48.45 |
|        plant        | 44.09 | 57.99 |
|       curtain       |  46.9 | 54.59 |
|        chair        | 46.72 | 60.56 |
|         car         |  75.8 | 86.99 |
|        water        | 37.54 | 54.52 |
|       painting      | 61.83 | 69.96 |
|         sofa        | 51.11 |  63.3 |
|        shelf        | 28.34 |  42.6 |
|        house        | 30.61 | 37.77 |
|         sea         | 21.72 | 31.93 |
|        mirror       | 35.44 | 38.39 |
|         rug         | 24.16 | 24.74 |
|        field        |  7.69 | 10.34 |
|       armchair      | 31.97 |  52.2 |
|         seat        |  45.0 | 50.13 |
|        fence        | 24.29 | 38.31 |
|         desk        | 31.99 | 47.58 |
|         rock        | 33.05 | 53.21 |
|       wardrobe      | 23.47 | 27.44 |
|         lamp        | 47.82 | 60.15 |
|       bathtub       | 14.54 | 15.13 |
|       railing       | 23.37 | 31.17 |
|       cushion       | 33.25 | 39.09 |
|         base        |  9.0  | 10.99 |
|         box         | 15.14 | 22.25 |
|        column       | 33.08 | 47.22 |
|      signboard      |  30.9 | 40.51 |
|   chest of drawers  | 34.88 | 54.35 |
|       counter       | 17.34 | 22.75 |
|         sand        |  3.61 |  4.02 |
|         sink        | 33.43 | 42.12 |
|      skyscraper     | 34.11 | 41.43 |
|      fireplace      | 46.35 | 53.51 |
|     refrigerator    | 37.05 | 38.04 |
|      grandstand     | 28.69 | 61.28 |
|         path        | 14.28 | 21.18 |
|        stairs       | 23.56 | 36.22 |
|        runway       |  0.0  |  0.0  |
|         case        | 33.16 | 40.87 |
|      pool table     | 87.99 | 94.07 |
|        pillow       | 30.14 | 33.96 |
|     screen door     |  3.67 |  3.69 |
|       stairway      | 19.82 | 32.85 |
|        river        |  1.8  |  2.02 |
|        bridge       | 41.62 | 43.51 |
|       bookcase      | 12.83 | 13.98 |
|        blind        | 18.65 |  19.3 |
|     coffee table    |  45.3 | 52.53 |
|        toilet       | 41.05 | 41.68 |
|        flower       | 21.99 | 35.03 |
|         book        | 37.15 | 48.31 |
|         hill        |  2.21 |  3.85 |
|        bench        | 22.52 | 25.26 |
|      countertop     | 23.98 | 27.42 |
|        stove        | 45.29 | 47.47 |
|         palm        | 41.44 | 49.96 |
|    kitchen island   | 31.25 | 48.05 |
|       computer      | 23.02 | 24.18 |
|     swivel chair    | 36.68 |  45.5 |
|         boat        | 16.95 | 17.39 |
|         bar         | 22.61 | 29.34 |
|    arcade machine   | 14.73 | 23.39 |
|        hovel        | 31.36 | 35.49 |
|         bus         | 40.04 | 40.41 |
|        towel        | 10.02 | 10.26 |
|        light        | 21.71 | 22.82 |
|        truck        | 12.43 | 15.13 |
|        tower        |  22.1 | 65.94 |
|      chandelier     | 51.01 | 61.03 |
|        awning       |  3.8  |  3.94 |
|     streetlight     | 17.02 | 19.34 |
|        booth        | 19.74 |  27.8 |
| television receiver | 36.34 | 38.12 |
|       airplane      | 11.55 | 11.94 |
|      dirt track     |  3.21 | 13.72 |
|       apparel       | 17.93 |  21.1 |
|         pole        | 19.25 | 30.18 |
|         land        |  0.0  |  0.0  |
|      bannister      |  4.09 |  4.75 |
|      escalator      |  1.18 |  1.22 |
|       ottoman       | 28.85 | 32.96 |
|        bottle       | 11.13 | 12.89 |
|        buffet       | 19.78 | 22.11 |
|        poster       |  3.9  |  4.48 |
|        stage        |  4.22 |  4.73 |
|         van         | 27.48 |  32.5 |
|         ship        |  1.8  |  1.8  |
|       fountain      |  1.0  |  1.11 |
|    conveyer belt    | 37.42 | 39.97 |
|        canopy       |  0.32 |  0.33 |
|        washer       | 17.03 | 17.05 |
|      plaything      | 15.71 | 18.26 |
|    swimming pool    | 17.67 | 17.89 |
|        stool        | 27.46 | 45.65 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 14.75 | 18.28 |
|      waterfall      | 47.21 | 53.81 |
|         tent        |  2.42 |  2.43 |
|         bag         |  0.6  |  0.63 |
|       minibike      | 24.22 | 26.33 |
|        cradle       | 50.91 |  62.3 |
|         oven        | 18.93 | 24.73 |
|         ball        | 36.15 | 64.69 |
|         food        | 43.63 | 61.14 |
|         step        |  0.06 |  0.06 |
|         tank        | 11.57 | 16.92 |
|      trade name     |  11.5 | 12.09 |
|      microwave      | 19.89 | 20.57 |
|         pot         | 21.31 | 22.63 |
|        animal       | 30.12 | 34.39 |
|       bicycle       |  40.2 | 68.22 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 47.91 | 48.47 |
|        screen       | 35.45 | 39.37 |
|       blanket       |  1.74 |  1.83 |
|      sculpture      |  25.2 |  31.0 |
|         hood        | 12.81 | 12.88 |
|        sconce       | 11.86 |  12.3 |
|         vase        | 29.28 |  41.2 |
|    traffic light    |  9.55 |  10.0 |
|         tray        |  2.37 |  3.12 |
|        ashcan       | 24.19 | 26.18 |
|         fan         |  30.7 | 32.51 |
|         pier        |  2.43 |  2.47 |
|      crt screen     |  3.2  |  4.56 |
|        plate        | 26.19 | 28.86 |
|       monitor       | 20.99 | 23.65 |
|    bulletin board   | 17.25 | 18.21 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  2.5  |  2.5  |
|        glass        |  5.79 |  5.9  |
|        clock        | 17.24 | 20.18 |
|         flag        |  11.7 | 11.92 |
+---------------------+-------+-------+
09/20 10:52:28 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 71.0900  mIoU: 26.8800  mAcc: 33.8700  data_time: 0.0017  time: 0.3788
Finished processing corruption type: shot_noise
Processing corruption type: impulse_noise
09/20 10:52:31 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1969771981
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1969771981
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 10:52:31 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='impulse_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/impulse_noise'

09/20 10:52:36 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 10:52:36 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 10:52:36 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 10:52:36 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 10:53:50 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:48:07  time: 0.8022  data_time: 0.0015  memory: 17152  
09/20 10:54:30 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:36:04  time: 0.9305  data_time: 0.0016  memory: 16931  
09/20 10:54:51 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:27:42  time: 0.4409  data_time: 0.0015  memory: 16924  
09/20 10:55:22 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:24:53  time: 0.5545  data_time: 0.0015  memory: 16933  
09/20 10:55:51 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:22:44  time: 0.3574  data_time: 0.0015  memory: 16932  
09/20 10:56:15 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:38  time: 0.0872  data_time: 0.0016  memory: 16928  
09/20 10:56:44 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:26  time: 0.4059  data_time: 0.0015  memory: 16932  
09/20 10:57:07 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:18:01  time: 0.4754  data_time: 0.0015  memory: 16929  
09/20 10:57:15 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:15:59  time: 0.2117  data_time: 0.0015  memory: 16854  
09/20 10:57:25 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:14:25  time: 0.0780  data_time: 0.0015  memory: 16912  
09/20 10:57:37 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:13:12  time: 0.4669  data_time: 0.0016  memory: 16932  
09/20 10:57:44 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:58  time: 0.2654  data_time: 0.0016  memory: 16860  
09/20 10:58:01 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:13  time: 0.4779  data_time: 0.0014  memory: 16934  
09/20 10:58:21 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:39  time: 0.0881  data_time: 0.0016  memory: 16934  
09/20 10:58:41 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:07  time: 0.9128  data_time: 0.0014  memory: 16937  
09/20 10:58:48 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:09:17  time: 0.0748  data_time: 0.0016  memory: 16925  
09/20 10:58:52 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:28  time: 0.0764  data_time: 0.0016  memory: 628  
09/20 10:59:00 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:48  time: 0.1983  data_time: 0.0014  memory: 16850  
09/20 10:59:18 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:23  time: 0.3312  data_time: 0.0015  memory: 16932  
09/20 10:59:28 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:51  time: 0.0723  data_time: 0.0015  memory: 16908  
09/20 10:59:43 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:25  time: 0.6087  data_time: 0.0015  memory: 16935  
09/20 10:59:55 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:58  time: 0.0767  data_time: 0.0015  memory: 16921  
09/20 11:00:03 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:30  time: 0.2064  data_time: 0.0015  memory: 16913  
09/20 11:00:07 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:00  time: 0.0749  data_time: 0.0014  memory: 1824  
09/20 11:00:17 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:36  time: 0.2083  data_time: 0.0014  memory: 16925  
09/20 11:00:20 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:09  time: 0.0762  data_time: 0.0014  memory: 1463  
09/20 11:00:27 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:46  time: 0.0692  data_time: 0.0014  memory: 16910  
09/20 11:00:44 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:29  time: 0.4360  data_time: 0.0014  memory: 16928  
09/20 11:00:52 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:08  time: 0.3743  data_time: 0.0014  memory: 16917  
09/20 11:00:56 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:46  time: 0.0675  data_time: 0.0014  memory: 628  
09/20 11:01:02 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:26  time: 0.0804  data_time: 0.0015  memory: 16859  
09/20 11:01:06 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:07  time: 0.0723  data_time: 0.0015  memory: 1507  
09/20 11:01:16 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:50  time: 0.0673  data_time: 0.0014  memory: 16931  
09/20 11:01:26 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:33  time: 0.0750  data_time: 0.0016  memory: 16922  
09/20 11:01:36 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:17  time: 0.0825  data_time: 0.0013  memory: 16911  
09/20 11:01:42 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:00  time: 0.0776  data_time: 0.0016  memory: 16911  
09/20 11:01:46 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:44  time: 0.0735  data_time: 0.0015  memory: 578  
09/20 11:01:53 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:29  time: 0.0813  data_time: 0.0014  memory: 16935  
09/20 11:02:02 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.0741  data_time: 0.0014  memory: 16916  
09/20 11:02:10 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0700  data_time: 0.0013  memory: 16864  
09/20 11:02:10 - mmengine - INFO - per class results:
09/20 11:02:10 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 56.26 | 87.18 |
|       building      | 69.76 | 84.21 |
|         sky         | 71.65 | 73.88 |
|        floor        | 60.38 | 86.63 |
|         tree        | 57.95 | 82.92 |
|       ceiling       | 63.93 | 74.53 |
|         road        | 52.43 | 56.34 |
|         bed         | 69.21 | 77.09 |
|      windowpane     | 39.48 |  49.4 |
|        grass        | 46.05 | 86.62 |
|       cabinet       | 31.64 | 36.16 |
|       sidewalk      | 37.29 | 43.94 |
|        person       | 58.65 |  71.2 |
|        earth        | 20.33 | 49.99 |
|         door        | 19.49 | 28.22 |
|        table        | 41.01 | 57.08 |
|       mountain      | 32.32 | 54.46 |
|        plant        | 34.71 | 59.27 |
|       curtain       |  42.5 | 47.05 |
|        chair        | 36.44 | 41.21 |
|         car         | 73.24 | 82.24 |
|        water        | 23.28 |  65.8 |
|       painting      | 58.62 | 64.69 |
|         sofa        | 50.35 | 60.27 |
|        shelf        | 26.75 | 40.41 |
|        house        | 14.98 |  16.4 |
|         sea         | 15.25 | 17.24 |
|        mirror       | 26.68 | 28.99 |
|         rug         | 13.85 | 13.93 |
|        field        |  5.7  |  6.56 |
|       armchair      | 27.86 | 39.47 |
|         seat        | 35.52 | 40.44 |
|        fence        | 22.18 |  34.5 |
|         desk        | 23.91 | 28.57 |
|         rock        | 23.67 |  55.0 |
|       wardrobe      |  9.32 | 10.81 |
|         lamp        | 46.51 | 52.16 |
|       bathtub       | 14.84 | 15.65 |
|       railing       | 20.16 | 25.41 |
|       cushion       | 30.36 | 35.03 |
|         base        |  4.51 |  5.03 |
|         box         | 12.03 | 23.45 |
|        column       | 25.31 | 37.58 |
|      signboard      | 28.38 | 37.99 |
|   chest of drawers  | 27.86 |  41.6 |
|       counter       |  8.21 | 10.37 |
|         sand        |  3.21 |  3.61 |
|         sink        | 27.12 | 45.62 |
|      skyscraper     |  9.47 | 10.65 |
|      fireplace      | 39.02 | 41.74 |
|     refrigerator    |  16.1 | 16.21 |
|      grandstand     |  18.2 | 52.67 |
|         path        | 12.29 | 24.71 |
|        stairs       | 20.81 | 40.94 |
|        runway       |  0.0  |  0.0  |
|         case        |  29.6 | 36.36 |
|      pool table     | 72.19 | 74.52 |
|        pillow       | 19.24 | 20.67 |
|     screen door     |  3.56 |  3.57 |
|       stairway      | 18.43 | 22.98 |
|        river        |  0.51 |  0.55 |
|        bridge       | 35.22 | 36.41 |
|       bookcase      |  7.71 |  7.97 |
|        blind        |  5.63 |  5.77 |
|     coffee table    | 42.03 | 46.59 |
|        toilet       | 49.17 |  51.5 |
|        flower       |  17.8 | 30.36 |
|         book        | 31.27 | 37.66 |
|         hill        |  0.43 |  0.67 |
|        bench        |  15.8 | 18.33 |
|      countertop     | 23.43 | 27.04 |
|        stove        | 33.88 | 34.77 |
|         palm        | 34.23 | 39.08 |
|    kitchen island   | 24.61 | 28.58 |
|       computer      | 28.44 | 29.71 |
|     swivel chair    | 20.83 | 23.64 |
|         boat        |  8.52 |  8.62 |
|         bar         | 21.68 | 22.45 |
|    arcade machine   | 15.09 | 22.08 |
|        hovel        | 28.64 | 31.37 |
|         bus         |  19.3 | 19.51 |
|        towel        |  5.55 |  5.59 |
|        light        | 11.32 | 11.52 |
|        truck        |  2.85 |  3.34 |
|        tower        | 21.57 | 78.77 |
|      chandelier     | 47.22 | 55.08 |
|        awning       |  2.04 |  2.06 |
|     streetlight     | 12.49 | 13.42 |
|        booth        |  9.04 | 34.58 |
| television receiver | 14.93 | 15.49 |
|       airplane      | 14.54 | 14.79 |
|      dirt track     |  0.47 |  3.37 |
|       apparel       | 11.24 | 13.27 |
|         pole        | 16.38 | 27.76 |
|         land        |  0.02 |  0.02 |
|      bannister      |  3.56 |  5.62 |
|      escalator      |  1.59 |  1.68 |
|       ottoman       | 27.16 | 30.64 |
|        bottle       |  11.3 | 13.05 |
|        buffet       |  1.14 |  1.16 |
|        poster       |  2.86 |  3.26 |
|        stage        |  2.03 |  2.24 |
|         van         | 30.92 | 36.85 |
|         ship        |  2.9  |  2.9  |
|       fountain      |  0.04 |  0.07 |
|    conveyer belt    | 15.51 | 15.71 |
|        canopy       |  0.25 |  0.26 |
|        washer       | 14.36 | 14.47 |
|      plaything      | 11.12 | 13.88 |
|    swimming pool    | 15.43 |  15.6 |
|        stool        | 20.21 |  28.6 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  9.41 | 10.43 |
|      waterfall      | 42.22 | 46.15 |
|         tent        |  0.21 |  0.21 |
|         bag         |  0.17 |  0.18 |
|       minibike      | 22.67 | 24.41 |
|        cradle       | 11.78 | 12.79 |
|         oven        |  6.66 |  8.03 |
|         ball        |  25.1 | 66.34 |
|         food        | 38.36 | 67.87 |
|         step        |  0.58 |  0.6  |
|         tank        | 19.08 | 19.55 |
|      trade name     |  5.52 |  5.58 |
|      microwave      |  8.94 |  8.96 |
|         pot         | 13.22 | 13.61 |
|        animal       | 14.33 | 15.75 |
|       bicycle       | 34.54 | 55.88 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 21.46 |  21.5 |
|        screen       |  6.35 |  6.35 |
|       blanket       |  0.03 |  0.03 |
|      sculpture      |  2.89 |  3.58 |
|         hood        |  9.39 |  9.41 |
|        sconce       |  8.49 |  8.63 |
|         vase        | 27.81 | 33.29 |
|    traffic light    |  7.6  |  7.76 |
|         tray        |  2.9  |  3.56 |
|        ashcan       | 16.66 | 17.75 |
|         fan         | 24.96 | 26.09 |
|         pier        |  0.33 |  0.34 |
|      crt screen     |  7.44 |  10.0 |
|        plate        |  24.4 | 26.17 |
|       monitor       |  7.93 |  8.81 |
|    bulletin board   |  8.29 |  8.78 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  0.68 |  0.68 |
|        glass        |  6.4  |  6.59 |
|        clock        | 15.76 | 17.77 |
|         flag        |  9.52 |  9.6  |
+---------------------+-------+-------+
09/20 11:02:10 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 65.7900  mIoU: 21.0400  mAcc: 27.3500  data_time: 0.0016  time: 0.2868
Finished processing corruption type: impulse_noise
Processing corruption type: defocus_blur
09/20 11:02:14 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1602638413
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1602638413
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 11:02:14 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='defocus_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/defocus_blur'

09/20 11:02:18 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 11:02:18 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 11:02:18 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 11:02:19 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 11:03:35 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:49:22  time: 0.8137  data_time: 0.0016  memory: 17152  
09/20 11:04:15 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:36:46  time: 0.9384  data_time: 0.0017  memory: 16931  
09/20 11:04:36 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:28:13  time: 0.4466  data_time: 0.0016  memory: 16924  
09/20 11:05:07 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:25:19  time: 0.5603  data_time: 0.0015  memory: 16933  
09/20 11:05:36 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:23:02  time: 0.3633  data_time: 0.0015  memory: 16932  
09/20 11:06:00 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:54  time: 0.0975  data_time: 0.0016  memory: 16928  
09/20 11:06:29 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:41  time: 0.4107  data_time: 0.0015  memory: 16932  
09/20 11:06:53 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:18:15  time: 0.4826  data_time: 0.0015  memory: 16929  
09/20 11:07:01 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:16:13  time: 0.2249  data_time: 0.0016  memory: 16854  
09/20 11:07:12 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:14:39  time: 0.0880  data_time: 0.0015  memory: 16912  
09/20 11:07:24 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:13:25  time: 0.4765  data_time: 0.0017  memory: 16932  
09/20 11:07:32 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:12:11  time: 0.2762  data_time: 0.0018  memory: 16860  
09/20 11:07:49 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:26  time: 0.4871  data_time: 0.0014  memory: 16934  
09/20 11:08:09 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:49  time: 0.0960  data_time: 0.0016  memory: 16934  
09/20 11:08:29 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:17  time: 0.9146  data_time: 0.0014  memory: 16937  
09/20 11:08:37 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:09:27  time: 0.0795  data_time: 0.0016  memory: 16925  
09/20 11:08:41 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:37  time: 0.0867  data_time: 0.0016  memory: 628  
09/20 11:08:49 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:57  time: 0.2083  data_time: 0.0015  memory: 16850  
09/20 11:09:08 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:31  time: 0.3357  data_time: 0.0016  memory: 16932  
09/20 11:09:18 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:59  time: 0.0815  data_time: 0.0015  memory: 16908  
09/20 11:09:34 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:33  time: 0.6159  data_time: 0.0015  memory: 16935  
09/20 11:09:46 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:06  time: 0.0821  data_time: 0.0015  memory: 16921  
09/20 11:09:55 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:37  time: 0.2128  data_time: 0.0015  memory: 16913  
09/20 11:09:59 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:06  time: 0.0852  data_time: 0.0015  memory: 1824  
09/20 11:10:09 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:42  time: 0.2179  data_time: 0.0015  memory: 16925  
09/20 11:10:13 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:15  time: 0.0851  data_time: 0.0015  memory: 1463  
09/20 11:10:20 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:51  time: 0.0809  data_time: 0.0015  memory: 16910  
09/20 11:10:38 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:33  time: 0.4441  data_time: 0.0015  memory: 16928  
09/20 11:10:46 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:12  time: 0.3799  data_time: 0.0014  memory: 16917  
09/20 11:10:50 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:50  time: 0.0787  data_time: 0.0014  memory: 628  
09/20 11:10:56 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:30  time: 0.0842  data_time: 0.0015  memory: 16859  
09/20 11:11:01 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:10  time: 0.0829  data_time: 0.0016  memory: 1507  
09/20 11:11:12 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:53  time: 0.0809  data_time: 0.0014  memory: 16931  
09/20 11:11:22 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:35  time: 0.0897  data_time: 0.0017  memory: 16922  
09/20 11:11:32 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:19  time: 0.0917  data_time: 0.0014  memory: 16911  
09/20 11:11:39 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:02  time: 0.0858  data_time: 0.0017  memory: 16911  
09/20 11:11:43 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:45  time: 0.0851  data_time: 0.0017  memory: 578  
09/20 11:11:51 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:30  time: 0.0907  data_time: 0.0015  memory: 16935  
09/20 11:12:00 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.0833  data_time: 0.0015  memory: 16916  
09/20 11:12:09 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0783  data_time: 0.0014  memory: 16864  
09/20 11:12:09 - mmengine - INFO - per class results:
09/20 11:12:09 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 71.72 | 87.33 |
|       building      | 77.99 | 92.41 |
|         sky         | 93.19 | 96.81 |
|        floor        | 76.35 | 88.46 |
|         tree        |  70.2 | 83.95 |
|       ceiling       | 80.03 | 88.14 |
|         road        |  80.3 | 90.01 |
|         bed         | 84.76 | 94.34 |
|      windowpane     | 56.11 | 75.47 |
|        grass        | 64.14 | 79.94 |
|       cabinet       | 52.85 | 65.21 |
|       sidewalk      | 59.29 | 71.87 |
|        person       | 71.21 |  87.1 |
|        earth        | 28.79 | 40.65 |
|         door        | 37.43 |  46.4 |
|        table        | 54.27 | 69.51 |
|       mountain      |  50.7 | 65.97 |
|        plant        | 45.06 | 57.73 |
|       curtain       | 67.33 | 77.31 |
|        chair        | 49.22 | 62.67 |
|         car         | 77.59 |  85.6 |
|        water        | 44.36 | 54.25 |
|       painting      |  67.4 |  81.3 |
|         sofa        | 56.64 | 74.59 |
|        shelf        | 34.71 | 49.79 |
|        house        | 37.03 |  46.1 |
|         sea         |  46.9 | 74.44 |
|        mirror       | 56.21 | 63.89 |
|         rug         | 54.11 | 63.31 |
|        field        | 27.49 | 49.62 |
|       armchair      |  39.0 | 58.39 |
|         seat        | 52.99 |  67.8 |
|        fence        | 34.69 | 45.82 |
|         desk        | 41.42 | 58.15 |
|         rock        | 36.62 | 61.66 |
|       wardrobe      |  42.2 | 60.03 |
|         lamp        | 55.53 | 66.74 |
|       bathtub       | 66.41 | 70.78 |
|       railing       | 24.85 | 38.36 |
|       cushion       | 45.97 | 55.89 |
|         base        | 23.32 | 34.09 |
|         box         | 15.39 | 20.92 |
|        column       | 40.71 |  52.7 |
|      signboard      | 27.21 | 34.56 |
|   chest of drawers  | 37.29 | 50.83 |
|       counter       | 18.49 | 21.21 |
|         sand        | 30.42 | 44.36 |
|         sink        | 58.05 | 73.43 |
|      skyscraper     | 60.22 | 83.76 |
|      fireplace      | 61.56 |  73.8 |
|     refrigerator    | 65.68 | 73.71 |
|      grandstand     | 28.76 | 64.58 |
|         path        | 18.47 |  25.4 |
|        stairs       | 19.66 | 22.29 |
|        runway       | 68.72 | 94.97 |
|         case        | 47.81 |  69.4 |
|      pool table     | 89.59 | 95.05 |
|        pillow       | 45.96 | 56.35 |
|     screen door     | 52.45 | 65.29 |
|       stairway      | 27.77 | 41.53 |
|        river        | 10.79 | 20.64 |
|        bridge       | 33.69 | 38.53 |
|       bookcase      | 33.88 | 49.36 |
|        blind        | 21.65 | 21.88 |
|     coffee table    | 55.33 | 76.08 |
|        toilet       | 80.84 | 86.81 |
|        flower       |  28.3 | 46.72 |
|         book        | 35.41 | 49.86 |
|         hill        |  5.9  |  9.37 |
|        bench        |  39.9 | 49.24 |
|      countertop     | 47.91 |  59.2 |
|        stove        | 65.13 | 76.93 |
|         palm        | 44.34 | 61.81 |
|    kitchen island   | 34.42 | 72.34 |
|       computer      | 50.78 | 62.39 |
|     swivel chair    | 40.32 | 63.97 |
|         boat        | 38.04 |  62.8 |
|         bar         | 24.41 | 35.43 |
|    arcade machine   | 54.84 | 64.08 |
|        hovel        |  7.93 |  8.16 |
|         bus         | 72.25 | 86.89 |
|        towel        | 44.59 | 53.88 |
|        light        | 48.49 |  59.6 |
|        truck        | 19.37 | 27.26 |
|        tower        | 12.71 | 17.54 |
|      chandelier     | 59.89 |  77.5 |
|        awning       | 18.43 | 22.04 |
|     streetlight     | 18.19 | 23.75 |
|        booth        | 52.08 | 56.11 |
| television receiver | 58.83 | 71.75 |
|       airplane      | 49.48 | 62.59 |
|      dirt track     |  1.9  |  4.43 |
|       apparel       | 20.27 | 26.85 |
|         pole        |  15.6 |  19.2 |
|         land        |  2.23 |  3.83 |
|      bannister      |  1.13 |  1.46 |
|      escalator      | 18.56 | 19.26 |
|       ottoman       | 34.88 | 43.98 |
|        bottle       | 18.03 | 24.12 |
|        buffet       | 41.97 | 50.55 |
|        poster       | 24.63 | 33.52 |
|        stage        |  3.38 | 12.24 |
|         van         | 33.98 | 40.09 |
|         ship        | 61.68 | 75.13 |
|       fountain      | 15.91 | 16.06 |
|    conveyer belt    |  52.9 | 85.26 |
|        canopy       | 14.75 | 19.39 |
|        washer       | 58.62 | 64.34 |
|      plaything      | 14.28 | 34.22 |
|    swimming pool    | 36.05 | 56.81 |
|        stool        | 26.53 | 34.01 |
|        barrel       | 44.22 | 61.92 |
|        basket       | 12.48 | 13.66 |
|      waterfall      | 52.78 | 95.85 |
|         tent        | 89.15 | 98.83 |
|         bag         |  1.01 |  1.11 |
|       minibike      | 43.33 | 68.93 |
|        cradle       | 69.47 | 98.24 |
|         oven        | 12.67 | 25.52 |
|         ball        |  40.4 | 65.74 |
|         food        | 47.55 | 63.07 |
|         step        |  0.77 |  0.9  |
|         tank        |  44.5 | 45.42 |
|      trade name     | 15.29 | 16.68 |
|      microwave      | 36.79 | 40.09 |
|         pot         |  33.8 | 38.62 |
|        animal       |  43.1 | 44.97 |
|       bicycle       | 35.55 | 46.44 |
|         lake        |  31.3 | 63.25 |
|      dishwasher     | 57.03 | 60.46 |
|        screen       | 56.44 | 73.22 |
|       blanket       |  5.73 |  6.88 |
|      sculpture      | 26.42 | 40.07 |
|         hood        | 48.32 | 56.07 |
|        sconce       | 34.31 | 42.95 |
|         vase        | 25.16 | 34.96 |
|    traffic light    | 18.17 | 25.32 |
|         tray        |  3.28 |  4.23 |
|        ashcan       | 31.54 | 39.24 |
|         fan         | 45.13 | 53.99 |
|         pier        |  9.48 | 10.04 |
|      crt screen     |  3.29 |  5.89 |
|        plate        | 43.35 |  55.2 |
|       monitor       | 23.61 | 27.67 |
|    bulletin board   | 27.24 |  34.4 |
|        shower       |  0.01 |  0.01 |
|       radiator      | 34.35 | 36.68 |
|        glass        |  3.37 |  3.45 |
|        clock        | 14.43 |  16.4 |
|         flag        | 33.38 | 38.11 |
+---------------------+-------+-------+
09/20 11:12:09 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.0200  mIoU: 39.6900  mAcc: 50.9300  data_time: 0.0017  time: 0.2950
Finished processing corruption type: defocus_blur
Processing corruption type: glass_blur
09/20 11:12:13 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 411758065
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 411758065
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 11:12:13 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='glass_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/glass_blur'

09/20 11:12:17 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 11:12:17 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 11:12:17 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 11:12:18 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 11:19:10 - mmengine - INFO - Iter(test) [  50/2000]    eta: 4:27:52  time: 7.9246  data_time: 0.0016  memory: 17152  
09/20 11:25:24 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 4:09:05  time: 7.8922  data_time: 0.0018  memory: 16931  
09/20 11:31:20 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 3:54:49  time: 7.2685  data_time: 0.0016  memory: 16924  
09/20 11:37:30 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 3:46:52  time: 7.1876  data_time: 0.0016  memory: 16933  
09/20 11:43:21 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 3:37:22  time: 6.8714  data_time: 0.0016  memory: 16932  
09/20 11:49:05 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 3:28:30  time: 6.8599  data_time: 0.0017  memory: 16928  
09/20 11:55:08 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 3:21:59  time: 6.6813  data_time: 0.0016  memory: 16932  
09/20 12:00:59 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 3:14:44  time: 7.2263  data_time: 0.0015  memory: 16929  
09/20 12:06:06 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 3:05:20  time: 6.2609  data_time: 0.0016  memory: 16854  
09/20 12:11:48 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 2:58:30  time: 6.5152  data_time: 0.0016  memory: 16912  
09/20 12:18:00 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 2:53:13  time: 8.5886  data_time: 0.0439  memory: 16932  
09/20 12:23:35 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 2:46:20  time: 7.0879  data_time: 0.0017  memory: 16860  
09/20 12:29:18 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 2:39:56  time: 7.1083  data_time: 0.0015  memory: 16934  
09/20 12:35:22 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 2:34:16  time: 6.8913  data_time: 0.0043  memory: 16934  
09/20 12:41:17 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 2:28:18  time: 7.3428  data_time: 0.0016  memory: 16937  
09/20 12:46:34 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 2:21:25  time: 6.6941  data_time: 0.0017  memory: 16925  
09/20 12:52:11 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 2:15:08  time: 6.7892  data_time: 0.0017  memory: 628  
09/20 12:57:29 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 2:08:33  time: 6.1046  data_time: 0.0015  memory: 16850  
09/20 13:03:22 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 2:02:46  time: 6.7992  data_time: 0.0016  memory: 16932  
09/20 13:08:50 - mmengine - INFO - Iter(test) [1000/2000]    eta: 1:56:31  time: 6.4089  data_time: 0.0016  memory: 16908  
09/20 13:14:47 - mmengine - INFO - Iter(test) [1050/2000]    eta: 1:50:49  time: 7.4738  data_time: 0.0015  memory: 16935  
09/20 13:20:31 - mmengine - INFO - Iter(test) [1100/2000]    eta: 1:44:54  time: 6.5690  data_time: 0.0016  memory: 16921  
09/20 13:26:08 - mmengine - INFO - Iter(test) [1150/2000]    eta: 1:38:55  time: 6.8605  data_time: 0.0016  memory: 16913  
09/20 13:31:47 - mmengine - INFO - Iter(test) [1200/2000]    eta: 1:32:59  time: 6.5051  data_time: 0.0016  memory: 1824  
09/20 13:37:14 - mmengine - INFO - Iter(test) [1250/2000]    eta: 1:26:57  time: 6.5912  data_time: 0.0015  memory: 16925  
09/20 13:42:26 - mmengine - INFO - Iter(test) [1300/2000]    eta: 1:20:50  time: 6.6816  data_time: 0.0015  memory: 1463  
09/20 13:47:57 - mmengine - INFO - Iter(test) [1350/2000]    eta: 1:14:56  time: 6.1584  data_time: 0.0015  memory: 16910  
09/20 13:53:42 - mmengine - INFO - Iter(test) [1400/2000]    eta: 1:09:10  time: 7.3181  data_time: 0.0015  memory: 16928  
09/20 13:59:03 - mmengine - INFO - Iter(test) [1450/2000]    eta: 1:03:15  time: 7.1735  data_time: 0.0015  memory: 16917  
09/20 14:04:27 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:57:23  time: 6.2028  data_time: 0.0015  memory: 628  
09/20 14:10:16 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:51:40  time: 6.7782  data_time: 0.0015  memory: 16859  
09/20 14:15:40 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:45:50  time: 6.5629  data_time: 0.0017  memory: 1507  
09/20 14:21:17 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:40:05  time: 6.1308  data_time: 0.0029  memory: 16931  
09/20 14:27:05 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:34:22  time: 6.7258  data_time: 0.0017  memory: 16922  
09/20 14:32:50 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:28:38  time: 6.6217  data_time: 0.0015  memory: 16911  
09/20 14:38:11 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:22:52  time: 6.7283  data_time: 0.0017  memory: 16911  
09/20 14:43:45 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:17:08  time: 6.6828  data_time: 0.0017  memory: 578  
09/20 14:49:02 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:11:24  time: 6.4494  data_time: 0.0016  memory: 16935  
09/20 14:54:43 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:05:42  time: 6.4751  data_time: 0.0015  memory: 16916  
09/20 15:00:05 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 6.0135  data_time: 0.0014  memory: 16864  
09/20 15:00:06 - mmengine - INFO - per class results:
09/20 15:00:06 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 71.43 | 88.33 |
|       building      | 79.15 | 93.12 |
|         sky         | 93.04 | 97.22 |
|        floor        | 77.09 | 87.08 |
|         tree        | 69.71 | 85.23 |
|       ceiling       | 80.42 | 88.73 |
|         road        |  79.7 | 89.38 |
|         bed         | 85.36 | 93.61 |
|      windowpane     | 54.86 | 71.75 |
|        grass        | 61.53 | 77.65 |
|       cabinet       | 53.31 | 65.26 |
|       sidewalk      | 56.19 | 65.64 |
|        person       | 72.56 | 88.33 |
|        earth        |  26.9 | 43.41 |
|         door        | 34.45 | 40.04 |
|        table        | 54.56 | 69.08 |
|       mountain      | 50.83 | 66.86 |
|        plant        |  45.7 | 58.84 |
|       curtain       | 58.61 |  82.9 |
|        chair        | 52.26 | 66.67 |
|         car         | 78.63 | 84.47 |
|        water        | 44.91 | 57.55 |
|       painting      | 66.59 | 79.07 |
|         sofa        | 59.14 | 80.14 |
|        shelf        | 35.58 | 49.77 |
|        house        | 40.49 | 46.55 |
|         sea         |  48.7 | 78.02 |
|        mirror       | 57.67 | 67.69 |
|         rug         |  55.9 | 73.09 |
|        field        | 22.99 | 38.19 |
|       armchair      | 38.82 | 52.71 |
|         seat        | 52.86 |  69.1 |
|        fence        | 36.95 | 48.33 |
|         desk        | 35.27 | 44.29 |
|         rock        |  33.8 | 52.62 |
|       wardrobe      | 40.28 | 54.83 |
|         lamp        | 56.25 | 66.36 |
|       bathtub       | 69.18 | 74.34 |
|       railing       | 28.44 | 39.52 |
|       cushion       | 46.31 | 59.89 |
|         base        | 16.92 | 21.48 |
|         box         | 16.61 |  22.6 |
|        column       |  43.0 | 51.83 |
|      signboard      |  29.1 | 35.52 |
|   chest of drawers  | 35.49 | 50.65 |
|       counter       | 15.23 | 18.95 |
|         sand        | 31.07 | 43.21 |
|         sink        | 61.46 | 75.26 |
|      skyscraper     | 61.59 | 78.27 |
|      fireplace      | 64.01 | 78.99 |
|     refrigerator    | 60.39 | 66.13 |
|      grandstand     | 28.83 | 68.59 |
|         path        | 22.48 |  28.1 |
|        stairs       | 24.64 | 28.98 |
|        runway       | 63.64 | 80.33 |
|         case        | 48.19 | 65.23 |
|      pool table     | 90.47 |  95.3 |
|        pillow       | 48.71 | 58.08 |
|     screen door     | 54.49 |  58.4 |
|       stairway      | 29.07 |  41.3 |
|        river        | 12.13 | 20.31 |
|        bridge       | 28.46 | 31.17 |
|       bookcase      | 29.37 |  39.4 |
|        blind        | 26.07 | 28.73 |
|     coffee table    | 55.27 | 74.13 |
|        toilet       | 80.96 | 86.06 |
|        flower       | 27.84 | 50.11 |
|         book        | 37.27 | 53.59 |
|         hill        |  5.07 |  8.4  |
|        bench        |  34.2 |  43.0 |
|      countertop     | 50.71 | 63.93 |
|        stove        | 65.52 | 76.07 |
|         palm        | 43.59 | 57.32 |
|    kitchen island   | 38.12 | 64.39 |
|       computer      | 49.14 | 55.47 |
|     swivel chair    | 43.53 | 56.15 |
|         boat        | 30.91 | 36.49 |
|         bar         | 20.12 |  26.9 |
|    arcade machine   | 31.27 | 42.62 |
|        hovel        | 36.56 | 39.42 |
|         bus         | 77.58 | 86.56 |
|        towel        | 40.95 | 61.34 |
|        light        | 43.31 |  49.9 |
|        truck        | 21.42 | 33.73 |
|        tower        | 26.05 | 37.01 |
|      chandelier     | 62.13 |  78.5 |
|        awning       | 20.59 | 25.27 |
|     streetlight     | 16.93 | 22.15 |
|        booth        | 32.85 | 33.38 |
| television receiver |  59.3 | 67.79 |
|       airplane      | 48.35 | 53.48 |
|      dirt track     |  2.15 |  7.25 |
|       apparel       | 28.76 | 42.86 |
|         pole        | 18.35 | 22.83 |
|         land        |  1.19 |  1.91 |
|      bannister      |  1.6  |  1.88 |
|      escalator      | 18.79 | 19.62 |
|       ottoman       | 41.55 | 48.93 |
|        bottle       | 24.77 | 35.13 |
|        buffet       | 43.78 | 52.41 |
|        poster       | 23.29 | 35.87 |
|        stage        |  7.7  | 17.46 |
|         van         | 40.25 | 51.26 |
|         ship        | 65.45 | 87.31 |
|       fountain      | 12.28 | 16.64 |
|    conveyer belt    |  54.6 | 58.77 |
|        canopy       | 10.93 | 12.81 |
|        washer       |  59.0 | 60.82 |
|      plaything      | 18.31 | 33.66 |
|    swimming pool    | 31.05 | 45.84 |
|        stool        | 33.26 | 41.14 |
|        barrel       |  43.8 | 63.93 |
|        basket       |  13.7 | 15.42 |
|      waterfall      | 50.78 | 92.87 |
|         tent        | 94.35 | 97.45 |
|         bag         |  2.83 |  3.03 |
|       minibike      | 52.11 |  59.4 |
|        cradle       | 68.98 | 97.89 |
|         oven        | 25.72 | 30.27 |
|         ball        | 38.64 | 66.66 |
|         food        | 48.61 | 69.34 |
|         step        |  2.17 |  2.37 |
|         tank        | 40.54 | 43.08 |
|      trade name     | 13.52 | 14.52 |
|      microwave      | 33.08 | 35.74 |
|         pot         | 31.11 | 34.93 |
|        animal       | 47.77 | 49.96 |
|       bicycle       | 36.46 | 50.85 |
|         lake        | 30.95 | 62.82 |
|      dishwasher     | 49.55 |  52.6 |
|        screen       | 36.89 | 43.34 |
|       blanket       |  6.41 |  7.19 |
|      sculpture      | 27.66 | 43.16 |
|         hood        | 50.02 | 60.53 |
|        sconce       | 34.29 | 40.08 |
|         vase        | 26.48 |  36.3 |
|    traffic light    | 15.98 |  19.3 |
|         tray        |  2.45 |  3.45 |
|        ashcan       | 29.41 | 35.66 |
|         fan         | 43.58 |  50.9 |
|         pier        | 13.87 | 15.49 |
|      crt screen     |  3.98 |  7.8  |
|        plate        | 38.73 | 45.35 |
|       monitor       | 49.28 | 54.88 |
|    bulletin board   |  29.2 | 38.74 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 36.04 | 42.28 |
|        glass        |  3.89 |  3.96 |
|        clock        | 15.94 |  17.8 |
|         flag        |  37.4 | 47.03 |
+---------------------+-------+-------+
09/20 15:00:06 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.0300  mIoU: 40.0700  mAcc: 50.3800  data_time: 0.0035  time: 6.8336
Finished processing corruption type: glass_blur
Processing corruption type: motion_blur
09/20 15:02:13 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 2013703445
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 2013703445
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 15:02:14 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='motion_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/motion_blur'

09/20 15:03:07 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 15:03:08 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 15:03:09 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 15:03:10 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 15:05:42 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:38:47  time: 1.5520  data_time: 0.0015  memory: 17152  
09/20 15:06:59 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:12:30  time: 1.6698  data_time: 0.0016  memory: 16931  
09/20 15:07:54 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:58:31  time: 1.1393  data_time: 0.0015  memory: 16924  
09/20 15:09:02 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:52:50  time: 1.2704  data_time: 0.0016  memory: 16933  
09/20 15:10:05 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:48:29  time: 1.0735  data_time: 0.0015  memory: 16932  
09/20 15:11:03 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:44:44  time: 0.8398  data_time: 0.0016  memory: 16928  
09/20 15:12:07 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:42:14  time: 1.0829  data_time: 0.0015  memory: 16932  
09/20 15:13:06 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:39:45  time: 1.2217  data_time: 0.0015  memory: 16929  
09/20 15:13:46 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:36:31  time: 0.8743  data_time: 0.0014  memory: 16854  
09/20 15:14:31 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:34:05  time: 0.7396  data_time: 0.0015  memory: 16912  
09/20 15:15:20 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:32:05  time: 1.2123  data_time: 0.0016  memory: 16932  
09/20 15:16:01 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:29:58  time: 0.9490  data_time: 0.0016  memory: 16860  
09/20 15:16:52 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:28:28  time: 1.1476  data_time: 0.0014  memory: 16934  
09/20 15:17:49 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:27:12  time: 0.8212  data_time: 0.0016  memory: 16934  
09/20 15:18:46 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:26:00  time: 1.6427  data_time: 0.0015  memory: 16937  
09/20 15:19:26 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:24:24  time: 0.7453  data_time: 0.0017  memory: 16925  
09/20 15:20:04 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:22:52  time: 0.7676  data_time: 0.0019  memory: 628  
09/20 15:20:44 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:21:29  time: 0.8330  data_time: 0.0015  memory: 16850  
09/20 15:21:38 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:20:25  time: 1.0406  data_time: 0.0016  memory: 16932  
09/20 15:22:23 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:19:13  time: 0.7562  data_time: 0.0015  memory: 16908  
09/20 15:23:14 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:18:09  time: 1.3664  data_time: 0.0015  memory: 16935  
09/20 15:24:01 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:17:03  time: 0.7702  data_time: 0.0016  memory: 16921  
09/20 15:24:44 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:15:56  time: 0.9177  data_time: 0.0015  memory: 16913  
09/20 15:25:24 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:14:49  time: 0.7746  data_time: 0.0015  memory: 1824  
09/20 15:26:08 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:13:47  time: 0.8989  data_time: 0.0015  memory: 16925  
09/20 15:26:45 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:12:42  time: 0.7711  data_time: 0.0015  memory: 1463  
09/20 15:27:27 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:11:41  time: 0.7254  data_time: 0.0015  memory: 16910  
09/20 15:28:20 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:10:47  time: 1.2001  data_time: 0.0016  memory: 16928  
09/20 15:29:02 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:09:48  time: 1.1233  data_time: 0.0014  memory: 16917  
09/20 15:29:40 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:08:50  time: 0.7127  data_time: 0.0015  memory: 628  
09/20 15:30:23 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:07:54  time: 0.8069  data_time: 0.0015  memory: 16859  
09/20 15:30:59 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:06:57  time: 0.7256  data_time: 0.0016  memory: 1507  
09/20 15:31:44 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:03  time: 0.7289  data_time: 0.0014  memory: 16931  
09/20 15:32:30 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:10  time: 0.7987  data_time: 0.0017  memory: 16922  
09/20 15:33:15 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:17  time: 0.8331  data_time: 0.0015  memory: 16911  
09/20 15:33:56 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:25  time: 0.7727  data_time: 0.0017  memory: 16911  
09/20 15:34:33 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:32  time: 0.7488  data_time: 0.0016  memory: 578  
09/20 15:35:14 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:41  time: 0.7800  data_time: 0.0015  memory: 16935  
09/20 15:35:58 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:50  time: 0.7853  data_time: 0.0015  memory: 16916  
09/20 15:36:40 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6788  data_time: 0.0014  memory: 16864  
09/20 15:36:40 - mmengine - INFO - per class results:
09/20 15:36:40 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 71.82 | 85.06 |
|       building      | 77.14 | 94.06 |
|         sky         | 92.04 | 95.43 |
|        floor        | 75.72 |  88.6 |
|         tree        |  66.5 | 77.23 |
|       ceiling       | 80.68 | 91.78 |
|         road        | 76.06 | 82.63 |
|         bed         | 84.26 | 94.39 |
|      windowpane     | 57.41 | 75.95 |
|        grass        | 60.19 | 80.12 |
|       cabinet       | 55.17 | 67.53 |
|       sidewalk      | 56.89 | 78.82 |
|        person       | 71.29 | 87.26 |
|        earth        | 19.47 | 24.95 |
|         door        |  37.0 | 45.21 |
|        table        | 54.39 |  72.0 |
|       mountain      | 49.92 | 75.06 |
|        plant        | 43.39 | 63.44 |
|       curtain       | 66.18 | 79.59 |
|        chair        | 50.75 | 65.77 |
|         car         | 78.05 | 87.68 |
|        water        | 37.36 | 54.34 |
|       painting      | 64.14 | 77.95 |
|         sofa        | 58.16 | 78.31 |
|        shelf        | 33.41 | 50.91 |
|        house        | 30.54 | 37.67 |
|         sea         | 42.28 | 76.22 |
|        mirror       | 58.46 | 66.25 |
|         rug         | 53.47 | 63.39 |
|        field        | 22.39 | 34.23 |
|       armchair      | 36.93 | 49.54 |
|         seat        | 48.11 | 69.86 |
|        fence        | 27.77 | 41.69 |
|         desk        | 41.38 |  58.9 |
|         rock        | 27.99 | 37.47 |
|       wardrobe      | 48.14 | 60.38 |
|         lamp        | 56.31 | 68.82 |
|       bathtub       | 69.98 | 74.34 |
|       railing       | 23.46 | 38.69 |
|       cushion       | 45.86 |  57.9 |
|         base        | 18.52 | 30.99 |
|         box         | 14.43 | 18.57 |
|        column       | 39.25 | 51.42 |
|      signboard      |  29.1 | 36.06 |
|   chest of drawers  | 36.87 | 54.19 |
|       counter       | 27.76 | 34.97 |
|         sand        | 24.35 | 49.15 |
|         sink        | 61.58 | 76.52 |
|      skyscraper     | 49.87 | 60.22 |
|      fireplace      |  62.7 | 81.46 |
|     refrigerator    |  74.3 | 84.55 |
|      grandstand     |  34.5 | 62.77 |
|         path        | 14.51 | 21.81 |
|        stairs       | 24.45 |  27.3 |
|        runway       | 69.31 | 94.74 |
|         case        |  44.4 | 74.11 |
|      pool table     | 89.95 | 94.59 |
|        pillow       | 49.15 | 67.12 |
|     screen door     | 54.93 | 70.89 |
|       stairway      | 32.41 |  42.2 |
|        river        |  9.48 | 23.46 |
|        bridge       | 42.97 | 48.11 |
|       bookcase      | 32.44 | 42.38 |
|        blind        |  35.6 | 41.55 |
|     coffee table    | 54.88 | 72.97 |
|        toilet       | 81.76 | 89.67 |
|        flower       | 24.95 |  30.2 |
|         book        | 37.67 | 53.93 |
|         hill        |  2.8  |  4.77 |
|        bench        | 37.47 | 48.57 |
|      countertop     |  54.7 | 72.48 |
|        stove        | 61.53 | 70.61 |
|         palm        | 33.35 | 65.67 |
|    kitchen island   |  35.2 | 71.89 |
|       computer      |  52.1 | 66.14 |
|     swivel chair    | 42.78 | 65.11 |
|         boat        | 35.39 | 52.49 |
|         bar         | 19.51 |  21.9 |
|    arcade machine   | 24.02 | 25.36 |
|        hovel        |  7.47 |  7.59 |
|         bus         | 72.06 | 84.57 |
|        towel        | 38.63 | 59.13 |
|        light        | 48.55 | 59.81 |
|        truck        | 17.11 | 24.66 |
|        tower        |  6.79 |  8.15 |
|      chandelier     | 55.93 | 66.63 |
|        awning       |  20.4 |  23.7 |
|     streetlight     | 17.35 | 21.34 |
|        booth        |  32.6 | 35.51 |
| television receiver | 61.73 | 73.53 |
|       airplane      | 50.44 | 62.63 |
|      dirt track     |  7.25 |  16.1 |
|       apparel       | 18.27 | 24.67 |
|         pole        | 17.64 | 24.37 |
|         land        |  0.23 |  0.29 |
|      bannister      |  4.16 |  4.97 |
|      escalator      | 18.65 | 19.54 |
|       ottoman       | 34.44 |  44.5 |
|        bottle       |  9.55 | 14.19 |
|        buffet       | 37.61 | 44.88 |
|        poster       | 22.35 |  28.5 |
|        stage        |  8.16 | 10.62 |
|         van         | 30.46 | 35.86 |
|         ship        | 57.45 |  63.7 |
|       fountain      |  0.76 |  0.76 |
|    conveyer belt    |  70.4 | 89.02 |
|        canopy       |  16.3 | 17.18 |
|        washer       | 61.69 | 64.94 |
|      plaything      | 12.83 | 18.38 |
|    swimming pool    | 28.63 | 37.52 |
|        stool        | 31.18 | 39.32 |
|        barrel       | 27.14 | 64.42 |
|        basket       | 13.32 | 22.24 |
|      waterfall      | 31.41 | 52.79 |
|         tent        | 89.26 | 97.78 |
|         bag         |  2.84 |  3.38 |
|       minibike      | 38.62 | 66.32 |
|        cradle       | 73.88 | 96.35 |
|         oven        | 14.65 | 41.87 |
|         ball        | 38.26 | 66.71 |
|         food        | 46.16 | 60.17 |
|         step        |  1.65 |  1.81 |
|         tank        | 42.65 | 44.66 |
|      trade name     | 19.63 | 21.02 |
|      microwave      | 38.34 | 43.46 |
|         pot         | 27.98 |  32.4 |
|        animal       | 40.27 | 50.08 |
|       bicycle       | 37.86 | 53.17 |
|         lake        | 17.42 | 17.82 |
|      dishwasher     |  57.6 | 60.83 |
|        screen       | 58.37 |  74.3 |
|       blanket       |  5.51 |  6.8  |
|      sculpture      |  32.1 | 43.94 |
|         hood        | 60.93 | 78.79 |
|        sconce       | 33.96 | 41.39 |
|         vase        | 27.97 | 35.66 |
|    traffic light    | 18.95 | 25.54 |
|         tray        |  4.05 |  5.77 |
|        ashcan       | 32.92 | 45.98 |
|         fan         | 49.51 | 60.29 |
|         pier        | 10.38 | 12.86 |
|      crt screen     |  4.1  |  6.38 |
|        plate        | 44.71 | 59.97 |
|       monitor       | 60.46 | 71.12 |
|    bulletin board   |  37.0 | 42.62 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 38.28 | 42.49 |
|        glass        |  4.86 |  4.99 |
|        clock        | 15.75 | 18.46 |
|         flag        | 27.85 | 31.22 |
+---------------------+-------+-------+
09/20 15:36:40 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.2400  mIoU: 39.1000  mAcc: 50.2800  data_time: 0.0020  time: 1.0051
Finished processing corruption type: motion_blur
Processing corruption type: zoom_blur
09/20 15:36:44 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1877633077
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1877633077
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 15:36:44 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='zoom_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/zoom_blur'

09/20 15:36:48 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 15:36:48 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 15:36:48 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 15:36:49 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 15:38:36 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:09:29  time: 1.4872  data_time: 0.0038  memory: 17152  
09/20 15:39:48 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:56:48  time: 1.5903  data_time: 0.0016  memory: 16931  
09/20 15:40:41 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:47:44  time: 1.1014  data_time: 0.0016  memory: 16924  
09/20 15:41:45 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:44:23  time: 1.1939  data_time: 0.0016  memory: 16933  
09/20 15:42:44 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:41:24  time: 0.9798  data_time: 0.0015  memory: 16932  
09/20 15:43:37 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:38:35  time: 0.7384  data_time: 0.0016  memory: 16928  
09/20 15:44:38 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:36:51  time: 1.0113  data_time: 0.0015  memory: 16932  
09/20 15:45:32 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:34:54  time: 1.1214  data_time: 0.0014  memory: 16929  
09/20 15:46:09 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:32:10  time: 0.7944  data_time: 0.0014  memory: 16854  
09/20 15:46:51 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:30:06  time: 0.6924  data_time: 0.0015  memory: 16912  
09/20 15:47:36 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:28:27  time: 1.1255  data_time: 0.0016  memory: 16932  
09/20 15:48:15 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:26:42  time: 0.9226  data_time: 0.0016  memory: 16860  
09/20 15:49:03 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:25:25  time: 1.1190  data_time: 0.0014  memory: 16934  
09/20 15:49:56 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:24:21  time: 0.7455  data_time: 0.0016  memory: 16934  
09/20 15:50:48 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:23:18  time: 1.5006  data_time: 0.0015  memory: 16937  
09/20 15:51:25 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:21:55  time: 0.7192  data_time: 0.0016  memory: 16925  
09/20 15:52:02 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:20:35  time: 0.7302  data_time: 0.0017  memory: 628  
09/20 15:52:39 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:19:21  time: 0.7679  data_time: 0.0015  memory: 16850  
09/20 15:53:29 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:18:25  time: 0.9543  data_time: 0.0016  memory: 16932  
09/20 15:54:10 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:17:20  time: 0.6856  data_time: 0.0016  memory: 16908  
09/20 15:54:57 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:16:24  time: 1.2682  data_time: 0.0016  memory: 16935  
09/20 15:55:41 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:15:26  time: 0.7043  data_time: 0.0015  memory: 16921  
09/20 15:56:21 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:14:26  time: 0.8429  data_time: 0.0015  memory: 16913  
09/20 15:56:57 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:13:25  time: 0.6990  data_time: 0.0015  memory: 1824  
09/20 15:57:37 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:12:29  time: 0.8211  data_time: 0.0015  memory: 16925  
09/20 15:58:11 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:11:30  time: 0.7172  data_time: 0.0015  memory: 1463  
09/20 15:58:49 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:10:35  time: 0.6602  data_time: 0.0015  memory: 16910  
09/20 15:59:38 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:09:46  time: 1.1048  data_time: 0.0015  memory: 16928  
09/20 16:00:16 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:08:53  time: 1.0326  data_time: 0.0015  memory: 16917  
09/20 16:00:51 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:08:00  time: 0.6702  data_time: 0.0014  memory: 628  
09/20 16:01:30 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:07:10  time: 0.7330  data_time: 0.0015  memory: 16859  
09/20 16:02:05 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:06:19  time: 0.7105  data_time: 0.0016  memory: 1507  
09/20 16:02:46 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:05:30  time: 0.6595  data_time: 0.0014  memory: 16931  
09/20 16:03:29 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:42  time: 0.7147  data_time: 0.0016  memory: 16922  
09/20 16:04:10 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:54  time: 0.7091  data_time: 0.0014  memory: 16911  
09/20 16:04:48 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:06  time: 0.7249  data_time: 0.0016  memory: 16911  
09/20 16:05:24 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:19  time: 0.7286  data_time: 0.0017  memory: 578  
09/20 16:06:01 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:32  time: 0.7000  data_time: 0.0015  memory: 16935  
09/20 16:06:42 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:45  time: 0.6936  data_time: 0.0015  memory: 16916  
09/20 16:07:20 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6410  data_time: 0.0014  memory: 16864  
09/20 16:07:20 - mmengine - INFO - per class results:
09/20 16:07:20 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 50.87 | 82.77 |
|       building      | 61.09 | 77.83 |
|         sky         | 83.85 | 87.68 |
|        floor        | 46.75 |  77.3 |
|         tree        | 22.84 | 24.63 |
|       ceiling       | 56.68 | 85.28 |
|         road        | 41.99 | 46.02 |
|         bed         | 65.21 | 88.04 |
|      windowpane     | 38.15 | 53.73 |
|        grass        | 35.65 | 48.21 |
|       cabinet       | 38.03 | 45.24 |
|       sidewalk      | 23.35 | 36.86 |
|        person       | 44.94 | 63.46 |
|        earth        |  6.31 |  8.05 |
|         door        | 12.58 | 13.77 |
|        table        | 34.67 | 48.81 |
|       mountain      | 32.27 |  52.1 |
|        plant        | 20.83 | 34.95 |
|       curtain       |  34.3 | 57.05 |
|        chair        | 26.78 | 33.26 |
|         car         | 54.11 | 60.51 |
|        water        | 17.89 | 35.49 |
|       painting      |  38.1 | 58.96 |
|         sofa        | 36.57 |  58.1 |
|        shelf        | 20.11 | 29.42 |
|        house        |  7.37 |  8.01 |
|         sea         | 34.03 |  58.0 |
|        mirror       | 33.84 | 37.24 |
|         rug         |  17.5 | 18.09 |
|        field        | 12.36 | 20.01 |
|       armchair      | 16.43 |  21.1 |
|         seat        | 18.99 | 27.32 |
|        fence        | 14.25 | 23.44 |
|         desk        | 23.55 | 33.52 |
|         rock        |  8.18 | 10.86 |
|       wardrobe      | 15.89 | 20.11 |
|         lamp        | 33.52 | 43.05 |
|       bathtub       | 52.05 | 64.13 |
|       railing       |  4.95 |  7.09 |
|       cushion       | 23.63 |  29.3 |
|         base        |  5.45 |  8.81 |
|         box         |  0.67 |  0.76 |
|        column       | 13.74 | 17.11 |
|      signboard      |  14.2 | 15.58 |
|   chest of drawers  | 23.25 | 31.78 |
|       counter       |  8.17 | 14.91 |
|         sand        |  5.77 | 26.12 |
|         sink        | 37.61 |  61.8 |
|      skyscraper     | 28.25 | 42.31 |
|      fireplace      | 51.84 | 60.99 |
|     refrigerator    | 41.64 | 61.38 |
|      grandstand     | 18.88 | 25.13 |
|         path        |  1.87 |  2.02 |
|        stairs       |  3.27 |  3.56 |
|        runway       | 51.67 | 78.81 |
|         case        |  17.8 | 49.56 |
|      pool table     | 81.82 | 89.49 |
|        pillow       | 36.95 | 58.04 |
|     screen door     | 26.57 | 53.36 |
|       stairway      | 15.05 | 19.24 |
|        river        |  0.47 |  1.18 |
|        bridge       |  21.1 | 23.24 |
|       bookcase      |  9.17 |  9.67 |
|        blind        | 14.41 | 23.36 |
|     coffee table    |  33.7 |  38.4 |
|        toilet       | 62.59 | 75.23 |
|        flower       | 12.14 | 15.89 |
|         book        | 15.57 | 18.73 |
|         hill        |  3.33 |  3.86 |
|        bench        | 26.66 | 37.13 |
|      countertop     | 36.87 | 45.55 |
|        stove        | 44.56 | 50.03 |
|         palm        |  6.72 | 47.42 |
|    kitchen island   | 29.16 | 69.25 |
|       computer      |  43.3 | 49.37 |
|     swivel chair    |  7.11 |  7.88 |
|         boat        | 16.82 | 18.63 |
|         bar         |  6.26 |  6.71 |
|    arcade machine   |  0.0  |  0.0  |
|        hovel        |  6.91 |  7.1  |
|         bus         | 46.34 | 58.41 |
|        towel        | 13.93 | 29.64 |
|        light        | 16.84 | 19.83 |
|        truck        |  0.27 |  0.31 |
|        tower        |  0.21 |  0.22 |
|      chandelier     |  27.3 | 30.96 |
|        awning       |  6.34 |  7.29 |
|     streetlight     |  1.31 |  1.34 |
|        booth        |  8.66 |  9.79 |
| television receiver | 36.26 | 39.75 |
|       airplane      | 31.67 | 54.37 |
|      dirt track     |  0.0  |  0.0  |
|       apparel       |  0.34 |  0.53 |
|         pole        |  3.18 |  3.54 |
|         land        |  6.19 |  8.64 |
|      bannister      |  0.79 |  1.35 |
|      escalator      | 14.65 | 16.01 |
|       ottoman       |  19.4 | 25.55 |
|        bottle       |  0.6  |  0.69 |
|        buffet       |  5.28 |  5.52 |
|        poster       |  9.96 |  14.4 |
|        stage        |  3.86 |  6.66 |
|         van         |  4.2  |  4.4  |
|         ship        |  0.0  |  0.0  |
|       fountain      |  4.04 |  8.64 |
|    conveyer belt    | 19.55 |  29.4 |
|        canopy       |  2.71 |  2.72 |
|        washer       | 43.36 | 46.16 |
|      plaything      |  0.6  |  0.71 |
|    swimming pool    | 26.73 | 37.07 |
|        stool        |  7.21 |  8.42 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  4.4  |  5.64 |
|      waterfall      |  7.99 |  81.2 |
|         tent        | 25.91 | 28.25 |
|         bag         |  0.08 |  0.09 |
|       minibike      | 21.58 | 24.49 |
|        cradle       | 46.99 | 71.57 |
|         oven        | 17.81 | 30.01 |
|         ball        | 17.21 | 18.26 |
|         food        | 10.77 | 11.45 |
|         step        |  0.87 |  1.46 |
|         tank        | 11.41 | 14.85 |
|      trade name     |  5.53 |  5.75 |
|      microwave      | 18.66 | 21.15 |
|         pot         |  6.82 |  7.15 |
|        animal       | 33.85 | 44.09 |
|       bicycle       |  2.04 |  2.11 |
|         lake        |  0.02 |  0.02 |
|      dishwasher     | 32.13 | 37.07 |
|        screen       | 55.56 | 72.35 |
|       blanket       |  1.08 |  1.49 |
|      sculpture      |  3.32 |  6.17 |
|         hood        | 33.77 | 58.59 |
|        sconce       | 13.06 | 16.26 |
|         vase        | 12.74 | 19.64 |
|    traffic light    |  2.63 |  2.64 |
|         tray        |  1.34 |  2.18 |
|        ashcan       | 13.75 | 16.05 |
|         fan         | 22.09 | 29.13 |
|         pier        |  7.39 |  7.73 |
|      crt screen     |  1.15 |  1.17 |
|        plate        | 23.85 | 30.48 |
|       monitor       |  0.16 |  0.16 |
|    bulletin board   | 13.21 |  14.3 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 19.93 | 36.01 |
|        glass        |  1.04 |  1.07 |
|        clock        |  3.55 |  3.62 |
|         flag        | 11.58 | 13.24 |
+---------------------+-------+-------+
09/20 16:07:20 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 60.3100  mIoU: 20.0600  mAcc: 28.0500  data_time: 0.0017  time: 0.9157
Finished processing corruption type: zoom_blur
Processing corruption type: snow
09/20 16:07:24 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 2015789665
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 2015789665
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 16:07:24 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='snow',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/snow'

09/20 16:07:28 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 16:07:28 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 16:07:29 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 16:07:29 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 16:08:55 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:56:02  time: 1.0336  data_time: 0.0015  memory: 17152  
09/20 16:09:46 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:43:31  time: 1.1529  data_time: 0.0016  memory: 16931  
09/20 16:10:18 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:34:44  time: 0.6615  data_time: 0.0016  memory: 16924  
09/20 16:11:00 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:31:39  time: 0.7583  data_time: 0.0015  memory: 16933  
09/20 16:11:39 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:29:08  time: 0.5716  data_time: 0.0014  memory: 16932  
09/20 16:12:13 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:26:46  time: 0.3167  data_time: 0.0016  memory: 16928  
09/20 16:12:52 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:25:23  time: 0.6038  data_time: 0.0014  memory: 16932  
09/20 16:13:26 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:23:46  time: 0.6991  data_time: 0.0014  memory: 16929  
09/20 16:13:44 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:21:30  time: 0.4151  data_time: 0.0014  memory: 16854  
09/20 16:14:04 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:19:45  time: 0.2939  data_time: 0.0014  memory: 16912  
09/20 16:14:28 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:18:24  time: 0.6902  data_time: 0.0015  memory: 16932  
09/20 16:14:46 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:16:59  time: 0.4874  data_time: 0.0016  memory: 16860  
09/20 16:15:13 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:16:03  time: 0.6914  data_time: 0.0014  memory: 16934  
09/20 16:15:44 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:15:18  time: 0.3086  data_time: 0.0016  memory: 16934  
09/20 16:16:14 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:14:35  time: 1.0890  data_time: 0.0014  memory: 16937  
09/20 16:16:32 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:13:33  time: 0.2960  data_time: 0.0030  memory: 16925  
09/20 16:16:47 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:12:34  time: 0.2999  data_time: 0.0016  memory: 628  
09/20 16:17:04 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:42  time: 0.3882  data_time: 0.0014  memory: 16850  
09/20 16:17:33 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:11:07  time: 0.5420  data_time: 0.0015  memory: 16932  
09/20 16:17:54 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:10:24  time: 0.2814  data_time: 0.0016  memory: 16908  
09/20 16:18:19 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:48  time: 0.8269  data_time: 0.0015  memory: 16935  
09/20 16:18:42 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:09:10  time: 0.2891  data_time: 0.0015  memory: 16921  
09/20 16:19:01 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:08:31  time: 0.4213  data_time: 0.0015  memory: 16913  
09/20 16:19:16 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:51  time: 0.2863  data_time: 0.0015  memory: 1824  
09/20 16:19:36 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:07:15  time: 0.4160  data_time: 0.0015  memory: 16925  
09/20 16:19:50 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:38  time: 0.2929  data_time: 0.0015  memory: 1463  
09/20 16:20:07 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:06:04  time: 0.2702  data_time: 0.0015  memory: 16910  
09/20 16:20:34 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:36  time: 0.6577  data_time: 0.0015  memory: 16928  
09/20 16:20:53 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:05:04  time: 0.5943  data_time: 0.0015  memory: 16917  
09/20 16:21:07 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:32  time: 0.2795  data_time: 0.0015  memory: 628  
09/20 16:21:25 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:04:02  time: 0.3009  data_time: 0.0014  memory: 16859  
09/20 16:21:39 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:32  time: 0.2864  data_time: 0.0016  memory: 1507  
09/20 16:22:00 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:03:04  time: 0.2671  data_time: 0.0014  memory: 16931  
09/20 16:22:21 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:37  time: 0.3012  data_time: 0.0015  memory: 16922  
09/20 16:22:41 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:10  time: 0.3011  data_time: 0.0014  memory: 16911  
09/20 16:22:58 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:43  time: 0.2913  data_time: 0.0016  memory: 16911  
09/20 16:23:13 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:16  time: 0.2973  data_time: 0.0031  memory: 578  
09/20 16:23:30 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:50  time: 0.2929  data_time: 0.0014  memory: 16935  
09/20 16:23:50 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:25  time: 0.2806  data_time: 0.0014  memory: 16916  
09/20 16:24:08 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2656  data_time: 0.0014  memory: 16864  
09/20 16:24:08 - mmengine - INFO - per class results:
09/20 16:24:08 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 53.74 | 88.53 |
|       building      | 63.92 | 90.55 |
|         sky         | 72.47 | 75.65 |
|        floor        | 52.57 | 87.03 |
|         tree        | 65.33 | 80.66 |
|       ceiling       | 57.26 | 66.51 |
|         road        |  47.8 | 50.71 |
|         bed         | 56.86 |  60.6 |
|      windowpane     | 43.16 | 52.63 |
|        grass        | 57.02 | 81.55 |
|       cabinet       |  29.8 | 35.38 |
|       sidewalk      | 39.07 | 58.04 |
|        person       | 62.88 | 75.45 |
|        earth        | 24.95 | 36.51 |
|         door        | 13.51 | 15.08 |
|        table        | 38.32 | 49.52 |
|       mountain      | 31.83 | 41.56 |
|        plant        | 37.55 | 58.39 |
|       curtain       | 36.57 | 41.57 |
|        chair        | 38.63 | 52.75 |
|         car         | 73.93 | 80.05 |
|        water        | 30.51 | 39.98 |
|       painting      | 55.95 |  67.2 |
|         sofa        | 44.01 |  51.6 |
|        shelf        |  24.6 | 43.01 |
|        house        |  9.27 |  9.59 |
|         sea         | 17.72 | 24.01 |
|        mirror       |  26.1 | 27.21 |
|         rug         | 16.56 | 16.79 |
|        field        | 13.27 | 21.57 |
|       armchair      | 19.76 | 24.08 |
|         seat        | 29.77 | 39.27 |
|        fence        | 14.73 | 39.32 |
|         desk        | 17.97 | 19.02 |
|         rock        | 25.83 | 33.92 |
|       wardrobe      | 12.98 |  15.9 |
|         lamp        | 49.85 |  56.8 |
|       bathtub       | 11.34 | 11.87 |
|       railing       | 17.35 | 20.96 |
|       cushion       | 34.41 | 42.33 |
|         base        | 10.92 | 25.35 |
|         box         |  7.51 | 15.08 |
|        column       | 11.42 | 12.26 |
|      signboard      | 26.86 | 35.05 |
|   chest of drawers  | 18.95 | 23.36 |
|       counter       |  6.47 |  7.63 |
|         sand        |  7.07 |  8.45 |
|         sink        | 34.26 | 40.91 |
|      skyscraper     | 17.65 | 28.31 |
|      fireplace      | 43.63 | 46.24 |
|     refrigerator    | 27.75 | 28.04 |
|      grandstand     |  13.3 | 54.71 |
|         path        | 10.76 | 11.93 |
|        stairs       | 16.48 | 18.88 |
|        runway       | 15.97 | 18.08 |
|         case        | 34.64 | 56.03 |
|      pool table     | 20.09 | 20.19 |
|        pillow       | 28.63 | 31.75 |
|     screen door     | 11.04 | 11.64 |
|       stairway      |  8.34 | 11.89 |
|        river        |  4.07 |  5.15 |
|        bridge       | 42.05 | 43.02 |
|       bookcase      | 10.24 | 10.73 |
|        blind        | 16.79 | 17.51 |
|     coffee table    | 33.87 | 37.25 |
|        toilet       | 30.86 | 31.69 |
|        flower       | 25.69 | 40.27 |
|         book        | 25.68 | 31.05 |
|         hill        |  0.02 |  0.02 |
|        bench        | 14.99 | 15.74 |
|      countertop     |  9.54 |  9.74 |
|        stove        | 29.82 | 30.62 |
|         palm        | 36.33 | 55.07 |
|    kitchen island   | 21.98 | 27.69 |
|       computer      |  38.2 |  43.0 |
|     swivel chair    |  8.12 |  8.37 |
|         boat        | 20.14 | 20.97 |
|         bar         | 17.99 | 18.59 |
|    arcade machine   | 15.94 | 16.67 |
|        hovel        |  4.28 |  4.29 |
|         bus         | 74.05 | 81.31 |
|        towel        | 11.07 | 12.04 |
|        light        |  17.5 | 17.71 |
|        truck        |  2.67 |  3.09 |
|        tower        |  2.33 |  2.59 |
|      chandelier     | 50.83 |  61.6 |
|        awning       | 10.84 | 11.59 |
|     streetlight     | 15.65 | 16.94 |
|        booth        | 22.93 | 24.72 |
| television receiver | 21.68 | 23.19 |
|       airplane      | 18.29 | 20.22 |
|      dirt track     |  0.0  |  0.0  |
|       apparel       |  5.89 | 24.59 |
|         pole        | 13.73 | 16.44 |
|         land        |  0.0  |  0.0  |
|      bannister      |  2.07 |  2.52 |
|      escalator      |  4.63 |  5.7  |
|       ottoman       |  9.43 |  9.68 |
|        bottle       |  8.76 | 26.26 |
|        buffet       |  3.33 |  3.52 |
|        poster       | 10.44 |  18.7 |
|        stage        |  1.26 |  1.56 |
|         van         | 35.74 | 49.85 |
|         ship        |  1.49 |  1.7  |
|       fountain      |  1.18 |  2.22 |
|    conveyer belt    |  3.02 |  3.08 |
|        canopy       |  0.08 |  0.08 |
|        washer       | 25.76 | 26.68 |
|      plaything      |  5.56 |  6.08 |
|    swimming pool    | 12.69 | 12.75 |
|        stool        | 18.81 | 21.48 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 12.19 | 19.93 |
|      waterfall      | 29.16 |  68.8 |
|         tent        | 12.41 | 12.64 |
|         bag         |  2.22 |  4.95 |
|       minibike      | 29.31 | 31.96 |
|        cradle       | 30.86 | 37.84 |
|         oven        | 13.66 | 16.52 |
|         ball        | 29.79 | 32.24 |
|         food        | 31.25 | 58.14 |
|         step        |  0.0  |  0.0  |
|         tank        |  6.19 |  7.36 |
|      trade name     |  11.9 | 12.49 |
|      microwave      | 12.48 | 13.02 |
|         pot         | 22.66 | 24.95 |
|        animal       | 11.55 | 11.96 |
|       bicycle       | 34.65 | 58.46 |
|         lake        |  3.86 |  3.86 |
|      dishwasher     | 19.93 |  20.3 |
|        screen       | 40.97 | 47.32 |
|       blanket       |  0.18 |  0.19 |
|      sculpture      |  3.23 |  5.89 |
|         hood        | 24.49 | 25.12 |
|        sconce       |  8.72 |  9.07 |
|         vase        | 22.29 | 28.78 |
|    traffic light    |  9.33 | 10.07 |
|         tray        |  1.17 |  1.46 |
|        ashcan       | 23.11 | 28.05 |
|         fan         | 21.91 | 23.03 |
|         pier        |  1.71 |  1.75 |
|      crt screen     |  2.08 |  4.74 |
|        plate        | 29.41 | 32.33 |
|       monitor       | 14.12 | 17.47 |
|    bulletin board   | 25.17 | 33.22 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  4.64 |  4.81 |
|        glass        |  7.93 |  8.81 |
|        clock        |  8.27 |  8.55 |
|         flag        | 16.73 | 17.27 |
+---------------------+-------+-------+
09/20 16:24:08 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 65.1200  mIoU: 21.5900  mAcc: 27.3800  data_time: 0.0017  time: 0.4994
Finished processing corruption type: snow
Processing corruption type: frost
09/20 16:24:12 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 2084405302
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 2084405302
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 16:24:12 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='frost',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/frost'

09/20 16:24:16 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 16:24:16 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 16:24:17 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 16:24:17 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 16:25:31 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:48:09  time: 0.7976  data_time: 0.0015  memory: 17152  
09/20 16:26:11 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:36:01  time: 0.9223  data_time: 0.0016  memory: 16931  
09/20 16:26:31 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:27:36  time: 0.4344  data_time: 0.0015  memory: 16924  
09/20 16:27:02 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:24:45  time: 0.5505  data_time: 0.0015  memory: 16933  
09/20 16:27:31 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:22:36  time: 0.3518  data_time: 0.0014  memory: 16932  
09/20 16:27:54 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:30  time: 0.0815  data_time: 0.0015  memory: 16928  
09/20 16:28:23 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:19  time: 0.4032  data_time: 0.0015  memory: 16932  
09/20 16:28:45 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:17:54  time: 0.4674  data_time: 0.0014  memory: 16929  
09/20 16:28:53 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:15:52  time: 0.2074  data_time: 0.0014  memory: 16854  
09/20 16:29:03 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:14:18  time: 0.0766  data_time: 0.0014  memory: 16912  
09/20 16:29:15 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:13:05  time: 0.4621  data_time: 0.0015  memory: 16932  
09/20 16:29:22 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:52  time: 0.2615  data_time: 0.0016  memory: 16860  
09/20 16:29:38 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:07  time: 0.4743  data_time: 0.0014  memory: 16934  
09/20 16:29:58 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:33  time: 0.0847  data_time: 0.0016  memory: 16934  
09/20 16:30:18 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:01  time: 0.9072  data_time: 0.0014  memory: 16937  
09/20 16:30:25 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:09:12  time: 0.0722  data_time: 0.0016  memory: 16925  
09/20 16:30:29 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:23  time: 0.0741  data_time: 0.0016  memory: 628  
09/20 16:30:36 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:43  time: 0.1933  data_time: 0.0014  memory: 16850  
09/20 16:30:54 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:18  time: 0.3317  data_time: 0.0036  memory: 16932  
09/20 16:31:04 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:47  time: 0.0708  data_time: 0.0015  memory: 16908  
09/20 16:31:19 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:21  time: 0.6034  data_time: 0.0015  memory: 16935  
09/20 16:31:31 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:55  time: 0.0780  data_time: 0.0015  memory: 16921  
09/20 16:31:39 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:26  time: 0.2036  data_time: 0.0015  memory: 16913  
09/20 16:31:43 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:57  time: 0.0753  data_time: 0.0015  memory: 1824  
09/20 16:31:52 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:32  time: 0.2048  data_time: 0.0014  memory: 16925  
09/20 16:31:55 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:06  time: 0.0726  data_time: 0.0015  memory: 1463  
09/20 16:32:02 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:43  time: 0.0691  data_time: 0.0014  memory: 16910  
09/20 16:32:19 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:26  time: 0.4274  data_time: 0.0014  memory: 16928  
09/20 16:32:27 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:05  time: 0.3683  data_time: 0.0014  memory: 16917  
09/20 16:32:30 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:44  time: 0.0681  data_time: 0.0014  memory: 628  
09/20 16:32:36 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:24  time: 0.0746  data_time: 0.0014  memory: 16859  
09/20 16:32:40 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:05  time: 0.0728  data_time: 0.0016  memory: 1507  
09/20 16:32:50 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:48  time: 0.0727  data_time: 0.0014  memory: 16931  
09/20 16:33:00 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:32  time: 0.0741  data_time: 0.0016  memory: 16922  
09/20 16:33:09 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:16  time: 0.0788  data_time: 0.0014  memory: 16911  
09/20 16:33:16 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:59  time: 0.0737  data_time: 0.0016  memory: 16911  
09/20 16:33:19 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:43  time: 0.0723  data_time: 0.0016  memory: 578  
09/20 16:33:27 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:28  time: 0.0750  data_time: 0.0014  memory: 16935  
09/20 16:33:35 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.0697  data_time: 0.0014  memory: 16916  
09/20 16:33:43 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0692  data_time: 0.0013  memory: 16864  
09/20 16:33:43 - mmengine - INFO - per class results:
09/20 16:33:43 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 62.48 | 87.23 |
|       building      | 76.71 | 91.13 |
|         sky         | 73.71 | 76.46 |
|        floor        | 69.37 | 86.53 |
|         tree        | 66.47 | 85.82 |
|       ceiling       | 67.01 | 76.06 |
|         road        | 72.24 |  78.8 |
|         bed         | 80.25 | 89.73 |
|      windowpane     | 50.74 | 63.97 |
|        grass        |  59.3 | 76.17 |
|       cabinet       | 44.34 | 51.63 |
|       sidewalk      | 50.82 | 63.23 |
|        person       | 71.03 | 84.03 |
|        earth        | 26.01 | 44.77 |
|         door        | 25.41 | 31.91 |
|        table        | 49.48 | 67.69 |
|       mountain      | 27.37 | 72.35 |
|        plant        | 45.41 |  59.0 |
|       curtain       | 52.26 | 66.45 |
|        chair        | 49.12 | 62.71 |
|         car         | 79.27 | 86.56 |
|        water        | 43.95 | 59.22 |
|       painting      | 62.89 | 78.39 |
|         sofa        |  53.4 | 70.07 |
|        shelf        | 32.27 | 43.31 |
|        house        | 42.62 | 49.47 |
|         sea         | 30.89 | 46.93 |
|        mirror       | 47.48 | 52.81 |
|         rug         | 46.34 | 52.26 |
|        field        | 26.29 | 40.85 |
|       armchair      | 31.13 | 47.71 |
|         seat        |  42.4 | 46.82 |
|        fence        | 26.92 | 39.84 |
|         desk        | 32.05 | 42.97 |
|         rock        | 27.24 | 38.95 |
|       wardrobe      | 30.94 | 39.45 |
|         lamp        | 54.31 | 64.35 |
|       bathtub       | 50.46 |  59.3 |
|       railing       | 24.84 | 37.74 |
|       cushion       | 42.43 | 53.65 |
|         base        | 12.51 | 16.94 |
|         box         | 15.64 | 19.78 |
|        column       | 33.36 | 41.47 |
|      signboard      | 30.49 | 39.58 |
|   chest of drawers  |  38.5 | 47.26 |
|       counter       | 12.11 | 21.63 |
|         sand        |  17.3 | 22.56 |
|         sink        | 46.14 | 53.25 |
|      skyscraper     | 49.97 | 61.51 |
|      fireplace      |  56.2 | 69.69 |
|     refrigerator    | 45.13 | 47.32 |
|      grandstand     | 31.66 |  65.6 |
|         path        | 14.71 | 19.57 |
|        stairs       | 30.62 | 40.72 |
|        runway       | 47.46 | 50.86 |
|         case        | 39.24 | 67.23 |
|      pool table     | 86.33 | 89.07 |
|        pillow       | 45.48 | 55.89 |
|     screen door     | 28.27 | 76.83 |
|       stairway      | 29.06 | 43.56 |
|        river        |  5.73 | 10.54 |
|        bridge       | 50.96 | 54.61 |
|       bookcase      | 28.85 |  35.0 |
|        blind        | 33.09 |  36.6 |
|     coffee table    | 52.24 | 63.76 |
|        toilet       | 61.17 |  65.0 |
|        flower       | 28.83 | 37.11 |
|         book        | 38.15 |  55.2 |
|         hill        |  2.76 |  4.29 |
|        bench        |  29.6 | 34.16 |
|      countertop     | 43.07 | 65.84 |
|        stove        | 54.45 | 58.53 |
|         palm        | 44.13 | 59.84 |
|    kitchen island   | 30.64 | 56.25 |
|       computer      | 44.31 | 49.65 |
|     swivel chair    | 31.91 | 35.67 |
|         boat        | 27.85 | 31.51 |
|         bar         | 21.63 | 26.98 |
|    arcade machine   | 10.71 | 10.97 |
|        hovel        | 39.31 | 41.95 |
|         bus         | 77.56 | 83.69 |
|        towel        | 33.69 | 46.51 |
|        light        | 36.61 | 41.86 |
|        truck        |  4.81 |  5.92 |
|        tower        | 16.87 | 22.96 |
|      chandelier     | 58.14 | 73.91 |
|        awning       | 15.02 | 16.02 |
|     streetlight     | 19.09 | 21.21 |
|        booth        | 37.54 |  39.9 |
| television receiver | 31.02 | 33.18 |
|       airplane      | 44.65 | 66.48 |
|      dirt track     |  8.91 | 29.48 |
|       apparel       | 18.85 | 23.13 |
|         pole        | 19.24 | 26.75 |
|         land        |  0.03 |  0.04 |
|      bannister      |  6.48 |  7.78 |
|      escalator      | 12.15 | 12.33 |
|       ottoman       | 28.55 | 32.64 |
|        bottle       | 11.43 | 15.02 |
|        buffet       | 29.38 | 35.65 |
|        poster       | 18.51 |  22.6 |
|        stage        |  3.78 |  4.18 |
|         van         | 37.65 |  51.6 |
|         ship        | 15.64 | 16.39 |
|       fountain      |  0.11 |  0.12 |
|    conveyer belt    | 30.89 |  34.4 |
|        canopy       |  0.0  |  0.0  |
|        washer       | 53.21 | 54.93 |
|      plaything      | 17.74 | 19.68 |
|    swimming pool    | 48.38 | 58.56 |
|        stool        | 31.56 | 42.65 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 16.58 | 23.22 |
|      waterfall      |  57.7 | 75.67 |
|         tent        | 17.83 | 18.37 |
|         bag         |  4.58 |  5.36 |
|       minibike      | 44.12 | 51.15 |
|        cradle       | 73.72 | 92.95 |
|         oven        | 26.99 | 34.38 |
|         ball        | 37.71 | 65.19 |
|         food        | 42.39 | 55.92 |
|         step        |  3.32 |  3.78 |
|         tank        |  27.8 | 37.81 |
|      trade name     | 23.45 |  28.1 |
|      microwave      |  29.3 | 30.18 |
|         pot         | 25.77 | 29.08 |
|        animal       | 39.51 |  42.2 |
|       bicycle       | 38.47 | 62.12 |
|         lake        |  0.03 |  0.03 |
|      dishwasher     | 41.47 | 43.18 |
|        screen       | 38.82 | 42.85 |
|       blanket       |  6.29 |  6.85 |
|      sculpture      | 26.46 | 42.17 |
|         hood        |  35.8 | 39.65 |
|        sconce       | 25.59 | 28.38 |
|         vase        |  30.3 | 43.52 |
|    traffic light    | 12.91 | 14.31 |
|         tray        |  4.36 |  5.57 |
|        ashcan       | 25.18 | 28.12 |
|         fan         | 40.45 | 46.82 |
|         pier        |  7.24 |  7.43 |
|      crt screen     |  5.83 |  6.83 |
|        plate        | 41.89 | 50.65 |
|       monitor       | 54.83 |  60.7 |
|    bulletin board   | 27.62 | 31.95 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 11.51 |  11.7 |
|        glass        |  7.97 |  8.41 |
|        clock        |  12.5 | 14.33 |
|         flag        | 24.31 | 25.49 |
+---------------------+-------+-------+
09/20 16:33:43 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 73.3100  mIoU: 33.9700  mAcc: 42.6900  data_time: 0.0016  time: 0.2830
Finished processing corruption type: frost
Processing corruption type: fog
09/20 16:33:46 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1201667827
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1201667827
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 16:33:46 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='fog',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/fog'

09/20 16:33:51 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 16:33:51 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 16:33:51 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 16:33:51 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 16:35:12 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:52:30  time: 0.9238  data_time: 0.0016  memory: 17152  
09/20 16:35:58 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:40:12  time: 1.0433  data_time: 0.0015  memory: 16931  
09/20 16:36:25 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:31:34  time: 0.5549  data_time: 0.0015  memory: 16924  
09/20 16:37:02 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:35  time: 0.6621  data_time: 0.0015  memory: 16933  
09/20 16:37:36 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:13  time: 0.4715  data_time: 0.0014  memory: 16932  
09/20 16:38:05 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:59  time: 0.2183  data_time: 0.0016  memory: 16928  
09/20 16:38:40 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:42  time: 0.5226  data_time: 0.0014  memory: 16932  
09/20 16:39:09 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:11  time: 0.5895  data_time: 0.0014  memory: 16929  
09/20 16:39:23 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:19:03  time: 0.3286  data_time: 0.0014  memory: 16854  
09/20 16:39:39 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:17:23  time: 0.2014  data_time: 0.0014  memory: 16912  
09/20 16:39:58 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:16:06  time: 0.5979  data_time: 0.0016  memory: 16932  
09/20 16:40:12 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:47  time: 0.3869  data_time: 0.0016  memory: 16860  
09/20 16:40:34 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:56  time: 0.6043  data_time: 0.0013  memory: 16934  
09/20 16:41:00 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:13:15  time: 0.2082  data_time: 0.0016  memory: 16934  
09/20 16:41:26 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:37  time: 1.0082  data_time: 0.0015  memory: 16937  
09/20 16:41:40 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:42  time: 0.2055  data_time: 0.0015  memory: 16925  
09/20 16:41:50 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:47  time: 0.2067  data_time: 0.0016  memory: 628  
09/20 16:42:04 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:10:01  time: 0.3227  data_time: 0.0014  memory: 16850  
09/20 16:42:28 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:09:30  time: 0.4506  data_time: 0.0015  memory: 16932  
09/20 16:42:44 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:52  time: 0.1967  data_time: 0.0015  memory: 16908  
09/20 16:43:05 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:08:21  time: 0.7292  data_time: 0.0015  memory: 16935  
09/20 16:43:23 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:47  time: 0.1973  data_time: 0.0015  memory: 16921  
09/20 16:43:37 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:13  time: 0.3254  data_time: 0.0015  memory: 16913  
09/20 16:43:48 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:37  time: 0.1969  data_time: 0.0015  memory: 1824  
09/20 16:44:03 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:07  time: 0.3344  data_time: 0.0017  memory: 16925  
09/20 16:44:13 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:34  time: 0.2002  data_time: 0.0014  memory: 1463  
09/20 16:44:26 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:05  time: 0.1951  data_time: 0.0014  memory: 16910  
09/20 16:44:49 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:41  time: 0.5554  data_time: 0.0014  memory: 16928  
09/20 16:45:03 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:14  time: 0.4933  data_time: 0.0014  memory: 16917  
09/20 16:45:13 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:47  time: 0.1995  data_time: 0.0014  memory: 628  
09/20 16:45:25 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:21  time: 0.2011  data_time: 0.0014  memory: 16859  
09/20 16:45:35 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:55  time: 0.1970  data_time: 0.0015  memory: 1507  
09/20 16:45:52 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:32  time: 0.1982  data_time: 0.0013  memory: 16931  
09/20 16:46:08 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:09  time: 0.1956  data_time: 0.0016  memory: 16922  
09/20 16:46:23 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:47  time: 0.2041  data_time: 0.0015  memory: 16911  
09/20 16:46:36 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:24  time: 0.1986  data_time: 0.0016  memory: 16911  
09/20 16:46:46 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:02  time: 0.2030  data_time: 0.0016  memory: 578  
09/20 16:47:00 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:41  time: 0.2040  data_time: 0.0015  memory: 16935  
09/20 16:47:14 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:20  time: 0.1964  data_time: 0.0014  memory: 16916  
09/20 16:47:29 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1922  data_time: 0.0014  memory: 16864  
09/20 16:47:29 - mmengine - INFO - per class results:
09/20 16:47:29 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.96 | 88.45 |
|       building      | 78.81 | 91.83 |
|         sky         | 93.05 | 96.44 |
|        floor        | 76.26 |  88.3 |
|         tree        | 69.27 | 86.45 |
|       ceiling       | 80.74 | 90.29 |
|         road        | 78.48 | 86.11 |
|         bed         | 86.08 | 94.76 |
|      windowpane     | 57.87 | 75.81 |
|        grass        | 61.76 | 78.59 |
|       cabinet       | 54.11 | 65.35 |
|       sidewalk      | 59.45 | 75.19 |
|        person       | 75.04 | 87.21 |
|        earth        | 27.58 | 40.75 |
|         door        | 38.93 | 48.13 |
|        table        | 56.34 | 72.75 |
|       mountain      | 52.12 | 71.64 |
|        plant        | 46.35 |  59.1 |
|       curtain       | 66.96 |  79.3 |
|        chair        | 51.92 | 70.38 |
|         car         |  78.5 | 86.19 |
|        water        | 44.24 | 61.92 |
|       painting      | 64.92 |  81.9 |
|         sofa        | 59.68 | 76.67 |
|        shelf        | 36.61 | 52.01 |
|        house        | 39.89 | 44.22 |
|         sea         | 39.81 | 66.04 |
|        mirror       | 59.08 | 66.38 |
|         rug         |  49.3 |  57.7 |
|        field        | 19.75 | 26.12 |
|       armchair      | 39.58 | 54.74 |
|         seat        | 56.47 | 67.63 |
|        fence        | 31.94 | 44.42 |
|         desk        | 42.11 | 53.18 |
|         rock        | 29.31 |  40.4 |
|       wardrobe      | 40.88 |  56.0 |
|         lamp        | 59.57 |  72.3 |
|       bathtub       | 68.86 | 83.76 |
|       railing       | 28.19 | 48.03 |
|       cushion       | 47.45 | 56.73 |
|         base        | 19.93 | 31.97 |
|         box         | 15.76 | 20.92 |
|        column       |  45.5 | 58.33 |
|      signboard      | 32.67 | 46.82 |
|   chest of drawers  | 36.24 | 58.64 |
|       counter       | 24.61 | 34.86 |
|         sand        |  28.2 | 41.52 |
|         sink        | 59.76 | 77.47 |
|      skyscraper     | 32.25 | 39.09 |
|      fireplace      |  69.9 | 81.25 |
|     refrigerator    | 64.61 | 72.86 |
|      grandstand     | 35.94 | 61.39 |
|         path        | 15.63 | 20.45 |
|        stairs       | 29.59 | 34.21 |
|        runway       | 59.13 | 91.86 |
|         case        | 43.33 |  75.2 |
|      pool table     |  91.5 | 94.49 |
|        pillow       | 53.66 | 72.75 |
|     screen door     | 58.65 |  80.6 |
|       stairway      | 28.31 | 39.23 |
|        river        |  6.74 | 11.17 |
|        bridge       | 35.09 | 38.79 |
|       bookcase      | 37.24 | 46.38 |
|        blind        | 36.74 |  43.3 |
|     coffee table    |  56.3 |  72.8 |
|        toilet       | 76.71 | 90.99 |
|        flower       | 31.29 | 37.26 |
|         book        | 37.15 | 56.82 |
|         hill        |  3.23 |  4.84 |
|        bench        | 35.62 | 43.99 |
|      countertop     |  50.9 |  69.3 |
|        stove        | 65.81 | 70.24 |
|         palm        | 43.56 | 57.18 |
|    kitchen island   |  36.3 | 78.33 |
|       computer      | 50.94 |  71.0 |
|     swivel chair    | 37.35 | 49.52 |
|         boat        | 27.66 | 30.66 |
|         bar         | 21.87 | 24.91 |
|    arcade machine   | 12.35 | 14.21 |
|        hovel        | 16.51 | 16.95 |
|         bus         | 75.03 |  81.0 |
|        towel        | 40.71 |  64.8 |
|        light        | 49.95 | 58.63 |
|        truck        | 21.59 | 26.44 |
|        tower        | 30.72 | 43.38 |
|      chandelier     |  64.8 | 80.77 |
|        awning       |  9.29 |  9.87 |
|     streetlight     | 20.52 |  25.3 |
|        booth        | 55.44 | 58.33 |
| television receiver | 58.95 | 65.82 |
|       airplane      | 44.69 | 66.23 |
|      dirt track     |  4.04 |  9.32 |
|       apparel       | 25.01 | 33.37 |
|         pole        | 19.47 | 29.71 |
|         land        |  6.0  |  9.23 |
|      bannister      | 12.55 | 17.79 |
|      escalator      | 17.66 | 18.22 |
|       ottoman       | 43.67 | 52.83 |
|        bottle       | 12.45 | 19.94 |
|        buffet       | 36.09 | 47.11 |
|        poster       | 20.43 | 31.55 |
|        stage        |  5.48 |  6.18 |
|         van         | 38.07 | 54.53 |
|         ship        | 57.11 |  61.9 |
|       fountain      |  1.56 |  1.62 |
|    conveyer belt    | 66.99 | 79.45 |
|        canopy       | 18.19 | 19.32 |
|        washer       | 62.35 | 68.11 |
|      plaything      | 18.72 | 28.12 |
|    swimming pool    | 27.12 | 33.17 |
|        stool        | 36.53 | 46.97 |
|        barrel       | 42.61 | 58.03 |
|        basket       | 20.06 | 25.91 |
|      waterfall      | 56.47 | 81.86 |
|         tent        |  81.9 | 99.04 |
|         bag         |  5.02 |  5.78 |
|       minibike      | 46.21 | 51.67 |
|        cradle       | 69.89 | 97.92 |
|         oven        | 17.96 | 39.15 |
|         ball        | 39.41 | 65.16 |
|         food        | 23.15 | 24.66 |
|         step        |  2.47 |  2.85 |
|         tank        | 37.76 | 38.96 |
|      trade name     | 19.13 | 20.94 |
|      microwave      | 41.22 | 44.72 |
|         pot         |  31.4 | 35.52 |
|        animal       | 43.91 | 45.58 |
|       bicycle       | 36.81 | 58.14 |
|         lake        |  61.8 | 62.93 |
|      dishwasher     | 63.35 | 72.36 |
|        screen       | 49.27 | 60.72 |
|       blanket       |  4.04 |  4.81 |
|      sculpture      | 34.16 | 46.62 |
|         hood        | 59.01 | 63.75 |
|        sconce       | 34.95 | 39.46 |
|         vase        | 31.41 | 45.31 |
|    traffic light    | 16.22 | 19.41 |
|         tray        |  3.93 |  4.43 |
|        ashcan       | 32.12 |  40.5 |
|         fan         | 52.55 | 64.83 |
|         pier        | 42.71 | 46.73 |
|      crt screen     |  0.11 |  0.17 |
|        plate        | 32.71 | 41.02 |
|       monitor       | 53.31 |  69.2 |
|    bulletin board   | 30.73 | 45.44 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 40.34 | 50.32 |
|        glass        |  9.57 | 10.95 |
|        clock        | 19.52 | 21.99 |
|         flag        | 24.37 | 26.78 |
+---------------------+-------+-------+
09/20 16:47:29 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.3900  mIoU: 40.6500  mAcc: 51.2600  data_time: 0.0017  time: 0.4087
Finished processing corruption type: fog
Processing corruption type: brightness
09/20 16:47:33 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 743388015
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 743388015
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 16:47:33 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='brightness',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/brightness'

09/20 16:47:37 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 16:47:37 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 16:47:37 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 16:47:38 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 16:49:01 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:54:08  time: 0.9454  data_time: 0.0016  memory: 17152  
09/20 16:49:48 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:41:20  time: 1.0722  data_time: 0.0016  memory: 16931  
09/20 16:50:16 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:32:31  time: 0.5825  data_time: 0.0015  memory: 16924  
09/20 16:50:54 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:29:25  time: 0.6801  data_time: 0.0015  memory: 16933  
09/20 16:51:29 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:56  time: 0.4891  data_time: 0.0015  memory: 16932  
09/20 16:51:58 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:24:36  time: 0.2269  data_time: 0.0016  memory: 16928  
09/20 16:52:34 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:23:17  time: 0.5338  data_time: 0.0015  memory: 16932  
09/20 16:53:04 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:43  time: 0.6148  data_time: 0.0014  memory: 16929  
09/20 16:53:18 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:19:32  time: 0.3355  data_time: 0.0015  memory: 16854  
09/20 16:53:35 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:17:51  time: 0.2141  data_time: 0.0015  memory: 16912  
09/20 16:53:54 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:16:31  time: 0.6064  data_time: 0.0016  memory: 16932  
09/20 16:54:08 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:15:10  time: 0.4053  data_time: 0.0016  memory: 16860  
09/20 16:54:31 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:14:18  time: 0.6104  data_time: 0.0014  memory: 16934  
09/20 16:54:58 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:13:37  time: 0.2240  data_time: 0.0016  memory: 16934  
09/20 16:55:25 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:58  time: 1.0170  data_time: 0.0015  memory: 16937  
09/20 16:55:38 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:12:01  time: 0.2192  data_time: 0.0016  memory: 16925  
09/20 16:55:50 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:11:05  time: 0.2244  data_time: 0.0016  memory: 628  
09/20 16:56:03 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:10:18  time: 0.3210  data_time: 0.0014  memory: 16850  
09/20 16:56:28 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:09:46  time: 0.4623  data_time: 0.0015  memory: 16932  
09/20 16:56:45 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:09:07  time: 0.2068  data_time: 0.0015  memory: 16908  
09/20 16:57:07 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:08:35  time: 0.7475  data_time: 0.0015  memory: 16935  
09/20 16:57:26 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:01  time: 0.2111  data_time: 0.0016  memory: 16921  
09/20 16:57:41 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:25  time: 0.3439  data_time: 0.0015  memory: 16913  
09/20 16:57:52 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:49  time: 0.2120  data_time: 0.0014  memory: 1824  
09/20 16:58:08 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:17  time: 0.3358  data_time: 0.0014  memory: 16925  
09/20 16:58:18 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:44  time: 0.2123  data_time: 0.0015  memory: 1463  
09/20 16:58:31 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:14  time: 0.1988  data_time: 0.0027  memory: 16910  
09/20 16:58:55 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:50  time: 0.5778  data_time: 0.0015  memory: 16928  
09/20 16:59:09 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:22  time: 0.5111  data_time: 0.0014  memory: 16917  
09/20 16:59:20 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:54  time: 0.2019  data_time: 0.0014  memory: 628  
09/20 16:59:33 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:27  time: 0.2234  data_time: 0.0015  memory: 16859  
09/20 16:59:44 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:01  time: 0.2135  data_time: 0.0015  memory: 1507  
09/20 17:00:01 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:37  time: 0.1982  data_time: 0.0014  memory: 16931  
09/20 17:00:18 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:14  time: 0.2106  data_time: 0.0016  memory: 16922  
09/20 17:00:34 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:50  time: 0.2256  data_time: 0.0014  memory: 16911  
09/20 17:00:48 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:27  time: 0.2141  data_time: 0.0016  memory: 16911  
09/20 17:00:58 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:04  time: 0.2150  data_time: 0.0016  memory: 578  
09/20 17:01:12 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:42  time: 0.2134  data_time: 0.0014  memory: 16935  
09/20 17:01:27 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:21  time: 0.2068  data_time: 0.0014  memory: 16916  
09/20 17:01:42 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1908  data_time: 0.0013  memory: 16864  
09/20 17:01:42 - mmengine - INFO - per class results:
09/20 17:01:42 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.19 | 88.18 |
|       building      | 81.18 | 93.02 |
|         sky         | 93.62 |  97.2 |
|        floor        |  78.0 | 89.99 |
|         tree        | 72.45 |  86.1 |
|       ceiling       | 81.88 |  90.3 |
|         road        | 80.75 | 88.23 |
|         bed         | 86.79 | 94.83 |
|      windowpane     | 58.13 | 74.75 |
|        grass        | 65.03 | 83.47 |
|       cabinet       | 56.44 | 69.24 |
|       sidewalk      |  63.6 | 78.59 |
|        person       | 75.95 | 89.11 |
|        earth        | 30.75 | 43.64 |
|         door        | 44.03 | 57.75 |
|        table        | 58.23 | 73.76 |
|       mountain      | 51.39 | 69.22 |
|        plant        | 50.05 | 65.16 |
|       curtain       | 67.77 | 79.68 |
|        chair        | 53.94 | 69.87 |
|         car         | 80.84 | 88.56 |
|        water        |  44.9 | 59.35 |
|       painting      | 69.53 | 84.03 |
|         sofa        | 60.85 | 79.43 |
|        shelf        | 38.56 | 54.27 |
|        house        | 42.97 | 48.85 |
|         sea         | 42.88 | 70.62 |
|        mirror       | 60.74 | 69.46 |
|         rug         | 56.87 | 64.26 |
|        field        | 24.94 | 38.61 |
|       armchair      | 39.52 |  56.1 |
|         seat        | 57.33 | 72.27 |
|        fence        |  34.6 | 45.84 |
|         desk        | 46.07 | 60.44 |
|         rock        | 29.14 | 42.05 |
|       wardrobe      | 44.88 | 61.83 |
|         lamp        | 59.84 | 72.24 |
|       bathtub       | 71.91 | 78.15 |
|       railing       | 28.92 | 44.42 |
|       cushion       | 50.76 | 63.02 |
|         base        |  21.9 | 31.13 |
|         box         | 20.54 | 27.74 |
|        column       | 43.84 | 54.79 |
|      signboard      | 34.21 |  47.6 |
|   chest of drawers  | 37.78 | 58.89 |
|       counter       | 26.58 | 32.86 |
|         sand        | 32.38 | 48.04 |
|         sink        | 64.21 | 77.67 |
|      skyscraper     |  64.7 | 74.62 |
|      fireplace      | 68.94 | 83.94 |
|     refrigerator    |  69.3 |  80.0 |
|      grandstand     | 35.49 | 64.06 |
|         path        | 14.67 | 19.22 |
|        stairs       | 30.15 | 35.16 |
|        runway       | 61.91 | 82.81 |
|         case        |  48.4 | 71.25 |
|      pool table     | 91.46 | 95.21 |
|        pillow       | 53.57 |  66.9 |
|     screen door     | 64.53 | 77.55 |
|       stairway      | 30.75 | 41.28 |
|        river        | 10.94 | 20.41 |
|        bridge       | 44.34 | 48.22 |
|       bookcase      | 37.26 | 45.16 |
|        blind        | 38.82 | 45.45 |
|     coffee table    | 57.16 | 75.18 |
|        toilet       | 81.06 |  90.2 |
|        flower       | 33.54 | 48.23 |
|         book        | 43.03 |  65.4 |
|         hill        |  5.04 |  7.51 |
|        bench        | 37.57 | 48.03 |
|      countertop     | 51.86 | 67.03 |
|        stove        | 70.48 | 78.51 |
|         palm        | 49.37 | 68.52 |
|    kitchen island   | 40.35 | 76.55 |
|       computer      | 55.12 | 67.54 |
|     swivel chair    | 42.92 | 58.84 |
|         boat        |  42.5 |  48.8 |
|         bar         |  24.5 | 28.94 |
|    arcade machine   | 34.53 | 42.49 |
|        hovel        | 34.83 | 37.77 |
|         bus         | 76.71 | 86.86 |
|        towel        | 50.29 | 62.98 |
|        light        | 50.36 | 58.88 |
|        truck        | 24.36 | 32.67 |
|        tower        | 27.99 | 37.02 |
|      chandelier     | 64.03 | 81.27 |
|        awning       | 22.01 | 24.82 |
|     streetlight     | 21.38 | 26.16 |
|        booth        | 42.86 | 46.66 |
| television receiver | 66.98 | 75.35 |
|       airplane      | 52.15 | 69.76 |
|      dirt track     |  3.39 | 10.31 |
|       apparel       | 26.03 | 35.34 |
|         pole        | 22.36 | 31.37 |
|         land        |  0.66 |  0.98 |
|      bannister      |  6.87 |  8.37 |
|      escalator      | 20.48 |  21.6 |
|       ottoman       | 37.54 | 47.81 |
|        bottle       | 13.12 | 20.78 |
|        buffet       |  35.0 | 45.09 |
|        poster       | 24.61 | 31.56 |
|        stage        |  6.32 |  8.47 |
|         van         | 38.45 | 50.11 |
|         ship        | 75.28 | 82.85 |
|       fountain      |  0.55 |  0.55 |
|    conveyer belt    | 68.79 |  89.9 |
|        canopy       | 12.01 | 13.35 |
|        washer       |  62.6 | 65.67 |
|      plaything      | 22.28 | 34.85 |
|    swimming pool    | 38.04 | 47.16 |
|        stool        | 37.71 | 48.02 |
|        barrel       | 36.71 | 64.31 |
|        basket       | 23.66 | 33.07 |
|      waterfall      | 61.52 | 83.04 |
|         tent        | 93.07 | 97.95 |
|         bag         |  5.56 |  6.35 |
|       minibike      | 48.44 | 55.73 |
|        cradle       | 74.17 | 97.04 |
|         oven        | 21.09 | 48.78 |
|         ball        | 37.23 | 66.53 |
|         food        | 51.61 | 64.48 |
|         step        |  1.91 |  2.12 |
|         tank        | 43.99 | 44.92 |
|      trade name     | 23.32 | 26.49 |
|      microwave      | 37.02 | 40.19 |
|         pot         | 36.49 | 41.78 |
|        animal       | 41.76 | 42.77 |
|       bicycle       | 42.53 | 66.72 |
|         lake        | 60.64 | 63.08 |
|      dishwasher     | 67.78 | 70.86 |
|        screen       | 56.71 | 66.12 |
|       blanket       |  5.51 |  6.27 |
|      sculpture      | 40.67 | 59.35 |
|         hood        | 57.94 | 66.27 |
|        sconce       | 35.69 | 41.98 |
|         vase        | 31.77 | 45.98 |
|    traffic light    | 22.84 | 28.74 |
|         tray        |  4.95 |  6.52 |
|        ashcan       | 36.09 | 46.05 |
|         fan         | 54.01 | 65.29 |
|         pier        | 33.87 | 40.93 |
|      crt screen     |  2.72 |  4.15 |
|        plate        | 40.85 | 54.98 |
|       monitor       | 59.38 | 68.06 |
|    bulletin board   | 33.89 | 46.62 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 37.76 | 43.91 |
|        glass        |  9.61 | 10.37 |
|        clock        | 20.29 | 24.19 |
|         flag        | 36.07 | 40.47 |
+---------------------+-------+-------+
09/20 17:01:42 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.8400  mIoU: 43.6100  mAcc: 54.3600  data_time: 0.0016  time: 0.4220
Finished processing corruption type: brightness
Processing corruption type: contrast
09/20 17:01:45 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 312337646
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 312337646
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 17:01:46 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='contrast',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/contrast'

09/20 17:01:50 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 17:01:50 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 17:01:50 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 17:01:50 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 17:03:04 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:47:55  time: 0.7969  data_time: 0.0015  memory: 17152  
09/20 17:03:44 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:35:51  time: 0.9199  data_time: 0.0016  memory: 16931  
09/20 17:04:04 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:27:27  time: 0.4298  data_time: 0.0015  memory: 16924  
09/20 17:04:35 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:24:39  time: 0.5466  data_time: 0.0015  memory: 16933  
09/20 17:05:03 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:22:30  time: 0.3504  data_time: 0.0015  memory: 16932  
09/20 17:05:27 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:25  time: 0.0796  data_time: 0.0016  memory: 16928  
09/20 17:05:55 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:14  time: 0.3987  data_time: 0.0015  memory: 16932  
09/20 17:06:18 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:17:48  time: 0.4669  data_time: 0.0014  memory: 16929  
09/20 17:06:26 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:15:47  time: 0.2065  data_time: 0.0014  memory: 16854  
09/20 17:06:35 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:14:14  time: 0.0740  data_time: 0.0015  memory: 16912  
09/20 17:06:47 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:13:01  time: 0.4588  data_time: 0.0015  memory: 16932  
09/20 17:06:54 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:48  time: 0.2571  data_time: 0.0016  memory: 16860  
09/20 17:07:10 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:03  time: 0.4720  data_time: 0.0013  memory: 16934  
09/20 17:07:29 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:29  time: 0.0808  data_time: 0.0015  memory: 16934  
09/20 17:07:49 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:09:58  time: 0.9065  data_time: 0.0014  memory: 16937  
09/20 17:07:56 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:09:08  time: 0.0699  data_time: 0.0016  memory: 16925  
09/20 17:08:00 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:19  time: 0.0713  data_time: 0.0016  memory: 628  
09/20 17:08:07 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:40  time: 0.1923  data_time: 0.0014  memory: 16850  
09/20 17:08:25 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:15  time: 0.3246  data_time: 0.0015  memory: 16932  
09/20 17:08:35 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:44  time: 0.0672  data_time: 0.0014  memory: 16908  
09/20 17:08:49 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:18  time: 0.5998  data_time: 0.0015  memory: 16935  
09/20 17:09:01 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:52  time: 0.0732  data_time: 0.0016  memory: 16921  
09/20 17:09:09 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:24  time: 0.1990  data_time: 0.0014  memory: 16913  
09/20 17:09:13 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:55  time: 0.0719  data_time: 0.0015  memory: 1824  
09/20 17:09:22 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:30  time: 0.2042  data_time: 0.0014  memory: 16925  
09/20 17:09:25 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:04  time: 0.0698  data_time: 0.0014  memory: 1463  
09/20 17:09:32 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:42  time: 0.0669  data_time: 0.0014  memory: 16910  
09/20 17:09:49 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:24  time: 0.4264  data_time: 0.0014  memory: 16928  
09/20 17:09:56 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:04  time: 0.3637  data_time: 0.0014  memory: 16917  
09/20 17:10:00 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:43  time: 0.0650  data_time: 0.0014  memory: 628  
09/20 17:10:05 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:23  time: 0.0731  data_time: 0.0014  memory: 16859  
09/20 17:10:09 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:04  time: 0.0688  data_time: 0.0015  memory: 1507  
09/20 17:10:19 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:47  time: 0.0641  data_time: 0.0014  memory: 16931  
09/20 17:10:29 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:31  time: 0.0708  data_time: 0.0016  memory: 16922  
09/20 17:10:38 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:15  time: 0.0746  data_time: 0.0014  memory: 16911  
09/20 17:10:44 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:59  time: 0.0714  data_time: 0.0016  memory: 16911  
09/20 17:10:48 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:43  time: 0.0707  data_time: 0.0016  memory: 578  
09/20 17:10:55 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:28  time: 0.0754  data_time: 0.0014  memory: 16935  
09/20 17:11:03 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.0678  data_time: 0.0014  memory: 16916  
09/20 17:11:11 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0653  data_time: 0.0013  memory: 16864  
09/20 17:11:11 - mmengine - INFO - per class results:
09/20 17:11:11 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.44 | 88.94 |
|       building      | 79.42 |  91.8 |
|         sky         | 93.14 | 96.51 |
|        floor        | 76.42 | 88.43 |
|         tree        | 69.07 | 86.07 |
|       ceiling       | 80.96 | 90.21 |
|         road        |  79.0 |  86.2 |
|         bed         | 85.93 | 94.78 |
|      windowpane     | 57.07 |  73.0 |
|        grass        | 61.42 | 80.15 |
|       cabinet       | 54.39 | 65.83 |
|       sidewalk      | 59.08 | 74.49 |
|        person       | 74.76 | 86.21 |
|        earth        | 29.34 | 44.95 |
|         door        | 40.09 | 49.53 |
|        table        | 55.48 | 72.06 |
|       mountain      | 48.73 | 68.34 |
|        plant        | 46.08 | 55.84 |
|       curtain       |  67.8 | 79.23 |
|        chair        | 51.62 | 69.78 |
|         car         | 79.91 | 86.75 |
|        water        | 45.55 | 66.45 |
|       painting      | 64.41 | 81.59 |
|         sofa        |  60.3 | 76.96 |
|        shelf        | 36.42 | 50.86 |
|        house        | 40.53 |  46.5 |
|         sea         | 41.99 | 65.62 |
|        mirror       | 58.11 | 65.81 |
|         rug         |  48.4 | 56.47 |
|        field        | 20.46 | 28.62 |
|       armchair      | 40.73 | 57.23 |
|         seat        | 49.66 | 60.23 |
|        fence        | 32.19 | 43.79 |
|         desk        | 40.73 | 50.81 |
|         rock        | 27.99 |  34.2 |
|       wardrobe      |  37.7 | 52.08 |
|         lamp        | 59.11 | 72.04 |
|       bathtub       | 66.08 | 85.33 |
|       railing       |  29.0 | 48.19 |
|       cushion       | 46.68 | 55.92 |
|         base        | 19.94 | 32.15 |
|         box         | 16.22 |  21.5 |
|        column       | 42.91 | 54.46 |
|      signboard      | 33.15 | 46.67 |
|   chest of drawers  | 35.35 | 59.41 |
|       counter       | 22.77 | 36.59 |
|         sand        |  27.1 | 36.33 |
|         sink        | 59.56 |  76.3 |
|      skyscraper     | 53.83 | 67.25 |
|      fireplace      | 69.54 | 82.36 |
|     refrigerator    | 65.22 | 74.68 |
|      grandstand     | 28.88 | 55.12 |
|         path        | 15.34 | 20.42 |
|        stairs       | 28.69 | 32.42 |
|        runway       | 60.29 | 92.04 |
|         case        | 39.18 | 74.93 |
|      pool table     | 91.64 | 94.82 |
|        pillow       | 53.04 | 71.41 |
|     screen door     | 60.92 | 77.97 |
|       stairway      | 30.21 |  40.5 |
|        river        |  4.56 |  7.16 |
|        bridge       |  30.0 | 33.02 |
|       bookcase      | 37.36 | 45.21 |
|        blind        | 39.58 | 46.88 |
|     coffee table    | 56.04 | 73.69 |
|        toilet       | 78.42 | 90.44 |
|        flower       | 31.76 | 37.53 |
|         book        | 36.68 | 52.83 |
|         hill        |  3.04 |  4.04 |
|        bench        | 37.97 | 48.76 |
|      countertop     |  48.9 | 67.85 |
|        stove        | 64.05 | 67.94 |
|         palm        | 43.19 | 54.34 |
|    kitchen island   | 37.23 | 79.19 |
|       computer      | 52.58 | 68.53 |
|     swivel chair    | 36.12 | 47.16 |
|         boat        | 29.38 | 32.92 |
|         bar         |  16.7 | 18.71 |
|    arcade machine   | 11.78 | 13.19 |
|        hovel        |  7.88 |  8.68 |
|         bus         | 75.75 | 82.14 |
|        towel        |  41.3 | 62.59 |
|        light        | 45.21 | 50.32 |
|        truck        | 13.11 | 16.93 |
|        tower        | 25.51 | 35.79 |
|      chandelier     | 64.77 |  79.1 |
|        awning       | 15.61 | 16.49 |
|     streetlight     | 20.69 | 25.44 |
|        booth        | 51.39 | 53.73 |
| television receiver | 54.69 | 60.04 |
|       airplane      | 50.71 | 72.29 |
|      dirt track     |  2.81 |  6.87 |
|       apparel       | 25.25 | 30.35 |
|         pole        | 20.03 | 29.84 |
|         land        |  6.7  |  9.84 |
|      bannister      | 10.23 | 13.32 |
|      escalator      | 13.82 | 14.05 |
|       ottoman       | 42.82 |  51.6 |
|        bottle       | 11.62 |  17.5 |
|        buffet       |  36.5 | 48.99 |
|        poster       |  19.4 |  28.4 |
|        stage        |  6.66 |  7.52 |
|         van         | 39.85 |  55.5 |
|         ship        | 48.95 | 52.72 |
|       fountain      |  0.88 |  0.89 |
|    conveyer belt    | 62.54 | 80.29 |
|        canopy       | 12.67 | 13.31 |
|        washer       | 60.25 | 64.77 |
|      plaything      | 18.18 | 29.02 |
|    swimming pool    | 28.58 | 34.92 |
|        stool        | 34.63 | 43.53 |
|        barrel       | 51.08 | 60.92 |
|        basket       | 20.94 |  28.1 |
|      waterfall      |  38.5 | 49.92 |
|         tent        | 82.82 | 98.58 |
|         bag         |  4.05 |  4.59 |
|       minibike      | 45.85 | 50.49 |
|        cradle       | 67.66 | 97.87 |
|         oven        | 28.75 | 43.57 |
|         ball        | 37.49 | 65.93 |
|         food        | 23.73 | 26.07 |
|         step        |  1.92 |  2.22 |
|         tank        | 35.93 | 36.61 |
|      trade name     | 18.64 | 20.16 |
|      microwave      |  45.7 | 49.26 |
|         pot         | 28.66 | 31.82 |
|        animal       | 43.52 | 45.17 |
|       bicycle       | 37.37 | 58.18 |
|         lake        | 62.33 | 63.72 |
|      dishwasher     |  61.3 | 67.33 |
|        screen       | 51.25 | 60.53 |
|       blanket       |  5.07 |  6.05 |
|      sculpture      | 36.28 | 48.97 |
|         hood        | 59.08 | 64.78 |
|        sconce       | 32.31 | 35.78 |
|         vase        | 29.93 | 44.86 |
|    traffic light    | 15.63 | 18.68 |
|         tray        |  3.37 |  3.81 |
|        ashcan       | 33.05 | 40.28 |
|         fan         | 52.95 | 64.04 |
|         pier        | 37.77 | 41.73 |
|      crt screen     |  0.0  |  0.01 |
|        plate        | 30.21 | 37.56 |
|       monitor       | 57.25 | 69.64 |
|    bulletin board   | 25.15 | 41.74 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 42.17 | 51.63 |
|        glass        |  8.94 | 10.05 |
|        clock        | 17.59 | 19.78 |
|         flag        | 23.46 | 25.26 |
+---------------------+-------+-------+
09/20 17:11:11 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.3500  mIoU: 40.1600  mAcc: 50.3100  data_time: 0.0016  time: 0.2801
Finished processing corruption type: contrast
Processing corruption type: elastic_transform
09/20 17:11:14 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1968134474
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1968134474
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 17:11:15 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/elastic_transform'

09/20 17:11:19 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 17:11:19 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 17:11:19 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 17:11:19 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 17:13:23 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:20:37  time: 1.7965  data_time: 0.0016  memory: 17152  
09/20 17:14:51 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:06:50  time: 1.8925  data_time: 0.0016  memory: 16931  
09/20 17:15:58 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:57:17  time: 1.3935  data_time: 0.0016  memory: 16924  
09/20 17:17:17 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:53:34  time: 1.4699  data_time: 0.0015  memory: 16933  
09/20 17:18:30 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:50:11  time: 1.2641  data_time: 0.0015  memory: 16932  
09/20 17:19:37 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:46:59  time: 1.0266  data_time: 0.0016  memory: 16928  
09/20 17:20:52 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:44:57  time: 1.2817  data_time: 0.0015  memory: 16932  
09/20 17:22:00 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:42:43  time: 1.4229  data_time: 0.0014  memory: 16929  
09/20 17:22:50 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:39:38  time: 1.0560  data_time: 0.0015  memory: 16854  
09/20 17:23:45 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:37:17  time: 0.9581  data_time: 0.0015  memory: 16912  
09/20 17:24:46 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:35:25  time: 1.4333  data_time: 0.0016  memory: 16932  
09/20 17:25:38 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:33:24  time: 1.2049  data_time: 0.0016  memory: 16860  
09/20 17:26:40 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:31:51  time: 1.3887  data_time: 0.0015  memory: 16934  
09/20 17:27:47 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:30:34  time: 1.0466  data_time: 0.0016  memory: 16934  
09/20 17:28:54 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:29:17  time: 1.7769  data_time: 0.0015  memory: 16937  
09/20 17:29:44 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:27:37  time: 1.0087  data_time: 0.0017  memory: 16925  
09/20 17:30:35 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:26:03  time: 1.0199  data_time: 0.0017  memory: 628  
09/20 17:31:25 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:24:33  time: 1.0093  data_time: 0.0015  memory: 16850  
09/20 17:32:29 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:23:23  time: 1.2211  data_time: 0.0015  memory: 16932  
09/20 17:33:23 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:22:03  time: 0.9624  data_time: 0.0016  memory: 16908  
09/20 17:34:26 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:20:54  time: 1.5657  data_time: 0.0016  memory: 16935  
09/20 17:35:24 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:19:41  time: 0.9792  data_time: 0.0020  memory: 16921  
09/20 17:36:17 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:18:26  time: 1.1227  data_time: 0.0015  memory: 16913  
09/20 17:37:08 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:17:12  time: 0.9712  data_time: 0.0015  memory: 1824  
09/20 17:38:01 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:16:00  time: 1.0960  data_time: 0.0015  memory: 16925  
09/20 17:38:48 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:14:47  time: 1.0054  data_time: 0.0015  memory: 1463  
09/20 17:39:40 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:13:38  time: 0.9295  data_time: 0.0015  memory: 16910  
09/20 17:40:42 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:12:35  time: 1.3967  data_time: 0.0015  memory: 16928  
09/20 17:41:34 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:11:28  time: 1.3210  data_time: 0.0015  memory: 16917  
09/20 17:42:22 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:10:20  time: 0.9250  data_time: 0.0016  memory: 628  
09/20 17:43:17 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:09:16  time: 1.1405  data_time: 0.0237  memory: 16859  
09/20 17:44:05 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:08:11  time: 0.9795  data_time: 0.0016  memory: 1507  
09/20 17:45:00 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:08  time: 0.9050  data_time: 0.0014  memory: 16931  
09/20 17:45:56 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:06  time: 0.9899  data_time: 0.0016  memory: 16922  
09/20 17:46:51 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:05:04  time: 0.9823  data_time: 0.0014  memory: 16911  
09/20 17:47:41 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:04:02  time: 1.0081  data_time: 0.0017  memory: 16911  
09/20 17:48:32 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:03:00  time: 1.0026  data_time: 0.0017  memory: 578  
09/20 17:49:22 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:02:00  time: 0.9628  data_time: 0.0015  memory: 16935  
09/20 17:50:16 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:59  time: 0.9597  data_time: 0.0015  memory: 16916  
09/20 17:51:07 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.8953  data_time: 0.0014  memory: 16864  
09/20 17:51:07 - mmengine - INFO - per class results:
09/20 17:51:07 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 61.57 | 78.52 |
|       building      | 72.57 | 88.37 |
|         sky         | 83.54 | 91.63 |
|        floor        | 66.11 | 81.32 |
|         tree        | 62.11 | 78.09 |
|       ceiling       | 67.95 | 81.76 |
|         road        | 73.79 | 84.31 |
|         bed         | 76.19 | 88.14 |
|      windowpane     | 47.55 | 66.04 |
|        grass        | 58.65 | 76.55 |
|       cabinet       | 46.51 | 60.55 |
|       sidewalk      | 50.55 | 68.03 |
|        person       | 57.42 | 75.84 |
|        earth        | 28.28 | 40.62 |
|         door        |  35.0 | 45.62 |
|        table        | 43.43 | 62.27 |
|       mountain      | 43.54 | 59.06 |
|        plant        |  42.1 |  56.4 |
|       curtain       | 51.02 | 68.45 |
|        chair        | 39.36 | 56.52 |
|         car         | 59.78 | 73.56 |
|        water        | 43.34 | 57.11 |
|       painting      | 45.16 | 63.63 |
|         sofa        | 48.24 | 68.32 |
|        shelf        | 33.15 | 48.97 |
|        house        | 30.11 | 35.18 |
|         sea         | 39.42 | 67.16 |
|        mirror       |  51.1 | 61.47 |
|         rug         | 40.52 | 52.08 |
|        field        | 23.34 | 37.91 |
|       armchair      | 30.11 | 42.96 |
|         seat        | 52.58 | 71.55 |
|        fence        | 25.62 | 35.97 |
|         desk        | 35.03 | 50.24 |
|         rock        |  29.0 | 46.66 |
|       wardrobe      | 39.99 | 57.46 |
|         lamp        | 30.52 | 45.99 |
|       bathtub       | 60.65 | 68.92 |
|       railing       | 21.84 | 36.82 |
|       cushion       | 34.91 |  47.3 |
|         base        | 18.81 | 29.15 |
|         box         | 15.12 | 20.31 |
|        column       | 27.86 | 41.21 |
|      signboard      | 20.48 | 30.94 |
|   chest of drawers  | 33.29 | 51.03 |
|       counter       | 21.98 | 25.89 |
|         sand        | 26.03 | 42.96 |
|         sink        |  46.6 | 64.84 |
|      skyscraper     | 41.91 | 49.85 |
|      fireplace      | 56.56 | 74.37 |
|     refrigerator    | 55.06 | 69.33 |
|      grandstand     |  32.3 |  65.4 |
|         path        | 12.29 | 17.13 |
|        stairs       | 26.16 | 31.85 |
|        runway       | 59.74 | 82.98 |
|         case        | 46.91 |  67.2 |
|      pool table     | 79.55 | 89.28 |
|        pillow       | 38.31 | 52.66 |
|     screen door     | 56.02 | 75.44 |
|       stairway      | 23.14 | 31.86 |
|        river        |  9.39 | 16.28 |
|        bridge       | 44.46 | 54.51 |
|       bookcase      | 24.53 | 35.62 |
|        blind        | 31.53 | 36.79 |
|     coffee table    | 44.94 | 63.38 |
|        toilet       | 61.87 |  75.8 |
|        flower       | 24.62 | 39.21 |
|         book        | 29.74 | 46.97 |
|         hill        |  3.92 |  6.14 |
|        bench        | 35.05 |  46.9 |
|      countertop     | 41.13 | 54.69 |
|        stove        | 57.73 | 70.41 |
|         palm        | 37.31 | 56.67 |
|    kitchen island   | 32.12 | 65.99 |
|       computer      | 42.06 | 57.28 |
|     swivel chair    | 35.24 |  53.4 |
|         boat        | 41.78 | 62.68 |
|         bar         | 24.14 | 30.26 |
|    arcade machine   | 21.59 | 26.89 |
|        hovel        | 18.73 | 19.84 |
|         bus         | 61.68 | 77.83 |
|        towel        | 33.15 | 47.46 |
|        light        | 13.84 | 21.86 |
|        truck        | 20.88 | 31.56 |
|        tower        | 14.49 | 19.97 |
|      chandelier     | 46.78 | 65.85 |
|        awning       |  13.3 | 16.29 |
|     streetlight     |  8.16 | 12.13 |
|        booth        | 33.53 | 37.04 |
| television receiver | 45.13 | 60.26 |
|       airplane      | 32.48 |  49.6 |
|      dirt track     |  2.66 |  8.07 |
|       apparel       | 19.89 | 29.43 |
|         pole        |  6.13 |  9.25 |
|         land        |  0.11 |  0.16 |
|      bannister      |  2.08 |  2.6  |
|      escalator      | 21.24 | 22.26 |
|       ottoman       | 30.47 | 42.27 |
|        bottle       |  6.19 | 11.19 |
|        buffet       | 36.85 | 46.28 |
|        poster       | 21.01 | 28.74 |
|        stage        |  5.86 |  8.24 |
|         van         | 34.86 | 45.76 |
|         ship        | 70.53 |  79.5 |
|       fountain      |  2.35 |  2.39 |
|    conveyer belt    | 38.15 | 74.46 |
|        canopy       | 16.47 |  19.5 |
|        washer       | 56.15 | 59.13 |
|      plaything      | 17.67 | 29.08 |
|    swimming pool    | 28.74 | 35.81 |
|        stool        | 22.67 | 31.38 |
|        barrel       | 34.33 | 65.72 |
|        basket       | 16.59 | 21.59 |
|      waterfall      | 47.12 | 78.44 |
|         tent        | 79.62 |  94.6 |
|         bag         |  4.14 |  4.77 |
|       minibike      | 44.55 | 55.61 |
|        cradle       | 62.42 | 85.23 |
|         oven        | 15.72 | 28.88 |
|         ball        | 35.38 | 62.77 |
|         food        | 45.22 | 63.21 |
|         step        |  1.07 |  1.16 |
|         tank        | 38.95 | 42.05 |
|      trade name     | 13.62 | 16.32 |
|      microwave      |  29.7 | 34.63 |
|         pot         | 21.89 | 28.31 |
|        animal       | 41.84 | 46.07 |
|       bicycle       | 31.95 | 51.99 |
|         lake        | 48.23 | 63.36 |
|      dishwasher     | 47.79 | 55.74 |
|        screen       | 42.85 | 58.76 |
|       blanket       |  5.38 |  6.29 |
|      sculpture      | 33.48 | 47.88 |
|         hood        | 37.18 | 54.36 |
|        sconce       | 18.41 | 25.57 |
|         vase        |  14.7 | 26.71 |
|    traffic light    | 11.82 | 16.92 |
|         tray        |  2.33 |  3.18 |
|        ashcan       | 23.75 | 37.25 |
|         fan         | 26.36 | 37.82 |
|         pier        | 24.79 | 31.84 |
|      crt screen     |  0.65 |  1.06 |
|        plate        | 29.21 | 45.17 |
|       monitor       | 48.99 | 58.48 |
|    bulletin board   | 21.24 | 30.44 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 28.46 | 36.03 |
|        glass        |  4.93 |  5.43 |
|        clock        |  9.13 | 12.47 |
|         flag        | 26.61 | 32.09 |
+---------------------+-------+-------+
09/20 17:51:07 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 72.8600  mIoU: 34.1000  mAcc: 46.0300  data_time: 0.0019  time: 1.1938
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
09/20 17:51:30 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 482247261
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 482247261
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 17:51:30 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/pixelate'

09/20 17:51:41 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 17:51:42 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 17:51:42 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 17:51:42 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 17:52:54 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:46:48  time: 0.7192  data_time: 0.0015  memory: 17152  
09/20 17:53:33 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:34:52  time: 0.8916  data_time: 0.0016  memory: 16931  
09/20 17:53:52 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:26:43  time: 0.4207  data_time: 0.0016  memory: 16924  
09/20 17:54:23 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:24:01  time: 0.5377  data_time: 0.0016  memory: 16933  
09/20 17:54:51 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:21:57  time: 0.3402  data_time: 0.0015  memory: 16932  
09/20 17:55:14 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:19:56  time: 0.0689  data_time: 0.0017  memory: 16928  
09/20 17:55:41 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:18:45  time: 0.3461  data_time: 0.0015  memory: 16932  
09/20 17:56:03 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:17:22  time: 0.4561  data_time: 0.0014  memory: 16929  
09/20 17:56:11 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:15:24  time: 0.1977  data_time: 0.0028  memory: 16854  
09/20 17:56:20 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:13:52  time: 0.0628  data_time: 0.0014  memory: 16912  
09/20 17:56:31 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:12:40  time: 0.4491  data_time: 0.0016  memory: 16932  
09/20 17:56:38 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:28  time: 0.2467  data_time: 0.0016  memory: 16860  
09/20 17:56:53 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:10:45  time: 0.4621  data_time: 0.0014  memory: 16934  
09/20 17:57:12 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:11  time: 0.0706  data_time: 0.0016  memory: 16934  
09/20 17:57:31 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:09:41  time: 0.8956  data_time: 0.0015  memory: 16937  
09/20 17:57:38 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:08:52  time: 0.0594  data_time: 0.0015  memory: 16925  
09/20 17:57:41 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:04  time: 0.0609  data_time: 0.0016  memory: 628  
09/20 17:57:48 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:26  time: 0.1830  data_time: 0.0014  memory: 16850  
09/20 17:58:05 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:02  time: 0.3163  data_time: 0.0015  memory: 16932  
09/20 17:58:14 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:31  time: 0.0574  data_time: 0.0014  memory: 16908  
09/20 17:58:28 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:07  time: 0.5907  data_time: 0.0015  memory: 16935  
09/20 17:58:40 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:41  time: 0.0605  data_time: 0.0015  memory: 16921  
09/20 17:58:47 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:13  time: 0.1886  data_time: 0.0014  memory: 16913  
09/20 17:58:50 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:45  time: 0.0598  data_time: 0.0014  memory: 1824  
09/20 17:58:59 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:21  time: 0.1924  data_time: 0.0015  memory: 16925  
09/20 17:59:02 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:56  time: 0.0595  data_time: 0.0014  memory: 1463  
09/20 17:59:08 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:34  time: 0.0565  data_time: 0.0014  memory: 16910  
09/20 17:59:24 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:17  time: 0.4150  data_time: 0.0014  memory: 16928  
09/20 17:59:31 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:57  time: 0.4083  data_time: 0.0014  memory: 16917  
09/20 17:59:34 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:37  time: 0.0548  data_time: 0.0013  memory: 628  
09/20 17:59:39 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:18  time: 0.0621  data_time: 0.0014  memory: 16859  
09/20 17:59:42 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:59  time: 0.0577  data_time: 0.0015  memory: 1507  
09/20 17:59:52 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:43  time: 0.0541  data_time: 0.0013  memory: 16931  
09/20 18:00:01 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:27  time: 0.0598  data_time: 0.0016  memory: 16922  
09/20 18:00:09 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:12  time: 0.0639  data_time: 0.0014  memory: 16911  
09/20 18:00:15 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:56  time: 0.0603  data_time: 0.0016  memory: 16911  
09/20 18:00:18 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:41  time: 0.0604  data_time: 0.0016  memory: 578  
09/20 18:00:24 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:27  time: 0.0640  data_time: 0.0014  memory: 16935  
09/20 18:00:31 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:13  time: 0.0592  data_time: 0.0030  memory: 16916  
09/20 18:00:39 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0564  data_time: 0.0013  memory: 16864  
09/20 18:00:39 - mmengine - INFO - per class results:
09/20 18:00:39 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.06 | 87.94 |
|       building      | 80.99 |  93.4 |
|         sky         | 93.89 | 97.12 |
|        floor        |  78.2 | 89.57 |
|         tree        |  72.5 | 86.06 |
|       ceiling       | 81.53 | 89.91 |
|         road        | 81.52 | 89.08 |
|         bed         | 86.75 | 94.62 |
|      windowpane     |  58.3 | 75.18 |
|        grass        | 64.68 | 82.55 |
|       cabinet       | 56.83 | 70.23 |
|       sidewalk      | 63.64 | 78.98 |
|        person       | 76.29 | 88.17 |
|        earth        | 32.03 | 45.33 |
|         door        | 43.32 | 56.59 |
|        table        |  58.3 | 74.28 |
|       mountain      | 51.39 | 67.42 |
|        plant        | 50.09 | 63.13 |
|       curtain       | 69.49 | 82.14 |
|        chair        | 54.36 | 69.06 |
|         car         | 80.24 |  87.5 |
|        water        | 46.19 | 61.95 |
|       painting      | 69.47 |  83.8 |
|         sofa        | 60.26 | 80.24 |
|        shelf        | 38.63 | 55.52 |
|        house        | 46.76 |  52.9 |
|         sea         | 43.22 | 70.12 |
|        mirror       | 60.93 | 69.84 |
|         rug         | 55.85 | 65.11 |
|        field        | 26.51 | 41.06 |
|       armchair      | 38.28 | 52.07 |
|         seat        | 57.44 | 73.59 |
|        fence        | 33.19 | 44.39 |
|         desk        | 47.74 | 61.36 |
|         rock        | 30.56 | 45.47 |
|       wardrobe      | 43.14 | 59.12 |
|         lamp        |  60.8 | 72.71 |
|       bathtub       |  73.2 | 79.19 |
|       railing       | 30.01 | 45.13 |
|       cushion       | 51.28 | 62.76 |
|         base        | 21.56 | 31.36 |
|         box         | 20.56 | 27.92 |
|        column       | 44.17 | 54.39 |
|      signboard      | 34.16 | 45.97 |
|   chest of drawers  | 38.81 | 59.84 |
|       counter       | 21.46 | 27.22 |
|         sand        | 32.59 | 44.95 |
|         sink        |  65.3 | 79.17 |
|      skyscraper     | 61.61 | 71.43 |
|      fireplace      | 68.32 | 85.25 |
|     refrigerator    | 70.49 | 84.56 |
|      grandstand     | 31.96 | 66.87 |
|         path        | 15.77 |  20.6 |
|        stairs       | 30.54 | 36.66 |
|        runway       | 64.54 |  86.6 |
|         case        | 46.67 | 70.55 |
|      pool table     | 90.89 | 95.31 |
|        pillow       | 52.41 | 65.57 |
|     screen door     | 64.24 | 78.05 |
|       stairway      | 28.27 | 42.25 |
|        river        | 12.04 | 22.22 |
|        bridge       | 56.53 | 61.61 |
|       bookcase      | 37.12 | 46.06 |
|        blind        | 40.94 | 45.53 |
|     coffee table    | 59.17 | 77.88 |
|        toilet       | 81.54 | 90.53 |
|        flower       | 33.69 | 48.76 |
|         book        | 43.51 |  65.3 |
|         hill        |  5.33 |  8.11 |
|        bench        | 37.97 | 48.55 |
|      countertop     | 53.92 |  68.1 |
|        stove        | 71.12 | 81.05 |
|         palm        | 48.26 | 65.19 |
|    kitchen island   | 43.06 |  79.2 |
|       computer      | 54.85 | 66.55 |
|     swivel chair    | 44.76 | 62.11 |
|         boat        | 42.74 | 50.76 |
|         bar         |  23.2 | 29.33 |
|    arcade machine   | 29.82 | 36.45 |
|        hovel        |  37.1 | 40.05 |
|         bus         | 75.74 | 88.17 |
|        towel        | 52.77 | 63.96 |
|        light        | 52.59 | 60.98 |
|        truck        |  27.1 | 42.68 |
|        tower        | 25.06 | 34.11 |
|      chandelier     | 64.91 | 82.61 |
|        awning       | 22.75 | 25.52 |
|     streetlight     | 21.99 |  27.7 |
|        booth        |  43.4 | 47.65 |
| television receiver | 66.01 | 77.61 |
|       airplane      | 50.44 | 65.77 |
|      dirt track     |  3.74 |  8.67 |
|       apparel       |  26.5 | 37.15 |
|         pole        | 22.99 | 31.89 |
|         land        |  0.85 |  1.18 |
|      bannister      |  5.28 |  6.49 |
|      escalator      | 18.64 | 19.48 |
|       ottoman       | 38.82 | 48.36 |
|        bottle       | 14.06 | 22.88 |
|        buffet       | 42.29 | 54.88 |
|        poster       | 23.15 | 29.56 |
|        stage        |  7.69 | 11.84 |
|         van         | 40.58 | 56.51 |
|         ship        | 74.96 | 85.28 |
|       fountain      |  3.92 |  3.95 |
|    conveyer belt    | 56.45 | 86.06 |
|        canopy       | 12.29 | 12.65 |
|        washer       | 63.87 | 66.84 |
|      plaything      | 19.68 | 27.57 |
|    swimming pool    |  32.4 | 40.03 |
|        stool        | 39.14 | 50.19 |
|        barrel       | 21.02 | 65.12 |
|        basket       |  25.9 | 31.77 |
|      waterfall      | 58.43 | 84.84 |
|         tent        | 93.87 | 97.71 |
|         bag         |  7.15 |  7.97 |
|       minibike      |  40.6 | 44.02 |
|        cradle       | 73.83 | 97.05 |
|         oven        | 18.38 | 44.62 |
|         ball        | 40.86 | 66.13 |
|         food        | 49.48 | 59.25 |
|         step        |  3.68 |  4.32 |
|         tank        | 42.67 | 45.82 |
|      trade name     | 25.91 | 30.21 |
|      microwave      | 38.09 | 41.68 |
|         pot         |  34.0 | 38.83 |
|        animal       | 48.32 | 49.31 |
|       bicycle       | 38.49 | 59.55 |
|         lake        | 59.91 | 63.06 |
|      dishwasher     | 62.68 | 66.16 |
|        screen       | 54.49 |  66.9 |
|       blanket       |  5.62 |  6.2  |
|      sculpture      | 36.56 | 52.67 |
|         hood        | 54.72 | 64.66 |
|        sconce       |  34.6 |  40.3 |
|         vase        | 31.01 | 46.34 |
|    traffic light    |  22.7 | 30.11 |
|         tray        |  3.62 |  5.08 |
|        ashcan       | 35.98 | 48.43 |
|         fan         | 56.81 |  67.2 |
|         pier        | 22.95 | 29.15 |
|      crt screen     |  1.36 |  2.27 |
|        plate        | 40.39 | 51.37 |
|       monitor       | 55.28 | 62.74 |
|    bulletin board   | 36.25 | 45.49 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 41.18 | 47.25 |
|        glass        |  9.33 |  9.96 |
|        clock        |  17.3 | 20.77 |
|         flag        | 33.56 | 36.62 |
+---------------------+-------+-------+
09/20 18:00:39 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.9000  mIoU: 43.4000  mAcc: 54.4100  data_time: 0.0017  time: 0.2682
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
09/20 18:00:42 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1350544281
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1350544281
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 18:00:43 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/jpeg_compression'

09/20 18:00:47 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 18:00:47 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 18:00:47 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 18:00:48 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 18:02:00 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:47:07  time: 0.7254  data_time: 0.0015  memory: 17152  
09/20 18:02:39 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:35:10  time: 0.9179  data_time: 0.0015  memory: 16931  
09/20 18:02:59 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:26:58  time: 0.4251  data_time: 0.0015  memory: 16924  
09/20 18:03:29 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:24:15  time: 0.5440  data_time: 0.0015  memory: 16933  
09/20 18:03:56 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:22:01  time: 0.3440  data_time: 0.0014  memory: 16932  
09/20 18:04:20 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:00  time: 0.0751  data_time: 0.0015  memory: 16928  
09/20 18:04:48 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:18:53  time: 0.3951  data_time: 0.0015  memory: 16932  
09/20 18:05:10 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:17:30  time: 0.4624  data_time: 0.0013  memory: 16929  
09/20 18:05:18 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:15:31  time: 0.2016  data_time: 0.0014  memory: 16854  
09/20 18:05:27 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:13:59  time: 0.0683  data_time: 0.0014  memory: 16912  
09/20 18:05:39 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:12:47  time: 0.4553  data_time: 0.0015  memory: 16932  
09/20 18:05:46 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:35  time: 0.2529  data_time: 0.0015  memory: 16860  
09/20 18:06:02 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:10:51  time: 0.4676  data_time: 0.0013  memory: 16934  
09/20 18:06:21 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:18  time: 0.0755  data_time: 0.0015  memory: 16934  
09/20 18:06:40 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:09:47  time: 0.8997  data_time: 0.0014  memory: 16937  
09/20 18:06:47 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:08:59  time: 0.0649  data_time: 0.0015  memory: 16925  
09/20 18:06:50 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:10  time: 0.0671  data_time: 0.0015  memory: 628  
09/20 18:06:58 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:32  time: 0.1884  data_time: 0.0013  memory: 16850  
09/20 18:07:15 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:08  time: 0.3209  data_time: 0.0015  memory: 16932  
09/20 18:07:25 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:37  time: 0.0644  data_time: 0.0015  memory: 16908  
09/20 18:07:39 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:12  time: 0.5954  data_time: 0.0014  memory: 16935  
09/20 18:07:51 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:46  time: 0.0664  data_time: 0.0015  memory: 16921  
09/20 18:07:58 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:18  time: 0.1949  data_time: 0.0014  memory: 16913  
09/20 18:08:02 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:49  time: 0.0664  data_time: 0.0014  memory: 1824  
09/20 18:08:11 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:25  time: 0.1994  data_time: 0.0014  memory: 16925  
09/20 18:08:14 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:00  time: 0.0653  data_time: 0.0014  memory: 1463  
09/20 18:08:20 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:37  time: 0.0630  data_time: 0.0014  memory: 16910  
09/20 18:08:36 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:20  time: 0.4214  data_time: 0.0014  memory: 16928  
09/20 18:08:44 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:00  time: 0.4158  data_time: 0.0014  memory: 16917  
09/20 18:08:47 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:39  time: 0.0603  data_time: 0.0014  memory: 628  
09/20 18:08:53 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:20  time: 0.0696  data_time: 0.0015  memory: 16859  
09/20 18:08:56 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:02  time: 0.0636  data_time: 0.0015  memory: 1507  
09/20 18:09:06 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:45  time: 0.0593  data_time: 0.0013  memory: 16931  
09/20 18:09:16 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:29  time: 0.0665  data_time: 0.0016  memory: 16922  
09/20 18:09:24 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:13  time: 0.0703  data_time: 0.0014  memory: 16911  
09/20 18:09:30 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:57  time: 0.0669  data_time: 0.0016  memory: 16911  
09/20 18:09:33 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:42  time: 0.0668  data_time: 0.0016  memory: 578  
09/20 18:09:40 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:27  time: 0.0696  data_time: 0.0014  memory: 16935  
09/20 18:09:47 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:13  time: 0.0612  data_time: 0.0013  memory: 16916  
09/20 18:09:55 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0606  data_time: 0.0012  memory: 16864  
09/20 18:09:55 - mmengine - INFO - per class results:
09/20 18:09:55 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.45 | 88.21 |
|       building      | 80.42 | 92.84 |
|         sky         | 93.46 | 96.98 |
|        floor        |  76.3 | 90.13 |
|         tree        | 72.59 | 85.57 |
|       ceiling       | 79.55 | 87.94 |
|         road        | 79.45 | 87.66 |
|         bed         | 86.25 | 94.16 |
|      windowpane     | 56.76 | 73.92 |
|        grass        | 65.31 | 80.88 |
|       cabinet       | 55.71 | 68.62 |
|       sidewalk      |  61.1 | 76.88 |
|        person       | 75.79 | 87.51 |
|        earth        | 30.84 | 47.53 |
|         door        | 40.11 |  53.4 |
|        table        | 56.98 | 73.21 |
|       mountain      | 51.23 |  69.3 |
|        plant        | 49.14 | 61.84 |
|       curtain       |  68.0 | 78.58 |
|        chair        |  53.4 | 66.01 |
|         car         | 80.63 | 88.49 |
|        water        | 47.76 | 63.39 |
|       painting      |  68.9 |  80.4 |
|         sofa        | 59.78 | 80.12 |
|        shelf        | 36.84 | 52.41 |
|        house        | 42.99 | 48.73 |
|         sea         | 43.98 | 71.22 |
|        mirror       | 59.39 | 68.52 |
|         rug         | 49.32 | 53.61 |
|        field        | 29.86 | 44.35 |
|       armchair      | 37.04 | 49.46 |
|         seat        | 57.95 | 73.95 |
|        fence        | 33.73 | 44.92 |
|         desk        | 44.52 | 59.09 |
|         rock        | 31.61 |  47.9 |
|       wardrobe      | 42.51 | 62.54 |
|         lamp        | 60.34 | 71.18 |
|       bathtub       | 71.97 | 77.99 |
|       railing       | 28.15 | 40.13 |
|       cushion       | 49.08 | 62.49 |
|         base        | 16.88 | 23.14 |
|         box         |  19.7 | 27.17 |
|        column       | 45.37 | 55.53 |
|      signboard      | 33.14 | 43.67 |
|   chest of drawers  | 38.16 | 59.05 |
|       counter       | 16.57 |  20.8 |
|         sand        | 24.49 | 34.35 |
|         sink        |  66.4 | 77.18 |
|      skyscraper     | 56.52 |  66.9 |
|      fireplace      | 66.87 | 83.26 |
|     refrigerator    | 68.72 | 80.83 |
|      grandstand     |  32.3 | 61.56 |
|         path        |  15.4 | 20.88 |
|        stairs       | 29.89 | 35.59 |
|        runway       | 56.23 | 75.27 |
|         case        | 44.11 | 63.65 |
|      pool table     | 91.08 | 94.89 |
|        pillow       | 51.31 |  61.8 |
|     screen door     | 62.73 | 74.72 |
|       stairway      |  33.2 | 43.21 |
|        river        |  7.99 |  13.8 |
|        bridge       | 46.45 | 50.49 |
|       bookcase      | 35.28 | 43.19 |
|        blind        |  31.0 | 33.93 |
|     coffee table    | 60.73 | 76.89 |
|        toilet       | 81.59 | 89.43 |
|        flower       | 31.03 | 45.17 |
|         book        | 43.43 | 61.73 |
|         hill        |  6.89 | 10.18 |
|        bench        | 37.95 |  47.6 |
|      countertop     | 51.77 | 65.87 |
|        stove        | 69.21 | 81.47 |
|         palm        | 48.79 | 66.06 |
|    kitchen island   | 41.37 | 70.24 |
|       computer      | 54.51 | 66.85 |
|     swivel chair    | 43.65 | 56.22 |
|         boat        | 36.34 | 46.54 |
|         bar         | 24.14 | 31.67 |
|    arcade machine   |  54.3 | 60.59 |
|        hovel        |  35.3 | 39.39 |
|         bus         |  75.1 | 85.99 |
|        towel        | 49.84 | 56.68 |
|        light        | 48.31 | 55.14 |
|        truck        | 24.15 | 32.88 |
|        tower        | 27.07 | 35.86 |
|      chandelier     | 64.55 | 82.74 |
|        awning       | 20.91 | 22.89 |
|     streetlight     | 19.73 | 23.09 |
|        booth        | 39.53 | 49.98 |
| television receiver | 64.53 | 76.26 |
|       airplane      | 50.47 | 62.87 |
|      dirt track     |  3.52 | 10.02 |
|       apparel       | 26.75 | 38.44 |
|         pole        | 20.92 | 28.76 |
|         land        |  0.42 |  0.63 |
|      bannister      |  4.25 |  5.02 |
|      escalator      | 19.67 | 20.58 |
|       ottoman       | 41.84 | 50.73 |
|        bottle       | 11.66 | 17.94 |
|        buffet       | 34.68 | 42.33 |
|        poster       | 23.86 | 29.96 |
|        stage        |  8.31 | 11.62 |
|         van         | 39.28 | 53.32 |
|         ship        | 71.16 | 88.63 |
|       fountain      |  0.54 |  0.55 |
|    conveyer belt    | 61.64 | 88.48 |
|        canopy       | 11.09 | 11.63 |
|        washer       | 63.05 | 66.81 |
|      plaything      |  16.0 | 22.01 |
|    swimming pool    |  31.5 | 38.32 |
|        stool        | 34.29 | 42.58 |
|        barrel       | 17.11 | 40.61 |
|        basket       | 21.16 | 26.91 |
|      waterfall      | 62.36 | 85.12 |
|         tent        | 91.02 | 97.99 |
|         bag         |  6.62 |  7.47 |
|       minibike      | 46.22 | 51.66 |
|        cradle       | 73.11 | 96.62 |
|         oven        |  13.6 | 34.79 |
|         ball        | 39.83 | 63.41 |
|         food        | 48.06 | 61.27 |
|         step        |  2.32 |  2.69 |
|         tank        | 39.03 | 41.32 |
|      trade name     | 23.78 | 27.66 |
|      microwave      | 36.47 | 41.16 |
|         pot         |  33.9 |  37.9 |
|        animal       |  50.4 | 51.95 |
|       bicycle       | 43.47 | 65.43 |
|         lake        | 59.75 | 63.02 |
|      dishwasher     | 56.72 | 59.69 |
|        screen       |  52.0 | 62.72 |
|       blanket       |  4.73 |  5.03 |
|      sculpture      | 37.92 |  56.7 |
|         hood        | 55.85 | 65.21 |
|        sconce       | 30.63 | 34.26 |
|         vase        | 28.51 | 43.25 |
|    traffic light    | 20.58 | 25.22 |
|         tray        |  4.31 |  6.44 |
|        ashcan       | 34.24 | 46.17 |
|         fan         | 53.78 | 64.43 |
|         pier        | 24.52 | 29.16 |
|      crt screen     |  3.3  |  5.06 |
|        plate        | 36.97 |  46.9 |
|       monitor       | 53.85 | 59.65 |
|    bulletin board   | 34.62 | 42.19 |
|        shower       |  0.17 |  0.19 |
|       radiator      |  38.5 | 42.98 |
|        glass        |  8.58 |  9.06 |
|        clock        | 16.21 |  19.1 |
|         flag        | 29.27 | 30.97 |
+---------------------+-------+-------+
09/20 18:09:55 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.1000  mIoU: 42.2300  mAcc: 52.4500  data_time: 0.0016  time: 0.2737
Finished processing corruption type: jpeg_compression
Processing corruption type: elastic_transform
09/20 18:09:58 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1138770056
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1138770056
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 18:09:59 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/elastic_transform'

09/20 18:10:03 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 18:10:03 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 18:10:03 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 18:10:04 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 18:12:05 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:19:01  time: 1.7850  data_time: 0.0016  memory: 17152  
09/20 18:13:32 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:06:00  time: 1.8890  data_time: 0.0016  memory: 16931  
09/20 18:14:39 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:56:37  time: 1.3894  data_time: 0.0016  memory: 16924  
09/20 18:15:57 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:53:03  time: 1.4591  data_time: 0.0015  memory: 16933  
09/20 18:17:10 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:49:43  time: 1.2574  data_time: 0.0015  memory: 16932  
09/20 18:18:17 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:46:35  time: 1.0257  data_time: 0.0016  memory: 16928  
09/20 18:19:31 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:44:35  time: 1.2672  data_time: 0.0015  memory: 16932  
09/20 18:20:39 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:42:22  time: 1.4132  data_time: 0.0015  memory: 16929  
09/20 18:21:29 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:39:20  time: 1.0506  data_time: 0.0015  memory: 16854  
09/20 18:22:24 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:37:02  time: 0.9755  data_time: 0.0015  memory: 16912  
09/20 18:23:25 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:35:12  time: 1.4318  data_time: 0.0016  memory: 16932  
09/20 18:24:18 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:33:12  time: 1.2082  data_time: 0.0016  memory: 16860  
09/20 18:25:20 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:31:42  time: 1.3991  data_time: 0.0014  memory: 16934  
09/20 18:26:27 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:30:26  time: 1.0463  data_time: 0.0016  memory: 16934  
09/20 18:27:33 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:29:09  time: 1.7767  data_time: 0.0015  memory: 16937  
09/20 18:28:24 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:27:30  time: 1.0110  data_time: 0.0016  memory: 16925  
09/20 18:29:15 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:25:57  time: 1.0228  data_time: 0.0017  memory: 628  
09/20 18:30:05 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:24:28  time: 1.0046  data_time: 0.0014  memory: 16850  
09/20 18:31:09 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:23:18  time: 1.2188  data_time: 0.0015  memory: 16932  
09/20 18:32:03 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:21:59  time: 0.9630  data_time: 0.0015  memory: 16908  
09/20 18:33:05 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:20:50  time: 1.5642  data_time: 0.0015  memory: 16935  
09/20 18:34:03 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:19:38  time: 0.9828  data_time: 0.0016  memory: 16921  
09/20 18:34:57 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:18:23  time: 1.1228  data_time: 0.0015  memory: 16913  
09/20 18:35:48 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:17:09  time: 0.9733  data_time: 0.0015  memory: 1824  
09/20 18:36:41 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:15:58  time: 1.0951  data_time: 0.0015  memory: 16925  
09/20 18:37:28 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:14:45  time: 1.0056  data_time: 0.0015  memory: 1463  
09/20 18:38:20 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:13:36  time: 0.9294  data_time: 0.0015  memory: 16910  
09/20 18:39:23 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:12:33  time: 1.3962  data_time: 0.0015  memory: 16928  
09/20 18:40:14 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:11:26  time: 1.3188  data_time: 0.0015  memory: 16917  
09/20 18:41:02 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:10:19  time: 0.9185  data_time: 0.0014  memory: 628  
09/20 18:41:56 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:09:15  time: 1.0127  data_time: 0.0016  memory: 16859  
09/20 18:42:44 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:08:10  time: 0.9782  data_time: 0.0016  memory: 1507  
09/20 18:43:38 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:07  time: 0.9060  data_time: 0.0014  memory: 16931  
09/20 18:44:35 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:05  time: 0.9985  data_time: 0.0016  memory: 16922  
09/20 18:45:30 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:05:03  time: 0.9908  data_time: 0.0014  memory: 16911  
09/20 18:46:21 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:04:01  time: 1.0214  data_time: 0.0016  memory: 16911  
09/20 18:47:12 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:03:00  time: 1.0099  data_time: 0.0017  memory: 578  
09/20 18:48:02 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:59  time: 0.9741  data_time: 0.0015  memory: 16935  
09/20 18:48:57 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:59  time: 0.9689  data_time: 0.0015  memory: 16916  
09/20 18:49:49 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.8961  data_time: 0.0014  memory: 16864  
09/20 18:49:49 - mmengine - INFO - per class results:
09/20 18:49:49 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 61.34 | 78.28 |
|       building      | 73.06 | 88.53 |
|         sky         | 84.09 | 91.62 |
|        floor        | 66.24 | 81.66 |
|         tree        | 62.12 | 78.68 |
|       ceiling       | 68.11 | 81.71 |
|         road        | 73.57 | 84.26 |
|         bed         |  74.9 | 86.97 |
|      windowpane     | 46.97 | 65.34 |
|        grass        | 57.29 | 75.57 |
|       cabinet       | 45.91 | 59.45 |
|       sidewalk      |  51.8 | 68.98 |
|        person       | 58.02 | 76.05 |
|        earth        | 27.85 | 40.57 |
|         door        | 32.74 | 43.27 |
|        table        | 42.96 | 61.94 |
|       mountain      | 46.63 | 62.57 |
|        plant        | 41.18 | 56.26 |
|       curtain       |  50.3 | 68.35 |
|        chair        |  38.9 | 56.35 |
|         car         | 60.41 | 74.26 |
|        water        | 45.12 | 58.46 |
|       painting      | 46.66 | 64.96 |
|         sofa        | 48.09 | 67.82 |
|        shelf        | 32.52 | 49.95 |
|        house        | 35.36 | 41.16 |
|         sea         | 38.68 |  64.1 |
|        mirror       | 51.44 | 61.97 |
|         rug         | 42.63 | 53.56 |
|        field        | 23.72 | 38.14 |
|       armchair      | 31.91 | 46.52 |
|         seat        | 52.53 |  68.2 |
|        fence        | 29.14 | 41.02 |
|         desk        | 38.32 | 55.62 |
|         rock        | 29.59 |  47.3 |
|       wardrobe      | 39.15 |  56.0 |
|         lamp        | 29.25 | 45.56 |
|       bathtub       | 57.33 | 65.98 |
|       railing       | 21.47 | 34.06 |
|       cushion       | 35.75 | 48.52 |
|         base        | 17.68 |  24.8 |
|         box         | 15.05 | 20.61 |
|        column       | 29.72 | 42.33 |
|      signboard      | 21.47 |  32.3 |
|   chest of drawers  | 32.07 | 50.75 |
|       counter       | 22.65 |  26.0 |
|         sand        | 24.74 | 43.28 |
|         sink        | 43.66 | 61.39 |
|      skyscraper     | 54.88 | 65.26 |
|      fireplace      | 59.81 | 78.27 |
|     refrigerator    | 58.13 | 70.72 |
|      grandstand     | 30.98 |  65.4 |
|         path        | 12.51 |  17.1 |
|        stairs       | 25.08 | 30.35 |
|        runway       | 61.77 | 84.56 |
|         case        | 47.71 | 66.44 |
|      pool table     | 74.03 | 84.85 |
|        pillow       | 36.06 | 50.52 |
|     screen door     | 57.65 |  75.0 |
|       stairway      | 25.33 | 34.26 |
|        river        |  9.73 | 17.44 |
|        bridge       | 33.32 | 39.97 |
|       bookcase      | 22.58 | 32.68 |
|        blind        | 34.38 | 39.72 |
|     coffee table    | 45.44 | 63.92 |
|        toilet       | 58.01 | 73.74 |
|        flower       | 27.06 | 42.63 |
|         book        | 29.42 | 49.08 |
|         hill        |  3.17 |  4.97 |
|        bench        | 36.36 | 46.84 |
|      countertop     | 38.18 | 52.83 |
|        stove        | 56.87 | 69.61 |
|         palm        | 38.67 | 58.97 |
|    kitchen island   | 31.66 | 61.57 |
|       computer      | 44.05 | 57.89 |
|     swivel chair    | 33.29 |  50.3 |
|         boat        | 39.66 | 52.21 |
|         bar         | 23.06 | 28.82 |
|    arcade machine   | 34.06 | 41.17 |
|        hovel        | 20.02 | 20.93 |
|         bus         | 64.16 | 80.64 |
|        towel        | 32.26 | 47.46 |
|        light        | 14.42 | 22.57 |
|        truck        | 20.02 | 31.52 |
|        tower        | 17.76 | 24.29 |
|      chandelier     | 43.01 | 60.63 |
|        awning       | 13.22 |  16.2 |
|     streetlight     |  5.24 |  7.69 |
|        booth        | 34.57 | 39.09 |
| television receiver | 43.48 | 61.66 |
|       airplane      | 36.45 | 50.67 |
|      dirt track     |  3.84 | 10.09 |
|       apparel       | 21.09 | 33.85 |
|         pole        |  8.91 | 13.07 |
|         land        |  0.2  |  0.28 |
|      bannister      |  2.34 |  2.85 |
|      escalator      |  18.6 | 19.27 |
|       ottoman       | 29.23 | 38.69 |
|        bottle       |  9.06 | 16.74 |
|        buffet       | 35.43 | 47.96 |
|        poster       |  22.7 | 30.36 |
|        stage        |  5.61 |  9.12 |
|         van         | 30.16 | 40.22 |
|         ship        | 73.95 | 76.62 |
|       fountain      |  5.02 |  5.07 |
|    conveyer belt    | 48.34 | 70.72 |
|        canopy       | 15.46 | 17.37 |
|        washer       | 55.86 |  65.5 |
|      plaything      | 18.36 | 30.81 |
|    swimming pool    |  37.4 | 47.34 |
|        stool        | 21.19 | 30.74 |
|        barrel       | 46.18 | 52.87 |
|        basket       |  14.7 | 19.55 |
|      waterfall      | 48.54 |  77.4 |
|         tent        |  84.7 | 98.58 |
|         bag         |  4.95 |  5.78 |
|       minibike      | 42.79 |  54.2 |
|        cradle       | 61.41 |  90.0 |
|         oven        | 17.62 | 40.98 |
|         ball        | 35.99 | 65.12 |
|         food        | 45.82 | 63.23 |
|         step        |  0.63 |  0.7  |
|         tank        | 38.66 | 42.14 |
|      trade name     | 16.59 | 20.05 |
|      microwave      | 29.49 | 34.02 |
|         pot         | 22.89 | 30.07 |
|        animal       | 42.36 | 46.07 |
|       bicycle       | 29.08 |  46.1 |
|         lake        | 53.95 | 63.41 |
|      dishwasher     | 45.95 | 52.74 |
|        screen       | 44.26 | 60.92 |
|       blanket       |  4.03 |  4.87 |
|      sculpture      | 29.08 | 42.02 |
|         hood        | 38.11 | 51.56 |
|        sconce       | 16.28 | 22.28 |
|         vase        | 16.36 | 28.76 |
|    traffic light    | 10.43 | 14.89 |
|         tray        |  1.58 |  2.36 |
|        ashcan       | 26.01 | 41.27 |
|         fan         | 20.73 | 30.82 |
|         pier        | 18.06 |  23.1 |
|      crt screen     |  0.77 |  1.33 |
|        plate        | 31.92 | 49.03 |
|       monitor       | 44.19 | 55.12 |
|    bulletin board   | 22.46 | 32.95 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 23.97 | 30.81 |
|        glass        |  5.8  |  6.54 |
|        clock        |  8.73 | 11.54 |
|         flag        | 27.87 | 35.26 |
+---------------------+-------+-------+
09/20 18:49:49 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 72.9300  mIoU: 34.4200  mAcc: 46.1100  data_time: 0.0017  time: 1.1926
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
09/20 18:49:52 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 148781430
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 148781430
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 18:49:53 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/pixelate'

09/20 18:49:57 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 18:49:57 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 18:49:57 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 18:49:58 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 18:51:09 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:46:37  time: 0.7212  data_time: 0.0015  memory: 17152  
09/20 18:51:47 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:34:45  time: 0.8892  data_time: 0.0016  memory: 16931  
09/20 18:52:07 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:26:39  time: 0.4196  data_time: 0.0016  memory: 16924  
09/20 18:52:37 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:23:57  time: 0.5379  data_time: 0.0015  memory: 16933  
09/20 18:53:05 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:21:54  time: 0.3391  data_time: 0.0014  memory: 16932  
09/20 18:53:28 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:19:54  time: 0.0702  data_time: 0.0017  memory: 16928  
09/20 18:53:56 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:18:43  time: 0.3466  data_time: 0.0015  memory: 16932  
09/20 18:54:18 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:17:21  time: 0.4554  data_time: 0.0013  memory: 16929  
09/20 18:54:26 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:15:22  time: 0.1960  data_time: 0.0014  memory: 16854  
09/20 18:54:35 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:13:50  time: 0.0629  data_time: 0.0014  memory: 16912  
09/20 18:54:46 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:12:39  time: 0.4487  data_time: 0.0015  memory: 16932  
09/20 18:54:52 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:27  time: 0.2476  data_time: 0.0016  memory: 16860  
09/20 18:55:08 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:10:44  time: 0.4615  data_time: 0.0014  memory: 16934  
09/20 18:55:27 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:10  time: 0.0683  data_time: 0.0015  memory: 16934  
09/20 18:55:46 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:09:40  time: 0.8957  data_time: 0.0014  memory: 16937  
09/20 18:55:52 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:08:52  time: 0.0594  data_time: 0.0016  memory: 16925  
09/20 18:55:55 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:03  time: 0.0616  data_time: 0.0017  memory: 628  
09/20 18:56:02 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:25  time: 0.1840  data_time: 0.0014  memory: 16850  
09/20 18:56:19 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:01  time: 0.3145  data_time: 0.0015  memory: 16932  
09/20 18:56:29 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:31  time: 0.0573  data_time: 0.0014  memory: 16908  
09/20 18:56:43 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:06  time: 0.5904  data_time: 0.0015  memory: 16935  
09/20 18:56:54 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:40  time: 0.0609  data_time: 0.0015  memory: 16921  
09/20 18:57:01 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:13  time: 0.1891  data_time: 0.0014  memory: 16913  
09/20 18:57:04 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:44  time: 0.0594  data_time: 0.0014  memory: 1824  
09/20 18:57:13 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:21  time: 0.1933  data_time: 0.0014  memory: 16925  
09/20 18:57:16 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:55  time: 0.0590  data_time: 0.0014  memory: 1463  
09/20 18:57:22 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:33  time: 0.0569  data_time: 0.0014  memory: 16910  
09/20 18:57:38 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:17  time: 0.4148  data_time: 0.0014  memory: 16928  
09/20 18:57:45 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:57  time: 0.4082  data_time: 0.0014  memory: 16917  
09/20 18:57:48 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:36  time: 0.0550  data_time: 0.0014  memory: 628  
09/20 18:57:53 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:18  time: 0.0622  data_time: 0.0014  memory: 16859  
09/20 18:57:56 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:59  time: 0.0566  data_time: 0.0015  memory: 1507  
09/20 18:58:06 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:43  time: 0.0533  data_time: 0.0013  memory: 16931  
09/20 18:58:15 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:27  time: 0.0594  data_time: 0.0016  memory: 16922  
09/20 18:58:23 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:12  time: 0.0642  data_time: 0.0014  memory: 16911  
09/20 18:58:29 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:56  time: 0.0603  data_time: 0.0016  memory: 16911  
09/20 18:58:32 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:41  time: 0.0596  data_time: 0.0016  memory: 578  
09/20 18:58:38 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:27  time: 0.0640  data_time: 0.0014  memory: 16935  
09/20 18:58:45 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:13  time: 0.0573  data_time: 0.0014  memory: 16916  
09/20 18:58:53 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0560  data_time: 0.0012  memory: 16864  
09/20 18:58:53 - mmengine - INFO - per class results:
09/20 18:58:53 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.06 | 87.94 |
|       building      | 80.99 |  93.4 |
|         sky         | 93.89 | 97.12 |
|        floor        |  78.2 | 89.57 |
|         tree        |  72.5 | 86.06 |
|       ceiling       | 81.53 | 89.91 |
|         road        | 81.52 | 89.08 |
|         bed         | 86.75 | 94.62 |
|      windowpane     |  58.3 | 75.18 |
|        grass        | 64.68 | 82.55 |
|       cabinet       | 56.83 | 70.23 |
|       sidewalk      | 63.64 | 78.98 |
|        person       | 76.29 | 88.17 |
|        earth        | 32.03 | 45.33 |
|         door        | 43.32 | 56.59 |
|        table        |  58.3 | 74.28 |
|       mountain      | 51.39 | 67.42 |
|        plant        | 50.09 | 63.13 |
|       curtain       | 69.49 | 82.14 |
|        chair        | 54.36 | 69.06 |
|         car         | 80.24 |  87.5 |
|        water        | 46.19 | 61.95 |
|       painting      | 69.47 |  83.8 |
|         sofa        | 60.26 | 80.24 |
|        shelf        | 38.63 | 55.52 |
|        house        | 46.76 |  52.9 |
|         sea         | 43.22 | 70.12 |
|        mirror       | 60.93 | 69.84 |
|         rug         | 55.85 | 65.11 |
|        field        | 26.51 | 41.06 |
|       armchair      | 38.28 | 52.07 |
|         seat        | 57.44 | 73.59 |
|        fence        | 33.19 | 44.39 |
|         desk        | 47.74 | 61.36 |
|         rock        | 30.56 | 45.47 |
|       wardrobe      | 43.14 | 59.12 |
|         lamp        |  60.8 | 72.71 |
|       bathtub       |  73.2 | 79.19 |
|       railing       | 30.01 | 45.13 |
|       cushion       | 51.28 | 62.76 |
|         base        | 21.56 | 31.36 |
|         box         | 20.56 | 27.92 |
|        column       | 44.17 | 54.39 |
|      signboard      | 34.16 | 45.97 |
|   chest of drawers  | 38.81 | 59.84 |
|       counter       | 21.46 | 27.22 |
|         sand        | 32.59 | 44.95 |
|         sink        |  65.3 | 79.17 |
|      skyscraper     | 61.61 | 71.43 |
|      fireplace      | 68.32 | 85.25 |
|     refrigerator    | 70.49 | 84.56 |
|      grandstand     | 31.96 | 66.87 |
|         path        | 15.77 |  20.6 |
|        stairs       | 30.54 | 36.66 |
|        runway       | 64.54 |  86.6 |
|         case        | 46.67 | 70.55 |
|      pool table     | 90.89 | 95.31 |
|        pillow       | 52.41 | 65.57 |
|     screen door     | 64.24 | 78.05 |
|       stairway      | 28.27 | 42.25 |
|        river        | 12.04 | 22.22 |
|        bridge       | 56.53 | 61.61 |
|       bookcase      | 37.12 | 46.06 |
|        blind        | 40.94 | 45.53 |
|     coffee table    | 59.17 | 77.88 |
|        toilet       | 81.54 | 90.53 |
|        flower       | 33.69 | 48.76 |
|         book        | 43.51 |  65.3 |
|         hill        |  5.33 |  8.11 |
|        bench        | 37.97 | 48.55 |
|      countertop     | 53.92 |  68.1 |
|        stove        | 71.12 | 81.05 |
|         palm        | 48.26 | 65.19 |
|    kitchen island   | 43.06 |  79.2 |
|       computer      | 54.85 | 66.55 |
|     swivel chair    | 44.76 | 62.11 |
|         boat        | 42.74 | 50.76 |
|         bar         |  23.2 | 29.33 |
|    arcade machine   | 29.82 | 36.45 |
|        hovel        |  37.1 | 40.05 |
|         bus         | 75.74 | 88.17 |
|        towel        | 52.77 | 63.96 |
|        light        | 52.59 | 60.98 |
|        truck        |  27.1 | 42.68 |
|        tower        | 25.06 | 34.11 |
|      chandelier     | 64.91 | 82.61 |
|        awning       | 22.75 | 25.52 |
|     streetlight     | 21.99 |  27.7 |
|        booth        |  43.4 | 47.65 |
| television receiver | 66.01 | 77.61 |
|       airplane      | 50.44 | 65.77 |
|      dirt track     |  3.74 |  8.67 |
|       apparel       |  26.5 | 37.15 |
|         pole        | 22.99 | 31.89 |
|         land        |  0.85 |  1.18 |
|      bannister      |  5.28 |  6.49 |
|      escalator      | 18.64 | 19.48 |
|       ottoman       | 38.82 | 48.36 |
|        bottle       | 14.06 | 22.88 |
|        buffet       | 42.29 | 54.88 |
|        poster       | 23.15 | 29.56 |
|        stage        |  7.69 | 11.84 |
|         van         | 40.58 | 56.51 |
|         ship        | 74.96 | 85.28 |
|       fountain      |  3.92 |  3.95 |
|    conveyer belt    | 56.45 | 86.06 |
|        canopy       | 12.29 | 12.65 |
|        washer       | 63.87 | 66.84 |
|      plaything      | 19.68 | 27.57 |
|    swimming pool    |  32.4 | 40.03 |
|        stool        | 39.14 | 50.19 |
|        barrel       | 21.02 | 65.12 |
|        basket       |  25.9 | 31.77 |
|      waterfall      | 58.43 | 84.84 |
|         tent        | 93.87 | 97.71 |
|         bag         |  7.15 |  7.97 |
|       minibike      |  40.6 | 44.02 |
|        cradle       | 73.83 | 97.05 |
|         oven        | 18.38 | 44.62 |
|         ball        | 40.86 | 66.13 |
|         food        | 49.48 | 59.25 |
|         step        |  3.68 |  4.32 |
|         tank        | 42.67 | 45.82 |
|      trade name     | 25.91 | 30.21 |
|      microwave      | 38.09 | 41.68 |
|         pot         |  34.0 | 38.83 |
|        animal       | 48.32 | 49.31 |
|       bicycle       | 38.49 | 59.55 |
|         lake        | 59.91 | 63.06 |
|      dishwasher     | 62.68 | 66.16 |
|        screen       | 54.49 |  66.9 |
|       blanket       |  5.62 |  6.2  |
|      sculpture      | 36.56 | 52.67 |
|         hood        | 54.72 | 64.66 |
|        sconce       |  34.6 |  40.3 |
|         vase        | 31.01 | 46.34 |
|    traffic light    |  22.7 | 30.11 |
|         tray        |  3.62 |  5.08 |
|        ashcan       | 35.98 | 48.43 |
|         fan         | 56.81 |  67.2 |
|         pier        | 22.95 | 29.15 |
|      crt screen     |  1.36 |  2.27 |
|        plate        | 40.39 | 51.37 |
|       monitor       | 55.28 | 62.74 |
|    bulletin board   | 36.25 | 45.49 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 41.18 | 47.25 |
|        glass        |  9.33 |  9.96 |
|        clock        |  17.3 | 20.77 |
|         flag        | 33.56 | 36.62 |
+---------------------+-------+-------+
09/20 18:58:53 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.9000  mIoU: 43.4000  mAcc: 54.4100  data_time: 0.0016  time: 0.2675
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
09/20 18:58:57 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1410967611
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1410967611
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 18:58:57 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_4xb4-160k_ade20k-512x512/jpeg_compression'

09/20 18:59:01 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 18:59:01 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 18:59:02 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 18:59:02 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r50-d8_512x512_160k_ade20k_20200615_124504-6135c7e0.pth
09/20 19:00:14 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:46:48  time: 0.7232  data_time: 0.0014  memory: 17152  
09/20 19:00:53 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:34:59  time: 0.9153  data_time: 0.0015  memory: 16931  
09/20 19:01:13 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:26:50  time: 0.4229  data_time: 0.0014  memory: 16924  
09/20 19:01:43 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:24:09  time: 0.5422  data_time: 0.0015  memory: 16933  
09/20 19:02:11 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:22:05  time: 0.3441  data_time: 0.0014  memory: 16932  
09/20 19:02:34 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:03  time: 0.0749  data_time: 0.0015  memory: 16928  
09/20 19:03:03 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:18:54  time: 0.3956  data_time: 0.0014  memory: 16932  
09/20 19:03:25 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:17:31  time: 0.4623  data_time: 0.0013  memory: 16929  
09/20 19:03:33 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:15:32  time: 0.2023  data_time: 0.0014  memory: 16854  
09/20 19:03:42 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:13:59  time: 0.0692  data_time: 0.0014  memory: 16912  
09/20 19:03:53 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:12:48  time: 0.4548  data_time: 0.0015  memory: 16932  
09/20 19:04:00 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:35  time: 0.2522  data_time: 0.0015  memory: 16860  
09/20 19:04:16 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:10:52  time: 0.4668  data_time: 0.0013  memory: 16934  
09/20 19:04:35 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:18  time: 0.0758  data_time: 0.0015  memory: 16934  
09/20 19:04:55 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:09:48  time: 0.9117  data_time: 0.0014  memory: 16937  
09/20 19:05:02 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:08:59  time: 0.0669  data_time: 0.0016  memory: 16925  
09/20 19:05:05 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:11  time: 0.0675  data_time: 0.0016  memory: 628  
09/20 19:05:12 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:32  time: 0.1885  data_time: 0.0014  memory: 16850  
09/20 19:05:30 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:08  time: 0.3190  data_time: 0.0015  memory: 16932  
09/20 19:05:39 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:37  time: 0.0628  data_time: 0.0014  memory: 16908  
09/20 19:05:54 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:12  time: 0.5932  data_time: 0.0014  memory: 16935  
09/20 19:06:05 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:46  time: 0.0665  data_time: 0.0015  memory: 16921  
09/20 19:06:13 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:18  time: 0.1940  data_time: 0.0014  memory: 16913  
09/20 19:06:16 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:49  time: 0.0654  data_time: 0.0014  memory: 1824  
09/20 19:06:25 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:25  time: 0.1991  data_time: 0.0014  memory: 16925  
09/20 19:06:28 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:00  time: 0.0655  data_time: 0.0014  memory: 1463  
09/20 19:06:34 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:37  time: 0.0631  data_time: 0.0014  memory: 16910  
09/20 19:06:51 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:20  time: 0.4189  data_time: 0.0013  memory: 16928  
09/20 19:06:58 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:00  time: 0.3584  data_time: 0.0014  memory: 16917  
09/20 19:07:01 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:39  time: 0.0609  data_time: 0.0014  memory: 628  
09/20 19:07:07 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:20  time: 0.0673  data_time: 0.0014  memory: 16859  
09/20 19:07:10 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:01  time: 0.0637  data_time: 0.0015  memory: 1507  
09/20 19:07:20 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:45  time: 0.0599  data_time: 0.0013  memory: 16931  
09/20 19:07:29 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:29  time: 0.0659  data_time: 0.0015  memory: 16922  
09/20 19:07:38 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:13  time: 0.0698  data_time: 0.0014  memory: 16911  
09/20 19:07:44 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:58  time: 0.0673  data_time: 0.0015  memory: 16911  
09/20 19:07:48 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:42  time: 0.0664  data_time: 0.0015  memory: 578  
09/20 19:07:54 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:28  time: 0.0699  data_time: 0.0014  memory: 16935  
09/20 19:08:02 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:13  time: 0.0626  data_time: 0.0014  memory: 16916  
09/20 19:08:10 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0611  data_time: 0.0013  memory: 16864  
09/20 19:08:10 - mmengine - INFO - per class results:
09/20 19:08:10 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.45 | 88.21 |
|       building      | 80.42 | 92.84 |
|         sky         | 93.46 | 96.98 |
|        floor        |  76.3 | 90.13 |
|         tree        | 72.59 | 85.57 |
|       ceiling       | 79.55 | 87.94 |
|         road        | 79.45 | 87.66 |
|         bed         | 86.25 | 94.16 |
|      windowpane     | 56.76 | 73.92 |
|        grass        | 65.31 | 80.88 |
|       cabinet       | 55.71 | 68.62 |
|       sidewalk      |  61.1 | 76.88 |
|        person       | 75.79 | 87.51 |
|        earth        | 30.84 | 47.53 |
|         door        | 40.11 |  53.4 |
|        table        | 56.98 | 73.21 |
|       mountain      | 51.23 |  69.3 |
|        plant        | 49.14 | 61.84 |
|       curtain       |  68.0 | 78.58 |
|        chair        |  53.4 | 66.01 |
|         car         | 80.63 | 88.49 |
|        water        | 47.76 | 63.39 |
|       painting      |  68.9 |  80.4 |
|         sofa        | 59.78 | 80.12 |
|        shelf        | 36.84 | 52.41 |
|        house        | 42.99 | 48.73 |
|         sea         | 43.98 | 71.22 |
|        mirror       | 59.39 | 68.52 |
|         rug         | 49.32 | 53.61 |
|        field        | 29.86 | 44.35 |
|       armchair      | 37.04 | 49.46 |
|         seat        | 57.95 | 73.95 |
|        fence        | 33.73 | 44.92 |
|         desk        | 44.52 | 59.09 |
|         rock        | 31.61 |  47.9 |
|       wardrobe      | 42.51 | 62.54 |
|         lamp        | 60.34 | 71.18 |
|       bathtub       | 71.97 | 77.99 |
|       railing       | 28.15 | 40.13 |
|       cushion       | 49.08 | 62.49 |
|         base        | 16.88 | 23.14 |
|         box         |  19.7 | 27.17 |
|        column       | 45.37 | 55.53 |
|      signboard      | 33.14 | 43.67 |
|   chest of drawers  | 38.16 | 59.05 |
|       counter       | 16.57 |  20.8 |
|         sand        | 24.49 | 34.35 |
|         sink        |  66.4 | 77.18 |
|      skyscraper     | 56.52 |  66.9 |
|      fireplace      | 66.87 | 83.26 |
|     refrigerator    | 68.72 | 80.83 |
|      grandstand     |  32.3 | 61.56 |
|         path        |  15.4 | 20.88 |
|        stairs       | 29.89 | 35.59 |
|        runway       | 56.23 | 75.27 |
|         case        | 44.11 | 63.65 |
|      pool table     | 91.08 | 94.89 |
|        pillow       | 51.31 |  61.8 |
|     screen door     | 62.73 | 74.72 |
|       stairway      |  33.2 | 43.21 |
|        river        |  7.99 |  13.8 |
|        bridge       | 46.45 | 50.49 |
|       bookcase      | 35.28 | 43.19 |
|        blind        |  31.0 | 33.93 |
|     coffee table    | 60.73 | 76.89 |
|        toilet       | 81.59 | 89.43 |
|        flower       | 31.03 | 45.17 |
|         book        | 43.43 | 61.73 |
|         hill        |  6.89 | 10.18 |
|        bench        | 37.95 |  47.6 |
|      countertop     | 51.77 | 65.87 |
|        stove        | 69.21 | 81.47 |
|         palm        | 48.79 | 66.06 |
|    kitchen island   | 41.37 | 70.24 |
|       computer      | 54.51 | 66.85 |
|     swivel chair    | 43.65 | 56.22 |
|         boat        | 36.34 | 46.54 |
|         bar         | 24.14 | 31.67 |
|    arcade machine   |  54.3 | 60.59 |
|        hovel        |  35.3 | 39.39 |
|         bus         |  75.1 | 85.99 |
|        towel        | 49.84 | 56.68 |
|        light        | 48.31 | 55.14 |
|        truck        | 24.15 | 32.88 |
|        tower        | 27.07 | 35.86 |
|      chandelier     | 64.55 | 82.74 |
|        awning       | 20.91 | 22.89 |
|     streetlight     | 19.73 | 23.09 |
|        booth        | 39.53 | 49.98 |
| television receiver | 64.53 | 76.26 |
|       airplane      | 50.47 | 62.87 |
|      dirt track     |  3.52 | 10.02 |
|       apparel       | 26.75 | 38.44 |
|         pole        | 20.92 | 28.76 |
|         land        |  0.42 |  0.63 |
|      bannister      |  4.25 |  5.02 |
|      escalator      | 19.67 | 20.58 |
|       ottoman       | 41.84 | 50.73 |
|        bottle       | 11.66 | 17.94 |
|        buffet       | 34.68 | 42.33 |
|        poster       | 23.86 | 29.96 |
|        stage        |  8.31 | 11.62 |
|         van         | 39.28 | 53.32 |
|         ship        | 71.16 | 88.63 |
|       fountain      |  0.54 |  0.55 |
|    conveyer belt    | 61.64 | 88.48 |
|        canopy       | 11.09 | 11.63 |
|        washer       | 63.05 | 66.81 |
|      plaything      |  16.0 | 22.01 |
|    swimming pool    |  31.5 | 38.32 |
|        stool        | 34.29 | 42.58 |
|        barrel       | 17.11 | 40.61 |
|        basket       | 21.16 | 26.91 |
|      waterfall      | 62.36 | 85.12 |
|         tent        | 91.02 | 97.99 |
|         bag         |  6.62 |  7.47 |
|       minibike      | 46.22 | 51.66 |
|        cradle       | 73.11 | 96.62 |
|         oven        |  13.6 | 34.79 |
|         ball        | 39.83 | 63.41 |
|         food        | 48.06 | 61.27 |
|         step        |  2.32 |  2.69 |
|         tank        | 39.03 | 41.32 |
|      trade name     | 23.78 | 27.66 |
|      microwave      | 36.47 | 41.16 |
|         pot         |  33.9 |  37.9 |
|        animal       |  50.4 | 51.95 |
|       bicycle       | 43.47 | 65.43 |
|         lake        | 59.75 | 63.02 |
|      dishwasher     | 56.72 | 59.69 |
|        screen       |  52.0 | 62.72 |
|       blanket       |  4.73 |  5.03 |
|      sculpture      | 37.92 |  56.7 |
|         hood        | 55.85 | 65.21 |
|        sconce       | 30.63 | 34.26 |
|         vase        | 28.51 | 43.25 |
|    traffic light    | 20.58 | 25.22 |
|         tray        |  4.31 |  6.44 |
|        ashcan       | 34.24 | 46.17 |
|         fan         | 53.78 | 64.43 |
|         pier        | 24.52 | 29.16 |
|      crt screen     |  3.3  |  5.06 |
|        plate        | 36.97 |  46.9 |
|       monitor       | 53.85 | 59.65 |
|    bulletin board   | 34.62 | 42.19 |
|        shower       |  0.17 |  0.19 |
|       radiator      |  38.5 | 42.98 |
|        glass        |  8.58 |  9.06 |
|        clock        | 16.21 |  19.1 |
|         flag        | 29.27 | 30.97 |
+---------------------+-------+-------+
09/20 19:08:10 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.1000  mIoU: 42.2300  mAcc: 52.4500  data_time: 0.0016  time: 0.2739
Finished processing corruption type: jpeg_compression
Runtime: 1726852091

============================= JOB FEEDBACK =============================

NodeName=uc2n481
Job ID: 24247158
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 07:16:22
CPU Efficiency: 5.20% of 5-19:50:08 core-walltime
Job Wall-clock time: 08:44:23
Memory Utilized: 2.54 GB
Memory Efficiency: 2.54% of 100.00 GB
