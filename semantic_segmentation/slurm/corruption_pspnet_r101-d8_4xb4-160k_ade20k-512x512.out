Started at Wed Nov 13 08:26:45 CET 2024
11/13 08:26:49 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:12  time: 0.0838  data_time: 0.0017  memory: 17002  
Processing corruption type: glass_blur
11/13 08:27:09 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:53  time: 0.5136  data_time: 0.0017  memory: 17021  
11/13 08:27:18 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:29  time: 0.4447  data_time: 0.0017  memory: 17009  
11/13 08:27:22 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:05  time: 0.0808  data_time: 0.0016  memory: 720  
11/13 08:27:28 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:43  time: 0.0890  data_time: 0.0017  memory: 16952  
11/13 08:27:32 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:22  time: 0.0832  data_time: 0.0018  memory: 1600  
11/13 08:27:44 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:02  time: 0.0779  data_time: 0.0016  memory: 17024  
11/13 08:27:55 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:44  time: 0.0862  data_time: 0.0019  memory: 17015  
11/13 08:28:05 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:25  time: 0.0893  data_time: 0.0016  memory: 17004  
11/13 08:28:12 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:07  time: 0.0884  data_time: 0.0019  memory: 17004  
11/13 08:28:17 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:49  time: 0.0886  data_time: 0.0019  memory: 670  
11/13 08:28:25 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:32  time: 0.0910  data_time: 0.0017  memory: 17027  
11/13 08:28:35 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.0822  data_time: 0.0017  memory: 17008  
11/13 08:28:43 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0778  data_time: 0.0014  memory: 16956  
11/13 08:28:43 - mmengine - INFO - per class results:
11/13 08:28:43 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.54 | 89.49 |
|       building      | 78.52 | 92.85 |
|         sky         | 93.17 | 96.75 |
|        floor        | 76.29 | 91.02 |
|         tree        | 71.79 | 86.32 |
|       ceiling       | 78.64 | 86.69 |
|         road        | 80.87 | 90.02 |
|         bed         | 86.44 | 94.26 |
|      windowpane     | 58.63 | 72.87 |
|        grass        | 61.22 | 75.58 |
|       cabinet       |  55.9 | 71.36 |
|       sidewalk      | 60.85 | 74.82 |
|        person       | 75.84 |  88.0 |
|        earth        | 33.67 | 49.06 |
|         door        | 39.92 | 51.72 |
|        table        | 58.46 | 74.14 |
|       mountain      | 51.67 | 70.85 |
|        plant        | 48.12 | 58.84 |
|       curtain       | 65.84 | 76.14 |
|        chair        | 52.38 | 63.09 |
|         car         | 80.13 | 87.54 |
|        water        | 47.07 | 62.52 |
|       painting      | 69.08 |  80.0 |
|         sofa        | 62.28 | 82.47 |
|        shelf        | 39.77 |  58.3 |
|        house        | 28.64 | 32.69 |
|         sea         | 49.29 | 80.84 |
|        mirror       | 57.22 |  65.1 |
|         rug         | 44.53 | 48.82 |
|        field        | 27.06 | 44.83 |
|       armchair      | 37.63 |  47.1 |
|         seat        |  60.2 | 76.05 |
|        fence        |  35.4 | 46.69 |
|         desk        | 47.19 | 60.28 |
|         rock        | 32.28 | 47.32 |
|       wardrobe      | 38.95 | 56.68 |
|         lamp        | 60.07 | 70.32 |
|       bathtub       |  72.3 | 78.31 |
|       railing       | 29.44 |  40.1 |
|       cushion       | 51.74 | 65.08 |
|         base        | 16.51 | 18.87 |
|         box         |  17.4 | 22.98 |
|        column       | 40.56 | 50.87 |
|      signboard      | 31.93 | 41.58 |
|   chest of drawers  | 38.24 | 54.93 |
|       counter       | 20.56 | 28.29 |
|         sand        | 43.13 | 52.39 |
|         sink        | 68.79 | 79.26 |
|      skyscraper     | 31.44 | 33.71 |
|      fireplace      | 66.77 | 78.32 |
|     refrigerator    | 63.33 | 77.79 |
|      grandstand     | 37.97 | 60.58 |
|         path        | 18.08 |  24.0 |
|        stairs       | 31.05 | 36.85 |
|        runway       | 62.47 | 83.77 |
|         case        | 50.97 | 69.95 |
|      pool table     | 90.72 | 95.04 |
|        pillow       | 50.96 | 61.13 |
|     screen door     | 58.15 |  62.3 |
|       stairway      | 27.04 | 30.94 |
|        river        | 14.33 | 19.47 |
|        bridge       | 44.68 | 50.79 |
|       bookcase      | 35.09 | 41.29 |
|        blind        | 33.11 | 34.99 |
|     coffee table    | 61.99 | 75.61 |
|        toilet       | 82.71 | 89.24 |
|        flower       | 34.04 | 47.23 |
|         book        | 41.37 | 57.36 |
|         hill        |  6.05 |  8.13 |
|        bench        | 45.92 |  51.5 |
|      countertop     | 55.27 | 65.08 |
|        stove        | 73.12 | 79.35 |
|         palm        | 48.32 | 62.41 |
|    kitchen island   | 41.45 | 64.06 |
|       computer      | 53.33 | 64.52 |
|     swivel chair    |  41.5 | 56.06 |
|         boat        | 34.73 | 38.44 |
|         bar         | 21.48 | 25.94 |
|    arcade machine   | 22.31 | 26.25 |
|        hovel        | 27.25 | 39.72 |
|         bus         | 84.65 | 90.75 |
|        towel        | 43.65 | 46.54 |
|        light        | 45.28 | 50.77 |
|        truck        | 19.68 | 25.19 |
|        tower        | 15.32 | 18.58 |
|      chandelier     | 64.13 | 80.83 |
|        awning       | 19.17 | 20.23 |
|     streetlight     | 20.12 | 24.68 |
|        booth        | 42.73 | 49.92 |
| television receiver | 69.43 | 75.01 |
|       airplane      | 50.06 | 63.01 |
|      dirt track     | 11.53 | 21.66 |
|       apparel       | 27.85 | 40.86 |
|         pole        | 17.53 | 25.15 |
|         land        |  9.12 | 11.04 |
|      bannister      |  7.87 |  9.95 |
|      escalator      |  16.7 | 18.49 |
|       ottoman       | 39.01 | 47.35 |
|        bottle       | 14.72 | 23.07 |
|        buffet       | 30.78 | 33.33 |
|        poster       | 21.94 | 26.91 |
|        stage        | 12.52 | 15.26 |
|         van         | 45.81 | 59.67 |
|         ship        | 86.51 | 90.96 |
|       fountain      |  3.53 |  3.58 |
|    conveyer belt    | 59.55 | 82.84 |
|        canopy       | 16.41 | 17.63 |
|        washer       | 61.62 | 65.62 |
|      plaything      | 33.88 | 43.86 |
|    swimming pool    | 23.35 | 33.26 |
|        stool        | 32.27 | 43.57 |
|        barrel       | 20.78 | 59.42 |
|        basket       | 27.09 | 34.66 |
|      waterfall      | 51.34 | 61.17 |
|         tent        | 90.52 |  97.2 |
|         bag         |  7.07 |  8.19 |
|       minibike      | 50.58 | 57.68 |
|        cradle       | 71.35 |  95.9 |
|         oven        | 25.12 | 44.14 |
|         ball        | 40.46 | 59.93 |
|         food        | 44.32 | 55.64 |
|         step        | 12.11 | 13.81 |
|         tank        | 32.61 | 37.17 |
|      trade name     | 24.16 | 28.12 |
|      microwave      | 35.42 |  38.9 |
|         pot         | 37.96 | 44.28 |
|        animal       | 53.26 | 56.74 |
|       bicycle       | 48.66 | 66.51 |
|         lake        | 61.22 | 63.27 |
|      dishwasher     | 63.53 | 67.69 |
|        screen       | 57.59 |  72.7 |
|       blanket       |  3.97 |  4.09 |
|      sculpture      | 29.82 | 37.53 |
|         hood        | 56.14 | 60.38 |
|        sconce       | 33.38 | 38.45 |
|         vase        | 36.21 | 48.02 |
|    traffic light    | 22.74 | 28.47 |
|         tray        |  5.55 | 10.29 |
|        ashcan       | 32.11 | 40.48 |
|         fan         | 53.02 | 65.28 |
|         pier        | 23.75 | 28.09 |
|      crt screen     |  4.42 |  8.86 |
|        plate        | 42.15 | 51.79 |
|       monitor       | 47.52 | 56.51 |
|    bulletin board   | 37.55 | 41.81 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 40.62 | 46.46 |
|        glass        | 10.16 | 11.02 |
|        clock        | 20.52 | 23.23 |
|         flag        | 23.36 | 24.37 |
+---------------------+-------+-------+
11/13 08:28:43 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.0600  mIoU: 42.5300  mAcc: 51.9600  data_time: 0.0020  time: 0.3191
Finished processing corruption type: jpeg_compression
Runtime: 1731482923
11/13 08:28:47 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 613110719
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 613110719
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 08:28:48 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='glass_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/glass_blur'


============================= JOB FEEDBACK =============================

NodeName=uc2n519
Job ID: 24656061
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 8
CPU Utilized: 07:30:53
CPU Efficiency: 10.44% of 3-00:00:24 core-walltime
Job Wall-clock time: 09:00:03
Memory Utilized: 3.53 GB
Memory Efficiency: 35.34% of 10.00 GB
Number of parameters:  68068492
11/13 08:29:50 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 08:29:50 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 08:29:52 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 08:29:53 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 08:38:01 - mmengine - INFO - Iter(test) [  50/2000]    eta: 5:17:32  time: 7.9057  data_time: 0.0016  memory: 17244  
11/13 08:44:16 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 4:33:20  time: 7.8677  data_time: 0.0016  memory: 17024  
11/13 08:50:07 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 4:09:39  time: 7.2531  data_time: 0.0016  memory: 17018  
11/13 08:56:19 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 3:57:55  time: 7.2426  data_time: 0.0016  memory: 17026  
11/13 09:02:08 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 3:45:50  time: 6.8385  data_time: 0.0015  memory: 17024  
11/13 09:07:48 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 3:34:56  time: 6.7668  data_time: 0.0017  memory: 17020  
11/13 09:13:45 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 3:26:51  time: 6.5989  data_time: 0.0015  memory: 17024  
11/13 09:19:33 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 3:18:40  time: 7.1712  data_time: 0.0015  memory: 17022  
11/13 09:24:35 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 3:08:24  time: 6.1516  data_time: 0.0015  memory: 16946  
11/13 09:30:08 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 3:00:44  time: 6.3331  data_time: 0.0015  memory: 17004  
11/13 09:36:09 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 2:54:42  time: 7.8656  data_time: 0.0195  memory: 17024  
11/13 09:41:37 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 2:47:23  time: 6.9701  data_time: 0.0017  memory: 16952  
11/13 09:47:14 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 2:40:40  time: 7.0052  data_time: 0.0015  memory: 17026  
11/13 09:53:12 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 2:34:44  time: 6.7571  data_time: 0.0017  memory: 17027  
11/13 09:59:00 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 2:28:32  time: 7.2909  data_time: 0.0015  memory: 17029  
11/13 10:04:13 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 2:21:30  time: 6.5614  data_time: 0.0017  memory: 17018  
11/13 10:09:43 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 2:15:04  time: 6.6264  data_time: 0.0017  memory: 720  
11/13 10:14:51 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 2:08:18  time: 6.0321  data_time: 0.0015  memory: 16943  
11/13 10:21:37 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 2:03:29  time: 7.9099  data_time: 0.0024  memory: 17024  
11/13 10:27:22 - mmengine - INFO - Iter(test) [1000/2000]    eta: 1:57:29  time: 6.3455  data_time: 0.0015  memory: 17000  
11/13 10:33:14 - mmengine - INFO - Iter(test) [1050/2000]    eta: 1:51:36  time: 7.4648  data_time: 0.0016  memory: 17027  
11/13 10:39:00 - mmengine - INFO - Iter(test) [1100/2000]    eta: 1:45:38  time: 6.5940  data_time: 0.0016  memory: 17014  
11/13 10:44:33 - mmengine - INFO - Iter(test) [1150/2000]    eta: 1:39:32  time: 6.7995  data_time: 0.0035  memory: 17006  
11/13 10:50:08 - mmengine - INFO - Iter(test) [1200/2000]    eta: 1:33:30  time: 6.4032  data_time: 0.0016  memory: 1917  
11/13 10:55:33 - mmengine - INFO - Iter(test) [1250/2000]    eta: 1:27:24  time: 6.5134  data_time: 0.0016  memory: 17017  
11/13 11:00:45 - mmengine - INFO - Iter(test) [1300/2000]    eta: 1:21:14  time: 6.6722  data_time: 0.0016  memory: 1556  
11/13 11:06:16 - mmengine - INFO - Iter(test) [1350/2000]    eta: 1:15:17  time: 6.1630  data_time: 0.0016  memory: 17002  
11/13 11:11:58 - mmengine - INFO - Iter(test) [1400/2000]    eta: 1:09:28  time: 7.3176  data_time: 0.0015  memory: 17021  
11/13 11:17:16 - mmengine - INFO - Iter(test) [1450/2000]    eta: 1:03:29  time: 7.1936  data_time: 0.0016  memory: 17009  
11/13 11:22:38 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:57:35  time: 6.1619  data_time: 0.0016  memory: 720  
11/13 11:28:22 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:51:49  time: 6.6230  data_time: 0.0016  memory: 16952  
11/13 11:33:45 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:45:58  time: 6.5585  data_time: 0.0190  memory: 1600  
11/13 11:39:22 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:40:11  time: 6.1974  data_time: 0.0015  memory: 17024  
11/13 11:45:03 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:34:26  time: 6.6284  data_time: 0.0017  memory: 17015  
11/13 11:50:46 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:28:41  time: 6.5723  data_time: 0.0015  memory: 17004  
11/13 11:56:05 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:22:54  time: 6.7235  data_time: 0.0017  memory: 17004  
11/13 12:01:36 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:17:09  time: 6.6375  data_time: 0.0017  memory: 670  
11/13 12:06:50 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:11:25  time: 6.4048  data_time: 0.0016  memory: 17027  
11/13 12:12:29 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:05:42  time: 6.4217  data_time: 0.0016  memory: 17008  
11/13 12:17:49 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 5.9951  data_time: 0.0014  memory: 16956  
11/13 12:17:49 - mmengine - INFO - per class results:
11/13 12:17:49 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.04 | 88.32 |
|       building      | 78.24 | 93.61 |
|         sky         |  93.0 | 97.03 |
|        floor        |  76.6 | 87.92 |
|         tree        | 70.13 | 86.65 |
|       ceiling       | 80.65 | 89.19 |
|         road        | 79.54 | 90.27 |
|         bed         | 85.39 | 94.31 |
|      windowpane     | 54.45 | 76.51 |
|        grass        | 61.87 | 77.25 |
|       cabinet       | 53.64 | 66.71 |
|       sidewalk      | 56.42 | 67.03 |
|        person       | 73.28 | 88.64 |
|        earth        |  29.4 | 45.63 |
|         door        | 34.96 |  41.4 |
|        table        | 56.93 | 71.32 |
|       mountain      | 48.55 |  65.6 |
|        plant        | 46.48 | 58.17 |
|       curtain       | 60.68 |  81.3 |
|        chair        | 51.41 | 64.12 |
|         car         | 79.32 | 85.56 |
|        water        | 46.06 |  59.4 |
|       painting      | 68.08 | 78.48 |
|         sofa        | 62.16 |  82.2 |
|        shelf        | 38.25 | 57.12 |
|        house        | 28.14 | 30.73 |
|         sea         | 54.52 | 87.26 |
|        mirror       | 54.42 | 64.47 |
|         rug         | 53.48 | 66.28 |
|        field        | 19.68 | 34.64 |
|       armchair      | 36.49 | 44.81 |
|         seat        | 53.78 | 74.54 |
|        fence        | 32.17 | 47.85 |
|         desk        | 43.29 | 54.57 |
|         rock        | 34.06 | 50.54 |
|       wardrobe      | 38.17 | 52.39 |
|         lamp        | 59.96 | 69.33 |
|       bathtub       | 68.64 | 74.25 |
|       railing       | 28.48 | 38.45 |
|       cushion       | 49.22 | 63.24 |
|         base        | 24.04 | 30.13 |
|         box         | 13.47 | 18.27 |
|        column       | 38.94 | 49.05 |
|      signboard      | 27.61 | 33.99 |
|   chest of drawers  | 34.27 | 50.19 |
|       counter       | 13.46 | 18.38 |
|         sand        | 36.71 | 53.55 |
|         sink        | 63.38 | 75.17 |
|      skyscraper     | 27.22 | 32.62 |
|      fireplace      | 64.58 | 78.82 |
|     refrigerator    |  63.2 | 68.78 |
|      grandstand     | 32.79 | 62.09 |
|         path        | 21.27 | 25.66 |
|        stairs       | 32.95 | 36.85 |
|        runway       | 61.76 | 79.29 |
|         case        | 48.73 | 64.76 |
|      pool table     | 91.45 | 94.98 |
|        pillow       | 50.44 | 59.64 |
|     screen door     | 29.47 | 29.59 |
|       stairway      | 31.68 | 35.25 |
|        river        | 12.83 | 16.11 |
|        bridge       | 50.32 | 54.93 |
|       bookcase      | 32.79 | 38.35 |
|        blind        | 17.58 |  18.1 |
|     coffee table    | 58.45 | 76.41 |
|        toilet       | 78.33 | 83.34 |
|        flower       | 30.31 | 48.47 |
|         book        | 36.46 | 50.85 |
|         hill        |  4.41 |  7.23 |
|        bench        | 42.81 | 47.31 |
|      countertop     | 50.46 | 62.12 |
|        stove        |  67.0 | 73.06 |
|         palm        | 39.94 | 47.72 |
|    kitchen island   | 34.69 | 56.13 |
|       computer      | 47.77 |  53.1 |
|     swivel chair    | 43.58 | 57.62 |
|         boat        | 34.51 | 37.24 |
|         bar         | 22.25 | 24.72 |
|    arcade machine   | 41.73 | 46.48 |
|        hovel        | 27.76 | 41.44 |
|         bus         | 77.22 |  88.1 |
|        towel        | 45.62 | 55.43 |
|        light        | 43.36 | 51.53 |
|        truck        | 20.23 | 28.61 |
|        tower        |  8.39 |  11.6 |
|      chandelier     |  62.8 | 78.87 |
|        awning       | 24.21 | 27.63 |
|     streetlight     | 18.31 | 23.32 |
|        booth        | 34.22 | 36.59 |
| television receiver |  46.5 | 63.47 |
|       airplane      | 47.05 | 61.39 |
|      dirt track     |  7.88 | 18.01 |
|       apparel       | 25.57 | 41.09 |
|         pole        | 14.91 | 21.72 |
|         land        |  1.04 |  1.31 |
|      bannister      |  1.52 |  1.75 |
|      escalator      | 12.14 | 12.34 |
|       ottoman       |  38.8 | 49.46 |
|        bottle       | 15.94 | 19.44 |
|        buffet       | 34.16 | 37.45 |
|        poster       |  17.1 | 20.63 |
|        stage        |  7.73 | 12.49 |
|         van         | 40.64 | 50.34 |
|         ship        | 67.54 | 68.97 |
|       fountain      | 13.46 | 17.64 |
|    conveyer belt    | 76.09 |  84.0 |
|        canopy       | 10.82 | 11.59 |
|        washer       | 50.98 | 52.43 |
|      plaything      | 26.32 | 37.23 |
|    swimming pool    | 23.32 | 36.93 |
|        stool        | 30.29 | 44.33 |
|        barrel       | 43.85 | 62.74 |
|        basket       |  24.0 | 27.32 |
|      waterfall      | 49.81 | 81.81 |
|         tent        | 88.51 | 97.51 |
|         bag         |  5.24 |  5.52 |
|       minibike      | 62.74 | 72.47 |
|        cradle       | 69.64 |  96.9 |
|         oven        | 24.17 | 26.63 |
|         ball        | 38.06 | 65.53 |
|         food        | 44.49 | 58.48 |
|         step        |  9.72 | 11.24 |
|         tank        |  28.6 | 29.49 |
|      trade name     | 13.45 | 13.92 |
|      microwave      | 31.59 | 33.49 |
|         pot         |  39.0 | 44.16 |
|        animal       | 51.65 | 54.15 |
|       bicycle       | 43.89 | 53.34 |
|         lake        | 34.07 | 63.31 |
|      dishwasher     | 62.17 | 63.26 |
|        screen       | 33.99 | 43.25 |
|       blanket       |  3.61 |  3.86 |
|      sculpture      | 17.53 | 20.52 |
|         hood        | 51.32 |  56.1 |
|        sconce       | 33.48 | 41.14 |
|         vase        | 32.54 | 42.21 |
|    traffic light    | 22.42 | 29.15 |
|         tray        |  4.96 |  8.74 |
|        ashcan       | 29.83 | 35.93 |
|         fan         | 48.23 | 59.92 |
|         pier        | 11.12 | 11.81 |
|      crt screen     |  2.2  |  2.9  |
|        plate        | 37.49 |  43.4 |
|       monitor       | 58.54 | 74.86 |
|    bulletin board   | 28.86 | 34.23 |
|        shower       |  0.98 |  1.89 |
|       radiator      | 41.46 | 47.35 |
|        glass        |  5.52 |  5.69 |
|        clock        | 21.61 | 24.35 |
|         flag        | 23.16 |  24.1 |
+---------------------+-------+-------+
11/13 12:17:49 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.1500  mIoU: 40.0700  mAcc: 49.4900  data_time: 0.0033  time: 6.8382
Finished processing corruption type: glass_blur
Processing corruption type: motion_blur
11/13 12:19:53 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 2105210283
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 2105210283
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 12:19:53 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='motion_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/motion_blur'

Number of parameters:  68068492
11/13 12:20:50 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 12:20:50 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 12:20:51 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 12:20:52 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 12:24:00 - mmengine - INFO - Iter(test) [  50/2000]    eta: 2:02:20  time: 1.6563  data_time: 0.0015  memory: 17244  
11/13 12:25:23 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:25:49  time: 1.7953  data_time: 0.0016  memory: 17024  
11/13 12:26:23 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:08:02  time: 1.2616  data_time: 0.0016  memory: 17018  
11/13 12:27:36 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 1:00:40  time: 1.3595  data_time: 0.0016  memory: 17026  
11/13 12:28:45 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:55:11  time: 1.1866  data_time: 0.0015  memory: 17024  
11/13 12:29:46 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:50:26  time: 0.8795  data_time: 0.0017  memory: 17020  
11/13 12:30:56 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:47:25  time: 1.1343  data_time: 0.0015  memory: 17024  
11/13 12:31:57 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:44:19  time: 1.2746  data_time: 0.0015  memory: 17022  
11/13 12:32:38 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:40:31  time: 0.8738  data_time: 0.0015  memory: 16946  
11/13 12:33:25 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:37:40  time: 0.7696  data_time: 0.0015  memory: 17004  
11/13 12:34:17 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:35:21  time: 1.2845  data_time: 0.0016  memory: 17024  
11/13 12:34:59 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:32:55  time: 0.9721  data_time: 0.0016  memory: 16952  
11/13 12:35:53 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:31:12  time: 1.2462  data_time: 0.0014  memory: 17026  
11/13 12:36:52 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:29:43  time: 0.8546  data_time: 0.0016  memory: 17027  
11/13 12:37:52 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:28:19  time: 1.7126  data_time: 0.0015  memory: 17029  
11/13 12:38:34 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:26:33  time: 0.7769  data_time: 0.0017  memory: 17018  
11/13 12:39:14 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:24:51  time: 0.8014  data_time: 0.0017  memory: 720  
11/13 12:39:55 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:23:17  time: 0.8471  data_time: 0.0015  memory: 16943  
11/13 12:40:52 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:22:06  time: 1.0203  data_time: 0.0015  memory: 17024  
11/13 12:41:38 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:20:46  time: 0.7982  data_time: 0.0015  memory: 17000  
11/13 12:42:31 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:19:35  time: 1.4132  data_time: 0.0015  memory: 17027  
11/13 12:43:20 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:18:23  time: 0.8035  data_time: 0.0016  memory: 17014  
11/13 12:44:05 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:17:09  time: 0.9228  data_time: 0.0016  memory: 17006  
11/13 12:44:47 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:15:56  time: 0.8245  data_time: 0.0015  memory: 1917  
11/13 12:45:32 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:14:48  time: 0.9114  data_time: 0.0015  memory: 17017  
11/13 12:46:11 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:13:37  time: 0.7942  data_time: 0.0016  memory: 1556  
11/13 12:46:55 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:12:32  time: 0.7731  data_time: 0.0016  memory: 17002  
11/13 12:47:52 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:11:34  time: 1.3094  data_time: 0.0016  memory: 17021  
11/13 12:48:36 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:10:31  time: 1.2172  data_time: 0.0015  memory: 17009  
11/13 12:49:16 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:09:27  time: 0.7567  data_time: 0.0015  memory: 720  
11/13 12:50:00 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:08:27  time: 0.8402  data_time: 0.0016  memory: 16952  
11/13 12:50:38 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:26  time: 0.7753  data_time: 0.0016  memory: 1600  
11/13 12:51:26 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:28  time: 0.7596  data_time: 0.0014  memory: 17024  
11/13 12:52:14 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:32  time: 0.8363  data_time: 0.0017  memory: 17015  
11/13 12:53:01 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:35  time: 0.8644  data_time: 0.0015  memory: 17004  
11/13 12:53:43 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:39  time: 0.7985  data_time: 0.0017  memory: 17004  
11/13 12:54:22 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:42  time: 0.7863  data_time: 0.0017  memory: 670  
11/13 12:55:05 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:48  time: 0.8390  data_time: 0.0016  memory: 17027  
11/13 12:55:52 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:53  time: 0.8178  data_time: 0.0015  memory: 17008  
11/13 12:56:35 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7116  data_time: 0.0014  memory: 16956  
11/13 12:56:35 - mmengine - INFO - per class results:
11/13 12:56:35 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.19 |  86.0 |
|       building      | 74.65 | 94.07 |
|         sky         | 92.21 | 95.35 |
|        floor        | 75.48 | 88.86 |
|         tree        | 66.47 | 78.39 |
|       ceiling       | 80.18 | 90.95 |
|         road        | 78.41 | 84.56 |
|         bed         | 84.65 |  95.3 |
|      windowpane     | 57.66 | 75.13 |
|        grass        | 59.01 | 78.02 |
|       cabinet       | 53.49 | 67.67 |
|       sidewalk      | 57.01 | 79.64 |
|        person       | 71.33 | 87.26 |
|        earth        | 21.56 | 29.25 |
|         door        | 38.53 | 48.91 |
|        table        | 55.18 | 71.47 |
|       mountain      | 41.26 | 59.35 |
|        plant        | 42.89 | 59.39 |
|       curtain       | 65.73 | 78.13 |
|        chair        | 50.28 | 67.47 |
|         car         | 78.94 |  88.8 |
|        water        | 42.98 | 57.91 |
|       painting      | 65.71 | 81.14 |
|         sofa        | 62.26 | 79.63 |
|        shelf        |  37.9 | 59.96 |
|        house        |  28.3 | 33.22 |
|         sea         | 52.88 | 87.84 |
|        mirror       |  59.4 | 69.42 |
|         rug         | 51.16 | 60.54 |
|        field        | 20.17 | 33.64 |
|       armchair      | 39.72 |  50.8 |
|         seat        | 51.83 | 68.78 |
|        fence        | 25.28 | 42.58 |
|         desk        | 42.41 | 57.95 |
|         rock        | 34.58 | 42.57 |
|       wardrobe      | 40.67 | 59.75 |
|         lamp        | 56.92 | 68.99 |
|       bathtub       | 69.25 | 76.03 |
|       railing       | 28.21 | 41.97 |
|       cushion       |  44.7 | 55.04 |
|         base        |  30.5 | 44.31 |
|         box         | 13.48 |  17.3 |
|        column       | 39.27 | 48.22 |
|      signboard      | 27.22 | 35.49 |
|   chest of drawers  | 38.09 | 51.38 |
|       counter       | 22.32 | 27.41 |
|         sand        | 31.99 | 56.55 |
|         sink        |  63.2 | 76.87 |
|      skyscraper     |  24.4 | 27.01 |
|      fireplace      | 61.51 | 79.51 |
|     refrigerator    | 64.64 | 76.48 |
|      grandstand     |  40.5 | 55.84 |
|         path        | 17.15 | 21.48 |
|        stairs       | 21.19 | 24.18 |
|        runway       | 65.77 | 88.98 |
|         case        | 38.78 | 65.14 |
|      pool table     | 90.65 | 94.32 |
|        pillow       | 52.73 | 69.66 |
|     screen door     | 51.41 | 58.42 |
|       stairway      | 25.98 | 29.22 |
|        river        | 11.03 | 19.89 |
|        bridge       | 28.26 | 31.49 |
|       bookcase      | 33.51 | 39.89 |
|        blind        | 28.09 | 32.55 |
|     coffee table    | 59.22 | 75.62 |
|        toilet       | 80.51 | 88.69 |
|        flower       | 24.95 | 28.59 |
|         book        | 36.57 | 51.25 |
|         hill        |  2.81 |  3.98 |
|        bench        | 42.43 | 49.68 |
|      countertop     | 55.98 | 71.78 |
|        stove        | 68.99 | 75.64 |
|         palm        | 31.74 | 57.03 |
|    kitchen island   | 33.97 | 61.39 |
|       computer      | 52.35 | 61.85 |
|     swivel chair    | 45.38 |  64.2 |
|         boat        | 37.21 | 45.01 |
|         bar         |  13.4 | 15.16 |
|    arcade machine   | 20.79 | 21.65 |
|        hovel        |  4.06 |  4.33 |
|         bus         | 78.14 | 86.49 |
|        towel        | 41.69 | 50.25 |
|        light        | 44.78 | 54.59 |
|        truck        | 18.51 | 23.27 |
|        tower        |  5.79 |  6.83 |
|      chandelier     | 53.56 | 60.03 |
|        awning       | 27.17 | 29.83 |
|     streetlight     | 16.18 | 20.96 |
|        booth        | 55.46 | 62.02 |
| television receiver | 63.77 | 71.11 |
|       airplane      | 41.99 | 63.68 |
|      dirt track     |  9.57 | 18.47 |
|       apparel       | 25.45 | 35.91 |
|         pole        | 13.81 | 19.44 |
|         land        |  4.73 |  5.86 |
|      bannister      |  4.23 |  5.04 |
|      escalator      |  4.82 |  5.04 |
|       ottoman       | 40.36 | 53.01 |
|        bottle       |  11.5 | 14.06 |
|        buffet       | 31.97 |  34.3 |
|        poster       | 13.14 | 15.22 |
|        stage        | 10.84 | 13.56 |
|         van         | 37.39 | 42.03 |
|         ship        | 84.89 | 86.71 |
|       fountain      | 18.05 | 18.13 |
|    conveyer belt    | 78.09 | 88.18 |
|        canopy       | 13.89 | 14.69 |
|        washer       | 62.69 |  65.1 |
|      plaything      | 19.13 | 23.41 |
|    swimming pool    | 21.36 | 32.22 |
|        stool        |  28.9 | 37.75 |
|        barrel       | 49.57 |  62.0 |
|        basket       |  19.5 | 26.77 |
|      waterfall      | 28.39 | 47.44 |
|         tent        | 89.12 | 97.65 |
|         bag         |  6.74 |  7.51 |
|       minibike      |  51.6 | 74.62 |
|        cradle       | 72.22 | 95.31 |
|         oven        | 23.44 | 49.92 |
|         ball        | 41.25 | 64.75 |
|         food        | 37.97 |  47.1 |
|         step        |  8.37 |  10.6 |
|         tank        | 26.58 | 28.95 |
|      trade name     | 20.61 | 22.09 |
|      microwave      |  34.5 | 37.09 |
|         pot         | 36.77 | 42.77 |
|        animal       | 47.93 | 55.29 |
|       bicycle       | 43.11 | 55.51 |
|         lake        | 50.17 | 63.36 |
|      dishwasher     | 60.59 |  65.3 |
|        screen       | 61.81 |  81.2 |
|       blanket       |  5.58 |  6.24 |
|      sculpture      | 19.56 | 21.52 |
|         hood        | 53.91 |  62.5 |
|        sconce       | 32.14 | 41.86 |
|         vase        |  30.5 | 38.88 |
|    traffic light    | 24.47 | 34.35 |
|         tray        |  3.17 |  8.07 |
|        ashcan       | 30.19 | 42.55 |
|         fan         | 51.27 | 65.87 |
|         pier        | 28.97 | 39.18 |
|      crt screen     |  7.4  |  8.37 |
|        plate        | 40.99 |  59.9 |
|       monitor       | 52.21 | 61.97 |
|    bulletin board   | 35.19 | 37.31 |
|        shower       |  2.76 |  6.23 |
|       radiator      | 45.72 | 49.64 |
|        glass        |  6.24 |  6.57 |
|        clock        | 20.77 | 22.96 |
|         flag        | 32.83 | 34.59 |
+---------------------+-------+-------+
11/13 12:56:35 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.3000  mIoU: 40.1300  mAcc: 50.1300  data_time: 0.0022  time: 1.0716
Finished processing corruption type: motion_blur
Processing corruption type: zoom_blur
11/13 12:56:39 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 476226671
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 476226671
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 12:56:39 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='zoom_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/zoom_blur'

Number of parameters:  68068492
11/13 12:56:43 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 12:56:43 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 12:56:43 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 12:56:44 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 12:58:44 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:18:07  time: 1.6283  data_time: 0.0016  memory: 17244  
11/13 13:00:04 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:03:31  time: 1.7663  data_time: 0.0017  memory: 17024  
11/13 13:01:04 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:53:24  time: 1.2575  data_time: 0.0017  memory: 17018  
11/13 13:02:15 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:49:43  time: 1.3210  data_time: 0.0016  memory: 17026  
11/13 13:03:21 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:46:22  time: 1.1286  data_time: 0.0016  memory: 17024  
11/13 13:04:19 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:43:02  time: 0.8113  data_time: 0.0016  memory: 17020  
11/13 13:05:27 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:41:08  time: 1.0990  data_time: 0.0016  memory: 17024  
11/13 13:06:26 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:38:50  time: 1.2264  data_time: 0.0015  memory: 17022  
11/13 13:07:06 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:35:42  time: 0.8311  data_time: 0.0016  memory: 16946  
11/13 13:07:52 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:33:24  time: 0.7674  data_time: 0.0016  memory: 17004  
11/13 13:08:42 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:31:33  time: 1.2637  data_time: 0.0016  memory: 17024  
11/13 13:09:24 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:29:34  time: 0.9683  data_time: 0.0017  memory: 16952  
11/13 13:10:17 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:28:08  time: 1.2211  data_time: 0.0015  memory: 17026  
11/13 13:11:14 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:26:55  time: 0.8227  data_time: 0.0017  memory: 17027  
11/13 13:12:10 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:25:44  time: 1.6622  data_time: 0.0015  memory: 17029  
11/13 13:12:52 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:24:12  time: 0.7994  data_time: 0.0018  memory: 17018  
11/13 13:13:32 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:22:44  time: 0.8093  data_time: 0.0019  memory: 720  
11/13 13:14:12 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:21:20  time: 0.8140  data_time: 0.0015  memory: 16943  
11/13 13:15:06 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:20:18  time: 0.9847  data_time: 0.0016  memory: 17024  
11/13 13:15:51 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:19:07  time: 0.7647  data_time: 0.0016  memory: 17000  
11/13 13:16:43 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:18:04  time: 1.3468  data_time: 0.0017  memory: 17027  
11/13 13:17:29 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:16:59  time: 0.7706  data_time: 0.0034  memory: 17014  
11/13 13:18:13 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:15:52  time: 0.8891  data_time: 0.0016  memory: 17006  
11/13 13:18:53 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:14:46  time: 0.7688  data_time: 0.0016  memory: 1917  
11/13 13:19:36 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:13:43  time: 0.8626  data_time: 0.0016  memory: 17017  
11/13 13:20:13 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:12:38  time: 0.7855  data_time: 0.0016  memory: 1556  
11/13 13:20:56 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:11:39  time: 0.7434  data_time: 0.0016  memory: 17002  
11/13 13:21:50 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:10:45  time: 1.2452  data_time: 0.0016  memory: 17021  
11/13 13:22:33 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:09:47  time: 1.1685  data_time: 0.0015  memory: 17009  
11/13 13:23:11 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:08:49  time: 0.7416  data_time: 0.0015  memory: 720  
11/13 13:23:54 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:07:53  time: 0.8193  data_time: 0.0016  memory: 16952  
11/13 13:24:32 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:06:57  time: 0.7848  data_time: 0.0017  memory: 1600  
11/13 13:25:20 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:04  time: 0.7202  data_time: 0.0015  memory: 17024  
11/13 13:26:09 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:11  time: 0.8005  data_time: 0.0018  memory: 17015  
11/13 13:26:54 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:18  time: 0.7904  data_time: 0.0016  memory: 17004  
11/13 13:27:35 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:25  time: 0.7984  data_time: 0.0018  memory: 17004  
11/13 13:28:15 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:33  time: 0.7951  data_time: 0.0034  memory: 670  
11/13 13:28:57 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:41  time: 0.7726  data_time: 0.0016  memory: 17027  
11/13 13:29:41 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:50  time: 0.7602  data_time: 0.0015  memory: 17008  
11/13 13:30:23 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7103  data_time: 0.0014  memory: 16956  
11/13 13:30:23 - mmengine - INFO - per class results:
11/13 13:30:23 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 51.77 | 83.86 |
|       building      | 59.09 | 79.48 |
|         sky         | 82.85 | 85.93 |
|        floor        | 52.09 | 74.51 |
|         tree        |  30.2 |  33.7 |
|       ceiling       | 62.33 | 83.73 |
|         road        | 45.97 | 51.77 |
|         bed         | 64.85 | 87.52 |
|      windowpane     | 38.61 | 57.58 |
|        grass        | 37.29 | 60.61 |
|       cabinet       | 40.71 | 51.39 |
|       sidewalk      | 26.95 | 45.06 |
|        person       |  45.0 | 67.43 |
|        earth        |  7.12 |  8.38 |
|         door        | 14.24 | 15.93 |
|        table        | 33.57 |  44.5 |
|       mountain      | 28.45 | 42.03 |
|        plant        | 19.15 | 33.62 |
|       curtain       | 35.28 | 57.16 |
|        chair        | 27.51 | 34.49 |
|         car         | 49.78 | 62.92 |
|        water        | 21.68 | 41.99 |
|       painting      | 40.96 | 65.22 |
|         sofa        | 41.77 | 59.13 |
|        shelf        | 20.36 | 27.46 |
|        house        |  2.79 |  3.09 |
|         sea         |  37.9 | 68.03 |
|        mirror       | 41.33 | 47.79 |
|         rug         | 11.68 | 12.38 |
|        field        |  13.3 | 20.66 |
|       armchair      | 14.84 | 18.38 |
|         seat        |  19.8 | 30.07 |
|        fence        |  8.71 | 16.19 |
|         desk        | 25.65 | 33.76 |
|         rock        |  15.2 | 22.36 |
|       wardrobe      | 18.22 | 27.35 |
|         lamp        | 34.94 |  46.2 |
|       bathtub       | 58.51 | 73.93 |
|       railing       | 11.29 | 17.02 |
|       cushion       | 20.74 |  24.3 |
|         base        | 14.46 | 19.32 |
|         box         |  2.31 |  2.51 |
|        column       | 12.75 | 13.86 |
|      signboard      | 12.68 | 15.21 |
|   chest of drawers  | 26.65 | 34.38 |
|       counter       |  5.16 |  7.45 |
|         sand        |  9.43 | 32.39 |
|         sink        | 37.23 | 61.59 |
|      skyscraper     |  8.96 | 10.79 |
|      fireplace      | 52.79 | 60.85 |
|     refrigerator    | 52.07 | 64.82 |
|      grandstand     | 33.68 | 41.89 |
|         path        |  3.44 |  3.86 |
|        stairs       |  2.99 |  3.44 |
|        runway       |  52.2 |  79.2 |
|         case        | 17.03 | 52.51 |
|      pool table     | 70.13 | 85.75 |
|        pillow       | 38.43 | 59.08 |
|     screen door     | 23.19 | 33.17 |
|       stairway      | 11.13 | 11.67 |
|        river        |  5.95 |  9.47 |
|        bridge       | 22.14 | 30.81 |
|       bookcase      | 12.36 | 13.73 |
|        blind        | 16.17 | 24.71 |
|     coffee table    | 28.39 | 34.41 |
|        toilet       | 62.34 | 75.81 |
|        flower       | 14.13 | 18.37 |
|         book        | 11.42 | 12.96 |
|         hill        |  3.48 |  4.99 |
|        bench        | 30.66 |  43.5 |
|      countertop     |  29.8 | 34.69 |
|        stove        | 46.86 | 52.36 |
|         palm        |  8.85 | 35.28 |
|    kitchen island   | 32.36 | 50.29 |
|       computer      | 42.82 | 48.92 |
|     swivel chair    |  4.91 |  5.34 |
|         boat        | 16.92 | 19.01 |
|         bar         | 13.01 | 15.22 |
|    arcade machine   |  2.52 |  2.52 |
|        hovel        |  1.89 |  1.9  |
|         bus         | 58.16 | 63.74 |
|        towel        | 18.09 | 23.63 |
|        light        | 15.31 | 19.52 |
|        truck        |  0.18 |  0.2  |
|        tower        |  4.71 |  4.86 |
|      chandelier     | 19.36 | 20.46 |
|        awning       | 10.25 | 11.12 |
|     streetlight     |  2.38 |  2.51 |
|        booth        | 28.79 | 29.41 |
| television receiver | 36.86 | 39.31 |
|       airplane      | 28.74 | 59.45 |
|      dirt track     |  5.84 | 16.22 |
|       apparel       |  0.63 |  0.68 |
|         pole        |  3.01 |  3.37 |
|         land        |  1.71 |  1.97 |
|      bannister      |  1.01 |  1.37 |
|      escalator      | 15.85 | 29.64 |
|       ottoman       | 29.36 | 36.69 |
|        bottle       |  1.25 |  1.33 |
|        buffet       |  0.71 |  0.74 |
|        poster       |  5.75 |  7.85 |
|        stage        |  1.32 |  2.59 |
|         van         |  4.43 |  4.43 |
|         ship        |  1.32 |  1.35 |
|       fountain      |  1.84 |  2.99 |
|    conveyer belt    | 31.46 | 46.38 |
|        canopy       |  1.64 |  1.64 |
|        washer       | 57.35 | 61.89 |
|      plaything      |  1.77 |  1.83 |
|    swimming pool    | 21.16 | 32.91 |
|        stool        | 10.14 | 12.58 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  9.09 |  11.3 |
|      waterfall      | 11.13 | 94.73 |
|         tent        | 61.83 | 75.74 |
|         bag         |  0.01 |  0.01 |
|       minibike      | 20.63 |  22.1 |
|        cradle       | 64.68 | 87.48 |
|         oven        | 20.46 | 27.93 |
|         ball        | 16.07 | 18.02 |
|         food        |  8.63 |  8.77 |
|         step        |  1.29 |  2.48 |
|         tank        |  0.0  |  0.0  |
|      trade name     |  5.93 |  6.07 |
|      microwave      | 21.81 | 24.01 |
|         pot         |  5.93 |  6.18 |
|        animal       | 25.56 | 30.58 |
|       bicycle       |  1.76 |  1.81 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 31.54 | 36.51 |
|        screen       | 59.91 | 75.96 |
|       blanket       |  0.17 |  0.2  |
|      sculpture      |  0.68 |  0.85 |
|         hood        | 37.05 | 55.67 |
|        sconce       | 11.84 | 15.09 |
|         vase        | 13.13 |  20.8 |
|    traffic light    |  3.3  |  3.38 |
|         tray        |  2.04 |  3.65 |
|        ashcan       | 11.17 | 11.74 |
|         fan         | 23.02 | 30.31 |
|         pier        | 25.35 | 28.91 |
|      crt screen     |  3.94 |  5.76 |
|        plate        | 25.69 | 33.83 |
|       monitor       |  0.5  |  0.51 |
|    bulletin board   | 12.37 | 13.54 |
|        shower       |  0.0  |  0.01 |
|       radiator      | 22.76 | 31.28 |
|        glass        |  1.09 |  1.13 |
|        clock        |  4.07 |  4.14 |
|         flag        |  6.45 |  6.75 |
+---------------------+-------+-------+
11/13 13:30:23 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 61.7000  mIoU: 21.3200  mAcc: 29.2300  data_time: 0.0022  time: 1.0093
Finished processing corruption type: zoom_blur
Processing corruption type: snow
11/13 13:31:03 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1587898371
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1587898371
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 13:31:03 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='snow',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/snow'

Number of parameters:  68068492
11/13 13:31:30 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 13:31:30 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 13:31:31 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 13:31:32 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 13:33:16 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:08:09  time: 1.1177  data_time: 0.0016  memory: 17244  
11/13 13:34:14 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:51:18  time: 1.2718  data_time: 0.0018  memory: 17024  
11/13 13:34:49 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:40:34  time: 0.7620  data_time: 0.0017  memory: 17018  
11/13 13:35:37 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:36:45  time: 0.8395  data_time: 0.0017  memory: 17026  
11/13 13:36:20 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:33:40  time: 0.6705  data_time: 0.0016  memory: 17024  
11/13 13:36:56 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:30:41  time: 0.3387  data_time: 0.0017  memory: 17020  
11/13 13:37:41 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:29:02  time: 0.6551  data_time: 0.0016  memory: 17024  
11/13 13:38:17 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:27:01  time: 0.7494  data_time: 0.0016  memory: 17022  
11/13 13:38:36 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:24:20  time: 0.4087  data_time: 0.0016  memory: 16946  
11/13 13:38:59 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:22:21  time: 0.3145  data_time: 0.0015  memory: 17004  
11/13 13:39:25 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:20:46  time: 0.7703  data_time: 0.0016  memory: 17024  
11/13 13:39:44 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:19:08  time: 0.4969  data_time: 0.0017  memory: 16952  
11/13 13:40:14 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:18:04  time: 0.7721  data_time: 0.0015  memory: 17026  
11/13 13:40:46 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:17:10  time: 0.3406  data_time: 0.0017  memory: 17027  
11/13 13:41:19 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:16:19  time: 1.2092  data_time: 0.0016  memory: 17029  
11/13 13:41:39 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:15:11  time: 0.3225  data_time: 0.0016  memory: 17018  
11/13 13:41:55 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:14:03  time: 0.3259  data_time: 0.0017  memory: 720  
11/13 13:42:14 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:13:04  time: 0.3891  data_time: 0.0015  memory: 16943  
11/13 13:42:45 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:12:24  time: 0.5231  data_time: 0.0016  memory: 17024  
11/13 13:43:07 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:11:35  time: 0.3098  data_time: 0.0016  memory: 17000  
11/13 13:43:35 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:10:54  time: 0.8601  data_time: 0.0015  memory: 17027  
11/13 13:43:58 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:10:10  time: 0.3229  data_time: 0.0016  memory: 17014  
11/13 13:44:19 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:09:26  time: 0.4295  data_time: 0.0016  memory: 17006  
11/13 13:44:35 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:08:42  time: 0.3142  data_time: 0.0015  memory: 1917  
11/13 13:44:56 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:08:02  time: 0.4183  data_time: 0.0015  memory: 17017  
11/13 13:45:11 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:07:21  time: 0.3234  data_time: 0.0015  memory: 1556  
11/13 13:45:31 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:06:43  time: 0.2987  data_time: 0.0015  memory: 17002  
11/13 13:46:02 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:06:13  time: 0.7535  data_time: 0.0015  memory: 17021  
11/13 13:46:22 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:05:37  time: 0.6914  data_time: 0.0015  memory: 17009  
11/13 13:46:38 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:05:02  time: 0.2987  data_time: 0.0015  memory: 720  
11/13 13:46:56 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:04:28  time: 0.3294  data_time: 0.0015  memory: 16952  
11/13 13:47:12 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:55  time: 0.3175  data_time: 0.0017  memory: 1600  
11/13 13:47:35 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:03:24  time: 0.3034  data_time: 0.0015  memory: 17024  
11/13 13:47:58 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:54  time: 0.3182  data_time: 0.0016  memory: 17015  
11/13 13:48:20 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:24  time: 0.3225  data_time: 0.0015  memory: 17004  
11/13 13:48:38 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:54  time: 0.3239  data_time: 0.0017  memory: 17004  
11/13 13:48:55 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:24  time: 0.3282  data_time: 0.0016  memory: 670  
11/13 13:49:14 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:55  time: 0.3150  data_time: 0.0015  memory: 17027  
11/13 13:49:35 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:27  time: 0.3112  data_time: 0.0016  memory: 17008  
11/13 13:49:54 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2909  data_time: 0.0014  memory: 16956  
11/13 13:49:54 - mmengine - INFO - per class results:
11/13 13:49:55 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 52.98 | 90.08 |
|       building      | 64.99 | 89.25 |
|         sky         | 66.45 | 68.97 |
|        floor        | 53.75 | 86.32 |
|         tree        | 63.51 | 82.37 |
|       ceiling       | 51.28 | 62.06 |
|         road        | 48.16 | 50.09 |
|         bed         | 60.23 | 65.06 |
|      windowpane     | 47.43 | 56.19 |
|        grass        | 58.18 | 75.49 |
|       cabinet       | 28.63 | 32.76 |
|       sidewalk      | 41.14 | 68.37 |
|        person       |  62.0 | 75.88 |
|        earth        | 24.57 | 34.89 |
|         door        | 14.66 | 16.41 |
|        table        | 38.11 | 46.05 |
|       mountain      | 31.09 | 39.58 |
|        plant        | 44.24 |  54.5 |
|       curtain       | 39.04 | 44.87 |
|        chair        | 39.49 | 52.62 |
|         car         | 75.24 | 83.79 |
|        water        |  29.3 | 39.23 |
|       painting      | 50.51 | 62.27 |
|         sofa        |  42.2 | 49.98 |
|        shelf        | 25.04 | 46.24 |
|        house        |  5.32 |  5.6  |
|         sea         | 34.53 | 50.24 |
|        mirror       | 29.07 | 32.69 |
|         rug         | 20.81 | 21.72 |
|        field        |  16.1 | 29.39 |
|       armchair      | 21.22 | 23.25 |
|         seat        | 25.49 | 31.45 |
|        fence        | 13.81 |  43.5 |
|         desk        | 19.29 | 20.46 |
|         rock        | 18.69 | 25.38 |
|       wardrobe      | 16.54 | 20.16 |
|         lamp        | 50.46 | 57.35 |
|       bathtub       | 27.91 | 29.86 |
|       railing       |  18.1 | 24.32 |
|       cushion       | 32.78 | 37.98 |
|         base        | 10.03 | 20.78 |
|         box         | 10.05 | 17.52 |
|        column       | 15.12 | 15.96 |
|      signboard      |  26.4 | 41.41 |
|   chest of drawers  | 17.23 | 19.95 |
|       counter       |  5.25 |  7.28 |
|         sand        |  6.84 |  7.79 |
|         sink        | 39.87 | 46.61 |
|      skyscraper     |  6.63 |  9.2  |
|      fireplace      | 40.54 | 42.45 |
|     refrigerator    | 34.75 | 37.33 |
|      grandstand     | 16.81 | 70.47 |
|         path        |  13.3 | 17.55 |
|        stairs       | 20.86 | 23.38 |
|        runway       | 31.17 |  35.3 |
|         case        | 33.87 | 52.03 |
|      pool table     | 50.73 | 51.37 |
|        pillow       | 29.67 | 32.99 |
|     screen door     |  4.5  |  4.52 |
|       stairway      |  8.05 |  8.66 |
|        river        |  7.21 | 11.58 |
|        bridge       | 40.01 | 52.82 |
|       bookcase      |  6.19 |  6.28 |
|        blind        | 13.71 | 14.21 |
|     coffee table    | 28.37 | 30.19 |
|        toilet       | 40.25 | 41.48 |
|        flower       | 28.02 | 35.45 |
|         book        | 31.34 | 39.33 |
|         hill        |  1.02 |  1.14 |
|        bench        | 16.79 | 17.74 |
|      countertop     | 21.04 | 22.27 |
|        stove        | 45.77 | 49.26 |
|         palm        | 43.12 | 54.62 |
|    kitchen island   | 22.55 |  28.6 |
|       computer      | 40.07 | 43.52 |
|     swivel chair    | 12.24 | 12.52 |
|         boat        | 28.35 | 30.94 |
|         bar         | 14.26 | 14.74 |
|    arcade machine   |  0.72 |  0.73 |
|        hovel        | 26.62 | 29.64 |
|         bus         | 79.62 |  87.5 |
|        towel        | 10.27 | 10.44 |
|        light        | 17.56 | 17.96 |
|        truck        |  7.75 |  9.8  |
|        tower        |  4.31 |  5.04 |
|      chandelier     | 52.27 | 64.74 |
|        awning       |  9.67 | 10.42 |
|     streetlight     | 18.82 | 21.49 |
|        booth        |  26.7 |  27.6 |
| television receiver | 20.92 | 22.44 |
|       airplane      | 33.95 | 44.83 |
|      dirt track     |  0.0  |  0.0  |
|       apparel       |  8.9  | 22.69 |
|         pole        | 13.14 |  19.2 |
|         land        |  0.71 |  0.73 |
|      bannister      |  3.7  |  4.14 |
|      escalator      |  5.22 |  5.49 |
|       ottoman       | 11.82 | 12.94 |
|        bottle       | 10.78 | 22.24 |
|        buffet       |  0.2  |  0.2  |
|        poster       | 16.08 | 33.27 |
|        stage        |  7.13 |  7.41 |
|         van         | 25.24 | 31.87 |
|         ship        |  4.61 |  5.79 |
|       fountain      |  0.36 |  0.43 |
|    conveyer belt    | 40.04 |  41.1 |
|        canopy       |  1.46 |  1.57 |
|        washer       | 47.25 | 47.96 |
|      plaything      | 10.47 | 11.86 |
|    swimming pool    | 12.11 | 12.78 |
|        stool        | 18.54 | 27.46 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 14.35 | 27.46 |
|      waterfall      | 36.55 | 44.91 |
|         tent        | 14.69 | 16.26 |
|         bag         |  4.16 | 10.23 |
|       minibike      | 32.92 |  40.7 |
|        cradle       | 52.34 | 66.81 |
|         oven        | 12.22 | 16.59 |
|         ball        | 30.09 | 31.47 |
|         food        | 26.31 | 31.14 |
|         step        |  0.53 |  0.57 |
|         tank        | 15.84 | 20.27 |
|      trade name     | 14.71 | 16.31 |
|      microwave      |  17.7 | 18.27 |
|         pot         | 24.83 | 26.72 |
|        animal       | 39.78 |  41.3 |
|       bicycle       | 35.79 | 66.91 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 27.52 | 28.58 |
|        screen       | 58.57 | 67.43 |
|       blanket       |  1.1  |  1.11 |
|      sculpture      |  9.83 | 11.71 |
|         hood        | 21.38 | 21.66 |
|        sconce       | 12.03 | 13.25 |
|         vase        | 32.31 | 40.46 |
|    traffic light    |  19.9 | 22.72 |
|         tray        |  2.52 |  5.41 |
|        ashcan       | 20.37 | 25.06 |
|         fan         | 36.01 | 40.41 |
|         pier        | 11.77 | 12.86 |
|      crt screen     |  4.8  | 12.38 |
|        plate        | 42.34 | 51.53 |
|       monitor       | 42.85 | 51.63 |
|    bulletin board   | 21.46 | 22.69 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  2.18 |  2.27 |
|        glass        | 10.68 | 15.15 |
|        clock        | 15.03 | 16.52 |
|         flag        | 23.84 | 25.43 |
+---------------------+-------+-------+
11/13 13:49:55 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 65.1100  mIoU: 24.6700  mAcc: 30.8100  data_time: 0.0018  time: 0.5514
Finished processing corruption type: snow
Processing corruption type: frost
11/13 13:50:13 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1101941616
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1101941616
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 13:50:13 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='frost',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/frost'

Number of parameters:  68068492
11/13 13:50:17 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 13:50:17 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 13:50:18 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 13:50:18 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 13:51:45 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:56:04  time: 0.8718  data_time: 0.0016  memory: 17244  
11/13 13:52:31 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:42:03  time: 1.0224  data_time: 0.0016  memory: 17024  
11/13 13:52:55 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:32:11  time: 0.5229  data_time: 0.0016  memory: 17018  
11/13 13:53:31 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:57  time: 0.6440  data_time: 0.0016  memory: 17026  
11/13 13:54:04 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:19  time: 0.4462  data_time: 0.0015  memory: 17024  
11/13 13:54:30 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:45  time: 0.1092  data_time: 0.0017  memory: 17020  
11/13 13:55:04 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:25  time: 0.4447  data_time: 0.0015  memory: 17024  
11/13 13:55:28 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:39  time: 0.5180  data_time: 0.0015  memory: 17022  
11/13 13:55:37 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:16  time: 0.2008  data_time: 0.0015  memory: 16946  
11/13 13:55:48 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:30  time: 0.0946  data_time: 0.0015  memory: 17004  
11/13 13:56:02 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:05  time: 0.5321  data_time: 0.0016  memory: 17024  
11/13 13:56:10 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:40  time: 0.2588  data_time: 0.0016  memory: 16952  
11/13 13:56:28 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:47  time: 0.5285  data_time: 0.0014  memory: 17026  
11/13 13:56:49 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:05  time: 0.1058  data_time: 0.0017  memory: 17027  
11/13 13:57:11 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:28  time: 1.0454  data_time: 0.0015  memory: 17029  
11/13 13:57:20 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:32  time: 0.0926  data_time: 0.0016  memory: 17018  
11/13 13:57:25 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:37  time: 0.0948  data_time: 0.0017  memory: 720  
11/13 13:57:33 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:50  time: 0.1885  data_time: 0.0015  memory: 16943  
11/13 13:57:52 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:21  time: 0.2934  data_time: 0.0016  memory: 17024  
11/13 13:58:04 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:45  time: 0.0894  data_time: 0.0015  memory: 17000  
11/13 13:58:20 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:15  time: 0.6278  data_time: 0.0016  memory: 17027  
11/13 13:58:32 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:44  time: 0.0966  data_time: 0.0016  memory: 17014  
11/13 13:58:41 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:11  time: 0.1931  data_time: 0.0015  memory: 17006  
11/13 13:58:46 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:38  time: 0.0921  data_time: 0.0015  memory: 1917  
11/13 13:58:56 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:10  time: 0.1988  data_time: 0.0015  memory: 17017  
11/13 13:59:01 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:41  time: 0.0948  data_time: 0.0015  memory: 1556  
11/13 13:59:09 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:15  time: 0.0927  data_time: 0.0015  memory: 17002  
11/13 13:59:29 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:56  time: 0.5203  data_time: 0.0015  memory: 17021  
11/13 13:59:39 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:32  time: 0.4498  data_time: 0.0015  memory: 17009  
11/13 13:59:43 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:08  time: 0.0879  data_time: 0.0015  memory: 720  
11/13 13:59:50 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:45  time: 0.0982  data_time: 0.0016  memory: 16952  
11/13 13:59:54 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:23  time: 0.0914  data_time: 0.0016  memory: 1600  
11/13 14:00:06 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:04  time: 0.0837  data_time: 0.0014  memory: 17024  
11/13 14:00:17 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:45  time: 0.0924  data_time: 0.0016  memory: 17015  
11/13 14:00:27 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:26  time: 0.0962  data_time: 0.0014  memory: 17004  
11/13 14:00:35 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:08  time: 0.0957  data_time: 0.0017  memory: 17004  
11/13 14:00:40 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:50  time: 0.0939  data_time: 0.0016  memory: 670  
11/13 14:00:49 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:33  time: 0.0981  data_time: 0.0015  memory: 17027  
11/13 14:00:59 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.0895  data_time: 0.0015  memory: 17008  
11/13 14:01:07 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0876  data_time: 0.0014  memory: 16956  
11/13 14:01:07 - mmengine - INFO - per class results:
11/13 14:01:07 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 63.28 |  87.1 |
|       building      | 77.29 | 90.83 |
|         sky         |  78.7 | 81.53 |
|        floor        | 69.04 |  87.7 |
|         tree        | 60.44 | 85.83 |
|       ceiling       | 70.02 |  79.3 |
|         road        | 69.31 | 76.13 |
|         bed         | 80.36 | 91.36 |
|      windowpane     | 52.78 | 67.78 |
|        grass        | 60.33 |  77.6 |
|       cabinet       | 45.18 |  53.2 |
|       sidewalk      | 48.48 | 59.32 |
|        person       | 70.88 | 84.99 |
|        earth        | 26.48 | 47.31 |
|         door        | 27.84 | 37.48 |
|        table        | 51.06 | 67.89 |
|       mountain      | 30.64 | 70.07 |
|        plant        | 42.72 | 52.39 |
|       curtain       | 53.09 | 64.52 |
|        chair        | 48.25 | 59.71 |
|         car         | 77.55 |  86.0 |
|        water        | 38.48 | 50.02 |
|       painting      | 61.76 |  78.7 |
|         sofa        | 60.07 | 76.47 |
|        shelf        | 33.44 | 47.84 |
|        house        | 33.62 | 39.03 |
|         sea         | 36.43 | 58.72 |
|        mirror       | 49.05 | 55.44 |
|         rug         | 36.24 | 41.67 |
|        field        | 24.65 | 38.35 |
|       armchair      | 33.75 | 40.61 |
|         seat        | 53.08 | 58.53 |
|        fence        | 23.08 |  35.5 |
|         desk        | 34.44 | 44.58 |
|         rock        | 30.38 |  45.3 |
|       wardrobe      | 31.52 | 42.17 |
|         lamp        | 54.34 | 63.69 |
|       bathtub       | 40.43 | 49.34 |
|       railing       | 24.43 | 34.87 |
|       cushion       | 46.76 | 57.97 |
|         base        | 13.09 | 14.89 |
|         box         | 16.28 | 21.51 |
|        column       | 38.32 | 47.96 |
|      signboard      | 30.17 | 40.64 |
|   chest of drawers  | 29.17 | 33.54 |
|       counter       | 16.92 | 26.71 |
|         sand        | 18.97 | 22.45 |
|         sink        | 57.17 | 66.42 |
|      skyscraper     | 32.82 | 36.93 |
|      fireplace      |  53.2 |  63.9 |
|     refrigerator    | 50.08 | 53.56 |
|      grandstand     | 35.36 | 57.87 |
|         path        | 18.96 | 26.05 |
|        stairs       | 31.48 | 39.56 |
|        runway       | 62.36 | 73.43 |
|         case        | 46.53 | 72.23 |
|      pool table     | 85.79 | 87.97 |
|        pillow       | 43.75 | 54.36 |
|     screen door     |  38.4 | 63.01 |
|       stairway      |  27.7 | 32.53 |
|        river        |  8.96 | 16.17 |
|        bridge       | 58.42 | 64.19 |
|       bookcase      | 24.19 | 27.75 |
|        blind        |  25.4 | 26.88 |
|     coffee table    | 60.16 | 69.75 |
|        toilet       | 65.71 |  69.2 |
|        flower       |  28.3 | 38.67 |
|         book        | 37.04 | 52.88 |
|         hill        |  3.7  |  5.35 |
|        bench        | 40.82 | 47.06 |
|      countertop     | 45.92 | 66.71 |
|        stove        |  56.2 | 59.68 |
|         palm        |  42.1 | 51.96 |
|    kitchen island   | 30.28 | 59.68 |
|       computer      | 46.88 | 49.81 |
|     swivel chair    | 29.13 | 32.95 |
|         boat        | 33.38 |  35.2 |
|         bar         | 16.51 | 18.55 |
|    arcade machine   |  5.21 |  5.24 |
|        hovel        | 26.64 | 36.58 |
|         bus         | 82.56 | 87.66 |
|        towel        | 30.39 | 35.45 |
|        light        | 33.31 | 35.73 |
|        truck        | 10.26 | 12.33 |
|        tower        | 15.82 | 19.67 |
|      chandelier     | 57.92 | 74.35 |
|        awning       | 16.33 |  17.3 |
|     streetlight     | 19.78 | 22.18 |
|        booth        | 26.96 | 29.74 |
| television receiver | 38.66 | 40.66 |
|       airplane      | 38.18 | 59.03 |
|      dirt track     |  3.79 | 20.58 |
|       apparel       | 18.01 |  23.3 |
|         pole        | 15.11 | 22.29 |
|         land        |  4.47 |  4.56 |
|      bannister      |  3.18 |  3.98 |
|      escalator      | 20.19 | 21.26 |
|       ottoman       | 40.01 |  44.3 |
|        bottle       | 15.44 |  19.8 |
|        buffet       |  0.32 |  0.34 |
|        poster       | 17.01 | 20.28 |
|        stage        | 11.12 | 13.16 |
|         van         | 25.84 | 32.46 |
|         ship        |  7.37 |  7.4  |
|       fountain      |  5.97 |  6.05 |
|    conveyer belt    | 54.56 | 57.44 |
|        canopy       |  1.37 |  1.51 |
|        washer       | 51.41 | 52.09 |
|      plaything      | 29.04 | 33.68 |
|    swimming pool    | 29.56 | 37.86 |
|        stool        | 23.94 | 38.08 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 23.09 | 32.49 |
|      waterfall      | 45.31 | 53.49 |
|         tent        | 57.91 | 64.55 |
|         bag         |  4.82 |  5.88 |
|       minibike      |  52.9 | 59.08 |
|        cradle       | 69.57 | 90.18 |
|         oven        | 19.94 | 28.78 |
|         ball        | 41.31 | 65.04 |
|         food        | 36.56 | 46.52 |
|         step        | 10.85 | 14.34 |
|         tank        | 22.08 | 22.32 |
|      trade name     | 16.22 | 17.89 |
|      microwave      | 26.39 | 27.94 |
|         pot         | 31.06 | 33.81 |
|        animal       | 51.02 | 54.72 |
|       bicycle       | 47.29 | 66.89 |
|         lake        | 58.33 | 62.72 |
|      dishwasher     | 37.71 | 40.97 |
|        screen       | 33.92 | 36.15 |
|       blanket       |  8.94 |  9.57 |
|      sculpture      | 21.17 |  28.1 |
|         hood        | 50.54 |  51.8 |
|        sconce       | 27.91 | 32.07 |
|         vase        | 33.66 | 47.75 |
|    traffic light    | 19.99 | 22.73 |
|         tray        |  4.07 |  7.27 |
|        ashcan       | 29.37 | 31.64 |
|         fan         | 49.41 | 61.53 |
|         pier        | 10.45 | 10.72 |
|      crt screen     |  0.49 |  1.0  |
|        plate        | 41.71 | 49.15 |
|       monitor       | 30.95 | 36.19 |
|    bulletin board   | 37.64 | 40.21 |
|        shower       |  1.13 |  1.88 |
|       radiator      | 25.88 | 26.72 |
|        glass        |  9.42 | 10.24 |
|        clock        | 19.67 | 21.79 |
|         flag        | 23.33 | 24.55 |
+---------------------+-------+-------+
11/13 14:01:07 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 73.8300  mIoU: 35.0700  mAcc: 43.1300  data_time: 0.0018  time: 0.3243
Finished processing corruption type: frost
Processing corruption type: fog
11/13 14:01:10 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 748466366
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 748466366
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 14:01:11 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='fog',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/fog'

Number of parameters:  68068492
11/13 14:01:15 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 14:01:15 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 14:01:15 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 14:01:16 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 14:02:50 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:01:16  time: 1.0075  data_time: 0.0017  memory: 17244  
11/13 14:03:43 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:46:30  time: 1.1641  data_time: 0.0019  memory: 17024  
11/13 14:04:13 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:36:24  time: 0.6515  data_time: 0.0016  memory: 17018  
11/13 14:04:55 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:32:57  time: 0.7560  data_time: 0.0016  memory: 17026  
11/13 14:05:34 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:30:10  time: 0.5776  data_time: 0.0016  memory: 17024  
11/13 14:06:06 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:27:27  time: 0.2356  data_time: 0.0037  memory: 17020  
11/13 14:06:46 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:25:59  time: 0.5709  data_time: 0.0015  memory: 17024  
11/13 14:07:17 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:24:06  time: 0.6481  data_time: 0.0015  memory: 17022  
11/13 14:07:32 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:21:36  time: 0.3284  data_time: 0.0015  memory: 16946  
11/13 14:07:50 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:19:43  time: 0.2257  data_time: 0.0015  memory: 17004  
11/13 14:08:10 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:18:13  time: 0.6605  data_time: 0.0016  memory: 17024  
11/13 14:08:25 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:16:41  time: 0.3883  data_time: 0.0016  memory: 16952  
11/13 14:08:50 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:15:43  time: 0.6604  data_time: 0.0014  memory: 17026  
11/13 14:09:17 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:14:53  time: 0.2313  data_time: 0.0017  memory: 17027  
11/13 14:09:45 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:14:08  time: 1.1202  data_time: 0.0015  memory: 17029  
11/13 14:10:00 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:13:06  time: 0.2217  data_time: 0.0016  memory: 17018  
11/13 14:10:11 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:12:04  time: 0.2276  data_time: 0.0018  memory: 720  
11/13 14:10:26 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:12  time: 0.3144  data_time: 0.0015  memory: 16943  
11/13 14:10:52 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:36  time: 0.4232  data_time: 0.0016  memory: 17024  
11/13 14:11:09 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:09:53  time: 0.2173  data_time: 0.0016  memory: 17000  
11/13 14:11:32 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:17  time: 0.7524  data_time: 0.0015  memory: 17027  
11/13 14:11:51 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:39  time: 0.2219  data_time: 0.0016  memory: 17014  
11/13 14:12:06 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:08:00  time: 0.3269  data_time: 0.0015  memory: 17006  
11/13 14:12:17 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:21  time: 0.2216  data_time: 0.0015  memory: 1917  
11/13 14:12:34 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:46  time: 0.3270  data_time: 0.0015  memory: 17017  
11/13 14:12:45 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:11  time: 0.2217  data_time: 0.0015  memory: 1556  
11/13 14:12:59 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:38  time: 0.2193  data_time: 0.0015  memory: 17002  
11/13 14:13:26 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:13  time: 0.6481  data_time: 0.0015  memory: 17021  
11/13 14:13:42 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:43  time: 0.5790  data_time: 0.0015  memory: 17009  
11/13 14:13:53 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:12  time: 0.2168  data_time: 0.0015  memory: 720  
11/13 14:14:06 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:43  time: 0.2270  data_time: 0.0016  memory: 16952  
11/13 14:14:17 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:15  time: 0.2216  data_time: 0.0017  memory: 1600  
11/13 14:14:36 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:49  time: 0.2172  data_time: 0.0015  memory: 17024  
11/13 14:14:53 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:24  time: 0.2243  data_time: 0.0017  memory: 17015  
11/13 14:15:10 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:59  time: 0.2270  data_time: 0.0015  memory: 17004  
11/13 14:15:24 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:34  time: 0.2251  data_time: 0.0017  memory: 17004  
11/13 14:15:36 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:09  time: 0.2256  data_time: 0.0017  memory: 670  
11/13 14:15:51 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:46  time: 0.2251  data_time: 0.0015  memory: 17027  
11/13 14:16:07 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:22  time: 0.2173  data_time: 0.0015  memory: 17008  
11/13 14:16:22 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2151  data_time: 0.0014  memory: 16956  
11/13 14:16:22 - mmengine - INFO - per class results:
11/13 14:16:22 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  72.9 | 87.89 |
|       building      | 77.85 | 91.85 |
|         sky         | 93.05 | 96.43 |
|        floor        | 76.45 | 88.97 |
|         tree        | 69.97 | 88.14 |
|       ceiling       | 81.17 | 90.49 |
|         road        | 79.86 | 87.32 |
|         bed         | 86.52 | 95.82 |
|      windowpane     | 58.57 | 77.02 |
|        grass        | 61.46 | 76.66 |
|       cabinet       | 56.97 | 70.45 |
|       sidewalk      | 61.45 | 78.12 |
|        person       | 74.64 | 88.06 |
|        earth        | 29.66 | 44.05 |
|         door        | 42.89 | 54.88 |
|        table        | 57.34 | 72.37 |
|       mountain      | 51.62 | 73.18 |
|        plant        | 46.83 | 57.01 |
|       curtain       | 69.35 | 80.77 |
|        chair        | 53.43 | 71.93 |
|         car         | 81.02 | 88.65 |
|        water        | 42.59 | 57.77 |
|       painting      | 67.05 | 80.78 |
|         sofa        | 61.05 | 78.24 |
|        shelf        | 40.44 | 60.97 |
|        house        | 30.88 |  36.6 |
|         sea         | 41.54 |  69.5 |
|        mirror       |  59.6 | 69.95 |
|         rug         | 46.68 | 52.92 |
|        field        | 22.08 | 30.41 |
|       armchair      | 37.47 | 47.69 |
|         seat        | 55.05 | 69.81 |
|        fence        | 34.87 | 47.53 |
|         desk        | 43.97 | 57.83 |
|         rock        | 32.63 |  44.8 |
|       wardrobe      | 39.46 | 54.84 |
|         lamp        | 59.96 | 73.09 |
|       bathtub       | 67.07 | 82.46 |
|       railing       | 31.66 |  50.7 |
|       cushion       | 47.14 | 56.93 |
|         base        | 16.13 | 19.45 |
|         box         | 15.57 | 20.56 |
|        column       | 45.21 | 59.23 |
|      signboard      | 31.53 | 44.74 |
|   chest of drawers  | 38.69 |  53.3 |
|       counter       | 23.92 | 34.84 |
|         sand        | 27.68 | 39.09 |
|         sink        | 63.05 | 79.08 |
|      skyscraper     | 24.02 | 25.22 |
|      fireplace      |  69.4 | 78.12 |
|     refrigerator    | 62.33 | 72.24 |
|      grandstand     | 47.72 | 66.84 |
|         path        | 19.76 | 24.44 |
|        stairs       | 31.37 | 37.11 |
|        runway       | 64.24 | 91.72 |
|         case        | 42.97 | 71.56 |
|      pool table     | 90.54 | 94.19 |
|        pillow       | 53.02 | 71.39 |
|     screen door     |  64.0 | 81.28 |
|       stairway      | 25.19 | 28.11 |
|        river        | 11.95 | 15.62 |
|        bridge       | 28.22 | 31.09 |
|       bookcase      | 33.24 | 38.97 |
|        blind        | 43.36 | 50.34 |
|     coffee table    | 61.19 | 73.76 |
|        toilet       | 77.14 |  89.9 |
|        flower       | 28.13 | 39.66 |
|         book        | 39.11 | 55.48 |
|         hill        |  4.76 |  6.18 |
|        bench        | 42.18 | 48.75 |
|      countertop     | 52.78 | 74.25 |
|        stove        | 65.58 | 68.46 |
|         palm        | 43.96 | 55.02 |
|    kitchen island   | 39.02 | 69.43 |
|       computer      | 51.63 | 64.67 |
|     swivel chair    |  39.5 | 49.28 |
|         boat        | 55.61 | 59.94 |
|         bar         | 17.92 | 19.54 |
|    arcade machine   | 10.15 | 10.29 |
|        hovel        |  2.4  |  2.49 |
|         bus         | 84.27 | 87.12 |
|        towel        | 45.03 | 60.52 |
|        light        | 45.68 |  53.2 |
|        truck        | 18.94 |  21.7 |
|        tower        |  7.59 |  9.19 |
|      chandelier     | 63.34 | 76.78 |
|        awning       | 17.05 | 17.61 |
|     streetlight     | 22.33 | 28.53 |
|        booth        | 36.03 | 36.89 |
| television receiver | 54.17 | 58.33 |
|       airplane      | 29.59 | 63.07 |
|      dirt track     | 11.09 | 17.83 |
|       apparel       | 19.39 |  29.6 |
|         pole        |  16.2 | 23.07 |
|         land        |  7.63 |  10.4 |
|      bannister      | 10.65 | 15.87 |
|      escalator      | 15.95 | 16.39 |
|       ottoman       | 46.13 | 54.95 |
|        bottle       | 12.22 | 21.35 |
|        buffet       | 31.69 | 34.45 |
|        poster       |  21.9 | 31.29 |
|        stage        |  3.13 |  3.49 |
|         van         | 44.31 | 56.58 |
|         ship        | 70.43 | 73.47 |
|       fountain      |  0.0  |  0.0  |
|    conveyer belt    | 75.49 |  77.9 |
|        canopy       |  15.1 | 15.78 |
|        washer       | 61.41 | 65.36 |
|      plaything      | 23.51 | 36.13 |
|    swimming pool    | 25.74 | 31.52 |
|        stool        | 29.98 | 43.15 |
|        barrel       | 39.38 | 62.08 |
|        basket       | 30.44 | 37.99 |
|      waterfall      | 41.91 |  53.1 |
|         tent        | 83.54 | 98.19 |
|         bag         |  7.76 |  8.95 |
|       minibike      | 54.75 | 60.35 |
|        cradle       | 73.26 | 92.93 |
|         oven        | 32.32 | 36.15 |
|         ball        | 37.62 | 62.79 |
|         food        | 25.77 | 29.15 |
|         step        | 21.87 | 27.85 |
|         tank        | 28.19 | 28.77 |
|      trade name     | 18.13 | 20.06 |
|      microwave      | 37.16 | 40.65 |
|         pot         | 38.97 | 44.43 |
|        animal       | 47.19 |  48.5 |
|       bicycle       | 49.74 | 69.69 |
|         lake        | 39.56 | 63.42 |
|      dishwasher     | 66.82 | 72.99 |
|        screen       | 41.85 | 63.51 |
|       blanket       |  7.23 |  7.89 |
|      sculpture      | 32.49 | 38.03 |
|         hood        | 57.86 | 61.05 |
|        sconce       | 35.25 | 43.89 |
|         vase        | 38.97 | 56.86 |
|    traffic light    | 23.66 | 29.08 |
|         tray        |  4.36 |  5.94 |
|        ashcan       | 30.77 | 36.75 |
|         fan         | 53.95 | 67.91 |
|         pier        | 26.03 | 29.31 |
|      crt screen     |  0.2  |  0.45 |
|        plate        | 42.71 | 53.74 |
|       monitor       | 38.04 | 43.37 |
|    bulletin board   | 35.76 | 41.99 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 37.95 |  51.3 |
|        glass        | 13.51 | 16.36 |
|        clock        | 19.72 | 23.54 |
|         flag        |  23.9 | 24.78 |
+---------------------+-------+-------+
11/13 14:16:22 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.7300  mIoU: 41.0200  mAcc: 50.8300  data_time: 0.0020  time: 0.4532
Finished processing corruption type: fog
Processing corruption type: brightness
11/13 14:16:40 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1525494874
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1525494874
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 14:16:40 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='brightness',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/brightness'

Number of parameters:  68068492
11/13 14:16:48 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 14:16:49 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 14:16:49 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 14:16:50 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 14:18:27 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:03:12  time: 1.0378  data_time: 0.0016  memory: 17244  
11/13 14:19:21 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:47:47  time: 1.1940  data_time: 0.0017  memory: 17024  
11/13 14:19:52 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:37:27  time: 0.6773  data_time: 0.0016  memory: 17018  
11/13 14:20:36 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:33:55  time: 0.7813  data_time: 0.0020  memory: 17026  
11/13 14:21:16 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:31:00  time: 0.5971  data_time: 0.0016  memory: 17024  
11/13 14:21:48 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:28:12  time: 0.2572  data_time: 0.0017  memory: 17020  
11/13 14:22:29 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:26:41  time: 0.5853  data_time: 0.0015  memory: 17024  
11/13 14:23:01 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:24:46  time: 0.6720  data_time: 0.0014  memory: 17022  
11/13 14:23:16 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:22:10  time: 0.3341  data_time: 0.0015  memory: 16946  
11/13 14:23:35 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:20:16  time: 0.2437  data_time: 0.0015  memory: 17004  
11/13 14:23:57 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:18:45  time: 0.6848  data_time: 0.0016  memory: 17024  
11/13 14:24:12 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:17:11  time: 0.4196  data_time: 0.0017  memory: 16952  
11/13 14:24:38 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:16:11  time: 0.6747  data_time: 0.0014  memory: 17026  
11/13 14:25:06 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:15:22  time: 0.2617  data_time: 0.0017  memory: 17027  
11/13 14:25:35 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:14:36  time: 1.1367  data_time: 0.0015  memory: 17029  
11/13 14:25:51 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:13:32  time: 0.2470  data_time: 0.0016  memory: 17018  
11/13 14:26:04 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:12:29  time: 0.2486  data_time: 0.0016  memory: 720  
11/13 14:26:18 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:34  time: 0.3166  data_time: 0.0015  memory: 16943  
11/13 14:26:45 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:58  time: 0.4405  data_time: 0.0016  memory: 17024  
11/13 14:27:04 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:10:13  time: 0.2311  data_time: 0.0015  memory: 17000  
11/13 14:27:27 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:36  time: 0.7779  data_time: 0.0015  memory: 17027  
11/13 14:27:47 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:57  time: 0.2389  data_time: 0.0016  memory: 17014  
11/13 14:28:04 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:08:18  time: 0.3476  data_time: 0.0015  memory: 17006  
11/13 14:28:16 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:37  time: 0.2387  data_time: 0.0024  memory: 1917  
11/13 14:28:33 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:07:02  time: 0.3385  data_time: 0.0015  memory: 17017  
11/13 14:28:45 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:24  time: 0.2450  data_time: 0.0015  memory: 1556  
11/13 14:29:00 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:51  time: 0.2279  data_time: 0.0015  memory: 17002  
11/13 14:29:28 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:24  time: 0.6725  data_time: 0.0015  memory: 17021  
11/13 14:29:44 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:53  time: 0.6038  data_time: 0.0015  memory: 17009  
11/13 14:29:56 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:22  time: 0.2279  data_time: 0.0015  memory: 720  
11/13 14:30:10 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:52  time: 0.2490  data_time: 0.0015  memory: 16952  
11/13 14:30:22 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:23  time: 0.2397  data_time: 0.0016  memory: 1600  
11/13 14:30:41 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:56  time: 0.2249  data_time: 0.0015  memory: 17024  
11/13 14:31:00 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:30  time: 0.2436  data_time: 0.0016  memory: 17015  
11/13 14:31:18 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:03  time: 0.2422  data_time: 0.0015  memory: 17004  
11/13 14:31:32 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:38  time: 0.2455  data_time: 0.0016  memory: 17004  
11/13 14:31:45 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:12  time: 0.2494  data_time: 0.0036  memory: 670  
11/13 14:32:00 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:47  time: 0.2382  data_time: 0.0015  memory: 17027  
11/13 14:32:18 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:23  time: 0.2323  data_time: 0.0015  memory: 17008  
11/13 14:32:33 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2198  data_time: 0.0014  memory: 16956  
11/13 14:32:33 - mmengine - INFO - per class results:
11/13 14:32:33 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.33 |  88.5 |
|       building      | 78.55 | 92.44 |
|         sky         | 93.42 |  97.0 |
|        floor        | 77.89 | 90.26 |
|         tree        | 71.98 | 87.01 |
|       ceiling       |  82.1 | 90.74 |
|         road        | 81.82 | 89.86 |
|         bed         | 87.13 | 95.24 |
|      windowpane     | 59.66 | 75.49 |
|        grass        | 64.39 | 81.51 |
|       cabinet       | 58.44 | 72.82 |
|       sidewalk      | 64.32 |  78.3 |
|        person       |  76.0 | 89.35 |
|        earth        |  33.7 | 46.47 |
|         door        | 44.51 | 58.15 |
|        table        | 59.16 | 74.67 |
|       mountain      | 52.63 | 71.32 |
|        plant        | 49.12 | 61.83 |
|       curtain       | 68.75 |  80.7 |
|        chair        | 53.97 | 68.15 |
|         car         | 81.55 |  88.8 |
|        water        | 45.97 | 59.49 |
|       painting      | 67.99 | 82.26 |
|         sofa        | 63.09 | 82.35 |
|        shelf        | 40.37 | 58.79 |
|        house        | 28.94 | 33.37 |
|         sea         | 52.61 | 85.75 |
|        mirror       | 59.75 | 69.42 |
|         rug         | 48.96 | 56.21 |
|        field        | 24.11 | 38.37 |
|       armchair      | 38.74 | 49.89 |
|         seat        | 58.86 | 76.65 |
|        fence        | 34.57 | 48.05 |
|         desk        | 47.17 |  61.4 |
|         rock        | 31.37 | 45.32 |
|       wardrobe      | 43.45 | 59.67 |
|         lamp        | 60.33 |  72.5 |
|       bathtub       | 72.38 | 78.94 |
|       railing       | 30.74 | 43.26 |
|       cushion       | 53.74 |  67.2 |
|         base        | 22.05 |  26.6 |
|         box         |  18.2 | 24.66 |
|        column       |  42.3 |  53.2 |
|      signboard      | 32.56 |  46.3 |
|   chest of drawers  |  38.6 | 55.23 |
|       counter       |  28.3 |  38.4 |
|         sand        | 47.94 | 62.21 |
|         sink        |  65.3 | 79.56 |
|      skyscraper     |  25.8 | 27.95 |
|      fireplace      | 68.09 | 80.21 |
|     refrigerator    |  61.5 | 74.88 |
|      grandstand     | 39.73 | 63.52 |
|         path        | 19.02 | 23.87 |
|        stairs       |  33.3 | 38.77 |
|        runway       | 61.68 |  82.6 |
|         case        | 50.46 | 71.67 |
|      pool table     | 91.99 | 94.91 |
|        pillow       | 54.99 | 66.91 |
|     screen door     | 60.05 | 72.24 |
|       stairway      | 27.81 | 30.86 |
|        river        | 14.18 | 21.98 |
|        bridge       | 45.22 | 48.83 |
|       bookcase      | 35.62 | 41.78 |
|        blind        | 42.99 |  48.8 |
|     coffee table    |  61.7 | 78.13 |
|        toilet       |  81.5 | 90.07 |
|        flower       | 33.82 | 48.36 |
|         book        | 43.13 |  62.8 |
|         hill        |  5.4  |  7.26 |
|        bench        | 44.84 | 50.82 |
|      countertop     | 53.02 | 69.34 |
|        stove        | 70.75 | 75.02 |
|         palm        |  46.2 | 62.62 |
|    kitchen island   | 44.91 | 71.91 |
|       computer      | 52.68 | 64.74 |
|     swivel chair    | 41.22 | 57.26 |
|         boat        | 37.21 | 41.04 |
|         bar         |  16.7 | 18.38 |
|    arcade machine   | 41.24 | 43.26 |
|        hovel        | 25.79 | 32.08 |
|         bus         | 85.35 | 89.57 |
|        towel        | 45.81 | 56.03 |
|        light        | 47.58 | 55.42 |
|        truck        | 26.71 | 33.13 |
|        tower        |  6.93 |  8.26 |
|      chandelier     | 61.99 | 77.15 |
|        awning       | 25.12 | 27.02 |
|     streetlight     | 21.58 | 27.75 |
|        booth        | 43.03 | 48.46 |
| television receiver | 63.42 | 74.17 |
|       airplane      |  41.3 | 63.75 |
|      dirt track     | 11.03 | 21.85 |
|       apparel       | 29.04 | 43.74 |
|         pole        | 18.48 | 26.92 |
|         land        |  7.63 |  9.56 |
|      bannister      |  7.15 |  8.96 |
|      escalator      | 18.54 | 21.72 |
|       ottoman       | 41.56 | 52.73 |
|        bottle       | 17.94 | 27.68 |
|        buffet       |  35.7 | 38.83 |
|        poster       | 20.35 | 25.77 |
|        stage        | 13.19 | 15.53 |
|         van         | 45.59 | 57.15 |
|         ship        | 81.27 | 87.97 |
|       fountain      |  2.47 |  2.49 |
|    conveyer belt    | 77.32 | 88.64 |
|        canopy       | 15.62 | 16.98 |
|        washer       | 65.33 | 69.78 |
|      plaything      | 29.74 | 46.51 |
|    swimming pool    | 29.12 | 39.65 |
|        stool        | 32.59 | 42.21 |
|        barrel       | 36.88 | 63.12 |
|        basket       | 30.49 | 40.62 |
|      waterfall      | 51.51 | 62.59 |
|         tent        | 91.06 | 97.09 |
|         bag         |  7.37 |  8.74 |
|       minibike      | 57.96 | 65.62 |
|        cradle       | 74.03 | 95.41 |
|         oven        | 33.43 | 56.12 |
|         ball        | 39.03 | 65.59 |
|         food        | 44.65 | 53.88 |
|         step        |  17.7 | 20.56 |
|         tank        | 30.95 | 32.86 |
|      trade name     | 23.52 |  27.2 |
|      microwave      |  35.2 | 38.29 |
|         pot         | 40.13 | 47.33 |
|        animal       | 50.68 |  52.7 |
|       bicycle       |  51.2 | 69.31 |
|         lake        | 52.67 | 63.37 |
|      dishwasher     |  72.2 | 77.42 |
|        screen       | 60.58 | 77.29 |
|       blanket       |  7.66 |  8.61 |
|      sculpture      | 34.61 | 40.32 |
|         hood        | 55.27 | 61.41 |
|        sconce       | 38.04 | 46.85 |
|         vase        | 40.29 | 55.06 |
|    traffic light    | 25.22 |  32.7 |
|         tray        |  6.29 | 11.61 |
|        ashcan       | 34.29 | 43.96 |
|         fan         | 55.39 |  68.4 |
|         pier        | 24.94 | 28.48 |
|      crt screen     |  1.86 |  3.39 |
|        plate        | 46.06 | 57.99 |
|       monitor       |  43.0 |  51.4 |
|    bulletin board   | 37.29 | 40.99 |
|        shower       |  0.24 |  0.43 |
|       radiator      | 43.21 | 51.64 |
|        glass        |  12.6 | 13.97 |
|        clock        | 23.72 | 27.55 |
|         flag        | 26.83 | 29.24 |
+---------------------+-------+-------+
11/13 14:32:33 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.8600  mIoU: 43.8100  mAcc: 53.9400  data_time: 0.0018  time: 0.4716
Finished processing corruption type: brightness
Processing corruption type: contrast
11/13 14:32:36 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1814173936
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1814173936
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 14:32:36 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='contrast',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/contrast'

Number of parameters:  68068492
11/13 14:32:41 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 14:32:41 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 14:32:41 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 14:32:41 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 14:34:08 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:56:05  time: 0.8734  data_time: 0.0016  memory: 17244  
11/13 14:34:54 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:42:03  time: 1.0466  data_time: 0.0016  memory: 17024  
11/13 14:35:18 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:32:10  time: 0.5205  data_time: 0.0016  memory: 17018  
11/13 14:35:54 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:56  time: 0.6435  data_time: 0.0024  memory: 17026  
11/13 14:36:27 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:18  time: 0.4461  data_time: 0.0015  memory: 17024  
11/13 14:36:53 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:43  time: 0.1038  data_time: 0.0017  memory: 17020  
11/13 14:37:27 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:23  time: 0.4434  data_time: 0.0015  memory: 17024  
11/13 14:37:51 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:38  time: 0.5184  data_time: 0.0015  memory: 17022  
11/13 14:37:59 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:14  time: 0.1981  data_time: 0.0015  memory: 16946  
11/13 14:38:11 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:28  time: 0.0944  data_time: 0.0015  memory: 17004  
11/13 14:38:24 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:04  time: 0.5331  data_time: 0.0020  memory: 17024  
11/13 14:38:32 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:38  time: 0.2571  data_time: 0.0016  memory: 16952  
11/13 14:38:51 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:46  time: 0.5256  data_time: 0.0014  memory: 17026  
11/13 14:39:12 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:04  time: 0.1033  data_time: 0.0017  memory: 17027  
11/13 14:39:34 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:26  time: 1.0467  data_time: 0.0015  memory: 17029  
11/13 14:39:42 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:31  time: 0.0927  data_time: 0.0017  memory: 17018  
11/13 14:39:47 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:35  time: 0.0917  data_time: 0.0017  memory: 720  
11/13 14:39:55 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:49  time: 0.1856  data_time: 0.0015  memory: 16943  
11/13 14:40:14 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:20  time: 0.2937  data_time: 0.0016  memory: 17024  
11/13 14:40:25 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:43  time: 0.0867  data_time: 0.0015  memory: 17000  
11/13 14:40:42 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:14  time: 0.6289  data_time: 0.0016  memory: 17027  
11/13 14:40:54 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:42  time: 0.0933  data_time: 0.0017  memory: 17014  
11/13 14:41:03 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:10  time: 0.1951  data_time: 0.0015  memory: 17006  
11/13 14:41:08 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:37  time: 0.0913  data_time: 0.0016  memory: 1917  
11/13 14:41:18 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:09  time: 0.1992  data_time: 0.0016  memory: 17017  
11/13 14:41:22 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:40  time: 0.0914  data_time: 0.0015  memory: 1556  
11/13 14:41:30 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:14  time: 0.0894  data_time: 0.0015  memory: 17002  
11/13 14:41:51 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:55  time: 0.5182  data_time: 0.0015  memory: 17021  
11/13 14:42:00 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:31  time: 0.4498  data_time: 0.0015  memory: 17009  
11/13 14:42:04 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:07  time: 0.0858  data_time: 0.0015  memory: 720  
11/13 14:42:11 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:45  time: 0.0950  data_time: 0.0015  memory: 16952  
11/13 14:42:15 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:23  time: 0.0901  data_time: 0.0016  memory: 1600  
11/13 14:42:27 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:04  time: 0.0823  data_time: 0.0015  memory: 17024  
11/13 14:42:38 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:45  time: 0.0919  data_time: 0.0017  memory: 17015  
11/13 14:42:48 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:26  time: 0.0934  data_time: 0.0015  memory: 17004  
11/13 14:42:56 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:08  time: 0.0927  data_time: 0.0017  memory: 17004  
11/13 14:43:00 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:50  time: 0.0915  data_time: 0.0017  memory: 670  
11/13 14:43:09 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:33  time: 0.0965  data_time: 0.0016  memory: 17027  
11/13 14:43:19 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.0888  data_time: 0.0015  memory: 17008  
11/13 14:43:27 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0861  data_time: 0.0014  memory: 16956  
11/13 14:43:27 - mmengine - INFO - per class results:
11/13 14:43:27 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  72.5 | 88.49 |
|       building      | 78.78 | 91.86 |
|         sky         | 93.26 | 96.42 |
|        floor        | 76.37 | 89.41 |
|         tree        | 69.62 | 87.36 |
|       ceiling       |  81.3 | 90.57 |
|         road        | 80.35 | 87.32 |
|         bed         | 85.88 | 95.94 |
|      windowpane     | 58.38 | 74.96 |
|        grass        |  60.2 | 74.88 |
|       cabinet       | 57.78 | 71.15 |
|       sidewalk      | 61.88 | 77.09 |
|        person       | 74.77 | 87.24 |
|        earth        | 29.84 | 46.27 |
|         door        | 43.94 | 56.68 |
|        table        |  56.9 | 71.69 |
|       mountain      | 50.17 | 71.08 |
|        plant        | 45.67 | 54.19 |
|       curtain       |  68.7 | 79.59 |
|        chair        | 53.13 | 70.89 |
|         car         | 80.45 | 87.76 |
|        water        | 44.66 | 63.79 |
|       painting      | 65.46 | 80.73 |
|         sofa        |  62.2 | 78.97 |
|        shelf        | 40.35 | 59.75 |
|        house        |  36.2 | 43.13 |
|         sea         | 49.94 | 75.35 |
|        mirror       |  58.6 |  69.9 |
|         rug         | 46.59 | 52.67 |
|        field        | 29.74 | 43.33 |
|       armchair      | 38.03 | 48.71 |
|         seat        | 53.85 | 68.24 |
|        fence        | 31.56 | 42.42 |
|         desk        | 43.39 | 56.92 |
|         rock        | 28.42 | 39.22 |
|       wardrobe      | 38.36 | 53.04 |
|         lamp        | 59.45 | 72.74 |
|       bathtub       | 63.52 | 82.31 |
|       railing       | 30.17 | 48.88 |
|       cushion       | 46.84 | 56.16 |
|         base        |  21.6 | 25.84 |
|         box         | 17.05 | 22.81 |
|        column       | 44.67 | 56.28 |
|      signboard      | 31.63 | 44.22 |
|   chest of drawers  | 37.14 | 52.76 |
|       counter       | 22.37 | 33.41 |
|         sand        | 21.78 | 31.95 |
|         sink        | 61.34 | 77.71 |
|      skyscraper     | 25.85 | 27.92 |
|      fireplace      | 70.08 | 79.52 |
|     refrigerator    | 59.01 | 70.09 |
|      grandstand     | 40.01 | 59.22 |
|         path        | 20.64 | 24.58 |
|        stairs       | 30.58 | 36.45 |
|        runway       | 63.09 | 91.34 |
|         case        | 40.55 | 73.09 |
|      pool table     |  90.3 | 94.52 |
|        pillow       | 51.76 |  68.3 |
|     screen door     | 64.71 | 78.88 |
|       stairway      | 22.75 | 25.44 |
|        river        |  2.33 |  3.22 |
|        bridge       | 29.17 | 31.92 |
|       bookcase      | 32.76 | 38.33 |
|        blind        | 40.94 | 49.24 |
|     coffee table    | 60.35 | 73.25 |
|        toilet       | 76.43 |  89.4 |
|        flower       | 31.07 | 37.72 |
|         book        | 37.42 | 52.84 |
|         hill        |  4.28 |  4.98 |
|        bench        | 41.85 |  47.7 |
|      countertop     | 51.08 | 73.36 |
|        stove        | 62.35 |  64.3 |
|         palm        | 41.12 | 51.36 |
|    kitchen island   | 38.31 | 70.22 |
|       computer      | 52.28 | 64.66 |
|     swivel chair    | 35.64 | 45.92 |
|         boat        | 36.61 | 39.18 |
|         bar         | 12.87 | 13.84 |
|    arcade machine   | 10.02 | 10.11 |
|        hovel        |  2.69 |  2.93 |
|         bus         | 84.77 | 87.65 |
|        towel        | 44.27 | 57.06 |
|        light        | 41.69 | 47.04 |
|        truck        | 16.89 | 19.45 |
|        tower        |  9.2  | 11.08 |
|      chandelier     | 62.26 | 77.58 |
|        awning       | 16.77 | 17.07 |
|     streetlight     | 21.94 | 28.16 |
|        booth        | 46.61 | 47.89 |
| television receiver |  48.8 | 50.82 |
|       airplane      | 31.46 | 62.17 |
|      dirt track     |  8.13 |  18.6 |
|       apparel       | 16.69 | 22.57 |
|         pole        | 15.65 |  21.9 |
|         land        | 12.16 | 16.68 |
|      bannister      |  6.62 |  9.45 |
|      escalator      |  4.9  |  5.31 |
|       ottoman       | 46.72 | 54.97 |
|        bottle       | 11.38 |  19.7 |
|        buffet       | 32.57 | 36.32 |
|        poster       |  20.6 | 25.99 |
|        stage        |  3.9  |  4.4  |
|         van         | 45.91 | 57.82 |
|         ship        | 69.92 | 76.77 |
|       fountain      |  0.0  |  0.0  |
|    conveyer belt    | 64.99 | 68.34 |
|        canopy       | 17.01 | 18.46 |
|        washer       | 62.94 | 67.09 |
|      plaything      | 27.02 | 38.38 |
|    swimming pool    | 25.11 | 30.65 |
|        stool        | 29.38 | 39.79 |
|        barrel       | 35.05 | 62.93 |
|        basket       | 28.36 | 34.62 |
|      waterfall      | 35.57 | 42.62 |
|         tent        | 82.69 | 98.12 |
|         bag         |  6.81 |  7.7  |
|       minibike      | 50.74 | 56.08 |
|        cradle       | 72.48 | 93.72 |
|         oven        | 36.02 | 41.22 |
|         ball        |  36.2 | 63.28 |
|         food        | 22.89 | 26.42 |
|         step        | 19.49 | 24.71 |
|         tank        | 27.45 | 27.81 |
|      trade name     | 17.19 | 18.99 |
|      microwave      | 35.98 | 38.98 |
|         pot         | 39.12 | 44.03 |
|        animal       | 44.75 |  45.7 |
|       bicycle       | 48.76 | 67.59 |
|         lake        | 38.66 | 63.39 |
|      dishwasher     | 65.64 | 72.92 |
|        screen       | 57.63 | 69.04 |
|       blanket       |  8.24 |  8.99 |
|      sculpture      | 29.13 |  32.6 |
|         hood        | 56.02 | 59.16 |
|        sconce       | 35.37 | 43.05 |
|         vase        |  37.3 | 54.62 |
|    traffic light    | 22.84 | 28.23 |
|         tray        |  4.09 |  5.67 |
|        ashcan       | 31.02 | 35.85 |
|         fan         | 54.39 | 67.46 |
|         pier        | 27.29 |  31.3 |
|      crt screen     |  1.61 |  4.61 |
|        plate        | 38.78 | 46.98 |
|       monitor       | 15.49 | 17.53 |
|    bulletin board   | 37.14 | 46.85 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 39.22 | 52.65 |
|        glass        | 13.36 | 16.57 |
|        clock        | 19.53 | 22.36 |
|         flag        | 21.32 | 21.98 |
+---------------------+-------+-------+
11/13 14:43:27 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.6600  mIoU: 40.1600  mAcc: 49.7400  data_time: 0.0018  time: 0.3228
Finished processing corruption type: contrast
Processing corruption type: elastic_transform
11/13 14:43:31 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 973482558
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 973482558
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 14:43:31 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/elastic_transform'

Number of parameters:  68068492
11/13 14:43:36 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 14:43:36 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 14:43:36 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 14:43:36 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 14:45:49 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:25:55  time: 1.8635  data_time: 0.0016  memory: 17244  
11/13 14:47:21 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:11:12  time: 2.0141  data_time: 0.0016  memory: 17024  
11/13 14:48:32 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:00:47  time: 1.4986  data_time: 0.0016  memory: 17018  
11/13 14:49:56 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:56:59  time: 1.5624  data_time: 0.0016  memory: 17026  
11/13 14:51:14 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:53:23  time: 1.3695  data_time: 0.0015  memory: 17024  
11/13 14:52:24 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:49:51  time: 1.0763  data_time: 0.0017  memory: 17020  
11/13 14:53:44 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:47:46  time: 1.3384  data_time: 0.0015  memory: 17024  
11/13 14:54:55 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:45:15  time: 1.4739  data_time: 0.0015  memory: 17022  
11/13 14:55:47 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:41:54  time: 1.0407  data_time: 0.0024  memory: 16946  
11/13 14:56:44 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:39:23  time: 1.0056  data_time: 0.0015  memory: 17004  
11/13 14:57:47 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:37:23  time: 1.5126  data_time: 0.0017  memory: 17024  
11/13 14:58:41 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:35:10  time: 1.2019  data_time: 0.0017  memory: 16952  
11/13 14:59:45 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:33:31  time: 1.4520  data_time: 0.0014  memory: 17026  
11/13 15:00:54 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:32:07  time: 1.0640  data_time: 0.0016  memory: 17027  
11/13 15:02:03 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:30:44  time: 1.9083  data_time: 0.0015  memory: 17029  
11/13 15:02:56 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:28:59  time: 1.0335  data_time: 0.0016  memory: 17018  
11/13 15:03:48 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:27:18  time: 1.0429  data_time: 0.0017  memory: 720  
11/13 15:04:39 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:25:42  time: 1.0113  data_time: 0.0014  memory: 16943  
11/13 15:05:45 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:24:28  time: 1.2055  data_time: 0.0016  memory: 17024  
11/13 15:06:42 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:23:05  time: 0.9823  data_time: 0.0016  memory: 17000  
11/13 15:07:46 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:21:51  time: 1.6061  data_time: 0.0016  memory: 17027  
11/13 15:08:45 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:20:34  time: 1.0043  data_time: 0.0016  memory: 17014  
11/13 15:09:40 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:19:15  time: 1.1270  data_time: 0.0015  memory: 17006  
11/13 15:10:32 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:17:57  time: 1.0062  data_time: 0.0015  memory: 1917  
11/13 15:11:26 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:16:41  time: 1.0885  data_time: 0.0015  memory: 17017  
11/13 15:12:15 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:15:25  time: 1.0306  data_time: 0.0015  memory: 1556  
11/13 15:13:09 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:14:13  time: 0.9635  data_time: 0.0015  memory: 17002  
11/13 15:14:15 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:13:07  time: 1.5003  data_time: 0.0016  memory: 17021  
11/13 15:15:08 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:11:57  time: 1.4241  data_time: 0.0016  memory: 17009  
11/13 15:15:59 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:10:47  time: 0.9614  data_time: 0.0015  memory: 720  
11/13 15:16:53 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:09:39  time: 1.0530  data_time: 0.0015  memory: 16952  
11/13 15:17:43 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:08:31  time: 1.0087  data_time: 0.0016  memory: 1600  
11/13 15:18:41 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:26  time: 0.9479  data_time: 0.0015  memory: 17024  
11/13 15:19:39 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:21  time: 1.0317  data_time: 0.0016  memory: 17015  
11/13 15:20:36 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:05:17  time: 1.0156  data_time: 0.0015  memory: 17004  
11/13 15:21:29 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:04:12  time: 1.0298  data_time: 0.0017  memory: 17004  
11/13 15:22:20 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:03:08  time: 1.0359  data_time: 0.0016  memory: 670  
11/13 15:23:12 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:02:05  time: 0.9973  data_time: 0.0015  memory: 17027  
11/13 15:24:09 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:02  time: 0.9901  data_time: 0.0024  memory: 17008  
11/13 15:25:02 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.9319  data_time: 0.0014  memory: 16956  
11/13 15:25:02 - mmengine - INFO - per class results:
11/13 15:25:02 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 62.16 | 79.21 |
|       building      | 71.45 | 88.54 |
|         sky         | 83.73 |  91.3 |
|        floor        | 66.63 |  82.1 |
|         tree        | 62.11 | 79.56 |
|       ceiling       | 68.17 | 81.44 |
|         road        | 73.62 |  85.5 |
|         bed         | 74.37 |  87.7 |
|      windowpane     |  46.7 | 64.03 |
|        grass        | 57.33 | 74.48 |
|       cabinet       | 49.86 | 65.49 |
|       sidewalk      | 50.19 |  67.2 |
|        person       | 58.61 | 76.96 |
|        earth        | 30.96 | 43.83 |
|         door        | 35.76 | 46.97 |
|        table        | 43.99 | 61.85 |
|       mountain      |  46.5 | 64.36 |
|        plant        | 41.06 | 54.44 |
|       curtain       | 47.95 | 67.09 |
|        chair        | 38.78 |  55.0 |
|         car         | 59.96 | 74.31 |
|        water        | 41.67 | 54.51 |
|       painting      | 47.13 |  65.0 |
|         sofa        | 51.58 | 71.57 |
|        shelf        | 36.45 | 56.11 |
|        house        | 24.81 | 29.07 |
|         sea         | 46.17 | 75.45 |
|        mirror       | 47.75 | 60.28 |
|         rug         | 40.11 | 48.88 |
|        field        | 23.38 | 39.77 |
|       armchair      | 30.16 | 41.12 |
|         seat        | 52.39 | 72.17 |
|        fence        | 28.12 | 40.95 |
|         desk        | 39.54 |  55.3 |
|         rock        | 27.38 | 42.92 |
|       wardrobe      | 39.81 | 53.87 |
|         lamp        |  29.0 | 43.74 |
|       bathtub       |  62.1 |  71.1 |
|       railing       | 24.89 | 40.89 |
|       cushion       | 36.11 | 49.79 |
|         base        | 22.88 | 29.96 |
|         box         |  12.2 | 16.89 |
|        column       | 26.17 | 38.04 |
|      signboard      | 19.59 | 29.54 |
|   chest of drawers  | 34.15 | 47.53 |
|       counter       | 21.15 | 28.29 |
|         sand        | 32.42 | 46.08 |
|         sink        | 45.92 | 62.05 |
|      skyscraper     | 25.35 | 28.72 |
|      fireplace      | 61.41 | 76.87 |
|     refrigerator    | 54.67 | 65.52 |
|      grandstand     | 34.43 | 59.35 |
|         path        | 11.91 | 15.32 |
|        stairs       | 21.14 | 25.06 |
|        runway       | 59.57 | 81.46 |
|         case        |  45.5 | 65.85 |
|      pool table     | 70.46 | 82.36 |
|        pillow       | 38.69 | 52.91 |
|     screen door     | 56.02 | 64.23 |
|       stairway      | 21.24 | 24.26 |
|        river        | 10.07 | 16.42 |
|        bridge       | 38.67 | 45.17 |
|       bookcase      | 29.09 |  38.0 |
|        blind        | 28.15 | 32.13 |
|     coffee table    | 46.66 | 66.96 |
|        toilet       | 53.36 | 70.98 |
|        flower       | 24.12 | 36.57 |
|         book        | 30.44 | 47.57 |
|         hill        |  4.34 |  6.21 |
|        bench        | 35.45 | 43.75 |
|      countertop     | 39.11 | 53.45 |
|        stove        | 56.48 | 64.54 |
|         palm        | 35.93 | 50.52 |
|    kitchen island   | 34.04 | 57.29 |
|       computer      | 43.41 | 58.46 |
|     swivel chair    | 34.97 | 49.72 |
|         boat        | 30.02 | 34.76 |
|         bar         | 17.02 | 19.07 |
|    arcade machine   | 19.63 | 20.46 |
|        hovel        | 17.51 | 25.54 |
|         bus         | 66.37 |  80.5 |
|        towel        |  31.3 | 42.99 |
|        light        | 14.28 | 21.79 |
|        truck        | 25.89 | 34.82 |
|        tower        |  4.0  |  5.07 |
|      chandelier     | 44.69 | 61.19 |
|        awning       | 13.15 | 14.87 |
|     streetlight     |  6.99 |  11.2 |
|        booth        | 48.04 | 52.14 |
| television receiver | 43.69 | 57.45 |
|       airplane      | 32.19 | 50.11 |
|      dirt track     |  9.81 | 17.33 |
|       apparel       | 19.23 | 33.82 |
|         pole        |  6.77 | 10.32 |
|         land        |  8.12 | 10.13 |
|      bannister      |  0.79 |  1.01 |
|      escalator      |  4.09 |  4.4  |
|       ottoman       | 35.12 | 47.97 |
|        bottle       | 10.05 | 15.96 |
|        buffet       | 30.31 | 33.53 |
|        poster       |  19.6 | 25.11 |
|        stage        |  9.17 | 11.89 |
|         van         | 33.27 |  42.2 |
|         ship        | 56.91 |  59.8 |
|       fountain      |  9.59 |  9.94 |
|    conveyer belt    | 42.42 | 62.79 |
|        canopy       | 14.14 | 15.98 |
|        washer       | 58.61 | 64.41 |
|      plaything      | 22.48 | 34.03 |
|    swimming pool    | 22.33 | 33.88 |
|        stool        | 18.76 | 27.11 |
|        barrel       | 43.84 | 60.63 |
|        basket       | 19.38 | 26.99 |
|      waterfall      | 46.01 | 65.72 |
|         tent        | 76.75 | 88.69 |
|         bag         |  5.24 |  6.68 |
|       minibike      | 46.02 | 63.67 |
|        cradle       |  59.6 | 85.01 |
|         oven        | 21.34 | 47.32 |
|         ball        | 37.63 | 60.08 |
|         food        | 38.78 | 49.43 |
|         step        | 13.61 |  16.4 |
|         tank        | 32.34 | 34.96 |
|      trade name     | 13.19 | 15.91 |
|      microwave      | 25.98 | 29.81 |
|         pot         | 17.43 | 24.42 |
|        animal       | 42.92 | 47.07 |
|       bicycle       | 32.52 |  48.3 |
|         lake        | 35.36 | 59.19 |
|      dishwasher     | 52.04 | 60.64 |
|        screen       | 56.19 |  78.5 |
|       blanket       |  6.24 |  7.03 |
|      sculpture      | 26.89 | 33.79 |
|         hood        | 48.82 | 61.81 |
|        sconce       | 18.06 | 26.74 |
|         vase        | 18.87 | 34.88 |
|    traffic light    | 11.69 |  18.1 |
|         tray        |  4.7  |  9.96 |
|        ashcan       | 19.77 |  31.7 |
|         fan         | 22.05 | 35.51 |
|         pier        | 21.91 | 25.63 |
|      crt screen     |  1.59 |  3.0  |
|        plate        | 31.48 | 44.27 |
|       monitor       | 27.09 | 34.47 |
|    bulletin board   | 23.81 |  28.8 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 29.53 | 37.17 |
|        glass        |  8.54 |  9.75 |
|        clock        |  9.56 | 12.83 |
|         flag        | 18.34 | 21.22 |
+---------------------+-------+-------+
11/13 15:25:02 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 72.9800  mIoU: 33.7900  mAcc: 44.8100  data_time: 0.0021  time: 1.2425
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
11/13 15:25:30 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1773233209
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1773233209
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 15:25:30 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/pixelate'

Number of parameters:  68068492
11/13 15:25:49 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 15:25:49 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 15:25:50 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 15:25:51 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 15:27:19 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:57:19  time: 0.8621  data_time: 0.0016  memory: 17244  
11/13 15:28:05 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:42:26  time: 1.0322  data_time: 0.0017  memory: 17024  
11/13 15:28:28 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:32:17  time: 0.5065  data_time: 0.0015  memory: 17018  
11/13 15:29:03 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:55  time: 0.6292  data_time: 0.0016  memory: 17026  
11/13 15:29:35 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:13  time: 0.4326  data_time: 0.0015  memory: 17024  
11/13 15:30:00 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:36  time: 0.0887  data_time: 0.0016  memory: 17020  
11/13 15:30:34 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:15  time: 0.4318  data_time: 0.0015  memory: 17024  
11/13 15:30:58 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:27  time: 0.5022  data_time: 0.0015  memory: 17022  
11/13 15:31:05 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:03  time: 0.1853  data_time: 0.0015  memory: 16946  
11/13 15:31:16 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:16  time: 0.0799  data_time: 0.0015  memory: 17004  
11/13 15:31:29 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:14:51  time: 0.5166  data_time: 0.0016  memory: 17024  
11/13 15:31:36 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:25  time: 0.2409  data_time: 0.0016  memory: 16952  
11/13 15:31:53 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:33  time: 0.5097  data_time: 0.0014  memory: 17026  
11/13 15:32:14 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:51  time: 0.0893  data_time: 0.0016  memory: 17027  
11/13 15:32:35 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:14  time: 1.0490  data_time: 0.0015  memory: 17029  
11/13 15:32:43 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:18  time: 0.0778  data_time: 0.0016  memory: 17018  
11/13 15:32:47 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:23  time: 0.0783  data_time: 0.0016  memory: 720  
11/13 15:32:54 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:37  time: 0.1740  data_time: 0.0025  memory: 16943  
11/13 15:33:13 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:08  time: 0.2800  data_time: 0.0015  memory: 17024  
11/13 15:33:23 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:32  time: 0.0741  data_time: 0.0015  memory: 17000  
11/13 15:33:39 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:03  time: 0.6098  data_time: 0.0015  memory: 17027  
11/13 15:33:51 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:32  time: 0.0791  data_time: 0.0016  memory: 17014  
11/13 15:33:59 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:00  time: 0.1799  data_time: 0.0015  memory: 17006  
11/13 15:34:03 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:28  time: 0.0792  data_time: 0.0017  memory: 1917  
11/13 15:34:12 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:00  time: 0.1841  data_time: 0.0015  memory: 17017  
11/13 15:34:16 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:32  time: 0.0767  data_time: 0.0015  memory: 1556  
11/13 15:34:23 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:06  time: 0.0763  data_time: 0.0015  memory: 17002  
11/13 15:34:43 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:48  time: 0.5015  data_time: 0.0015  memory: 17021  
11/13 15:34:51 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:25  time: 0.4335  data_time: 0.0014  memory: 17009  
11/13 15:34:55 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:01  time: 0.0726  data_time: 0.0015  memory: 720  
11/13 15:35:01 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:39  time: 0.0806  data_time: 0.0015  memory: 16952  
11/13 15:35:05 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:18  time: 0.0774  data_time: 0.0033  memory: 1600  
11/13 15:35:16 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:59  time: 0.0711  data_time: 0.0015  memory: 17024  
11/13 15:35:26 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:41  time: 0.0771  data_time: 0.0017  memory: 17015  
11/13 15:35:36 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:23  time: 0.0814  data_time: 0.0015  memory: 17004  
11/13 15:35:43 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:05  time: 0.0788  data_time: 0.0016  memory: 17004  
11/13 15:35:47 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:48  time: 0.0779  data_time: 0.0017  memory: 670  
11/13 15:35:55 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:31  time: 0.0836  data_time: 0.0015  memory: 17027  
11/13 15:36:04 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:15  time: 0.0741  data_time: 0.0015  memory: 17008  
11/13 15:36:11 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0734  data_time: 0.0014  memory: 16956  
11/13 15:36:11 - mmengine - INFO - per class results:
11/13 15:36:11 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.44 | 88.42 |
|       building      | 78.56 | 93.47 |
|         sky         | 93.62 | 96.84 |
|        floor        | 78.09 | 90.46 |
|         tree        | 71.93 | 86.56 |
|       ceiling       |  81.6 | 89.89 |
|         road        |  82.1 | 91.05 |
|         bed         | 86.97 | 94.86 |
|      windowpane     | 59.13 |  74.8 |
|        grass        |  64.2 | 80.12 |
|       cabinet       | 58.17 | 72.74 |
|       sidewalk      |  63.0 | 77.77 |
|        person       | 76.29 | 87.85 |
|        earth        | 33.84 |  46.1 |
|         door        | 42.55 |  55.7 |
|        table        | 58.91 | 75.09 |
|       mountain      | 50.55 | 67.81 |
|        plant        | 49.22 | 61.26 |
|       curtain       | 69.43 | 81.73 |
|        chair        | 53.67 | 66.97 |
|         car         | 80.76 | 87.42 |
|        water        | 42.62 | 57.44 |
|       painting      | 69.38 | 82.87 |
|         sofa        | 61.22 | 82.67 |
|        shelf        | 40.42 | 59.71 |
|        house        | 37.97 | 43.11 |
|         sea         | 47.11 | 75.65 |
|        mirror       | 60.94 | 69.46 |
|         rug         | 49.14 | 57.28 |
|        field        | 24.75 | 40.02 |
|       armchair      | 34.99 | 43.93 |
|         seat        | 58.49 | 76.93 |
|        fence        | 33.86 | 46.51 |
|         desk        | 47.96 | 61.51 |
|         rock        | 30.53 | 43.39 |
|       wardrobe      |  44.0 | 58.96 |
|         lamp        | 60.63 | 72.46 |
|       bathtub       | 74.01 | 80.23 |
|       railing       | 32.11 | 45.12 |
|       cushion       | 52.56 | 65.71 |
|         base        | 21.11 | 25.78 |
|         box         | 18.44 | 24.68 |
|        column       |  42.3 | 52.76 |
|      signboard      | 32.46 | 44.09 |
|   chest of drawers  | 38.31 | 56.64 |
|       counter       | 25.01 | 35.82 |
|         sand        | 38.13 | 49.74 |
|         sink        | 67.07 | 79.99 |
|      skyscraper     | 26.93 | 28.93 |
|      fireplace      | 69.05 | 81.28 |
|     refrigerator    | 65.09 | 76.83 |
|      grandstand     | 37.28 | 65.67 |
|         path        | 18.05 | 23.68 |
|        stairs       | 34.49 | 41.28 |
|        runway       | 62.03 | 83.23 |
|         case        | 47.11 | 72.71 |
|      pool table     | 91.43 | 94.84 |
|        pillow       | 53.93 | 66.39 |
|     screen door     | 62.53 | 73.05 |
|       stairway      | 28.02 |  31.9 |
|        river        |  15.9 | 25.06 |
|        bridge       | 51.09 | 56.49 |
|       bookcase      | 35.19 | 42.69 |
|        blind        | 45.68 |  52.6 |
|     coffee table    | 61.08 | 78.05 |
|        toilet       | 82.66 | 89.94 |
|        flower       | 33.84 | 47.09 |
|         book        | 43.04 | 62.11 |
|         hill        |  5.14 |  7.25 |
|        bench        | 43.98 | 50.38 |
|      countertop     | 54.29 | 68.38 |
|        stove        | 70.17 | 75.02 |
|         palm        | 47.77 |  60.4 |
|    kitchen island   |  43.7 | 75.74 |
|       computer      | 53.07 | 64.94 |
|     swivel chair    | 42.58 | 59.63 |
|         boat        | 36.28 | 40.08 |
|         bar         | 26.71 | 32.25 |
|    arcade machine   | 23.85 | 25.14 |
|        hovel        | 27.81 | 30.83 |
|         bus         | 83.04 | 91.54 |
|        towel        | 50.15 | 56.68 |
|        light        | 48.88 | 57.01 |
|        truck        |  29.4 | 39.96 |
|        tower        |  6.62 |  7.93 |
|      chandelier     |  63.1 | 79.25 |
|        awning       | 24.42 | 25.84 |
|     streetlight     | 22.12 | 29.47 |
|        booth        | 50.12 | 55.77 |
| television receiver | 64.22 | 75.94 |
|       airplane      | 40.95 | 62.02 |
|      dirt track     | 11.26 |  21.2 |
|       apparel       | 25.59 | 38.87 |
|         pole        | 18.39 | 26.35 |
|         land        |  8.68 | 10.29 |
|      bannister      |  7.97 | 10.15 |
|      escalator      |  8.34 |  9.47 |
|       ottoman       | 38.34 | 48.71 |
|        bottle       | 16.09 | 27.18 |
|        buffet       | 37.26 | 41.86 |
|        poster       | 21.98 | 27.55 |
|        stage        | 12.31 | 15.35 |
|         van         | 44.79 | 62.32 |
|         ship        | 84.84 | 87.97 |
|       fountain      |  3.54 |  3.6  |
|    conveyer belt    | 72.01 | 88.92 |
|        canopy       | 15.91 | 16.74 |
|        washer       |  65.3 | 68.39 |
|      plaything      | 31.93 |  41.3 |
|    swimming pool    | 23.05 | 33.53 |
|        stool        | 33.89 | 45.52 |
|        barrel       | 26.95 | 63.28 |
|        basket       |  32.9 | 40.05 |
|      waterfall      | 49.24 | 60.34 |
|         tent        |  92.5 | 96.92 |
|         bag         |  7.69 |  8.8  |
|       minibike      | 53.83 | 59.66 |
|        cradle       | 69.42 | 96.31 |
|         oven        |  25.9 | 56.87 |
|         ball        | 41.68 | 64.36 |
|         food        | 42.95 | 52.14 |
|         step        | 13.21 | 15.92 |
|         tank        | 31.48 | 33.55 |
|      trade name     | 25.77 |  29.8 |
|      microwave      | 36.13 |  39.9 |
|         pot         |  40.8 | 47.99 |
|        animal       | 52.37 | 54.92 |
|       bicycle       | 45.91 | 61.07 |
|         lake        | 37.33 | 63.37 |
|      dishwasher     | 70.25 | 76.43 |
|        screen       | 63.87 | 85.29 |
|       blanket       |  5.22 |  5.62 |
|      sculpture      | 29.91 |  35.0 |
|         hood        | 54.45 | 62.74 |
|        sconce       | 37.32 | 46.15 |
|         vase        | 37.86 | 50.47 |
|    traffic light    | 26.06 | 34.24 |
|         tray        |  5.88 |  9.58 |
|        ashcan       | 34.34 |  44.0 |
|         fan         | 53.93 | 68.02 |
|         pier        | 23.12 | 27.61 |
|      crt screen     |  0.83 |  1.34 |
|        plate        | 45.75 |  55.8 |
|       monitor       |  49.6 |  59.7 |
|    bulletin board   | 34.97 | 38.28 |
|        shower       |  0.66 |  1.22 |
|       radiator      | 41.73 | 48.95 |
|        glass        | 11.96 | 13.35 |
|        clock        | 22.66 | 25.72 |
|         flag        | 26.46 |  27.8 |
+---------------------+-------+-------+
11/13 15:36:11 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.7800  mIoU: 43.3300  mAcc: 53.6800  data_time: 0.0018  time: 0.3102
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
11/13 15:36:15 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1584242413
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1584242413
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 15:36:15 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/jpeg_compression'

Number of parameters:  68068492
11/13 15:36:19 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 15:36:19 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 15:36:20 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 15:36:20 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 15:37:48 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:57:32  time: 0.8606  data_time: 0.0030  memory: 17244  
11/13 15:38:35 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:42:39  time: 1.0138  data_time: 0.0016  memory: 17024  
11/13 15:38:58 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:32:29  time: 0.5137  data_time: 0.0016  memory: 17018  
11/13 15:39:34 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:29:07  time: 0.6356  data_time: 0.0018  memory: 17026  
11/13 15:40:06 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:24  time: 0.4397  data_time: 0.0016  memory: 17024  
11/13 15:40:32 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:46  time: 0.0955  data_time: 0.0016  memory: 17020  
11/13 15:41:05 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:24  time: 0.4352  data_time: 0.0015  memory: 17024  
11/13 15:41:29 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:36  time: 0.5100  data_time: 0.0014  memory: 17022  
11/13 15:41:37 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:12  time: 0.1910  data_time: 0.0015  memory: 16946  
11/13 15:41:48 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:25  time: 0.0873  data_time: 0.0015  memory: 17004  
11/13 15:42:01 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:00  time: 0.5250  data_time: 0.0017  memory: 17024  
11/13 15:42:09 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:34  time: 0.2492  data_time: 0.0017  memory: 16952  
11/13 15:42:27 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:41  time: 0.5166  data_time: 0.0014  memory: 17026  
11/13 15:42:47 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:59  time: 0.0955  data_time: 0.0017  memory: 17027  
11/13 15:43:09 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:21  time: 1.0509  data_time: 0.0016  memory: 17029  
11/13 15:43:17 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:25  time: 0.0851  data_time: 0.0017  memory: 17018  
11/13 15:43:22 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:30  time: 0.0856  data_time: 0.0017  memory: 720  
11/13 15:43:29 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:44  time: 0.1786  data_time: 0.0015  memory: 16943  
11/13 15:43:48 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:15  time: 0.2851  data_time: 0.0016  memory: 17024  
11/13 15:43:59 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:38  time: 0.0805  data_time: 0.0015  memory: 17000  
11/13 15:44:15 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:09  time: 0.6171  data_time: 0.0015  memory: 17027  
11/13 15:44:27 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:38  time: 0.0841  data_time: 0.0016  memory: 17014  
11/13 15:44:35 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:06  time: 0.1848  data_time: 0.0015  memory: 17006  
11/13 15:44:40 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:32  time: 0.0833  data_time: 0.0015  memory: 1917  
11/13 15:44:49 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:05  time: 0.1900  data_time: 0.0015  memory: 17017  
11/13 15:44:53 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:36  time: 0.0840  data_time: 0.0015  memory: 1556  
11/13 15:45:01 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:10  time: 0.0817  data_time: 0.0015  memory: 17002  
11/13 15:45:21 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:51  time: 0.5093  data_time: 0.0015  memory: 17021  
11/13 15:45:29 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:28  time: 0.4405  data_time: 0.0015  memory: 17009  
11/13 15:45:33 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:04  time: 0.0789  data_time: 0.0014  memory: 720  
11/13 15:45:40 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:42  time: 0.0881  data_time: 0.0015  memory: 16952  
11/13 15:45:44 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:20  time: 0.0826  data_time: 0.0016  memory: 1600  
11/13 15:45:55 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:02  time: 0.0746  data_time: 0.0014  memory: 17024  
11/13 15:46:06 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:43  time: 0.0843  data_time: 0.0016  memory: 17015  
11/13 15:46:15 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:25  time: 0.0882  data_time: 0.0014  memory: 17004  
11/13 15:46:23 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:06  time: 0.0853  data_time: 0.0016  memory: 17004  
11/13 15:46:27 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:49  time: 0.0843  data_time: 0.0016  memory: 670  
11/13 15:46:35 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:32  time: 0.0891  data_time: 0.0015  memory: 17027  
11/13 15:46:45 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.0809  data_time: 0.0015  memory: 17008  
11/13 15:46:53 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0777  data_time: 0.0013  memory: 16956  
11/13 15:46:53 - mmengine - INFO - per class results:
11/13 15:46:53 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.54 | 89.49 |
|       building      | 78.52 | 92.85 |
|         sky         | 93.17 | 96.75 |
|        floor        | 76.29 | 91.02 |
|         tree        | 71.79 | 86.32 |
|       ceiling       | 78.64 | 86.69 |
|         road        | 80.87 | 90.02 |
|         bed         | 86.44 | 94.26 |
|      windowpane     | 58.63 | 72.87 |
|        grass        | 61.22 | 75.58 |
|       cabinet       |  55.9 | 71.36 |
|       sidewalk      | 60.85 | 74.82 |
|        person       | 75.84 |  88.0 |
|        earth        | 33.67 | 49.06 |
|         door        | 39.92 | 51.72 |
|        table        | 58.46 | 74.14 |
|       mountain      | 51.67 | 70.85 |
|        plant        | 48.12 | 58.84 |
|       curtain       | 65.84 | 76.14 |
|        chair        | 52.38 | 63.09 |
|         car         | 80.13 | 87.54 |
|        water        | 47.07 | 62.52 |
|       painting      | 69.08 |  80.0 |
|         sofa        | 62.28 | 82.47 |
|        shelf        | 39.77 |  58.3 |
|        house        | 28.64 | 32.69 |
|         sea         | 49.29 | 80.84 |
|        mirror       | 57.22 |  65.1 |
|         rug         | 44.53 | 48.82 |
|        field        | 27.06 | 44.83 |
|       armchair      | 37.63 |  47.1 |
|         seat        |  60.2 | 76.05 |
|        fence        |  35.4 | 46.69 |
|         desk        | 47.19 | 60.28 |
|         rock        | 32.28 | 47.32 |
|       wardrobe      | 38.95 | 56.68 |
|         lamp        | 60.07 | 70.32 |
|       bathtub       |  72.3 | 78.31 |
|       railing       | 29.44 |  40.1 |
|       cushion       | 51.74 | 65.08 |
|         base        | 16.51 | 18.87 |
|         box         |  17.4 | 22.98 |
|        column       | 40.56 | 50.87 |
|      signboard      | 31.93 | 41.58 |
|   chest of drawers  | 38.24 | 54.93 |
|       counter       | 20.56 | 28.29 |
|         sand        | 43.13 | 52.39 |
|         sink        | 68.79 | 79.26 |
|      skyscraper     | 31.44 | 33.71 |
|      fireplace      | 66.77 | 78.32 |
|     refrigerator    | 63.33 | 77.79 |
|      grandstand     | 37.97 | 60.58 |
|         path        | 18.08 |  24.0 |
|        stairs       | 31.05 | 36.85 |
|        runway       | 62.47 | 83.77 |
|         case        | 50.97 | 69.95 |
|      pool table     | 90.72 | 95.04 |
|        pillow       | 50.96 | 61.13 |
|     screen door     | 58.15 |  62.3 |
|       stairway      | 27.04 | 30.94 |
|        river        | 14.33 | 19.47 |
|        bridge       | 44.68 | 50.79 |
|       bookcase      | 35.09 | 41.29 |
|        blind        | 33.11 | 34.99 |
|     coffee table    | 61.99 | 75.61 |
|        toilet       | 82.71 | 89.24 |
|        flower       | 34.04 | 47.23 |
|         book        | 41.37 | 57.36 |
|         hill        |  6.05 |  8.13 |
|        bench        | 45.92 |  51.5 |
|      countertop     | 55.27 | 65.08 |
|        stove        | 73.12 | 79.35 |
|         palm        | 48.32 | 62.41 |
|    kitchen island   | 41.45 | 64.06 |
|       computer      | 53.33 | 64.52 |
|     swivel chair    |  41.5 | 56.06 |
|         boat        | 34.73 | 38.44 |
|         bar         | 21.48 | 25.94 |
|    arcade machine   | 22.31 | 26.25 |
|        hovel        | 27.25 | 39.72 |
|         bus         | 84.65 | 90.75 |
|        towel        | 43.65 | 46.54 |
|        light        | 45.28 | 50.77 |
|        truck        | 19.68 | 25.19 |
|        tower        | 15.32 | 18.58 |
|      chandelier     | 64.13 | 80.83 |
|        awning       | 19.17 | 20.23 |
|     streetlight     | 20.12 | 24.68 |
|        booth        | 42.73 | 49.92 |
| television receiver | 69.43 | 75.01 |
|       airplane      | 50.06 | 63.01 |
|      dirt track     | 11.53 | 21.66 |
|       apparel       | 27.85 | 40.86 |
|         pole        | 17.53 | 25.15 |
|         land        |  9.12 | 11.04 |
|      bannister      |  7.87 |  9.95 |
|      escalator      |  16.7 | 18.49 |
|       ottoman       | 39.01 | 47.35 |
|        bottle       | 14.72 | 23.07 |
|        buffet       | 30.78 | 33.33 |
|        poster       | 21.94 | 26.91 |
|        stage        | 12.52 | 15.26 |
|         van         | 45.81 | 59.67 |
|         ship        | 86.51 | 90.96 |
|       fountain      |  3.53 |  3.58 |
|    conveyer belt    | 59.55 | 82.84 |
|        canopy       | 16.41 | 17.63 |
|        washer       | 61.62 | 65.62 |
|      plaything      | 33.88 | 43.86 |
|    swimming pool    | 23.35 | 33.26 |
|        stool        | 32.27 | 43.57 |
|        barrel       | 20.78 | 59.42 |
|        basket       | 27.09 | 34.66 |
|      waterfall      | 51.34 | 61.17 |
|         tent        | 90.52 |  97.2 |
|         bag         |  7.07 |  8.19 |
|       minibike      | 50.58 | 57.68 |
|        cradle       | 71.35 |  95.9 |
|         oven        | 25.12 | 44.14 |
|         ball        | 40.46 | 59.93 |
|         food        | 44.32 | 55.64 |
|         step        | 12.11 | 13.81 |
|         tank        | 32.61 | 37.17 |
|      trade name     | 24.16 | 28.12 |
|      microwave      | 35.42 |  38.9 |
|         pot         | 37.96 | 44.28 |
|        animal       | 53.26 | 56.74 |
|       bicycle       | 48.66 | 66.51 |
|         lake        | 61.22 | 63.27 |
|      dishwasher     | 63.53 | 67.69 |
|        screen       | 57.59 |  72.7 |
|       blanket       |  3.97 |  4.09 |
|      sculpture      | 29.82 | 37.53 |
|         hood        | 56.14 | 60.38 |
|        sconce       | 33.38 | 38.45 |
|         vase        | 36.21 | 48.02 |
|    traffic light    | 22.74 | 28.47 |
|         tray        |  5.55 | 10.29 |
|        ashcan       | 32.11 | 40.48 |
|         fan         | 53.02 | 65.28 |
|         pier        | 23.75 | 28.09 |
|      crt screen     |  4.42 |  8.86 |
|        plate        | 42.15 | 51.79 |
|       monitor       | 47.52 | 56.51 |
|    bulletin board   | 37.55 | 41.81 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 40.62 | 46.46 |
|        glass        | 10.16 | 11.02 |
|        clock        | 20.52 | 23.23 |
|         flag        | 23.36 | 24.37 |
+---------------------+-------+-------+
11/13 15:46:53 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.0600  mIoU: 42.5300  mAcc: 51.9600  data_time: 0.0020  time: 0.3163
Finished processing corruption type: jpeg_compression
Processing corruption type: elastic_transform
11/13 15:47:09 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1575691582
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1575691582
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 15:47:09 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/elastic_transform'

Number of parameters:  68068492
11/13 15:47:17 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 15:47:17 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 15:47:18 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 15:47:18 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 15:49:41 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:32:52  time: 1.8968  data_time: 0.0029  memory: 17244  
11/13 15:51:14 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:14:40  time: 2.0282  data_time: 0.0016  memory: 17024  
11/13 15:52:25 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:03:06  time: 1.4970  data_time: 0.0016  memory: 17018  
11/13 15:53:49 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:58:38  time: 1.5610  data_time: 0.0016  memory: 17026  
11/13 15:55:07 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:54:41  time: 1.3592  data_time: 0.0015  memory: 17024  
11/13 15:56:17 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:50:53  time: 1.0691  data_time: 0.0016  memory: 17020  
11/13 15:57:37 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:48:37  time: 1.3124  data_time: 0.0015  memory: 17024  
11/13 15:58:48 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:45:58  time: 1.4850  data_time: 0.0015  memory: 17022  
11/13 15:59:38 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:42:29  time: 1.0604  data_time: 0.0015  memory: 16946  
11/13 16:00:36 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:39:53  time: 0.9972  data_time: 0.0016  memory: 17004  
11/13 16:01:39 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:37:49  time: 1.5111  data_time: 0.0017  memory: 17024  
11/13 16:02:33 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:35:34  time: 1.2223  data_time: 0.0017  memory: 16952  
11/13 16:03:37 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:33:52  time: 1.4729  data_time: 0.0015  memory: 17026  
11/13 16:04:46 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:32:27  time: 1.0844  data_time: 0.0017  memory: 17027  
11/13 16:05:55 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:31:01  time: 1.8966  data_time: 0.0016  memory: 17029  
11/13 16:06:48 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:29:15  time: 1.0467  data_time: 0.0017  memory: 17018  
11/13 16:07:41 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:27:34  time: 1.0458  data_time: 0.0017  memory: 720  
11/13 16:08:31 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:25:55  time: 0.9990  data_time: 0.0015  memory: 16943  
11/13 16:09:38 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:24:40  time: 1.2144  data_time: 0.0016  memory: 17024  
11/13 16:10:34 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:23:15  time: 0.9835  data_time: 0.0015  memory: 17000  
11/13 16:11:38 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:22:00  time: 1.6061  data_time: 0.0015  memory: 17027  
11/13 16:12:37 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:20:42  time: 1.0247  data_time: 0.0016  memory: 17014  
11/13 16:13:32 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:19:23  time: 1.1236  data_time: 0.0015  memory: 17006  
11/13 16:14:24 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:18:03  time: 1.0032  data_time: 0.0015  memory: 1917  
11/13 16:15:19 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:16:48  time: 1.0956  data_time: 0.0014  memory: 17017  
11/13 16:16:07 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:15:30  time: 1.0269  data_time: 0.0015  memory: 1556  
11/13 16:17:01 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:14:18  time: 0.9529  data_time: 0.0015  memory: 17002  
11/13 16:18:07 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:13:12  time: 1.4901  data_time: 0.0015  memory: 17021  
11/13 16:19:01 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:12:01  time: 1.4208  data_time: 0.0015  memory: 17009  
11/13 16:19:50 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:10:50  time: 0.9510  data_time: 0.0014  memory: 720  
11/13 16:20:46 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:09:42  time: 1.0568  data_time: 0.0015  memory: 16952  
11/13 16:21:35 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:08:34  time: 1.0192  data_time: 0.0016  memory: 1600  
11/13 16:22:33 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:28  time: 0.9473  data_time: 0.0014  memory: 17024  
11/13 16:23:31 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:23  time: 1.0261  data_time: 0.0016  memory: 17015  
11/13 16:24:28 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:05:18  time: 1.0300  data_time: 0.0015  memory: 17004  
11/13 16:25:21 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:04:13  time: 1.0332  data_time: 0.0016  memory: 17004  
11/13 16:26:12 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:03:09  time: 1.0171  data_time: 0.0016  memory: 670  
11/13 16:27:04 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:02:05  time: 0.9992  data_time: 0.0015  memory: 17027  
11/13 16:28:00 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:02  time: 0.9806  data_time: 0.0014  memory: 17008  
11/13 16:28:52 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.9091  data_time: 0.0014  memory: 16956  
11/13 16:28:52 - mmengine - INFO - per class results:
11/13 16:28:52 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 61.84 | 78.92 |
|       building      |  71.8 | 88.69 |
|         sky         | 83.89 | 91.15 |
|        floor        | 66.53 | 81.91 |
|         tree        | 61.47 | 78.73 |
|       ceiling       | 68.69 | 82.11 |
|         road        | 74.21 | 85.77 |
|         bed         | 75.09 | 87.43 |
|      windowpane     |  48.0 | 65.45 |
|        grass        | 56.31 | 73.61 |
|       cabinet       | 48.19 | 64.57 |
|       sidewalk      | 51.32 | 67.88 |
|        person       | 59.06 | 77.65 |
|        earth        | 30.89 | 42.59 |
|         door        | 35.95 | 48.07 |
|        table        | 43.97 | 61.54 |
|       mountain      | 45.18 | 63.23 |
|        plant        | 39.98 | 53.15 |
|       curtain       | 50.09 | 68.03 |
|        chair        | 38.29 | 55.15 |
|         car         | 59.96 | 74.33 |
|        water        | 40.79 | 52.57 |
|       painting      | 44.17 | 62.27 |
|         sofa        | 50.96 | 70.28 |
|        shelf        | 33.32 | 53.11 |
|        house        |  27.6 | 32.19 |
|         sea         | 47.11 | 79.79 |
|        mirror       | 50.68 | 62.85 |
|         rug         | 40.18 | 51.23 |
|        field        | 23.37 | 41.14 |
|       armchair      | 32.11 | 44.67 |
|         seat        |  54.0 | 71.54 |
|        fence        | 27.88 | 41.32 |
|         desk        | 36.39 | 52.51 |
|         rock        | 28.47 | 44.37 |
|       wardrobe      | 37.13 | 52.62 |
|         lamp        | 29.11 | 43.96 |
|       bathtub       | 60.68 | 71.95 |
|       railing       | 24.64 | 39.19 |
|       cushion       | 34.63 | 48.16 |
|         base        | 18.21 | 23.88 |
|         box         | 13.72 | 18.67 |
|        column       | 24.94 | 35.42 |
|      signboard      | 19.87 | 29.91 |
|   chest of drawers  | 32.53 | 46.85 |
|       counter       | 17.51 | 23.85 |
|         sand        | 37.91 | 51.86 |
|         sink        | 46.39 | 62.64 |
|      skyscraper     | 23.53 | 26.21 |
|      fireplace      | 59.76 | 73.22 |
|     refrigerator    | 55.55 | 68.03 |
|      grandstand     | 39.52 |  63.3 |
|         path        |  13.9 | 18.78 |
|        stairs       |  25.1 | 30.33 |
|        runway       | 60.31 | 80.81 |
|         case        | 46.01 | 66.13 |
|      pool table     | 78.96 | 86.39 |
|        pillow       | 37.88 | 52.13 |
|     screen door     | 52.88 | 66.85 |
|       stairway      | 23.33 | 26.89 |
|        river        | 10.69 |  15.6 |
|        bridge       | 29.37 | 33.48 |
|       bookcase      |  29.0 | 38.03 |
|        blind        | 29.45 | 33.87 |
|     coffee table    | 48.19 | 66.36 |
|        toilet       | 57.31 | 70.66 |
|        flower       | 24.32 | 39.96 |
|         book        | 30.91 | 47.84 |
|         hill        |  4.35 |  6.7  |
|        bench        | 37.08 | 45.16 |
|      countertop     | 39.04 |  54.3 |
|        stove        | 58.79 | 68.81 |
|         palm        | 35.29 |  49.9 |
|    kitchen island   | 32.23 | 57.57 |
|       computer      | 42.93 | 54.42 |
|     swivel chair    |  29.4 | 43.35 |
|         boat        | 29.46 | 36.55 |
|         bar         |  16.5 | 19.41 |
|    arcade machine   |  19.4 | 21.78 |
|        hovel        | 19.47 | 26.05 |
|         bus         | 72.18 | 82.88 |
|        towel        | 26.93 | 36.71 |
|        light        | 15.23 | 23.29 |
|        truck        | 27.59 | 35.79 |
|        tower        |  5.85 |  7.31 |
|      chandelier     | 43.14 | 60.21 |
|        awning       | 17.54 | 21.07 |
|     streetlight     |  6.88 | 11.21 |
|        booth        | 44.32 | 49.11 |
| television receiver | 32.34 | 50.17 |
|       airplane      | 36.64 | 55.72 |
|      dirt track     |  5.41 | 11.05 |
|       apparel       | 22.25 | 41.14 |
|         pole        |  9.5  | 14.81 |
|         land        |  1.49 |  1.83 |
|      bannister      |  3.12 |  3.91 |
|      escalator      |  8.91 |  10.1 |
|       ottoman       | 33.46 | 44.77 |
|        bottle       |  7.33 | 15.09 |
|        buffet       | 25.87 | 29.74 |
|        poster       | 19.29 | 24.19 |
|        stage        | 10.69 | 13.14 |
|         van         |  32.3 | 42.25 |
|         ship        | 52.29 | 63.01 |
|       fountain      |  9.63 |  9.88 |
|    conveyer belt    | 66.01 | 79.58 |
|        canopy       | 17.59 | 20.21 |
|        washer       |  61.7 | 65.59 |
|      plaything      | 18.58 | 28.43 |
|    swimming pool    | 20.91 | 32.56 |
|        stool        |  18.0 | 26.41 |
|        barrel       |  38.5 | 57.63 |
|        basket       | 18.81 | 25.78 |
|      waterfall      | 47.73 | 71.95 |
|         tent        |  69.3 | 91.96 |
|         bag         |  6.93 |  8.26 |
|       minibike      | 47.98 | 65.72 |
|        cradle       | 59.73 | 87.18 |
|         oven        | 28.72 | 41.48 |
|         ball        |  38.2 |  62.0 |
|         food        | 37.79 | 48.91 |
|         step        | 14.13 | 16.97 |
|         tank        | 30.97 | 34.06 |
|      trade name     | 16.17 | 19.73 |
|      microwave      | 30.01 | 35.33 |
|         pot         | 22.19 | 31.06 |
|        animal       | 43.19 | 47.89 |
|       bicycle       | 35.01 | 52.97 |
|         lake        | 37.69 | 62.92 |
|      dishwasher     | 46.67 | 54.57 |
|        screen       | 47.66 | 69.06 |
|       blanket       |  8.95 | 10.04 |
|      sculpture      | 29.99 | 40.13 |
|         hood        | 39.77 | 55.62 |
|        sconce       | 17.98 | 25.97 |
|         vase        |  18.8 | 32.55 |
|    traffic light    | 12.68 | 19.12 |
|         tray        |  4.42 |  8.42 |
|        ashcan       | 19.87 | 32.06 |
|         fan         | 24.46 | 39.12 |
|         pier        | 18.63 | 23.04 |
|      crt screen     |  4.78 |  8.62 |
|        plate        |  29.1 | 40.75 |
|       monitor       | 37.36 | 48.42 |
|    bulletin board   | 24.47 | 29.28 |
|        shower       |  0.22 |  0.31 |
|       radiator      | 28.18 |  35.2 |
|        glass        |  6.67 |  7.89 |
|        clock        |  8.33 | 11.53 |
|         flag        | 18.04 | 21.47 |
+---------------------+-------+-------+
11/13 16:28:52 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 72.9500  mIoU: 33.9200  mAcc: 45.1600  data_time: 0.0018  time: 1.2469
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
11/13 16:28:55 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1062461892
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1062461892
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 16:28:56 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/pixelate'

Number of parameters:  68068492
11/13 16:29:00 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 16:29:00 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 16:29:01 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 16:29:01 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 16:30:27 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:55:46  time: 0.8615  data_time: 0.0016  memory: 17244  
11/13 16:31:13 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:41:41  time: 1.0330  data_time: 0.0017  memory: 17024  
11/13 16:31:36 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:31:48  time: 0.5063  data_time: 0.0016  memory: 17018  
11/13 16:32:12 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:35  time: 0.6316  data_time: 0.0016  memory: 17026  
11/13 16:32:44 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:25:57  time: 0.4323  data_time: 0.0015  memory: 17024  
11/13 16:33:09 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:23  time: 0.0894  data_time: 0.0016  memory: 17020  
11/13 16:33:42 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:04  time: 0.4298  data_time: 0.0015  memory: 17024  
11/13 16:34:06 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:18  time: 0.5040  data_time: 0.0015  memory: 17022  
11/13 16:34:13 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:17:56  time: 0.1859  data_time: 0.0015  memory: 16946  
11/13 16:34:24 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:09  time: 0.0829  data_time: 0.0035  memory: 17004  
11/13 16:34:37 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:14:45  time: 0.5183  data_time: 0.0017  memory: 17024  
11/13 16:34:44 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:20  time: 0.2421  data_time: 0.0016  memory: 16952  
11/13 16:35:02 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:29  time: 0.5117  data_time: 0.0014  memory: 17026  
11/13 16:35:22 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:47  time: 0.0888  data_time: 0.0016  memory: 17027  
11/13 16:35:43 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:10  time: 1.0482  data_time: 0.0015  memory: 17029  
11/13 16:35:51 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:15  time: 0.0780  data_time: 0.0016  memory: 17018  
11/13 16:35:55 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:20  time: 0.0784  data_time: 0.0016  memory: 720  
11/13 16:36:02 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:35  time: 0.1730  data_time: 0.0014  memory: 16943  
11/13 16:36:21 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:06  time: 0.2803  data_time: 0.0015  memory: 17024  
11/13 16:36:32 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:30  time: 0.0731  data_time: 0.0015  memory: 17000  
11/13 16:36:47 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:01  time: 0.6114  data_time: 0.0015  memory: 17027  
11/13 16:36:59 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:30  time: 0.0784  data_time: 0.0016  memory: 17014  
11/13 16:37:07 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:59  time: 0.1797  data_time: 0.0015  memory: 17006  
11/13 16:37:11 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:26  time: 0.0775  data_time: 0.0015  memory: 1917  
11/13 16:37:20 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:59  time: 0.1838  data_time: 0.0015  memory: 17017  
11/13 16:37:24 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:30  time: 0.0773  data_time: 0.0015  memory: 1556  
11/13 16:37:32 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:05  time: 0.0759  data_time: 0.0015  memory: 17002  
11/13 16:37:51 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:47  time: 0.5022  data_time: 0.0015  memory: 17021  
11/13 16:38:00 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:24  time: 0.4334  data_time: 0.0014  memory: 17009  
11/13 16:38:03 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:00  time: 0.0730  data_time: 0.0015  memory: 720  
11/13 16:38:09 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:39  time: 0.0798  data_time: 0.0015  memory: 16952  
11/13 16:38:13 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:17  time: 0.0750  data_time: 0.0016  memory: 1600  
11/13 16:38:24 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:59  time: 0.0704  data_time: 0.0015  memory: 17024  
11/13 16:38:35 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:41  time: 0.0775  data_time: 0.0016  memory: 17015  
11/13 16:38:44 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:23  time: 0.0804  data_time: 0.0014  memory: 17004  
11/13 16:38:51 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:05  time: 0.0779  data_time: 0.0016  memory: 17004  
11/13 16:38:55 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:48  time: 0.0780  data_time: 0.0016  memory: 670  
11/13 16:39:03 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:31  time: 0.0826  data_time: 0.0015  memory: 17027  
11/13 16:39:12 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:15  time: 0.0746  data_time: 0.0015  memory: 17008  
11/13 16:39:19 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0729  data_time: 0.0014  memory: 16956  
11/13 16:39:19 - mmengine - INFO - per class results:
11/13 16:39:19 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.44 | 88.42 |
|       building      | 78.56 | 93.47 |
|         sky         | 93.62 | 96.84 |
|        floor        | 78.09 | 90.46 |
|         tree        | 71.93 | 86.56 |
|       ceiling       |  81.6 | 89.89 |
|         road        |  82.1 | 91.05 |
|         bed         | 86.97 | 94.86 |
|      windowpane     | 59.13 |  74.8 |
|        grass        |  64.2 | 80.12 |
|       cabinet       | 58.17 | 72.74 |
|       sidewalk      |  63.0 | 77.77 |
|        person       | 76.29 | 87.85 |
|        earth        | 33.84 |  46.1 |
|         door        | 42.55 |  55.7 |
|        table        | 58.91 | 75.09 |
|       mountain      | 50.55 | 67.81 |
|        plant        | 49.22 | 61.26 |
|       curtain       | 69.43 | 81.73 |
|        chair        | 53.67 | 66.97 |
|         car         | 80.76 | 87.42 |
|        water        | 42.62 | 57.44 |
|       painting      | 69.38 | 82.87 |
|         sofa        | 61.22 | 82.67 |
|        shelf        | 40.42 | 59.71 |
|        house        | 37.97 | 43.11 |
|         sea         | 47.11 | 75.65 |
|        mirror       | 60.94 | 69.46 |
|         rug         | 49.14 | 57.28 |
|        field        | 24.75 | 40.02 |
|       armchair      | 34.99 | 43.93 |
|         seat        | 58.49 | 76.93 |
|        fence        | 33.86 | 46.51 |
|         desk        | 47.96 | 61.51 |
|         rock        | 30.53 | 43.39 |
|       wardrobe      |  44.0 | 58.96 |
|         lamp        | 60.63 | 72.46 |
|       bathtub       | 74.01 | 80.23 |
|       railing       | 32.11 | 45.12 |
|       cushion       | 52.56 | 65.71 |
|         base        | 21.11 | 25.78 |
|         box         | 18.44 | 24.68 |
|        column       |  42.3 | 52.76 |
|      signboard      | 32.46 | 44.09 |
|   chest of drawers  | 38.31 | 56.64 |
|       counter       | 25.01 | 35.82 |
|         sand        | 38.13 | 49.74 |
|         sink        | 67.07 | 79.99 |
|      skyscraper     | 26.93 | 28.93 |
|      fireplace      | 69.05 | 81.28 |
|     refrigerator    | 65.09 | 76.83 |
|      grandstand     | 37.28 | 65.67 |
|         path        | 18.05 | 23.68 |
|        stairs       | 34.49 | 41.28 |
|        runway       | 62.03 | 83.23 |
|         case        | 47.11 | 72.71 |
|      pool table     | 91.43 | 94.84 |
|        pillow       | 53.93 | 66.39 |
|     screen door     | 62.53 | 73.05 |
|       stairway      | 28.02 |  31.9 |
|        river        |  15.9 | 25.06 |
|        bridge       | 51.09 | 56.49 |
|       bookcase      | 35.19 | 42.69 |
|        blind        | 45.68 |  52.6 |
|     coffee table    | 61.08 | 78.05 |
|        toilet       | 82.66 | 89.94 |
|        flower       | 33.84 | 47.09 |
|         book        | 43.04 | 62.11 |
|         hill        |  5.14 |  7.25 |
|        bench        | 43.98 | 50.38 |
|      countertop     | 54.29 | 68.38 |
|        stove        | 70.17 | 75.02 |
|         palm        | 47.77 |  60.4 |
|    kitchen island   |  43.7 | 75.74 |
|       computer      | 53.07 | 64.94 |
|     swivel chair    | 42.58 | 59.63 |
|         boat        | 36.28 | 40.08 |
|         bar         | 26.71 | 32.25 |
|    arcade machine   | 23.85 | 25.14 |
|        hovel        | 27.81 | 30.83 |
|         bus         | 83.04 | 91.54 |
|        towel        | 50.15 | 56.68 |
|        light        | 48.88 | 57.01 |
|        truck        |  29.4 | 39.96 |
|        tower        |  6.62 |  7.93 |
|      chandelier     |  63.1 | 79.25 |
|        awning       | 24.42 | 25.84 |
|     streetlight     | 22.12 | 29.47 |
|        booth        | 50.12 | 55.77 |
| television receiver | 64.22 | 75.94 |
|       airplane      | 40.95 | 62.02 |
|      dirt track     | 11.26 |  21.2 |
|       apparel       | 25.59 | 38.87 |
|         pole        | 18.39 | 26.35 |
|         land        |  8.68 | 10.29 |
|      bannister      |  7.97 | 10.15 |
|      escalator      |  8.34 |  9.47 |
|       ottoman       | 38.34 | 48.71 |
|        bottle       | 16.09 | 27.18 |
|        buffet       | 37.26 | 41.86 |
|        poster       | 21.98 | 27.55 |
|        stage        | 12.31 | 15.35 |
|         van         | 44.79 | 62.32 |
|         ship        | 84.84 | 87.97 |
|       fountain      |  3.54 |  3.6  |
|    conveyer belt    | 72.01 | 88.92 |
|        canopy       | 15.91 | 16.74 |
|        washer       |  65.3 | 68.39 |
|      plaything      | 31.93 |  41.3 |
|    swimming pool    | 23.05 | 33.53 |
|        stool        | 33.89 | 45.52 |
|        barrel       | 26.95 | 63.28 |
|        basket       |  32.9 | 40.05 |
|      waterfall      | 49.24 | 60.34 |
|         tent        |  92.5 | 96.92 |
|         bag         |  7.69 |  8.8  |
|       minibike      | 53.83 | 59.66 |
|        cradle       | 69.42 | 96.31 |
|         oven        |  25.9 | 56.87 |
|         ball        | 41.68 | 64.36 |
|         food        | 42.95 | 52.14 |
|         step        | 13.21 | 15.92 |
|         tank        | 31.48 | 33.55 |
|      trade name     | 25.77 |  29.8 |
|      microwave      | 36.13 |  39.9 |
|         pot         |  40.8 | 47.99 |
|        animal       | 52.37 | 54.92 |
|       bicycle       | 45.91 | 61.07 |
|         lake        | 37.33 | 63.37 |
|      dishwasher     | 70.25 | 76.43 |
|        screen       | 63.87 | 85.29 |
|       blanket       |  5.22 |  5.62 |
|      sculpture      | 29.91 |  35.0 |
|         hood        | 54.45 | 62.74 |
|        sconce       | 37.32 | 46.15 |
|         vase        | 37.86 | 50.47 |
|    traffic light    | 26.06 | 34.24 |
|         tray        |  5.88 |  9.58 |
|        ashcan       | 34.34 |  44.0 |
|         fan         | 53.93 | 68.02 |
|         pier        | 23.12 | 27.61 |
|      crt screen     |  0.83 |  1.34 |
|        plate        | 45.75 |  55.8 |
|       monitor       |  49.6 |  59.7 |
|    bulletin board   | 34.97 | 38.28 |
|        shower       |  0.66 |  1.22 |
|       radiator      | 41.73 | 48.95 |
|        glass        | 11.96 | 13.35 |
|        clock        | 22.66 | 25.72 |
|         flag        | 26.46 |  27.8 |
+---------------------+-------+-------+
11/13 16:39:19 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.7800  mIoU: 43.3300  mAcc: 53.6800  data_time: 0.0018  time: 0.3091
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
11/13 16:39:23 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 129094882
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 129094882
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/13 16:39:23 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=False,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r101-d8_4xb4-160k_ade20k-512x512/jpeg_compression'

Number of parameters:  68068492
11/13 16:39:27 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/13 16:39:27 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/13 16:39:28 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
11/13 16:39:28 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r101-d8_512x512_160k_ade20k_20200615_100650-967c316f.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/13 16:40:54 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:55:56  time: 0.8644  data_time: 0.0015  memory: 17244  
11/13 16:41:40 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:41:52  time: 1.0390  data_time: 0.0016  memory: 17024  
11/13 16:42:03 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:31:58  time: 0.5130  data_time: 0.0016  memory: 17018  
11/13 16:42:40 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:45  time: 0.6369  data_time: 0.0016  memory: 17026  
11/13 16:43:12 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:07  time: 0.4390  data_time: 0.0015  memory: 17024  
11/13 16:43:37 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:32  time: 0.0952  data_time: 0.0016  memory: 17020  
11/13 16:44:11 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:13  time: 0.4360  data_time: 0.0015  memory: 17024  
11/13 16:44:35 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:26  time: 0.5102  data_time: 0.0015  memory: 17022  
11/13 16:44:43 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:03  time: 0.1913  data_time: 0.0015  memory: 16946  
11/13 16:44:54 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:17  time: 0.0865  data_time: 0.0015  memory: 17004  
11/13 16:45:07 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:14:53  time: 0.5243  data_time: 0.0016  memory: 17024  
11/13 16:45:14 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:28  time: 0.2496  data_time: 0.0016  memory: 16952  
11/13 16:45:32 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:36  time: 0.5153  data_time: 0.0014  memory: 17026  
11/13 16:45:53 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:54  time: 0.0954  data_time: 0.0016  memory: 17027  
11/13 16:46:14 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:17  time: 1.0514  data_time: 0.0015  memory: 17029  
11/13 16:46:23 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:22  time: 0.0844  data_time: 0.0016  memory: 17018  
11/13 16:46:27 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:26  time: 0.0855  data_time: 0.0016  memory: 720  
11/13 16:46:34 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:41  time: 0.1782  data_time: 0.0015  memory: 16943  
11/13 16:46:53 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:12  time: 0.2857  data_time: 0.0015  memory: 17024  
11/13 16:47:04 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:36  time: 0.0802  data_time: 0.0015  memory: 17000  
11/13 16:47:20 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:07  time: 0.6185  data_time: 0.0015  memory: 17027  
11/13 16:47:32 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:36  time: 0.0833  data_time: 0.0016  memory: 17014  
11/13 16:47:41 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:04  time: 0.1851  data_time: 0.0015  memory: 17006  
11/13 16:47:45 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:31  time: 0.0864  data_time: 0.0016  memory: 1917  
11/13 16:47:55 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:03  time: 0.1900  data_time: 0.0016  memory: 17017  
11/13 16:47:59 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:34  time: 0.0833  data_time: 0.0015  memory: 1556  
11/13 16:48:06 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:09  time: 0.0822  data_time: 0.0015  memory: 17002  
11/13 16:48:26 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:50  time: 0.5098  data_time: 0.0015  memory: 17021  
11/13 16:48:35 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:27  time: 0.4416  data_time: 0.0015  memory: 17009  
11/13 16:48:39 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:03  time: 0.0787  data_time: 0.0015  memory: 720  
11/13 16:48:45 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:41  time: 0.0875  data_time: 0.0015  memory: 16952  
11/13 16:48:49 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:20  time: 0.0809  data_time: 0.0016  memory: 1600  
11/13 16:49:01 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:01  time: 0.0750  data_time: 0.0014  memory: 17024  
11/13 16:49:12 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:42  time: 0.0838  data_time: 0.0016  memory: 17015  
11/13 16:49:21 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:24  time: 0.0886  data_time: 0.0015  memory: 17004  
11/13 16:49:29 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:06  time: 0.0853  data_time: 0.0017  memory: 17004  
11/13 16:49:33 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:49  time: 0.0846  data_time: 0.0017  memory: 670  
11/13 16:49:41 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:32  time: 0.0890  data_time: 0.0015  memory: 17027  
11/13 16:49:51 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:15  time: 0.0808  data_time: 0.0015  memory: 17008  
11/13 16:49:58 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0779  data_time: 0.0013  memory: 16956  
11/13 16:49:58 - mmengine - INFO - per class results:
11/13 16:49:58 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.54 | 89.49 |
|       building      | 78.52 | 92.85 |
|         sky         | 93.17 | 96.75 |
|        floor        | 76.29 | 91.02 |
|         tree        | 71.79 | 86.32 |
|       ceiling       | 78.64 | 86.69 |
|         road        | 80.87 | 90.02 |
|         bed         | 86.44 | 94.26 |
|      windowpane     | 58.63 | 72.87 |
|        grass        | 61.22 | 75.58 |
|       cabinet       |  55.9 | 71.36 |
|       sidewalk      | 60.85 | 74.82 |
|        person       | 75.84 |  88.0 |
|        earth        | 33.67 | 49.06 |
|         door        | 39.92 | 51.72 |
|        table        | 58.46 | 74.14 |
|       mountain      | 51.67 | 70.85 |
|        plant        | 48.12 | 58.84 |
|       curtain       | 65.84 | 76.14 |
|        chair        | 52.38 | 63.09 |
|         car         | 80.13 | 87.54 |
|        water        | 47.07 | 62.52 |
|       painting      | 69.08 |  80.0 |
|         sofa        | 62.28 | 82.47 |
|        shelf        | 39.77 |  58.3 |
|        house        | 28.64 | 32.69 |
|         sea         | 49.29 | 80.84 |
|        mirror       | 57.22 |  65.1 |
|         rug         | 44.53 | 48.82 |
|        field        | 27.06 | 44.83 |
|       armchair      | 37.63 |  47.1 |
|         seat        |  60.2 | 76.05 |
|        fence        |  35.4 | 46.69 |
|         desk        | 47.19 | 60.28 |
|         rock        | 32.28 | 47.32 |
|       wardrobe      | 38.95 | 56.68 |
|         lamp        | 60.07 | 70.32 |
|       bathtub       |  72.3 | 78.31 |
|       railing       | 29.44 |  40.1 |
|       cushion       | 51.74 | 65.08 |
|         base        | 16.51 | 18.87 |
|         box         |  17.4 | 22.98 |
|        column       | 40.56 | 50.87 |
|      signboard      | 31.93 | 41.58 |
|   chest of drawers  | 38.24 | 54.93 |
|       counter       | 20.56 | 28.29 |
|         sand        | 43.13 | 52.39 |
|         sink        | 68.79 | 79.26 |
|      skyscraper     | 31.44 | 33.71 |
|      fireplace      | 66.77 | 78.32 |
|     refrigerator    | 63.33 | 77.79 |
|      grandstand     | 37.97 | 60.58 |
|         path        | 18.08 |  24.0 |
|        stairs       | 31.05 | 36.85 |
|        runway       | 62.47 | 83.77 |
|         case        | 50.97 | 69.95 |
|      pool table     | 90.72 | 95.04 |
|        pillow       | 50.96 | 61.13 |
|     screen door     | 58.15 |  62.3 |
|       stairway      | 27.04 | 30.94 |
|        river        | 14.33 | 19.47 |
|        bridge       | 44.68 | 50.79 |
|       bookcase      | 35.09 | 41.29 |
|        blind        | 33.11 | 34.99 |
|     coffee table    | 61.99 | 75.61 |
|        toilet       | 82.71 | 89.24 |
|        flower       | 34.04 | 47.23 |
|         book        | 41.37 | 57.36 |
|         hill        |  6.05 |  8.13 |
|        bench        | 45.92 |  51.5 |
|      countertop     | 55.27 | 65.08 |
|        stove        | 73.12 | 79.35 |
|         palm        | 48.32 | 62.41 |
|    kitchen island   | 41.45 | 64.06 |
|       computer      | 53.33 | 64.52 |
|     swivel chair    |  41.5 | 56.06 |
|         boat        | 34.73 | 38.44 |
|         bar         | 21.48 | 25.94 |
|    arcade machine   | 22.31 | 26.25 |
|        hovel        | 27.25 | 39.72 |
|         bus         | 84.65 | 90.75 |
|        towel        | 43.65 | 46.54 |
|        light        | 45.28 | 50.77 |
|        truck        | 19.68 | 25.19 |
|        tower        | 15.32 | 18.58 |
|      chandelier     | 64.13 | 80.83 |
|        awning       | 19.17 | 20.23 |
|     streetlight     | 20.12 | 24.68 |
|        booth        | 42.73 | 49.92 |
| television receiver | 69.43 | 75.01 |
|       airplane      | 50.06 | 63.01 |
|      dirt track     | 11.53 | 21.66 |
|       apparel       | 27.85 | 40.86 |
|         pole        | 17.53 | 25.15 |
|         land        |  9.12 | 11.04 |
|      bannister      |  7.87 |  9.95 |
|      escalator      |  16.7 | 18.49 |
|       ottoman       | 39.01 | 47.35 |
|        bottle       | 14.72 | 23.07 |
|        buffet       | 30.78 | 33.33 |
|        poster       | 21.94 | 26.91 |
|        stage        | 12.52 | 15.26 |
|         van         | 45.81 | 59.67 |
|         ship        | 86.51 | 90.96 |
|       fountain      |  3.53 |  3.58 |
|    conveyer belt    | 59.55 | 82.84 |
|        canopy       | 16.41 | 17.63 |
|        washer       | 61.62 | 65.62 |
|      plaything      | 33.88 | 43.86 |
|    swimming pool    | 23.35 | 33.26 |
|        stool        | 32.27 | 43.57 |
|        barrel       | 20.78 | 59.42 |
|        basket       | 27.09 | 34.66 |
|      waterfall      | 51.34 | 61.17 |
|         tent        | 90.52 |  97.2 |
|         bag         |  7.07 |  8.19 |
|       minibike      | 50.58 | 57.68 |
|        cradle       | 71.35 |  95.9 |
|         oven        | 25.12 | 44.14 |
|         ball        | 40.46 | 59.93 |
|         food        | 44.32 | 55.64 |
|         step        | 12.11 | 13.81 |
|         tank        | 32.61 | 37.17 |
|      trade name     | 24.16 | 28.12 |
|      microwave      | 35.42 |  38.9 |
|         pot         | 37.96 | 44.28 |
|        animal       | 53.26 | 56.74 |
|       bicycle       | 48.66 | 66.51 |
|         lake        | 61.22 | 63.27 |
|      dishwasher     | 63.53 | 67.69 |
|        screen       | 57.59 |  72.7 |
|       blanket       |  3.97 |  4.09 |
|      sculpture      | 29.82 | 37.53 |
|         hood        | 56.14 | 60.38 |
|        sconce       | 33.38 | 38.45 |
|         vase        | 36.21 | 48.02 |
|    traffic light    | 22.74 | 28.47 |
|         tray        |  5.55 | 10.29 |
|        ashcan       | 32.11 | 40.48 |
|         fan         | 53.02 | 65.28 |
|         pier        | 23.75 | 28.09 |
|      crt screen     |  4.42 |  8.86 |
|        plate        | 42.15 | 51.79 |
|       monitor       | 47.52 | 56.51 |
|    bulletin board   | 37.55 | 41.81 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 40.62 | 46.46 |
|        glass        | 10.16 | 11.02 |
|        clock        | 20.52 | 23.23 |
|         flag        | 23.36 | 24.37 |
+---------------------+-------+-------+
11/13 16:49:58 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.0600  mIoU: 42.5300  mAcc: 51.9600  data_time: 0.0018  time: 0.3152
Finished processing corruption type: jpeg_compression
Runtime: 1731512999

============================= JOB FEEDBACK =============================

NodeName=uc2n481
Job ID: 24668910
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 8
CPU Utilized: 07:04:30
CPU Efficiency: 10.53% of 2-19:09:52 core-walltime
Job Wall-clock time: 08:23:44
Memory Utilized: 3.64 GB
Memory Efficiency: 36.39% of 10.00 GB
