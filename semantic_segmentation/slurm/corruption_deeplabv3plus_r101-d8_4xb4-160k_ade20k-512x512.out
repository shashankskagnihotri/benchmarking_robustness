Started at Sat Sep 21 00:46:32 CEST 2024
Processing corruption type: gaussian_noise
09/21 00:48:48 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 717829439
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 717829439
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 00:48:48 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='gaussian_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/gaussian_noise'

09/21 00:49:53 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 00:49:54 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 00:49:55 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 00:49:56 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 00:52:25 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:36:53  time: 1.1652  data_time: 0.0015  memory: 17225  
09/21 00:53:17 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:03:32  time: 1.1534  data_time: 0.0015  memory: 17004  
09/21 00:53:46 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:47:16  time: 0.5239  data_time: 0.0015  memory: 16997  
09/21 00:54:24 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:40:08  time: 0.7091  data_time: 0.0015  memory: 17006  
09/21 00:54:56 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:34:57  time: 0.4364  data_time: 0.0014  memory: 17005  
09/21 00:55:24 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:30:58  time: 0.1248  data_time: 0.0015  memory: 17000  
09/21 00:55:59 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:28:30  time: 0.4405  data_time: 0.0015  memory: 17005  
09/21 00:56:24 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:25:52  time: 0.5155  data_time: 0.0014  memory: 17003  
09/21 00:56:36 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:22:56  time: 0.2474  data_time: 0.0014  memory: 16927  
09/21 00:56:48 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:20:35  time: 0.1158  data_time: 0.0014  memory: 16985  
09/21 00:57:03 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:18:44  time: 0.5440  data_time: 0.0016  memory: 17005  
09/21 00:57:12 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:16:57  time: 0.3113  data_time: 0.0016  memory: 16932  
09/21 00:57:35 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:15:52  time: 0.5273  data_time: 0.0014  memory: 17006  
09/21 00:57:57 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:14:52  time: 0.1252  data_time: 0.0016  memory: 17007  
09/21 00:58:22 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:14:02  time: 1.2323  data_time: 0.0015  memory: 17010  
09/21 00:58:36 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:12:58  time: 0.1354  data_time: 0.0017  memory: 16997  
09/21 00:58:45 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:11:55  time: 0.1356  data_time: 0.0016  memory: 701  
09/21 00:58:59 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:03  time: 0.3561  data_time: 0.0014  memory: 16923  
09/21 00:59:27 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:30  time: 0.5385  data_time: 0.0016  memory: 17004  
09/21 00:59:43 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:09:46  time: 0.1082  data_time: 0.0015  memory: 16981  
09/21 01:00:01 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:07  time: 0.6264  data_time: 0.0015  memory: 17008  
09/21 01:00:19 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:29  time: 0.1316  data_time: 0.0016  memory: 16995  
09/21 01:00:31 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:49  time: 0.3794  data_time: 0.0015  memory: 16986  
09/21 01:00:39 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:08  time: 0.2699  data_time: 0.0015  memory: 1897  
09/21 01:00:51 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:32  time: 0.2793  data_time: 0.0055  memory: 16997  
09/21 01:00:58 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:56  time: 0.1139  data_time: 0.0015  memory: 1536  
09/21 01:01:11 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:24  time: 0.2257  data_time: 0.0015  memory: 16983  
09/21 01:01:32 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:58  time: 0.5194  data_time: 0.0014  memory: 17001  
09/21 01:01:42 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:27  time: 0.4622  data_time: 0.0014  memory: 16989  
09/21 01:01:48 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:57  time: 0.1058  data_time: 0.0014  memory: 701  
09/21 01:01:56 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:28  time: 0.1176  data_time: 0.0015  memory: 16932  
09/21 01:02:01 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:01  time: 0.1112  data_time: 0.0016  memory: 1580  
09/21 01:02:18 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:37  time: 0.1608  data_time: 0.0014  memory: 17005  
09/21 01:02:30 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:13  time: 0.1139  data_time: 0.0016  memory: 16996  
09/21 01:02:41 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:49  time: 0.1177  data_time: 0.0014  memory: 16985  
09/21 01:02:50 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:25  time: 0.1156  data_time: 0.0016  memory: 16984  
09/21 01:02:56 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:03  time: 0.1147  data_time: 0.0016  memory: 651  
09/21 01:03:05 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:41  time: 0.1166  data_time: 0.0015  memory: 17008  
09/21 01:03:15 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:20  time: 0.1097  data_time: 0.0015  memory: 16989  
09/21 01:03:26 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1042  data_time: 0.0013  memory: 16936  
09/21 01:03:27 - mmengine - INFO - per class results:
09/21 01:03:27 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 62.71 |  88.8 |
|       building      | 75.47 | 89.38 |
|         sky         | 89.44 | 92.87 |
|        floor        | 66.89 | 88.23 |
|         tree        | 63.21 | 85.98 |
|       ceiling       | 71.25 | 80.17 |
|         road        | 66.69 | 78.28 |
|         bed         | 78.23 | 91.73 |
|      windowpane     | 48.23 | 57.41 |
|        grass        | 55.01 | 77.87 |
|       cabinet       | 43.75 |  54.9 |
|       sidewalk      | 37.99 | 41.47 |
|        person       | 68.99 |  82.8 |
|        earth        | 23.85 | 52.74 |
|         door        | 22.65 | 30.22 |
|        table        | 46.91 | 60.31 |
|       mountain      | 42.34 | 54.36 |
|        plant        | 39.71 | 61.37 |
|       curtain       | 49.12 | 68.42 |
|        chair        | 47.15 | 57.39 |
|         car         | 75.61 | 85.26 |
|        water        | 37.03 | 43.91 |
|       painting      | 62.12 | 72.83 |
|         sofa        | 53.28 | 66.77 |
|        shelf        | 27.51 | 38.77 |
|        house        | 21.28 | 23.52 |
|         sea         | 34.45 | 57.43 |
|        mirror       | 38.16 | 41.16 |
|         rug         | 28.18 | 29.67 |
|        field        |  14.2 | 23.62 |
|       armchair      | 36.91 | 59.19 |
|         seat        | 39.57 | 47.17 |
|        fence        | 24.81 | 37.59 |
|         desk        | 29.66 | 58.51 |
|         rock        | 28.63 |  43.5 |
|       wardrobe      | 22.21 | 29.25 |
|         lamp        |  54.1 | 63.52 |
|       bathtub       | 41.28 | 44.11 |
|       railing       | 25.34 | 31.48 |
|       cushion       | 34.34 | 38.14 |
|         base        | 14.57 | 18.08 |
|         box         | 11.89 | 13.43 |
|        column       | 34.65 | 41.91 |
|      signboard      | 28.14 | 37.01 |
|   chest of drawers  | 35.12 | 47.72 |
|       counter       | 15.62 | 28.28 |
|         sand        | 10.49 | 11.84 |
|         sink        | 43.48 | 50.74 |
|      skyscraper     | 22.29 | 25.56 |
|      fireplace      | 46.26 | 51.75 |
|     refrigerator    | 47.48 | 48.23 |
|      grandstand     | 30.78 | 61.91 |
|         path        | 15.66 | 20.03 |
|        stairs       | 24.45 | 37.59 |
|        runway       | 20.91 | 20.98 |
|         case        | 25.69 | 34.11 |
|      pool table     | 84.95 | 88.27 |
|        pillow       | 34.13 | 39.31 |
|     screen door     |  2.09 |  2.1  |
|       stairway      | 28.77 | 36.05 |
|        river        |  5.95 |  6.71 |
|        bridge       | 38.41 | 41.29 |
|       bookcase      | 22.59 | 29.07 |
|        blind        | 11.11 | 11.37 |
|     coffee table    | 53.74 | 60.94 |
|        toilet       | 30.85 | 31.15 |
|        flower       | 27.53 | 38.68 |
|         book        | 38.39 | 49.34 |
|         hill        |  5.31 |  9.65 |
|        bench        | 29.57 |  35.7 |
|      countertop     | 35.93 | 45.97 |
|        stove        | 44.58 | 46.67 |
|         palm        | 36.84 | 42.09 |
|    kitchen island   |  24.6 | 32.27 |
|       computer      | 30.39 | 31.18 |
|     swivel chair    | 29.07 | 52.06 |
|         boat        | 13.85 | 14.07 |
|         bar         | 33.11 | 39.18 |
|    arcade machine   | 12.59 | 16.75 |
|        hovel        | 32.23 | 39.67 |
|         bus         |  52.2 | 53.39 |
|        towel        | 19.25 | 20.73 |
|        light        | 30.64 | 32.37 |
|        truck        |  3.22 |  3.83 |
|        tower        |  6.38 |  7.8  |
|      chandelier     | 59.37 | 79.34 |
|        awning       |  5.74 |  6.41 |
|     streetlight     | 20.19 | 22.66 |
|        booth        | 18.95 | 28.06 |
| television receiver | 26.26 | 27.53 |
|       airplane      | 28.59 | 31.32 |
|      dirt track     |  3.32 |  9.84 |
|       apparel       | 27.17 | 36.18 |
|         pole        | 17.55 | 26.38 |
|         land        |  0.03 |  0.03 |
|      bannister      |  4.38 |  5.92 |
|      escalator      |  0.67 |  0.67 |
|       ottoman       | 26.79 | 29.16 |
|        bottle       |  14.6 | 16.58 |
|        buffet       |  2.62 |  2.73 |
|        poster       |  8.82 | 10.76 |
|        stage        | 13.74 | 16.96 |
|         van         |  30.7 | 35.99 |
|         ship        |  4.7  |  4.7  |
|       fountain      |  8.88 |  9.7  |
|    conveyer belt    | 42.31 | 46.02 |
|        canopy       |  2.47 |  2.69 |
|        washer       | 17.99 | 17.99 |
|      plaything      | 21.55 | 25.57 |
|    swimming pool    | 46.79 | 47.97 |
|        stool        | 21.79 | 37.92 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 12.99 | 15.44 |
|      waterfall      | 35.86 | 36.76 |
|         tent        |  8.84 |  8.87 |
|         bag         |  1.98 |  2.09 |
|       minibike      | 25.89 | 28.11 |
|        cradle       | 55.67 | 66.01 |
|         oven        | 11.69 | 14.45 |
|         ball        | 41.32 | 52.36 |
|         food        | 43.14 | 50.78 |
|         step        |  4.17 |  5.24 |
|         tank        | 18.24 | 18.28 |
|      trade name     |  11.6 | 12.09 |
|      microwave      | 11.33 | 11.37 |
|         pot         |  20.5 | 21.87 |
|        animal       | 41.52 | 46.39 |
|       bicycle       | 37.77 | 56.63 |
|         lake        | 17.97 | 17.97 |
|      dishwasher     | 20.72 | 21.02 |
|        screen       | 30.37 | 31.16 |
|       blanket       |  3.52 |  3.6  |
|      sculpture      | 10.36 | 13.51 |
|         hood        | 19.85 | 19.96 |
|        sconce       | 22.25 | 24.87 |
|         vase        | 34.68 | 45.83 |
|    traffic light    | 11.34 | 11.72 |
|         tray        |  3.81 |  4.77 |
|        ashcan       | 17.48 | 18.21 |
|         fan         | 49.12 | 58.06 |
|         pier        |  4.43 |  4.65 |
|      crt screen     |  5.81 |  7.45 |
|        plate        | 22.13 | 24.39 |
|       monitor       | 12.83 | 14.55 |
|    bulletin board   |  7.93 |  8.63 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  7.24 |  7.24 |
|        glass        |  7.81 |  8.02 |
|        clock        | 18.37 |  19.9 |
|         flag        | 15.26 | 15.83 |
+---------------------+-------+-------+
09/21 01:03:27 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 72.8200  mIoU: 28.5100  mAcc: 34.9600  data_time: 0.0026  time: 0.4051
Finished processing corruption type: gaussian_noise
Processing corruption type: shot_noise
09/21 01:03:31 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 118790656
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 118790656
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 01:03:31 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='shot_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/shot_noise'

09/21 01:03:36 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 01:03:36 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 01:03:36 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 01:03:37 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 01:05:02 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:55:00  time: 0.9288  data_time: 0.0016  memory: 17225  
09/21 01:05:52 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:42:36  time: 1.1420  data_time: 0.0016  memory: 17004  
09/21 01:06:20 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:33:27  time: 0.5980  data_time: 0.0015  memory: 16997  
09/21 01:06:59 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:30:16  time: 0.6613  data_time: 0.0015  memory: 17006  
09/21 01:07:34 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:27:41  time: 0.5086  data_time: 0.0015  memory: 17005  
09/21 01:08:13 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:26:04  time: 0.3120  data_time: 0.0015  memory: 17000  
09/21 01:09:03 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:25:36  time: 0.7174  data_time: 0.0029  memory: 17005  
09/21 01:09:36 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:23:56  time: 0.6730  data_time: 0.0014  memory: 17003  
09/21 01:09:53 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:21:34  time: 0.4899  data_time: 0.0014  memory: 16927  
09/21 01:10:12 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:19:44  time: 0.1848  data_time: 0.0014  memory: 16985  
09/21 01:10:30 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:18:09  time: 0.6186  data_time: 0.0016  memory: 17005  
09/21 01:10:47 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:16:43  time: 0.3853  data_time: 0.0015  memory: 16932  
09/21 01:11:10 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:15:41  time: 0.5967  data_time: 0.0013  memory: 17006  
09/21 01:11:38 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:14:52  time: 0.2416  data_time: 0.0015  memory: 17007  
09/21 01:12:08 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:14:11  time: 1.2932  data_time: 0.0015  memory: 17010  
09/21 01:12:22 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:13:07  time: 0.3112  data_time: 0.0016  memory: 16997  
09/21 01:12:32 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:12:03  time: 0.1900  data_time: 0.0016  memory: 701  
09/21 01:12:45 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:09  time: 0.2948  data_time: 0.0014  memory: 16923  
09/21 01:13:09 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:32  time: 0.4428  data_time: 0.0015  memory: 17004  
09/21 01:13:25 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:09:48  time: 0.1758  data_time: 0.0014  memory: 16981  
09/21 01:13:47 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:11  time: 0.7285  data_time: 0.0015  memory: 17008  
09/21 01:14:04 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:33  time: 0.1832  data_time: 0.0015  memory: 16995  
09/21 01:14:18 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:53  time: 0.3152  data_time: 0.0015  memory: 16986  
09/21 01:14:27 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:13  time: 0.1826  data_time: 0.0014  memory: 1897  
09/21 01:14:47 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:42  time: 0.5402  data_time: 0.0014  memory: 16997  
09/21 01:15:02 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:08  time: 0.3859  data_time: 0.0015  memory: 1536  
09/21 01:15:21 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:39  time: 0.3533  data_time: 0.0014  memory: 16983  
09/21 01:15:54 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:15  time: 0.7006  data_time: 0.0014  memory: 17001  
09/21 01:16:10 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:45  time: 0.6026  data_time: 0.0014  memory: 16989  
09/21 01:16:20 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:14  time: 0.1693  data_time: 0.0014  memory: 701  
09/21 01:16:36 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:46  time: 0.1927  data_time: 0.0014  memory: 16932  
09/21 01:16:48 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:17  time: 0.1820  data_time: 0.0015  memory: 1580  
09/21 01:17:06 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:51  time: 0.1708  data_time: 0.0013  memory: 17005  
09/21 01:17:25 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:26  time: 0.1899  data_time: 0.0016  memory: 16996  
09/21 01:17:41 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:00  time: 0.1945  data_time: 0.0013  memory: 16985  
09/21 01:17:53 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:35  time: 0.1904  data_time: 0.0016  memory: 16984  
09/21 01:18:04 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:10  time: 0.2909  data_time: 0.0016  memory: 651  
09/21 01:18:17 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:46  time: 0.1855  data_time: 0.0014  memory: 17008  
09/21 01:18:32 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:22  time: 0.1819  data_time: 0.0014  memory: 16989  
09/21 01:18:45 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1675  data_time: 0.0013  memory: 16936  
09/21 01:18:45 - mmengine - INFO - per class results:
09/21 01:18:45 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 62.34 | 88.59 |
|       building      | 76.24 | 89.77 |
|         sky         | 88.02 | 90.72 |
|        floor        | 68.14 | 89.57 |
|         tree        | 64.25 | 86.67 |
|       ceiling       | 68.14 | 77.52 |
|         road        | 67.79 | 78.17 |
|         bed         | 77.77 |  93.0 |
|      windowpane     | 45.65 |  54.6 |
|        grass        | 55.14 | 79.39 |
|       cabinet       | 43.58 | 54.83 |
|       sidewalk      |  37.6 | 41.66 |
|        person       | 70.61 | 85.05 |
|        earth        |  23.0 | 52.46 |
|         door        | 24.29 | 32.58 |
|        table        | 49.08 | 62.62 |
|       mountain      | 39.22 | 50.01 |
|        plant        | 43.11 | 59.21 |
|       curtain       |  49.7 | 67.48 |
|        chair        |  49.9 | 62.52 |
|         car         | 78.08 |  87.9 |
|        water        | 36.65 |  44.2 |
|       painting      | 62.04 | 72.51 |
|         sofa        | 54.84 | 68.52 |
|        shelf        | 28.78 | 40.71 |
|        house        | 29.48 | 33.38 |
|         sea         | 35.09 |  59.4 |
|        mirror       | 36.48 |  39.9 |
|         rug         | 30.36 | 31.88 |
|        field        | 13.55 | 20.94 |
|       armchair      | 36.14 |  58.9 |
|         seat        |  40.8 | 51.15 |
|        fence        | 26.65 | 39.45 |
|         desk        | 34.39 | 66.07 |
|         rock        | 29.74 | 47.71 |
|       wardrobe      | 26.16 | 34.32 |
|         lamp        | 51.26 | 59.94 |
|       bathtub       | 24.13 | 24.76 |
|       railing       | 25.38 | 32.71 |
|       cushion       |  34.9 | 38.55 |
|         base        | 15.88 |  20.8 |
|         box         | 12.56 | 14.72 |
|        column       | 30.29 | 36.33 |
|      signboard      | 29.55 | 37.19 |
|   chest of drawers  | 35.29 | 48.69 |
|       counter       |  18.6 | 34.79 |
|         sand        | 10.11 | 11.11 |
|         sink        | 36.32 | 40.63 |
|      skyscraper     | 28.67 | 33.62 |
|      fireplace      | 47.53 | 56.01 |
|     refrigerator    | 46.73 | 47.66 |
|      grandstand     | 29.37 | 60.28 |
|         path        | 14.45 | 18.59 |
|        stairs       | 24.65 | 36.65 |
|        runway       | 10.32 | 10.33 |
|         case        |  23.9 | 31.84 |
|      pool table     | 89.41 | 92.25 |
|        pillow       | 32.37 | 36.98 |
|     screen door     |  1.35 |  1.35 |
|       stairway      | 31.35 | 38.57 |
|        river        |  6.8  |  7.48 |
|        bridge       |  48.5 | 52.16 |
|       bookcase      | 24.58 | 31.29 |
|        blind        | 14.83 | 15.08 |
|     coffee table    | 54.68 | 63.75 |
|        toilet       | 11.89 | 11.94 |
|        flower       |  26.8 | 39.12 |
|         book        | 39.02 | 49.83 |
|         hill        |  5.37 | 10.13 |
|        bench        | 30.57 | 36.61 |
|      countertop     |  28.4 | 33.87 |
|        stove        | 45.67 | 48.12 |
|         palm        | 41.02 | 45.73 |
|    kitchen island   | 18.76 | 24.14 |
|       computer      | 28.19 |  29.0 |
|     swivel chair    | 32.31 | 61.05 |
|         boat        | 12.42 | 12.62 |
|         bar         | 30.78 | 36.04 |
|    arcade machine   | 12.93 | 19.05 |
|        hovel        | 27.94 | 40.07 |
|         bus         | 57.94 | 59.63 |
|        towel        |  9.97 | 10.75 |
|        light        | 25.28 |  26.3 |
|        truck        |  4.59 |  5.39 |
|        tower        |  6.26 |  7.56 |
|      chandelier     | 53.34 |  73.8 |
|        awning       |  3.96 |  4.08 |
|     streetlight     | 20.81 |  24.2 |
|        booth        | 21.46 | 28.73 |
| television receiver | 45.79 |  49.7 |
|       airplane      | 30.94 | 33.05 |
|      dirt track     |  0.68 |  1.72 |
|       apparel       | 26.56 | 35.24 |
|         pole        |  21.6 | 33.25 |
|         land        |  0.0  |  0.0  |
|      bannister      |  3.9  |  5.26 |
|      escalator      |  0.66 |  0.66 |
|       ottoman       |  26.0 | 28.74 |
|        bottle       | 15.12 | 17.56 |
|        buffet       |  12.5 | 13.03 |
|        poster       |  7.67 |  8.67 |
|        stage        | 13.96 | 17.22 |
|         van         | 34.65 | 40.62 |
|         ship        |  5.13 |  5.14 |
|       fountain      |  5.83 |  6.62 |
|    conveyer belt    | 43.71 | 54.43 |
|        canopy       |  3.94 |  4.42 |
|        washer       | 32.72 | 32.72 |
|      plaything      | 18.91 | 22.75 |
|    swimming pool    |  25.6 | 25.96 |
|        stool        | 27.15 | 49.76 |
|        barrel       | 17.85 | 19.84 |
|        basket       |  14.3 | 16.88 |
|      waterfall      | 34.87 | 36.47 |
|         tent        |  4.17 |  4.18 |
|         bag         |  1.87 |  2.0  |
|       minibike      | 32.79 | 35.77 |
|        cradle       | 51.21 | 60.33 |
|         oven        |  19.8 | 27.31 |
|         ball        | 38.48 | 46.52 |
|         food        | 45.76 | 55.28 |
|         step        |  7.83 |  9.33 |
|         tank        | 15.52 | 15.55 |
|      trade name     | 11.14 | 11.42 |
|      microwave      | 12.87 | 13.16 |
|         pot         | 27.51 | 29.25 |
|        animal       | 49.36 | 54.36 |
|       bicycle       | 41.27 |  62.5 |
|         lake        |  2.32 |  2.32 |
|      dishwasher     | 29.02 | 29.67 |
|        screen       | 30.49 | 31.01 |
|       blanket       |  4.24 |  4.31 |
|      sculpture      | 21.14 | 27.54 |
|         hood        | 15.28 | 15.83 |
|        sconce       | 16.41 |  18.6 |
|         vase        | 32.95 | 46.56 |
|    traffic light    | 11.96 | 12.45 |
|         tray        |  2.95 |  3.78 |
|        ashcan       | 21.59 | 22.74 |
|         fan         | 45.48 | 54.01 |
|         pier        |  8.33 |  8.94 |
|      crt screen     | 10.28 |  14.0 |
|        plate        | 21.72 | 24.14 |
|       monitor       | 41.07 | 48.21 |
|    bulletin board   | 16.07 |  17.5 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  4.67 |  4.67 |
|        glass        |  5.99 |  6.15 |
|        clock        | 18.42 | 19.54 |
|         flag        | 12.52 | 13.01 |
+---------------------+-------+-------+
09/21 01:18:45 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 72.8800  mIoU: 29.0300  mAcc: 35.8500  data_time: 0.0018  time: 0.4542
Finished processing corruption type: shot_noise
Processing corruption type: impulse_noise
09/21 01:18:49 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 696883071
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 696883071
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 01:18:49 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='impulse_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/impulse_noise'

09/21 01:18:53 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 01:18:53 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 01:18:53 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 01:18:54 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 01:20:11 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:50:03  time: 0.7606  data_time: 0.0015  memory: 17225  
09/21 01:20:53 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:37:42  time: 1.0397  data_time: 0.0017  memory: 17004  
09/21 01:21:16 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:29:15  time: 0.4743  data_time: 0.0031  memory: 16997  
09/21 01:21:51 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:26:29  time: 0.5950  data_time: 0.0014  memory: 17006  
09/21 01:22:20 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:24:05  time: 0.3780  data_time: 0.0014  memory: 17005  
09/21 01:22:47 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:21:58  time: 0.1088  data_time: 0.0014  memory: 17000  
09/21 01:23:19 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:20:51  time: 0.5348  data_time: 0.0014  memory: 17005  
09/21 01:23:44 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:19:18  time: 0.4619  data_time: 0.0013  memory: 17003  
09/21 01:23:53 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:17:09  time: 0.2333  data_time: 0.0013  memory: 16927  
09/21 01:24:04 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:15:28  time: 0.0985  data_time: 0.0013  memory: 16985  
09/21 01:24:16 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:14:09  time: 0.4772  data_time: 0.0015  memory: 17005  
09/21 01:24:26 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:12:54  time: 0.2928  data_time: 0.0015  memory: 16932  
09/21 01:24:45 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:08  time: 0.4716  data_time: 0.0013  memory: 17006  
09/21 01:25:06 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:31  time: 0.1079  data_time: 0.0015  memory: 17007  
09/21 01:25:29 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:57  time: 0.9418  data_time: 0.0013  memory: 17010  
09/21 01:25:37 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:04  time: 0.0953  data_time: 0.0014  memory: 16997  
09/21 01:25:42 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:11  time: 0.0974  data_time: 0.0015  memory: 701  
09/21 01:25:51 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:28  time: 0.2175  data_time: 0.0013  memory: 16923  
09/21 01:26:09 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:01  time: 0.3555  data_time: 0.0014  memory: 17004  
09/21 01:26:23 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:28  time: 0.0909  data_time: 0.0015  memory: 16981  
09/21 01:26:38 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:00  time: 0.5999  data_time: 0.0014  memory: 17008  
09/21 01:26:51 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:30  time: 0.0972  data_time: 0.0014  memory: 16995  
09/21 01:27:00 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:59  time: 0.2281  data_time: 0.0013  memory: 16986  
09/21 01:27:05 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:27  time: 0.0965  data_time: 0.0014  memory: 1897  
09/21 01:27:15 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:00  time: 0.2308  data_time: 0.0014  memory: 16997  
09/21 01:27:20 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:32  time: 0.0964  data_time: 0.0014  memory: 1536  
09/21 01:27:27 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:07  time: 0.0896  data_time: 0.0013  memory: 16983  
09/21 01:27:46 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:47  time: 0.4668  data_time: 0.0013  memory: 17001  
09/21 01:27:55 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:24  time: 0.3974  data_time: 0.0013  memory: 16989  
09/21 01:27:59 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:01  time: 0.0884  data_time: 0.0013  memory: 701  
09/21 01:28:06 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:40  time: 0.1006  data_time: 0.0013  memory: 16932  
09/21 01:28:11 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:19  time: 0.0939  data_time: 0.0014  memory: 1580  
09/21 01:28:24 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:00  time: 0.0875  data_time: 0.0012  memory: 17005  
09/21 01:28:35 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:42  time: 0.0972  data_time: 0.0015  memory: 16996  
09/21 01:28:45 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:24  time: 0.1032  data_time: 0.0013  memory: 16985  
09/21 01:28:52 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:06  time: 0.0980  data_time: 0.0015  memory: 16984  
09/21 01:28:57 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:48  time: 0.0962  data_time: 0.0015  memory: 651  
09/21 01:29:05 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:32  time: 0.1014  data_time: 0.0013  memory: 17008  
09/21 01:29:14 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:15  time: 0.0930  data_time: 0.0013  memory: 16989  
09/21 01:29:24 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0874  data_time: 0.0012  memory: 16936  
09/21 01:29:24 - mmengine - INFO - per class results:
09/21 01:29:24 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 53.79 | 91.83 |
|       building      | 72.63 | 84.97 |
|         sky         | 79.81 | 82.71 |
|        floor        | 60.19 | 85.82 |
|         tree        | 58.34 | 81.62 |
|       ceiling       | 59.37 | 65.48 |
|         road        | 57.14 | 62.65 |
|         bed         | 69.35 | 77.86 |
|      windowpane     | 41.34 | 48.78 |
|        grass        | 47.14 | 85.61 |
|       cabinet       | 32.18 | 40.05 |
|       sidewalk      | 39.27 | 45.15 |
|        person       | 60.36 | 70.59 |
|        earth        | 22.37 | 46.76 |
|         door        |  12.6 | 14.63 |
|        table        | 37.95 | 49.04 |
|       mountain      | 31.96 | 44.57 |
|        plant        | 35.45 |  61.2 |
|       curtain       | 40.31 | 48.16 |
|        chair        | 35.89 | 39.83 |
|         car         | 73.12 | 82.48 |
|        water        | 22.12 | 57.71 |
|       painting      | 57.74 | 65.76 |
|         sofa        | 46.26 | 55.48 |
|        shelf        | 22.29 | 32.11 |
|        house        | 17.82 | 19.02 |
|         sea         |  20.4 | 29.13 |
|        mirror       | 27.35 | 28.88 |
|         rug         | 24.16 | 25.18 |
|        field        | 11.45 | 14.29 |
|       armchair      | 25.05 | 34.52 |
|         seat        | 22.46 | 24.13 |
|        fence        | 24.98 | 37.62 |
|         desk        | 27.01 | 39.77 |
|         rock        | 25.74 | 55.79 |
|       wardrobe      | 12.35 | 15.24 |
|         lamp        | 46.15 | 50.82 |
|       bathtub       | 14.39 | 14.88 |
|       railing       | 21.05 | 24.12 |
|       cushion       | 27.87 | 30.56 |
|         base        | 11.67 | 17.35 |
|         box         | 11.37 | 13.63 |
|        column       | 22.49 | 26.34 |
|      signboard      | 26.14 | 32.54 |
|   chest of drawers  | 26.31 | 35.78 |
|       counter       |  11.9 | 22.22 |
|         sand        |  8.2  |  8.54 |
|         sink        | 30.69 | 41.62 |
|      skyscraper     |  4.12 |  4.37 |
|      fireplace      | 32.26 | 33.73 |
|     refrigerator    |  20.2 | 20.34 |
|      grandstand     | 27.62 | 52.25 |
|         path        | 11.51 | 15.12 |
|        stairs       | 21.47 | 41.57 |
|        runway       |  4.99 |  4.99 |
|         case        | 16.75 | 20.02 |
|      pool table     | 62.73 | 63.94 |
|        pillow       | 23.33 | 25.46 |
|     screen door     |  0.13 |  0.13 |
|       stairway      | 14.78 | 15.65 |
|        river        |  1.08 |  1.09 |
|        bridge       |  16.8 | 17.61 |
|       bookcase      |  7.48 |  8.6  |
|        blind        |  4.43 |  4.48 |
|     coffee table    |  32.4 | 34.92 |
|        toilet       |  9.85 |  9.91 |
|        flower       | 22.07 | 26.12 |
|         book        | 31.05 |  36.4 |
|         hill        |  3.11 |  4.25 |
|        bench        | 18.11 | 20.51 |
|      countertop     | 21.03 | 26.76 |
|        stove        | 37.42 | 39.87 |
|         palm        | 30.82 | 32.94 |
|    kitchen island   | 17.25 | 19.97 |
|       computer      | 22.27 | 22.74 |
|     swivel chair    | 22.34 | 27.51 |
|         boat        | 11.32 |  11.5 |
|         bar         | 15.75 | 16.53 |
|    arcade machine   | 13.47 | 15.44 |
|        hovel        | 15.86 | 21.26 |
|         bus         | 27.98 | 28.64 |
|        towel        |  7.49 |  7.64 |
|        light        | 13.03 | 13.12 |
|        truck        |  2.44 |  2.76 |
|        tower        |  14.4 | 19.73 |
|      chandelier     | 50.07 | 64.25 |
|        awning       |  1.71 |  1.72 |
|     streetlight     | 17.77 | 19.31 |
|        booth        | 16.03 | 26.71 |
| television receiver | 18.86 | 19.76 |
|       airplane      | 24.77 | 25.47 |
|      dirt track     |  0.01 |  0.02 |
|       apparel       | 18.13 | 22.74 |
|         pole        |  17.7 | 25.91 |
|         land        |  0.0  |  0.0  |
|      bannister      |  3.1  |  3.75 |
|      escalator      |  0.61 |  0.61 |
|       ottoman       |  16.8 | 17.81 |
|        bottle       | 10.95 | 12.02 |
|        buffet       |  0.0  |  0.0  |
|        poster       |  3.21 |  4.06 |
|        stage        |  3.23 |  3.29 |
|         van         | 25.24 | 28.87 |
|         ship        |  1.64 |  1.64 |
|       fountain      |  4.33 |  5.27 |
|    conveyer belt    | 19.32 | 19.33 |
|        canopy       |  0.71 |  0.72 |
|        washer       |  9.74 |  9.74 |
|      plaything      | 16.06 | 19.86 |
|    swimming pool    |  42.4 | 43.05 |
|        stool        | 20.01 | 32.88 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 11.26 | 11.84 |
|      waterfall      | 28.46 | 29.61 |
|         tent        |  3.72 |  3.74 |
|         bag         |  0.25 |  0.27 |
|       minibike      | 24.51 | 26.22 |
|        cradle       | 17.72 | 18.94 |
|         oven        | 13.87 | 17.43 |
|         ball        | 40.95 | 49.71 |
|         food        | 37.03 |  41.0 |
|         step        |  2.73 |  3.54 |
|         tank        | 15.45 | 15.62 |
|      trade name     |  7.8  |  7.94 |
|      microwave      |  4.45 |  4.45 |
|         pot         | 15.16 | 15.79 |
|        animal       | 32.79 | 38.09 |
|       bicycle       | 37.17 | 56.02 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 15.22 | 15.33 |
|        screen       |  4.57 |  4.57 |
|       blanket       |  0.82 |  0.82 |
|      sculpture      |  1.36 |  1.74 |
|         hood        | 13.34 | 13.38 |
|        sconce       |  8.3  |  8.54 |
|         vase        | 29.28 | 36.57 |
|    traffic light    |  8.14 |  8.38 |
|         tray        |  3.98 |  4.46 |
|        ashcan       | 16.25 | 16.91 |
|         fan         | 33.66 | 35.73 |
|         pier        |  0.55 |  0.56 |
|      crt screen     |  4.35 |  5.57 |
|        plate        | 15.98 |  17.0 |
|       monitor       |  5.73 |  6.17 |
|    bulletin board   |  3.67 |  3.89 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  2.04 |  2.04 |
|        glass        |  5.0  |  5.11 |
|        clock        | 14.15 | 14.66 |
|         flag        | 11.08 | 11.42 |
+---------------------+-------+-------+
09/21 01:29:24 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 66.5700  mIoU: 21.0600  mAcc: 25.9500  data_time: 0.0015  time: 0.3147
Finished processing corruption type: impulse_noise
Processing corruption type: defocus_blur
09/21 01:29:42 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 428208490
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 428208490
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 01:29:42 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='defocus_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/defocus_blur'

09/21 01:30:01 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 01:30:01 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 01:30:02 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 01:30:02 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 01:31:33 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:58:46  time: 0.7665  data_time: 0.0015  memory: 17225  
09/21 01:32:14 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:41:46  time: 0.9813  data_time: 0.0015  memory: 17004  
09/21 01:32:37 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:31:46  time: 0.4755  data_time: 0.0015  memory: 16997  
09/21 01:33:10 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:06  time: 0.6007  data_time: 0.0015  memory: 17006  
09/21 01:33:39 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:25:14  time: 0.3821  data_time: 0.0014  memory: 17005  
09/21 01:34:04 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:22:48  time: 0.1138  data_time: 0.0015  memory: 17000  
09/21 01:34:34 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:21:20  time: 0.3908  data_time: 0.0014  memory: 17005  
09/21 01:34:57 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:19:39  time: 0.4682  data_time: 0.0014  memory: 17003  
09/21 01:35:07 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:17:28  time: 0.2381  data_time: 0.0014  memory: 16927  
09/21 01:35:18 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:15:45  time: 0.1050  data_time: 0.0014  memory: 16985  
09/21 01:35:31 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:14:25  time: 0.4828  data_time: 0.0015  memory: 17005  
09/21 01:35:39 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:06  time: 0.2973  data_time: 0.0015  memory: 16932  
09/21 01:35:57 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:16  time: 0.4788  data_time: 0.0013  memory: 17006  
09/21 01:36:17 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:36  time: 0.1132  data_time: 0.0015  memory: 17007  
09/21 01:36:39 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:00  time: 0.9365  data_time: 0.0014  memory: 17010  
09/21 01:36:47 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:07  time: 0.1016  data_time: 0.0015  memory: 16997  
09/21 01:36:53 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:15  time: 0.1034  data_time: 0.0016  memory: 701  
09/21 01:37:02 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:32  time: 0.2241  data_time: 0.0015  memory: 16923  
09/21 01:37:21 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:04  time: 0.3597  data_time: 0.0015  memory: 17004  
09/21 01:37:33 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:30  time: 0.0979  data_time: 0.0015  memory: 16981  
09/21 01:37:49 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:01  time: 0.6047  data_time: 0.0014  memory: 17008  
09/21 01:38:02 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:32  time: 0.1028  data_time: 0.0015  memory: 16995  
09/21 01:38:11 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:01  time: 0.2323  data_time: 0.0014  memory: 16986  
09/21 01:38:16 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:29  time: 0.1001  data_time: 0.0014  memory: 1897  
09/21 01:38:26 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:02  time: 0.2355  data_time: 0.0014  memory: 16997  
09/21 01:38:31 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:34  time: 0.1014  data_time: 0.0014  memory: 1536  
09/21 01:38:39 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:08  time: 0.0966  data_time: 0.0015  memory: 16983  
09/21 01:38:59 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:49  time: 0.4705  data_time: 0.0014  memory: 17001  
09/21 01:39:08 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:27  time: 0.4003  data_time: 0.0014  memory: 16989  
09/21 01:39:13 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:03  time: 0.0955  data_time: 0.0014  memory: 701  
09/21 01:39:20 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:42  time: 0.1051  data_time: 0.0014  memory: 16932  
09/21 01:39:26 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:20  time: 0.0995  data_time: 0.0015  memory: 1580  
09/21 01:39:37 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:01  time: 0.0939  data_time: 0.0014  memory: 17005  
09/21 01:39:49 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:43  time: 0.1025  data_time: 0.0016  memory: 16996  
09/21 01:39:59 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:25  time: 0.1091  data_time: 0.0014  memory: 16985  
09/21 01:40:07 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:07  time: 0.1041  data_time: 0.0016  memory: 16984  
09/21 01:40:12 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:49  time: 0.1031  data_time: 0.0016  memory: 651  
09/21 01:40:21 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:32  time: 0.1065  data_time: 0.0014  memory: 17008  
09/21 01:40:30 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.0993  data_time: 0.0014  memory: 16989  
09/21 01:40:41 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0932  data_time: 0.0013  memory: 16936  
09/21 01:40:41 - mmengine - INFO - per class results:
09/21 01:40:41 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 73.31 |  88.2 |
|       building      | 78.82 | 93.18 |
|         sky         | 93.23 |  96.5 |
|        floor        | 78.15 | 89.99 |
|         tree        | 71.37 | 85.53 |
|       ceiling       | 80.42 |  87.6 |
|         road        | 80.35 | 90.21 |
|         bed         | 85.86 | 94.59 |
|      windowpane     | 56.41 | 75.09 |
|        grass        | 65.23 | 79.31 |
|       cabinet       | 55.76 | 68.29 |
|       sidewalk      | 60.16 | 72.12 |
|        person       | 73.51 | 86.02 |
|        earth        |  28.9 | 40.91 |
|         door        | 41.43 | 50.82 |
|        table        | 54.67 | 70.93 |
|       mountain      | 52.09 | 65.31 |
|        plant        | 45.16 | 59.42 |
|       curtain       | 69.68 | 80.47 |
|        chair        | 51.65 | 65.08 |
|         car         |  79.3 | 87.61 |
|        water        | 47.62 | 59.49 |
|       painting      | 66.64 |  80.3 |
|         sofa        | 62.78 | 77.89 |
|        shelf        | 39.04 | 58.48 |
|        house        | 42.53 | 50.97 |
|         sea         | 46.13 | 68.33 |
|        mirror       | 59.61 | 68.43 |
|         rug         | 58.75 | 65.52 |
|        field        | 23.93 | 45.86 |
|       armchair      | 46.76 | 67.87 |
|         seat        | 47.75 | 74.16 |
|        fence        | 36.36 | 50.55 |
|         desk        | 42.08 |  55.6 |
|         rock        |  42.0 | 63.95 |
|       wardrobe      |  46.9 | 65.95 |
|         lamp        | 56.98 | 69.24 |
|       bathtub       | 71.11 | 77.45 |
|       railing       | 26.13 | 37.31 |
|       cushion       | 48.94 |  58.2 |
|         base        | 31.15 | 43.01 |
|         box         | 21.49 | 28.92 |
|        column       | 40.61 | 49.61 |
|      signboard      | 27.59 | 35.84 |
|   chest of drawers  | 35.87 | 51.32 |
|       counter       |  25.5 | 32.43 |
|         sand        | 31.69 | 48.11 |
|         sink        | 63.09 | 73.92 |
|      skyscraper     | 58.09 | 69.18 |
|      fireplace      | 59.15 | 74.79 |
|     refrigerator    | 73.33 | 82.59 |
|      grandstand     |  33.4 | 63.62 |
|         path        | 17.21 | 24.33 |
|        stairs       |  20.9 | 23.57 |
|        runway       | 68.37 | 92.48 |
|         case        |  57.2 | 76.09 |
|      pool table     | 91.07 | 95.36 |
|        pillow       | 47.47 | 54.48 |
|     screen door     | 59.88 |  68.0 |
|       stairway      | 28.52 | 42.23 |
|        river        | 11.68 | 24.41 |
|        bridge       | 44.08 | 49.87 |
|       bookcase      | 34.19 | 55.05 |
|        blind        | 29.35 |  30.1 |
|     coffee table    | 55.62 | 78.38 |
|        toilet       | 79.66 | 84.81 |
|        flower       | 23.33 | 42.25 |
|         book        | 35.49 | 47.55 |
|         hill        |  3.61 |  6.05 |
|        bench        | 41.53 | 51.25 |
|      countertop     | 50.41 | 64.78 |
|        stove        | 69.97 | 76.71 |
|         palm        | 48.14 | 54.51 |
|    kitchen island   | 35.35 | 68.62 |
|       computer      | 53.11 | 60.73 |
|     swivel chair    | 44.39 | 67.84 |
|         boat        | 48.68 | 61.84 |
|         bar         |  26.2 | 35.33 |
|    arcade machine   | 32.69 | 45.54 |
|        hovel        |  6.41 |  6.84 |
|         bus         | 76.39 | 86.33 |
|        towel        | 48.01 | 52.98 |
|        light        | 48.21 | 57.24 |
|        truck        | 25.45 |  34.0 |
|        tower        |  6.49 |  9.17 |
|      chandelier     |  60.9 | 75.94 |
|        awning       | 20.82 | 23.51 |
|     streetlight     | 19.02 |  24.9 |
|        booth        | 52.97 | 60.25 |
| television receiver |  53.7 | 74.86 |
|       airplane      | 50.56 | 65.21 |
|      dirt track     |  7.06 | 17.51 |
|       apparel       | 21.29 | 30.44 |
|         pole        | 15.37 | 19.56 |
|         land        |  7.44 |  18.6 |
|      bannister      |  5.98 |  8.08 |
|      escalator      |  8.04 |  8.33 |
|       ottoman       |  43.1 | 58.13 |
|        bottle       |  8.74 | 14.41 |
|        buffet       | 41.04 | 47.38 |
|        poster       | 31.36 | 44.19 |
|        stage        |  9.4  | 13.81 |
|         van         | 29.27 | 33.83 |
|         ship        | 55.45 | 61.27 |
|       fountain      | 19.24 | 19.56 |
|    conveyer belt    | 51.66 | 61.78 |
|        canopy       | 24.69 | 28.03 |
|        washer       |  59.9 | 64.11 |
|      plaything      | 11.81 | 25.93 |
|    swimming pool    |  35.8 | 55.55 |
|        stool        | 35.26 | 44.36 |
|        barrel       | 39.76 | 41.46 |
|        basket       | 17.38 | 18.44 |
|      waterfall      | 54.52 | 95.73 |
|         tent        | 83.16 | 98.96 |
|         bag         |  1.97 |  2.23 |
|       minibike      |  57.8 | 78.19 |
|        cradle       | 72.74 | 98.24 |
|         oven        | 23.45 | 39.92 |
|         ball        | 42.47 | 62.91 |
|         food        | 49.49 | 59.55 |
|         step        |  2.5  |  3.28 |
|         tank        | 37.34 | 37.51 |
|      trade name     | 16.54 | 18.47 |
|      microwave      | 35.58 | 38.56 |
|         pot         | 33.86 | 39.04 |
|        animal       | 45.42 | 48.76 |
|       bicycle       | 37.88 | 45.59 |
|         lake        | 33.97 | 63.22 |
|      dishwasher     | 61.68 | 63.23 |
|        screen       | 65.39 | 87.65 |
|       blanket       |  3.92 |  4.51 |
|      sculpture      |  31.5 | 45.17 |
|         hood        | 58.42 | 68.18 |
|        sconce       | 34.68 | 46.56 |
|         vase        | 29.89 | 38.94 |
|    traffic light    | 22.04 |  37.0 |
|         tray        |  3.28 |  5.27 |
|        ashcan       | 30.05 |  39.0 |
|         fan         | 49.44 |  59.2 |
|         pier        | 12.27 | 17.02 |
|      crt screen     |  7.63 | 15.71 |
|        plate        | 37.04 | 48.98 |
|       monitor       | 43.81 | 66.85 |
|    bulletin board   | 35.28 | 38.05 |
|        shower       |  0.26 |  0.46 |
|       radiator      |  28.9 | 29.71 |
|        glass        |  4.01 |  4.14 |
|        clock        | 18.07 |  21.2 |
|         flag        | 24.56 | 26.29 |
+---------------------+-------+-------+
09/21 01:40:41 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.9900  mIoU: 41.5000  mAcc: 52.3800  data_time: 0.0017  time: 0.3195
Finished processing corruption type: defocus_blur
Processing corruption type: glass_blur
09/21 01:40:47 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1966814774
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1966814774
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 01:40:48 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='glass_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/glass_blur'

09/21 01:41:12 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 01:41:12 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 01:41:13 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 01:41:13 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 01:48:16 - mmengine - INFO - Iter(test) [  50/2000]    eta: 4:34:20  time: 7.9290  data_time: 0.0016  memory: 17225  
09/21 01:54:35 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 4:13:56  time: 8.0132  data_time: 0.0016  memory: 17004  
09/21 02:00:33 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 3:58:17  time: 7.3392  data_time: 0.0015  memory: 16997  
09/21 02:06:47 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 3:50:02  time: 7.2596  data_time: 0.0015  memory: 17006  
09/21 02:12:42 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 3:40:20  time: 6.9593  data_time: 0.0015  memory: 17005  
09/21 02:18:30 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 3:31:10  time: 6.9013  data_time: 0.0016  memory: 17000  
09/21 02:24:31 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 3:24:05  time: 6.6483  data_time: 0.0015  memory: 17005  
09/21 02:30:23 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 3:16:38  time: 7.2136  data_time: 0.0014  memory: 17003  
09/21 02:35:29 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 3:06:54  time: 6.2572  data_time: 0.0015  memory: 16927  
09/21 02:41:12 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 2:59:56  time: 6.5777  data_time: 0.0014  memory: 16985  
09/21 02:47:20 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 2:54:16  time: 7.5824  data_time: 0.0017  memory: 17005  
09/21 02:52:58 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 2:47:24  time: 7.1625  data_time: 0.0016  memory: 16932  
09/21 02:58:46 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 2:41:02  time: 7.2034  data_time: 0.0014  memory: 17006  
09/21 03:04:55 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 2:35:24  time: 6.9513  data_time: 0.0016  memory: 17007  
09/21 03:10:55 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 2:29:29  time: 7.5201  data_time: 0.0014  memory: 17010  
09/21 03:16:17 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 2:22:35  time: 6.7667  data_time: 0.0016  memory: 16997  
09/21 03:21:56 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 2:16:14  time: 6.7921  data_time: 0.0016  memory: 701  
09/21 03:27:12 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 2:09:31  time: 6.1639  data_time: 0.0014  memory: 16923  
09/21 03:33:10 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 2:03:43  time: 6.8604  data_time: 0.0015  memory: 17004  
09/21 03:38:41 - mmengine - INFO - Iter(test) [1000/2000]    eta: 1:57:27  time: 6.4595  data_time: 0.0015  memory: 16981  
09/21 03:44:36 - mmengine - INFO - Iter(test) [1050/2000]    eta: 1:51:37  time: 7.5003  data_time: 0.0015  memory: 17008  
09/21 03:50:21 - mmengine - INFO - Iter(test) [1100/2000]    eta: 1:45:39  time: 6.5858  data_time: 0.0015  memory: 16995  
09/21 03:55:57 - mmengine - INFO - Iter(test) [1150/2000]    eta: 1:39:34  time: 6.8556  data_time: 0.0014  memory: 16986  
09/21 04:01:38 - mmengine - INFO - Iter(test) [1200/2000]    eta: 1:33:36  time: 6.5455  data_time: 0.0014  memory: 1897  
09/21 04:07:08 - mmengine - INFO - Iter(test) [1250/2000]    eta: 1:27:32  time: 6.6583  data_time: 0.0014  memory: 16997  
09/21 04:12:23 - mmengine - INFO - Iter(test) [1300/2000]    eta: 1:21:23  time: 6.7355  data_time: 0.0014  memory: 1536  
09/21 04:17:57 - mmengine - INFO - Iter(test) [1350/2000]    eta: 1:15:27  time: 6.2033  data_time: 0.0014  memory: 16983  
09/21 04:23:46 - mmengine - INFO - Iter(test) [1400/2000]    eta: 1:09:39  time: 7.4041  data_time: 0.0014  memory: 17001  
09/21 04:29:12 - mmengine - INFO - Iter(test) [1450/2000]    eta: 1:03:42  time: 7.3111  data_time: 0.0014  memory: 16989  
09/21 04:34:39 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:57:48  time: 6.2637  data_time: 0.0014  memory: 701  
09/21 04:40:30 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:52:02  time: 6.8375  data_time: 0.0015  memory: 16932  
09/21 04:45:59 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:46:11  time: 6.7524  data_time: 0.0016  memory: 1580  
09/21 04:51:37 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:40:23  time: 6.1849  data_time: 0.0014  memory: 17005  
09/21 04:57:25 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:34:37  time: 6.7669  data_time: 0.0016  memory: 16996  
09/21 05:03:14 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:28:51  time: 6.7056  data_time: 0.0014  memory: 16985  
09/21 05:08:39 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:23:02  time: 6.8349  data_time: 0.0016  memory: 16984  
09/21 05:14:20 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:17:16  time: 6.7701  data_time: 0.0016  memory: 651  
09/21 05:19:40 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:11:29  time: 6.5292  data_time: 0.0014  memory: 17008  
09/21 05:25:23 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:05:44  time: 6.5221  data_time: 0.0014  memory: 16989  
09/21 05:30:48 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 6.0626  data_time: 0.0013  memory: 16936  
09/21 05:30:48 - mmengine - INFO - per class results:
09/21 05:30:48 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.79 | 88.29 |
|       building      | 78.77 | 93.19 |
|         sky         | 93.51 | 97.17 |
|        floor        | 78.53 | 89.84 |
|         tree        | 70.89 | 86.31 |
|       ceiling       | 81.39 | 89.68 |
|         road        | 79.11 | 88.14 |
|         bed         | 85.95 | 94.06 |
|      windowpane     | 55.73 | 73.09 |
|        grass        | 65.23 | 79.02 |
|       cabinet       | 56.05 | 67.21 |
|       sidewalk      | 58.86 | 68.63 |
|        person       | 75.15 | 87.29 |
|        earth        | 28.55 | 45.99 |
|         door        | 39.11 | 45.79 |
|        table        | 57.18 | 71.59 |
|       mountain      |  50.5 | 66.69 |
|        plant        | 45.22 | 58.16 |
|       curtain       | 61.05 | 84.44 |
|        chair        | 53.49 | 66.12 |
|         car         | 79.98 | 85.95 |
|        water        | 49.31 | 62.53 |
|       painting      | 68.15 | 77.75 |
|         sofa        | 65.01 | 83.98 |
|        shelf        | 39.21 | 57.74 |
|        house        | 34.17 | 39.16 |
|         sea         | 50.85 | 85.06 |
|        mirror       | 58.06 | 68.71 |
|         rug         | 58.42 | 66.27 |
|        field        | 24.74 | 44.98 |
|       armchair      | 46.71 | 61.51 |
|         seat        | 49.28 | 72.15 |
|        fence        | 37.72 | 54.76 |
|         desk        | 44.83 | 56.35 |
|         rock        | 36.11 | 51.41 |
|       wardrobe      | 45.28 |  58.0 |
|         lamp        | 58.05 | 67.81 |
|       bathtub       | 70.67 | 76.81 |
|       railing       | 26.62 | 34.56 |
|       cushion       | 49.71 | 61.47 |
|         base        | 28.38 | 36.23 |
|         box         | 20.41 | 28.88 |
|        column       | 41.71 | 51.05 |
|      signboard      | 29.91 | 36.41 |
|   chest of drawers  | 36.48 | 53.01 |
|       counter       | 22.35 | 31.54 |
|         sand        | 27.33 | 41.38 |
|         sink        | 65.43 | 74.24 |
|      skyscraper     | 46.82 | 58.24 |
|      fireplace      |  55.9 | 79.13 |
|     refrigerator    |  72.8 | 80.09 |
|      grandstand     | 30.15 | 63.33 |
|         path        | 18.96 |  23.6 |
|        stairs       | 30.99 | 36.17 |
|        runway       | 65.66 | 84.28 |
|         case        | 45.24 | 65.54 |
|      pool table     | 91.02 | 94.37 |
|        pillow       | 48.38 | 56.21 |
|     screen door     | 58.96 | 62.09 |
|       stairway      | 34.12 | 41.41 |
|        river        | 10.03 | 15.37 |
|        bridge       | 47.83 | 52.52 |
|       bookcase      | 33.05 | 45.38 |
|        blind        |  22.5 | 22.95 |
|     coffee table    | 62.36 | 79.41 |
|        toilet       | 81.41 | 85.12 |
|        flower       | 27.18 | 46.64 |
|         book        | 38.87 | 53.67 |
|         hill        |  4.95 |  8.14 |
|        bench        |  36.3 | 43.37 |
|      countertop     | 50.05 | 63.92 |
|        stove        | 70.75 | 78.31 |
|         palm        | 46.76 | 55.74 |
|    kitchen island   | 37.53 |  65.5 |
|       computer      | 50.48 | 55.77 |
|     swivel chair    | 43.92 | 63.46 |
|         boat        | 31.39 |  33.4 |
|         bar         | 23.91 | 29.83 |
|    arcade machine   |  51.2 | 60.94 |
|        hovel        | 29.87 | 43.56 |
|         bus         | 78.68 | 88.01 |
|        towel        |  52.2 | 59.14 |
|        light        | 47.51 | 54.84 |
|        truck        | 21.48 | 32.58 |
|        tower        |  7.48 | 10.86 |
|      chandelier     | 64.15 | 81.47 |
|        awning       | 21.33 | 24.18 |
|     streetlight     | 19.59 |  25.1 |
|        booth        | 35.19 | 35.94 |
| television receiver | 59.48 | 68.03 |
|       airplane      | 52.96 | 62.57 |
|      dirt track     |  4.13 | 18.15 |
|       apparel       | 28.53 | 47.39 |
|         pole        | 20.22 | 27.75 |
|         land        |  3.77 |  6.56 |
|      bannister      |  3.53 |  4.87 |
|      escalator      | 11.62 | 11.87 |
|       ottoman       | 42.37 | 54.16 |
|        bottle       | 10.42 | 17.64 |
|        buffet       | 46.74 | 52.64 |
|        poster       | 33.77 | 50.74 |
|        stage        | 12.56 | 22.28 |
|         van         | 41.45 | 53.81 |
|         ship        | 24.63 | 33.09 |
|       fountain      | 17.24 | 19.24 |
|    conveyer belt    | 61.53 | 75.66 |
|        canopy       | 22.63 | 25.54 |
|        washer       | 60.97 | 61.95 |
|      plaything      |  14.1 | 23.49 |
|    swimming pool    |  28.7 | 47.32 |
|        stool        | 36.88 | 49.96 |
|        barrel       | 28.32 | 41.18 |
|        basket       | 21.42 |  23.8 |
|      waterfall      | 63.31 | 93.48 |
|         tent        | 93.48 | 98.19 |
|         bag         |  5.45 |  5.86 |
|       minibike      | 56.92 | 68.63 |
|        cradle       | 72.31 | 98.08 |
|         oven        | 40.64 | 43.75 |
|         ball        | 44.69 |  62.1 |
|         food        | 50.79 | 66.02 |
|         step        |  5.59 |  7.32 |
|         tank        | 38.58 | 38.77 |
|      trade name     | 14.68 | 15.72 |
|      microwave      | 34.21 | 36.55 |
|         pot         | 33.99 | 38.38 |
|        animal       | 43.92 | 55.18 |
|       bicycle       | 37.95 | 50.87 |
|         lake        | 50.38 | 63.14 |
|      dishwasher     | 53.72 | 54.95 |
|        screen       | 55.69 |  67.5 |
|       blanket       |  2.82 |  3.11 |
|      sculpture      | 29.77 | 43.82 |
|         hood        | 62.71 | 74.43 |
|        sconce       | 34.48 | 45.59 |
|         vase        | 33.46 | 42.59 |
|    traffic light    | 25.17 | 32.23 |
|         tray        |  3.01 |  4.98 |
|        ashcan       | 31.69 | 38.62 |
|         fan         | 45.82 | 55.35 |
|         pier        | 12.49 | 15.14 |
|      crt screen     |  5.35 |  9.73 |
|        plate        | 39.23 | 46.38 |
|       monitor       | 53.64 | 67.05 |
|    bulletin board   | 38.15 | 43.77 |
|        shower       |  0.01 |  0.01 |
|       radiator      | 40.31 | 43.77 |
|        glass        |  5.03 |  5.17 |
|        clock        | 16.06 | 18.18 |
|         flag        | 27.55 | 29.07 |
+---------------------+-------+-------+
09/21 05:30:48 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.9000  mIoU: 41.9300  mAcc: 52.0200  data_time: 0.0019  time: 6.8874
Finished processing corruption type: glass_blur
Processing corruption type: motion_blur
09/21 05:30:52 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1541702839
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1541702839
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 05:30:52 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='motion_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/motion_blur'

09/21 05:30:56 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 05:30:56 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 05:30:56 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 05:30:57 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 05:32:50 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:13:42  time: 1.5451  data_time: 0.0015  memory: 17225  
09/21 05:34:10 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:01:05  time: 1.7717  data_time: 0.0015  memory: 17004  
09/21 05:35:07 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:51:25  time: 1.1957  data_time: 0.0015  memory: 16997  
09/21 05:36:17 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:47:59  time: 1.3087  data_time: 0.0015  memory: 17006  
09/21 05:37:32 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:46:03  time: 1.3747  data_time: 0.0015  memory: 17005  
09/21 05:38:36 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:43:23  time: 0.8346  data_time: 0.0015  memory: 17000  
09/21 05:39:45 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:41:29  time: 1.0753  data_time: 0.0014  memory: 17005  
09/21 05:40:46 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:39:16  time: 1.2133  data_time: 0.0014  memory: 17003  
09/21 05:41:26 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:36:06  time: 0.8674  data_time: 0.0014  memory: 16927  
09/21 05:42:13 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:33:48  time: 0.7340  data_time: 0.0014  memory: 16985  
09/21 05:43:02 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:31:50  time: 1.2524  data_time: 0.0016  memory: 17005  
09/21 05:43:43 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:29:47  time: 1.0131  data_time: 0.0016  memory: 16932  
09/21 05:44:35 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:28:19  time: 1.1948  data_time: 0.0014  memory: 17006  
09/21 05:45:33 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:27:06  time: 0.8244  data_time: 0.0016  memory: 17007  
09/21 05:46:30 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:25:55  time: 1.6672  data_time: 0.0024  memory: 17010  
09/21 05:47:12 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:24:21  time: 0.7407  data_time: 0.0016  memory: 16997  
09/21 05:47:50 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:22:50  time: 0.7509  data_time: 0.0016  memory: 701  
09/21 05:48:30 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:21:26  time: 0.8496  data_time: 0.0014  memory: 16923  
09/21 05:49:36 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:20:36  time: 1.2045  data_time: 0.0015  memory: 17004  
09/21 05:50:27 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:19:29  time: 0.7969  data_time: 0.0015  memory: 16981  
09/21 05:51:24 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:18:29  time: 1.5803  data_time: 0.0015  memory: 17008  
09/21 05:52:12 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:17:23  time: 0.7999  data_time: 0.0015  memory: 16995  
09/21 05:52:56 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:16:14  time: 0.9191  data_time: 0.0015  memory: 16986  
09/21 05:53:39 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:15:07  time: 0.8904  data_time: 0.0015  memory: 1897  
09/21 05:54:29 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:14:07  time: 1.0267  data_time: 0.0014  memory: 16997  
09/21 05:55:09 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:13:01  time: 0.8432  data_time: 0.0014  memory: 1536  
09/21 05:55:53 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:12:00  time: 0.7214  data_time: 0.0014  memory: 16983  
09/21 05:56:49 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:11:05  time: 1.2380  data_time: 0.0014  memory: 17001  
09/21 05:57:33 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:10:05  time: 1.2202  data_time: 0.0014  memory: 16989  
09/21 05:58:11 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:09:04  time: 0.7095  data_time: 0.0014  memory: 701  
09/21 05:58:53 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:08:06  time: 0.8019  data_time: 0.0014  memory: 16932  
09/21 05:59:30 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:08  time: 0.8042  data_time: 0.0015  memory: 1580  
09/21 06:00:15 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:12  time: 0.7211  data_time: 0.0014  memory: 17005  
09/21 06:01:03 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:18  time: 0.7912  data_time: 0.0016  memory: 16996  
09/21 06:01:48 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:24  time: 0.8224  data_time: 0.0014  memory: 16985  
09/21 06:02:31 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:30  time: 0.8975  data_time: 0.0016  memory: 16984  
09/21 06:03:13 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:36  time: 0.8096  data_time: 0.0016  memory: 651  
09/21 06:03:57 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:44  time: 0.7667  data_time: 0.0015  memory: 17008  
09/21 06:04:44 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:51  time: 0.8515  data_time: 0.0015  memory: 16989  
09/21 06:05:27 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6811  data_time: 0.0013  memory: 16936  
09/21 06:05:27 - mmengine - INFO - per class results:
09/21 06:05:27 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 73.28 | 85.81 |
|       building      | 76.79 | 94.21 |
|         sky         | 92.68 | 95.71 |
|        floor        | 76.78 | 89.48 |
|         tree        | 65.51 |  75.7 |
|       ceiling       | 80.72 | 90.35 |
|         road        | 77.02 | 82.94 |
|         bed         | 86.03 | 95.17 |
|      windowpane     | 57.47 | 76.39 |
|        grass        | 61.96 | 79.71 |
|       cabinet       | 56.21 | 68.33 |
|       sidewalk      | 59.43 | 80.93 |
|        person       | 73.36 | 87.45 |
|        earth        |  25.7 | 37.98 |
|         door        | 40.23 | 48.25 |
|        table        | 55.99 | 72.53 |
|       mountain      |  47.1 | 66.34 |
|        plant        | 41.29 | 62.35 |
|       curtain       | 68.53 | 79.68 |
|        chair        | 51.83 |  66.9 |
|         car         | 79.12 | 88.59 |
|        water        | 42.31 | 58.76 |
|       painting      |  66.3 | 81.58 |
|         sofa        | 60.68 |  78.9 |
|        shelf        | 36.82 | 56.49 |
|        house        | 34.85 | 42.32 |
|         sea         | 45.34 | 75.17 |
|        mirror       |  60.5 | 68.37 |
|         rug         | 51.73 |  63.1 |
|        field        | 23.05 | 34.93 |
|       armchair      | 40.78 | 55.67 |
|         seat        | 48.42 | 73.82 |
|        fence        | 30.79 | 48.29 |
|         desk        | 47.32 | 63.86 |
|         rock        | 26.39 | 31.17 |
|       wardrobe      | 46.88 | 66.12 |
|         lamp        | 57.36 |  69.8 |
|       bathtub       | 71.21 | 77.93 |
|       railing       | 26.44 | 37.87 |
|       cushion       | 46.33 | 57.39 |
|         base        | 32.29 | 43.24 |
|         box         |  20.9 | 28.62 |
|        column       | 37.93 | 47.01 |
|      signboard      | 29.04 | 37.79 |
|   chest of drawers  | 37.74 | 55.95 |
|       counter       | 24.97 |  34.5 |
|         sand        | 29.25 | 53.44 |
|         sink        | 65.49 | 75.94 |
|      skyscraper     |  44.9 | 49.05 |
|      fireplace      | 61.81 | 79.24 |
|     refrigerator    | 75.91 | 86.16 |
|      grandstand     | 34.37 | 61.34 |
|         path        | 15.75 | 22.04 |
|        stairs       | 25.39 | 28.61 |
|        runway       | 70.15 | 94.85 |
|         case        |  50.2 | 65.06 |
|      pool table     | 90.73 | 95.11 |
|        pillow       | 51.88 | 65.68 |
|     screen door     | 56.89 | 72.31 |
|       stairway      | 25.62 | 33.88 |
|        river        |  8.74 | 15.13 |
|        bridge       | 33.78 | 37.09 |
|       bookcase      | 36.96 | 50.63 |
|        blind        | 40.79 | 50.39 |
|     coffee table    | 57.98 | 75.06 |
|        toilet       | 83.09 | 88.04 |
|        flower       | 20.69 | 29.79 |
|         book        | 38.05 | 54.13 |
|         hill        |  4.47 |  8.22 |
|        bench        | 38.78 | 49.13 |
|      countertop     |  55.2 | 73.19 |
|        stove        |  71.5 | 77.53 |
|         palm        | 30.53 | 63.37 |
|    kitchen island   | 34.95 | 68.51 |
|       computer      | 53.12 |  61.4 |
|     swivel chair    | 46.08 | 67.64 |
|         boat        | 39.81 |  44.7 |
|         bar         | 24.08 | 29.62 |
|    arcade machine   | 25.24 | 27.65 |
|        hovel        |  4.96 |  5.23 |
|         bus         | 75.65 | 86.83 |
|        towel        | 48.05 | 62.05 |
|        light        | 50.51 | 60.25 |
|        truck        | 20.48 | 25.59 |
|        tower        |  5.68 |  7.12 |
|      chandelier     | 56.95 | 66.58 |
|        awning       | 18.29 |  24.8 |
|     streetlight     | 18.39 | 23.48 |
|        booth        |  62.1 |  66.7 |
| television receiver | 64.78 | 75.37 |
|       airplane      | 48.75 | 65.79 |
|      dirt track     |  4.24 |  19.4 |
|       apparel       | 22.78 | 32.43 |
|         pole        | 18.14 | 25.93 |
|         land        | 10.75 | 14.49 |
|      bannister      |  8.0  | 10.09 |
|      escalator      | 20.86 | 21.83 |
|       ottoman       | 39.69 | 55.36 |
|        bottle       |  9.04 | 12.28 |
|        buffet       | 45.08 | 50.95 |
|        poster       | 24.83 | 37.82 |
|        stage        | 11.93 |  16.6 |
|         van         |  34.8 | 40.02 |
|         ship        | 52.19 | 63.97 |
|       fountain      | 12.66 | 12.76 |
|    conveyer belt    |  73.4 | 84.41 |
|        canopy       | 20.55 |  22.4 |
|        washer       | 63.79 |  65.1 |
|      plaything      | 10.99 | 16.62 |
|    swimming pool    | 27.76 | 39.19 |
|        stool        | 34.43 | 44.65 |
|        barrel       | 38.79 | 41.71 |
|        basket       | 11.52 |  27.5 |
|      waterfall      | 41.31 | 54.47 |
|         tent        | 92.98 | 98.35 |
|         bag         |  6.25 |  7.35 |
|       minibike      | 51.04 | 76.16 |
|        cradle       | 75.77 | 94.48 |
|         oven        | 17.31 | 47.75 |
|         ball        | 46.05 | 62.56 |
|         food        | 50.87 | 64.82 |
|         step        |  4.02 |  4.73 |
|         tank        | 38.13 | 40.29 |
|      trade name     |  20.3 | 22.88 |
|      microwave      | 32.53 | 35.43 |
|         pot         |  27.0 | 31.52 |
|        animal       |  41.8 | 54.28 |
|       bicycle       | 38.88 | 54.84 |
|         lake        | 59.34 | 61.52 |
|      dishwasher     | 66.25 | 70.73 |
|        screen       | 66.06 | 85.95 |
|       blanket       |  8.87 | 10.42 |
|      sculpture      | 33.53 | 43.82 |
|         hood        | 62.99 | 83.44 |
|        sconce       | 36.67 |  49.0 |
|         vase        | 31.63 | 38.88 |
|    traffic light    | 25.23 | 39.18 |
|         tray        |  4.51 | 10.63 |
|        ashcan       |  31.2 | 45.28 |
|         fan         | 51.02 |  62.8 |
|         pier        | 25.03 | 32.08 |
|      crt screen     |  5.82 | 11.07 |
|        plate        | 37.97 | 56.28 |
|       monitor       |  46.2 | 71.74 |
|    bulletin board   | 36.64 | 42.76 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 43.63 | 46.33 |
|        glass        |  6.01 |  6.22 |
|        clock        | 27.27 | 30.09 |
|         flag        |  23.0 | 24.73 |
+---------------------+-------+-------+
09/21 06:05:27 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.9900  mIoU: 41.4600  mAcc: 52.4400  data_time: 0.0017  time: 1.0352
Finished processing corruption type: motion_blur
Processing corruption type: zoom_blur
09/21 06:05:30 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1273861464
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1273861464
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 06:05:31 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='zoom_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/zoom_blur'

09/21 06:05:35 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 06:05:35 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 06:05:35 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 06:05:35 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 06:07:26 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:12:02  time: 1.4830  data_time: 0.0015  memory: 17225  
09/21 06:08:43 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:59:21  time: 1.6823  data_time: 0.0015  memory: 17004  
09/21 06:09:38 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:49:45  time: 1.1371  data_time: 0.0015  memory: 16997  
09/21 06:10:45 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:46:23  time: 1.2259  data_time: 0.0015  memory: 17006  
09/21 06:11:45 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:43:09  time: 1.0322  data_time: 0.0015  memory: 17005  
09/21 06:12:51 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:41:07  time: 0.7974  data_time: 0.0016  memory: 17000  
09/21 06:14:02 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:39:47  time: 1.0562  data_time: 0.0015  memory: 17005  
09/21 06:15:00 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:37:39  time: 1.1267  data_time: 0.0014  memory: 17003  
09/21 06:15:39 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:34:37  time: 0.8342  data_time: 0.0014  memory: 16927  
09/21 06:16:21 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:32:17  time: 0.7041  data_time: 0.0014  memory: 16985  
09/21 06:17:11 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:30:32  time: 1.2422  data_time: 0.0015  memory: 17005  
09/21 06:17:54 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:28:42  time: 0.9461  data_time: 0.0016  memory: 16932  
09/21 06:18:45 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:27:20  time: 1.1100  data_time: 0.0014  memory: 17006  
09/21 06:19:40 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:26:07  time: 0.7298  data_time: 0.0016  memory: 17007  
09/21 06:20:32 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:24:54  time: 1.5880  data_time: 0.0014  memory: 17010  
09/21 06:21:11 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:23:23  time: 0.7025  data_time: 0.0016  memory: 16997  
09/21 06:21:47 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:21:53  time: 0.7211  data_time: 0.0016  memory: 701  
09/21 06:22:25 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:20:34  time: 0.7528  data_time: 0.0013  memory: 16923  
09/21 06:23:16 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:19:32  time: 0.9701  data_time: 0.0015  memory: 17004  
09/21 06:23:58 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:18:22  time: 0.6744  data_time: 0.0014  memory: 16981  
09/21 06:24:46 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:17:20  time: 1.2577  data_time: 0.0014  memory: 17008  
09/21 06:25:29 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:16:16  time: 0.6907  data_time: 0.0015  memory: 16995  
09/21 06:26:08 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:15:11  time: 0.8313  data_time: 0.0015  memory: 16986  
09/21 06:26:44 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:14:05  time: 0.6881  data_time: 0.0014  memory: 1897  
09/21 06:27:23 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:13:04  time: 0.8107  data_time: 0.0015  memory: 16997  
09/21 06:27:56 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:12:02  time: 0.7055  data_time: 0.0033  memory: 1536  
09/21 06:28:34 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:11:03  time: 0.6734  data_time: 0.0014  memory: 16983  
09/21 06:29:26 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:10:12  time: 1.1314  data_time: 0.0014  memory: 17001  
09/21 06:30:04 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:09:17  time: 1.0693  data_time: 0.0014  memory: 16989  
09/21 06:30:38 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:08:20  time: 0.6506  data_time: 0.0014  memory: 701  
09/21 06:31:17 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:07:27  time: 0.7189  data_time: 0.0014  memory: 16932  
09/21 06:31:51 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:06:33  time: 0.6881  data_time: 0.0015  memory: 1580  
09/21 06:32:32 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:05:42  time: 0.6442  data_time: 0.0013  memory: 17005  
09/21 06:33:14 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:52  time: 0.7032  data_time: 0.0015  memory: 16996  
09/21 06:33:55 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:02  time: 0.6986  data_time: 0.0013  memory: 16985  
09/21 06:34:33 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:13  time: 0.7162  data_time: 0.0016  memory: 16984  
09/21 06:35:08 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:23  time: 0.7044  data_time: 0.0016  memory: 651  
09/21 06:35:45 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:35  time: 0.6843  data_time: 0.0014  memory: 17008  
09/21 06:36:25 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:47  time: 0.6756  data_time: 0.0014  memory: 16989  
09/21 06:37:03 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6347  data_time: 0.0013  memory: 16936  
09/21 06:37:03 - mmengine - INFO - per class results:
09/21 06:37:03 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 53.64 |  83.3 |
|       building      | 61.74 |  83.7 |
|         sky         | 84.03 | 86.75 |
|        floor        | 52.06 | 78.51 |
|         tree        | 21.18 | 22.51 |
|       ceiling       | 60.34 | 84.02 |
|         road        | 51.82 | 58.38 |
|         bed         | 69.06 | 87.55 |
|      windowpane     | 39.17 | 60.16 |
|        grass        | 38.08 | 52.75 |
|       cabinet       | 40.22 | 50.03 |
|       sidewalk      | 28.58 | 41.49 |
|        person       | 49.86 | 66.23 |
|        earth        |  9.7  | 13.78 |
|         door        | 15.88 | 17.38 |
|        table        | 36.19 | 50.85 |
|       mountain      | 29.84 | 42.63 |
|        plant        | 19.24 |  47.7 |
|       curtain       | 39.05 | 64.02 |
|        chair        | 27.71 | 34.79 |
|         car         | 54.46 | 62.72 |
|        water        | 20.94 | 35.06 |
|       painting      | 42.78 | 61.61 |
|         sofa        | 44.41 | 67.79 |
|        shelf        | 23.11 | 35.97 |
|        house        |  2.23 |  2.38 |
|         sea         | 33.41 | 56.67 |
|        mirror       | 35.99 | 41.04 |
|         rug         | 17.49 | 18.78 |
|        field        | 13.34 | 24.05 |
|       armchair      | 16.13 | 20.41 |
|         seat        | 20.91 |  34.1 |
|        fence        |  6.56 | 13.07 |
|         desk        | 25.93 | 32.42 |
|         rock        | 14.55 | 16.64 |
|       wardrobe      |  23.9 | 33.84 |
|         lamp        | 36.14 | 48.12 |
|       bathtub       | 64.49 | 78.66 |
|       railing       | 11.95 | 16.32 |
|       cushion       | 23.32 | 29.24 |
|         base        |  13.0 | 17.21 |
|         box         |  2.82 |  3.09 |
|        column       | 16.82 | 18.29 |
|      signboard      | 11.45 | 12.65 |
|   chest of drawers  | 24.82 | 34.12 |
|       counter       | 11.75 | 22.16 |
|         sand        |  8.48 | 23.61 |
|         sink        | 43.84 | 61.79 |
|      skyscraper     |  12.2 | 14.93 |
|      fireplace      | 50.83 | 64.41 |
|     refrigerator    |  55.1 | 80.46 |
|      grandstand     | 29.28 | 48.33 |
|         path        |  1.98 |  2.3  |
|        stairs       |  4.07 |  4.82 |
|        runway       |  57.7 | 81.45 |
|         case        | 20.17 | 46.42 |
|      pool table     | 77.62 | 90.26 |
|        pillow       | 39.97 |  56.3 |
|     screen door     | 36.36 | 52.75 |
|       stairway      | 14.21 | 15.68 |
|        river        |  2.37 |  4.23 |
|        bridge       | 21.48 | 25.45 |
|       bookcase      | 12.73 |  13.7 |
|        blind        | 14.32 |  21.9 |
|     coffee table    | 39.41 | 46.83 |
|        toilet       |  62.9 | 70.86 |
|        flower       | 10.35 | 19.08 |
|         book        |  12.4 | 14.42 |
|         hill        |  4.62 |  7.21 |
|        bench        |  33.5 | 44.07 |
|      countertop     | 36.09 | 44.94 |
|        stove        |  41.5 | 47.08 |
|         palm        |  6.86 | 38.12 |
|    kitchen island   | 26.83 | 61.68 |
|       computer      |  42.7 | 50.28 |
|     swivel chair    |  7.02 |  7.73 |
|         boat        | 15.34 | 16.85 |
|         bar         | 12.39 | 15.99 |
|    arcade machine   |  0.9  |  0.9  |
|        hovel        |  0.26 |  0.26 |
|         bus         | 62.37 | 71.72 |
|        towel        | 19.27 | 24.88 |
|        light        | 18.21 | 21.81 |
|        truck        |  0.19 |  0.2  |
|        tower        |  3.09 |  3.17 |
|      chandelier     | 31.69 | 36.85 |
|        awning       |  8.62 |  9.08 |
|     streetlight     |  1.78 |  1.88 |
|        booth        |  2.17 |  2.17 |
| television receiver |  32.9 | 38.49 |
|       airplane      | 32.64 | 58.52 |
|      dirt track     | 10.54 | 18.92 |
|       apparel       |  8.34 | 12.04 |
|         pole        |  3.03 |  3.3  |
|         land        |  7.36 |  9.0  |
|      bannister      |  0.9  |  1.07 |
|      escalator      | 12.86 | 17.25 |
|       ottoman       | 26.45 | 38.39 |
|        bottle       |  0.61 |  0.66 |
|        buffet       | 21.95 | 24.57 |
|        poster       | 10.04 | 19.72 |
|        stage        |  7.79 | 15.29 |
|         van         |  1.8  |  1.81 |
|         ship        |  0.18 |  0.2  |
|       fountain      |  0.01 |  0.01 |
|    conveyer belt    | 23.87 | 33.37 |
|        canopy       |  3.88 |  4.0  |
|        washer       | 49.45 | 50.47 |
|      plaything      |  0.83 |  0.94 |
|    swimming pool    | 34.55 |  48.8 |
|        stool        | 15.77 | 20.29 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  7.2  |  9.47 |
|      waterfall      | 19.99 | 87.63 |
|         tent        | 14.45 | 14.51 |
|         bag         |  0.24 |  0.25 |
|       minibike      | 22.44 | 25.95 |
|        cradle       | 65.78 | 87.64 |
|         oven        | 21.77 | 33.88 |
|         ball        |  19.2 |  22.1 |
|         food        | 10.44 | 10.95 |
|         step        |  0.53 |  0.95 |
|         tank        |  3.11 |  3.17 |
|      trade name     |  3.25 |  3.28 |
|      microwave      | 23.45 | 26.15 |
|         pot         |  4.02 |  4.2  |
|        animal       | 34.15 | 41.34 |
|       bicycle       |  6.14 |  6.76 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 27.85 | 36.32 |
|        screen       | 51.76 | 78.68 |
|       blanket       |  7.92 |  9.22 |
|      sculpture      |  1.0  |  1.27 |
|         hood        | 38.24 | 54.06 |
|        sconce       | 17.38 | 23.23 |
|         vase        | 15.69 | 21.78 |
|    traffic light    |  3.77 |  3.86 |
|         tray        |  1.26 |  2.31 |
|        ashcan       |  8.28 |  9.29 |
|         fan         | 31.57 | 41.76 |
|         pier        |  9.92 | 12.43 |
|      crt screen     |  5.35 |  6.35 |
|        plate        | 22.62 | 30.44 |
|       monitor       |  8.5  |  9.06 |
|    bulletin board   | 12.17 | 14.56 |
|        shower       |  0.08 |  0.31 |
|       radiator      | 24.35 | 33.84 |
|        glass        |  1.47 |  1.53 |
|        clock        |  4.75 |  4.93 |
|         flag        | 10.75 | 11.26 |
+---------------------+-------+-------+
09/21 06:37:03 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 62.6200  mIoU: 22.0700  mAcc: 30.2100  data_time: 0.0016  time: 0.9435
Finished processing corruption type: zoom_blur
Processing corruption type: snow
09/21 06:37:10 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1080052916
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1080052916
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 06:37:10 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='snow',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/snow'

09/21 06:37:14 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 06:37:14 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 06:37:15 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 06:37:15 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 06:38:46 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:58:52  time: 1.0547  data_time: 0.0016  memory: 17225  
09/21 06:39:41 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:46:06  time: 1.2605  data_time: 0.0017  memory: 17004  
09/21 06:40:15 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:36:56  time: 0.7186  data_time: 0.0015  memory: 16997  
09/21 06:41:00 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:33:46  time: 0.8170  data_time: 0.0015  memory: 17006  
09/21 06:41:41 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:31:02  time: 0.6190  data_time: 0.0015  memory: 17005  
09/21 06:42:17 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:28:29  time: 0.3184  data_time: 0.0016  memory: 17000  
09/21 06:43:00 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:27:03  time: 0.6166  data_time: 0.0015  memory: 17005  
09/21 06:43:34 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:25:15  time: 0.7096  data_time: 0.0014  memory: 17003  
09/21 06:43:53 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:22:49  time: 0.4206  data_time: 0.0038  memory: 16927  
09/21 06:44:16 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:21:01  time: 0.4355  data_time: 0.0015  memory: 16985  
09/21 06:44:40 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:19:32  time: 0.7363  data_time: 0.0015  memory: 17005  
09/21 06:44:59 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:18:01  time: 0.5053  data_time: 0.0016  memory: 16932  
09/21 06:45:27 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:17:02  time: 0.7114  data_time: 0.0014  memory: 17006  
09/21 06:45:59 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:16:13  time: 0.3218  data_time: 0.0016  memory: 17007  
09/21 06:46:31 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:15:27  time: 1.1852  data_time: 0.0014  memory: 17010  
09/21 06:46:50 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:14:21  time: 0.3031  data_time: 0.0016  memory: 16997  
09/21 06:47:05 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:13:18  time: 0.3107  data_time: 0.0017  memory: 701  
09/21 06:47:23 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:12:22  time: 0.3993  data_time: 0.0014  memory: 16923  
09/21 06:47:53 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:11:45  time: 0.5509  data_time: 0.0015  memory: 17004  
09/21 06:48:15 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:10:59  time: 0.2880  data_time: 0.0015  memory: 16981  
09/21 06:48:42 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:10:21  time: 0.8404  data_time: 0.0015  memory: 17008  
09/21 06:49:05 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:09:40  time: 0.2956  data_time: 0.0015  memory: 16995  
09/21 06:49:24 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:08:58  time: 0.4298  data_time: 0.0015  memory: 16986  
09/21 06:49:40 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:08:16  time: 0.3003  data_time: 0.0014  memory: 1897  
09/21 06:50:00 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:07:38  time: 0.4379  data_time: 0.0015  memory: 16997  
09/21 06:50:19 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:07:02  time: 0.4964  data_time: 0.0015  memory: 1536  
09/21 06:50:43 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:06:29  time: 0.4137  data_time: 0.0015  memory: 16983  
09/21 06:51:24 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:06:03  time: 1.0419  data_time: 0.0015  memory: 17001  
09/21 06:51:47 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:05:30  time: 0.7719  data_time: 0.0014  memory: 16989  
09/21 06:52:05 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:56  time: 0.3679  data_time: 0.0023  memory: 701  
09/21 06:52:26 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:04:24  time: 0.3207  data_time: 0.0015  memory: 16932  
09/21 06:52:44 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:52  time: 0.4304  data_time: 0.0016  memory: 1580  
09/21 06:53:06 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:03:21  time: 0.2961  data_time: 0.0014  memory: 17005  
09/21 06:53:31 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:52  time: 0.3077  data_time: 0.0016  memory: 16996  
09/21 06:53:52 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:22  time: 0.3286  data_time: 0.0014  memory: 16985  
09/21 06:54:11 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:52  time: 0.3158  data_time: 0.0016  memory: 16984  
09/21 06:54:26 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:23  time: 0.3035  data_time: 0.0016  memory: 651  
09/21 06:54:52 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:55  time: 0.4247  data_time: 0.0015  memory: 17008  
09/21 06:55:19 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:27  time: 0.3800  data_time: 0.0015  memory: 16989  
09/21 06:55:46 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.3027  data_time: 0.0013  memory: 16936  
09/21 06:55:46 - mmengine - INFO - per class results:
09/21 06:55:46 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 53.75 | 89.48 |
|       building      | 66.83 | 91.41 |
|         sky         | 71.23 | 73.63 |
|        floor        | 60.13 | 83.91 |
|         tree        | 60.94 | 81.69 |
|       ceiling       | 53.84 | 61.12 |
|         road        | 48.68 | 51.47 |
|         bed         | 61.19 | 65.32 |
|      windowpane     | 48.73 | 59.15 |
|        grass        | 52.59 | 80.65 |
|       cabinet       | 33.23 |  40.7 |
|       sidewalk      | 40.25 | 64.38 |
|        person       | 65.87 | 78.05 |
|        earth        | 23.44 | 36.01 |
|         door        |  15.2 | 17.92 |
|        table        | 38.32 |  49.8 |
|       mountain      | 29.14 | 35.69 |
|        plant        | 43.68 | 61.93 |
|       curtain       | 35.61 | 41.37 |
|        chair        | 39.48 | 50.58 |
|         car         | 74.42 | 83.24 |
|        water        | 31.11 | 40.21 |
|       painting      | 56.87 | 66.75 |
|         sofa        | 39.35 | 44.99 |
|        shelf        | 24.72 | 43.92 |
|        house        | 13.72 |  14.3 |
|         sea         | 22.31 | 36.37 |
|        mirror       | 31.07 | 33.13 |
|         rug         | 25.81 | 26.63 |
|        field        | 15.08 | 25.46 |
|       armchair      | 25.44 | 28.97 |
|         seat        | 21.85 | 50.93 |
|        fence        | 18.88 |  44.2 |
|         desk        | 19.97 | 22.21 |
|         rock        | 22.64 | 29.28 |
|       wardrobe      | 16.89 | 21.53 |
|         lamp        | 51.27 | 60.25 |
|       bathtub       | 24.13 | 25.31 |
|       railing       | 12.85 | 15.41 |
|       cushion       | 34.22 | 44.34 |
|         base        |  8.81 | 27.18 |
|         box         |  9.62 | 17.06 |
|        column       | 14.88 | 15.56 |
|      signboard      |  27.5 | 38.34 |
|   chest of drawers  | 29.01 | 35.69 |
|       counter       | 13.08 | 20.85 |
|         sand        |  5.49 |  6.88 |
|         sink        | 44.75 | 58.63 |
|      skyscraper     | 11.43 | 14.26 |
|      fireplace      | 48.44 | 54.69 |
|     refrigerator    | 46.78 | 48.25 |
|      grandstand     | 18.98 | 60.68 |
|         path        | 10.45 | 12.07 |
|        stairs       | 20.83 | 25.92 |
|        runway       | 33.45 | 46.33 |
|         case        | 54.04 | 75.41 |
|      pool table     | 33.27 |  33.5 |
|        pillow       | 35.87 | 41.42 |
|     screen door     | 12.39 |  12.7 |
|       stairway      |  8.69 | 10.88 |
|        river        |  4.24 |  5.54 |
|        bridge       | 46.66 | 52.18 |
|       bookcase      |  8.43 |  9.04 |
|        blind        |  3.82 |  3.98 |
|     coffee table    | 28.86 | 30.45 |
|        toilet       | 27.81 | 29.55 |
|        flower       | 28.22 | 38.29 |
|         book        | 26.34 |  33.5 |
|         hill        |  2.65 |  2.8  |
|        bench        | 18.28 |  20.6 |
|      countertop     | 25.51 | 31.41 |
|        stove        | 40.21 | 42.63 |
|         palm        | 37.22 | 42.98 |
|    kitchen island   | 26.32 | 37.19 |
|       computer      | 33.38 |  38.3 |
|     swivel chair    | 13.37 | 14.23 |
|         boat        |  17.6 | 18.04 |
|         bar         | 19.31 | 20.71 |
|    arcade machine   |  9.69 |  9.87 |
|        hovel        |  5.22 |  6.96 |
|         bus         | 82.63 |  89.5 |
|        towel        | 12.13 | 13.63 |
|        light        | 23.79 | 24.41 |
|        truck        |  4.61 |  5.45 |
|        tower        | 21.46 | 28.47 |
|      chandelier     |  52.0 | 72.31 |
|        awning       | 10.36 | 10.62 |
|     streetlight     | 16.86 | 18.47 |
|        booth        | 33.76 | 35.91 |
| television receiver | 25.51 | 28.39 |
|       airplane      | 25.33 | 32.28 |
|      dirt track     |  0.46 |  0.52 |
|       apparel       | 16.29 | 30.74 |
|         pole        | 12.97 | 16.16 |
|         land        |  0.23 |  0.24 |
|      bannister      |  2.06 |  2.58 |
|      escalator      |  1.04 |  1.07 |
|       ottoman       | 20.34 |  22.0 |
|        bottle       | 10.47 | 29.96 |
|        buffet       |  4.02 |  4.05 |
|        poster       | 15.36 | 35.95 |
|        stage        |  3.25 |  3.52 |
|         van         | 26.06 | 31.51 |
|         ship        |  5.74 |  6.4  |
|       fountain      |  0.81 |  0.95 |
|    conveyer belt    |  0.0  |  0.0  |
|        canopy       |  0.72 |  0.78 |
|        washer       |  46.2 | 46.27 |
|      plaything      |  6.32 | 11.77 |
|    swimming pool    | 16.44 | 18.33 |
|        stool        | 16.15 | 22.98 |
|        barrel       |  1.89 |  3.97 |
|        basket       |  17.2 | 23.28 |
|      waterfall      | 29.58 | 35.43 |
|         tent        |  8.54 |  8.68 |
|         bag         |  5.21 | 11.55 |
|       minibike      | 22.41 | 28.08 |
|        cradle       |  31.5 | 36.49 |
|         oven        |  7.59 |  9.23 |
|         ball        | 34.59 | 39.02 |
|         food        | 41.78 | 51.73 |
|         step        |  1.44 |  1.48 |
|         tank        |  7.45 | 11.01 |
|      trade name     |  16.0 | 17.01 |
|      microwave      | 15.96 | 16.22 |
|         pot         |  31.9 | 34.85 |
|        animal       | 37.04 | 39.95 |
|       bicycle       | 29.94 | 63.72 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 30.02 |  30.8 |
|        screen       | 51.46 | 62.93 |
|       blanket       |  5.24 |  5.43 |
|      sculpture      | 15.66 | 23.89 |
|         hood        | 23.97 | 24.36 |
|        sconce       | 15.73 | 16.74 |
|         vase        | 29.71 | 40.38 |
|    traffic light    | 17.85 | 19.89 |
|         tray        |  1.95 |  2.6  |
|        ashcan       | 23.26 | 27.32 |
|         fan         | 29.81 |  31.4 |
|         pier        | 11.51 | 13.32 |
|      crt screen     |  2.07 |  8.65 |
|        plate        | 28.31 | 32.16 |
|       monitor       | 16.52 | 27.12 |
|    bulletin board   | 23.46 | 36.72 |
|        shower       |  0.04 |  0.07 |
|       radiator      |  1.7  |  1.71 |
|        glass        |  9.03 | 10.21 |
|        clock        |  16.3 | 17.83 |
|         flag        | 17.11 | 18.84 |
+---------------------+-------+-------+
09/21 06:55:46 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 66.0800  mIoU: 24.4000  mAcc: 30.9700  data_time: 0.0017  time: 0.5555
Finished processing corruption type: snow
Processing corruption type: frost
09/21 06:55:50 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 603689637
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 603689637
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 06:55:50 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='frost',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/frost'

09/21 06:55:54 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 06:55:54 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 06:55:55 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 06:55:55 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 06:57:22 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:56:49  time: 0.9119  data_time: 0.0015  memory: 17225  
09/21 06:58:07 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:41:42  time: 0.9943  data_time: 0.0015  memory: 17004  
09/21 06:58:31 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:32:07  time: 0.5048  data_time: 0.0015  memory: 16997  
09/21 06:59:07 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:50  time: 0.5763  data_time: 0.0014  memory: 17006  
09/21 06:59:40 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:11  time: 0.5504  data_time: 0.0014  memory: 17005  
09/21 07:00:10 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:24:06  time: 0.1053  data_time: 0.0015  memory: 17000  
09/21 07:00:49 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:23:05  time: 0.5687  data_time: 0.0014  memory: 17005  
09/21 07:01:19 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:35  time: 0.6159  data_time: 0.0014  memory: 17003  
09/21 07:01:28 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:19:07  time: 0.2506  data_time: 0.0014  memory: 16927  
09/21 07:01:41 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:17:18  time: 0.0954  data_time: 0.0014  memory: 16985  
09/21 07:01:56 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:51  time: 0.6591  data_time: 0.0015  memory: 17005  
09/21 07:02:04 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:21  time: 0.2847  data_time: 0.0015  memory: 16932  
09/21 07:02:24 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:27  time: 0.5236  data_time: 0.0013  memory: 17006  
09/21 07:02:46 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:43  time: 0.1036  data_time: 0.0015  memory: 17007  
09/21 07:03:08 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:00  time: 0.9659  data_time: 0.0014  memory: 17010  
09/21 07:03:16 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:01  time: 0.0926  data_time: 0.0015  memory: 16997  
09/21 07:03:21 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:03  time: 0.0950  data_time: 0.0015  memory: 701  
09/21 07:03:30 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:15  time: 0.2132  data_time: 0.0013  memory: 16923  
09/21 07:03:51 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:46  time: 0.3482  data_time: 0.0018  memory: 17004  
09/21 07:04:03 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:07  time: 0.1101  data_time: 0.0014  memory: 16981  
09/21 07:04:20 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:37  time: 0.6278  data_time: 0.0014  memory: 17008  
09/21 07:04:34 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:04  time: 0.0951  data_time: 0.0014  memory: 16995  
09/21 07:04:43 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:30  time: 0.2218  data_time: 0.0014  memory: 16986  
09/21 07:04:48 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:54  time: 0.0918  data_time: 0.0014  memory: 1897  
09/21 07:04:58 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:25  time: 0.2249  data_time: 0.0014  memory: 16997  
09/21 07:05:03 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:54  time: 0.0950  data_time: 0.0019  memory: 1536  
09/21 07:05:12 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:28  time: 0.0886  data_time: 0.0014  memory: 16983  
09/21 07:05:32 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:07  time: 0.5580  data_time: 0.0013  memory: 17001  
09/21 07:05:42 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:42  time: 0.4414  data_time: 0.0013  memory: 16989  
09/21 07:05:46 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:16  time: 0.0873  data_time: 0.0013  memory: 701  
09/21 07:05:53 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:53  time: 0.0951  data_time: 0.0014  memory: 16932  
09/21 07:05:58 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:30  time: 0.0906  data_time: 0.0015  memory: 1580  
09/21 07:06:09 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:10  time: 0.0860  data_time: 0.0013  memory: 17005  
09/21 07:06:21 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:50  time: 0.0940  data_time: 0.0015  memory: 16996  
09/21 07:06:33 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:31  time: 0.2664  data_time: 0.0014  memory: 16985  
09/21 07:06:41 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:11  time: 0.0933  data_time: 0.0015  memory: 16984  
09/21 07:06:45 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:52  time: 0.0932  data_time: 0.0015  memory: 651  
09/21 07:06:56 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:34  time: 0.2292  data_time: 0.0014  memory: 17008  
09/21 07:07:04 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.0881  data_time: 0.0014  memory: 16989  
09/21 07:07:14 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0867  data_time: 0.0013  memory: 16936  
09/21 07:07:14 - mmengine - INFO - per class results:
09/21 07:07:14 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 65.19 |  87.4 |
|       building      | 78.16 | 92.54 |
|         sky         | 75.96 | 78.39 |
|        floor        | 68.56 | 88.75 |
|         tree        | 66.85 | 84.79 |
|       ceiling       | 70.89 |  80.6 |
|         road        | 68.77 | 75.29 |
|         bed         |  82.7 |  91.1 |
|      windowpane     |  53.8 | 66.86 |
|        grass        | 62.67 | 77.58 |
|       cabinet       | 48.64 | 56.45 |
|       sidewalk      | 52.93 | 66.45 |
|        person       |  71.4 | 84.25 |
|        earth        | 28.15 |  52.5 |
|         door        | 32.17 | 41.38 |
|        table        | 49.95 | 67.38 |
|       mountain      | 26.13 | 64.41 |
|        plant        | 44.08 | 57.34 |
|       curtain       | 53.61 | 68.19 |
|        chair        | 50.21 | 61.72 |
|         car         | 80.34 | 87.54 |
|        water        | 42.65 | 57.12 |
|       painting      | 61.84 | 80.07 |
|         sofa        | 59.53 | 76.06 |
|        shelf        | 33.58 | 45.37 |
|        house        | 41.21 | 47.16 |
|         sea         | 29.58 | 49.21 |
|        mirror       | 51.41 | 55.82 |
|         rug         | 42.56 | 46.39 |
|        field        | 24.92 | 38.01 |
|       armchair      | 37.29 | 52.74 |
|         seat        | 41.16 | 49.49 |
|        fence        | 30.31 | 45.57 |
|         desk        |  40.3 | 51.62 |
|         rock        | 31.69 | 45.05 |
|       wardrobe      | 36.54 |  49.9 |
|         lamp        | 57.71 | 68.07 |
|       bathtub       |  38.9 | 44.35 |
|       railing       | 27.39 | 37.83 |
|       cushion       |  47.7 | 58.29 |
|         base        | 21.32 |  25.6 |
|         box         | 15.12 | 20.27 |
|        column       | 40.36 | 49.22 |
|      signboard      | 30.64 | 40.36 |
|   chest of drawers  | 35.48 | 43.25 |
|       counter       | 16.86 | 27.31 |
|         sand        | 26.13 | 35.88 |
|         sink        | 54.49 | 63.34 |
|      skyscraper     | 28.96 | 30.86 |
|      fireplace      | 57.16 | 71.34 |
|     refrigerator    | 59.81 | 66.14 |
|      grandstand     | 34.32 | 67.58 |
|         path        | 13.83 | 18.79 |
|        stairs       | 21.63 | 36.94 |
|        runway       | 37.17 | 38.45 |
|         case        | 46.41 |  74.4 |
|      pool table     | 80.74 | 83.15 |
|        pillow       | 45.27 | 52.68 |
|     screen door     |  32.9 | 76.55 |
|       stairway      | 31.21 | 42.89 |
|        river        |  7.8  | 10.39 |
|        bridge       | 32.15 | 35.12 |
|       bookcase      | 34.04 |  44.1 |
|        blind        | 31.86 | 34.21 |
|     coffee table    | 57.57 | 66.44 |
|        toilet       | 40.94 | 41.93 |
|        flower       | 26.23 | 40.21 |
|         book        | 36.92 | 55.94 |
|         hill        |  5.38 |  8.56 |
|        bench        | 33.45 | 40.95 |
|      countertop     | 41.91 |  67.3 |
|        stove        | 52.62 | 55.44 |
|         palm        |  42.8 | 60.96 |
|    kitchen island   | 34.77 | 58.46 |
|       computer      | 49.04 | 53.26 |
|     swivel chair    | 36.77 | 40.94 |
|         boat        | 32.03 | 33.58 |
|         bar         |  29.6 | 32.58 |
|    arcade machine   | 16.63 | 17.16 |
|        hovel        | 32.05 |  36.9 |
|         bus         | 82.61 | 86.95 |
|        towel        | 33.72 | 50.72 |
|        light        | 34.67 |  38.3 |
|        truck        | 13.15 | 15.54 |
|        tower        | 14.81 | 20.99 |
|      chandelier     | 57.84 | 78.02 |
|        awning       | 15.87 | 16.23 |
|     streetlight     |  19.9 | 21.62 |
|        booth        |  37.5 | 38.99 |
| television receiver | 40.07 | 43.51 |
|       airplane      | 49.55 | 62.82 |
|      dirt track     | 11.13 |  28.1 |
|       apparel       | 23.93 | 31.17 |
|         pole        | 17.61 | 24.15 |
|         land        |  0.38 |  0.42 |
|      bannister      |  3.65 |  4.57 |
|      escalator      | 12.49 | 12.73 |
|       ottoman       | 41.16 | 48.04 |
|        bottle       | 13.52 | 16.55 |
|        buffet       |  38.0 | 42.21 |
|        poster       | 17.31 | 23.02 |
|        stage        |  3.01 |  3.19 |
|         van         | 42.26 |  54.3 |
|         ship        |  5.64 |  5.66 |
|       fountain      |  2.24 |  2.26 |
|    conveyer belt    |  53.8 | 54.83 |
|        canopy       |  5.63 |  6.31 |
|        washer       |  47.5 | 47.52 |
|      plaything      | 15.06 | 17.31 |
|    swimming pool    | 68.32 | 79.76 |
|        stool        | 30.86 | 48.89 |
|        barrel       |  3.77 |  5.69 |
|        basket       | 20.57 | 28.27 |
|      waterfall      | 59.87 |  72.7 |
|         tent        | 18.46 | 19.14 |
|         bag         |  6.06 |  7.36 |
|       minibike      | 47.77 | 57.05 |
|        cradle       | 73.85 | 90.57 |
|         oven        | 14.83 | 21.14 |
|         ball        | 43.86 | 57.89 |
|         food        | 46.61 | 63.69 |
|         step        |  7.97 | 13.62 |
|         tank        | 22.87 | 23.15 |
|      trade name     | 16.42 | 18.13 |
|      microwave      |  25.3 |  26.5 |
|         pot         | 30.39 | 33.38 |
|        animal       | 46.14 | 56.16 |
|       bicycle       | 40.46 | 63.84 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 54.42 | 55.79 |
|        screen       | 44.07 | 48.49 |
|       blanket       |  8.0  |  8.46 |
|      sculpture      | 27.77 | 49.93 |
|         hood        | 56.35 | 63.68 |
|        sconce       | 34.41 |  39.6 |
|         vase        | 34.41 | 48.62 |
|    traffic light    | 20.38 | 22.15 |
|         tray        |  3.96 |  5.64 |
|        ashcan       | 27.36 | 30.37 |
|         fan         | 43.14 | 50.01 |
|         pier        |  10.0 | 11.23 |
|      crt screen     |  2.16 |  3.18 |
|        plate        | 40.79 | 50.11 |
|       monitor       |  21.8 | 25.29 |
|    bulletin board   | 24.21 | 26.74 |
|        shower       |  0.26 |  2.6  |
|       radiator      | 11.37 |  11.7 |
|        glass        |  9.85 | 10.47 |
|        clock        |  16.8 | 18.24 |
|         flag        | 21.94 | 22.75 |
+---------------------+-------+-------+
09/21 07:07:14 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 74.4500  mIoU: 35.3600  mAcc: 44.1100  data_time: 0.0016  time: 0.3392
Finished processing corruption type: frost
Processing corruption type: fog
09/21 07:07:18 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1181899993
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1181899993
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 07:07:18 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='fog',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/fog'

09/21 07:07:22 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 07:07:22 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 07:07:22 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 07:07:23 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 07:08:47 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:54:31  time: 0.9486  data_time: 0.0015  memory: 17225  
09/21 07:09:37 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:42:35  time: 1.1591  data_time: 0.0015  memory: 17004  
09/21 07:10:07 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:33:42  time: 0.6224  data_time: 0.0015  memory: 16997  
09/21 07:10:47 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:30:38  time: 0.6845  data_time: 0.0015  memory: 17006  
09/21 07:11:24 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:28:08  time: 0.5369  data_time: 0.0015  memory: 17005  
09/21 07:11:56 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:25:46  time: 0.2251  data_time: 0.0015  memory: 17000  
09/21 07:12:37 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:24:41  time: 0.5434  data_time: 0.0014  memory: 17005  
09/21 07:13:07 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:22:58  time: 0.6174  data_time: 0.0014  memory: 17003  
09/21 07:13:23 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:20:39  time: 0.3512  data_time: 0.0014  memory: 16927  
09/21 07:13:40 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:18:51  time: 0.2214  data_time: 0.0014  memory: 16985  
09/21 07:13:59 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:17:25  time: 0.6417  data_time: 0.0015  memory: 17005  
09/21 07:14:14 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:15:59  time: 0.4102  data_time: 0.0015  memory: 16932  
09/21 07:14:38 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:15:04  time: 0.6238  data_time: 0.0013  memory: 17006  
09/21 07:15:05 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:14:19  time: 0.2275  data_time: 0.0015  memory: 17007  
09/21 07:15:33 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:13:37  time: 1.1110  data_time: 0.0014  memory: 17010  
09/21 07:15:48 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:12:38  time: 0.2176  data_time: 0.0016  memory: 16997  
09/21 07:15:59 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:11:38  time: 0.2187  data_time: 0.0015  memory: 701  
09/21 07:16:14 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:10:48  time: 0.3354  data_time: 0.0014  memory: 16923  
09/21 07:16:40 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:15  time: 0.4701  data_time: 0.0015  memory: 17004  
09/21 07:16:58 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:09:34  time: 0.2138  data_time: 0.0014  memory: 16981  
09/21 07:17:20 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:00  time: 0.7525  data_time: 0.0014  memory: 17008  
09/21 07:17:39 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:24  time: 0.2172  data_time: 0.0015  memory: 16995  
09/21 07:17:55 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:47  time: 0.3697  data_time: 0.0014  memory: 16986  
09/21 07:18:07 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:09  time: 0.2179  data_time: 0.0014  memory: 1897  
09/21 07:18:24 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:36  time: 0.3512  data_time: 0.0014  memory: 16997  
09/21 07:18:34 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:01  time: 0.2211  data_time: 0.0041  memory: 1536  
09/21 07:18:48 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:30  time: 0.2128  data_time: 0.0014  memory: 16983  
09/21 07:19:14 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:04  time: 0.6207  data_time: 0.0014  memory: 17001  
09/21 07:19:30 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:35  time: 0.5648  data_time: 0.0014  memory: 16989  
09/21 07:19:41 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:05  time: 0.2116  data_time: 0.0014  memory: 701  
09/21 07:19:54 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:38  time: 0.2209  data_time: 0.0014  memory: 16932  
09/21 07:20:05 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:10  time: 0.2160  data_time: 0.0015  memory: 1580  
09/21 07:20:23 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:45  time: 0.2128  data_time: 0.0013  memory: 17005  
09/21 07:20:41 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:20  time: 0.2177  data_time: 0.0015  memory: 16996  
09/21 07:20:57 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:56  time: 0.2221  data_time: 0.0013  memory: 16985  
09/21 07:21:11 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:31  time: 0.2189  data_time: 0.0015  memory: 16984  
09/21 07:21:22 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:08  time: 0.2292  data_time: 0.0015  memory: 651  
09/21 07:21:38 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:45  time: 0.2212  data_time: 0.0014  memory: 17008  
09/21 07:21:53 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:22  time: 0.2142  data_time: 0.0014  memory: 16989  
09/21 07:22:08 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2100  data_time: 0.0013  memory: 16936  
09/21 07:22:08 - mmengine - INFO - per class results:
09/21 07:22:08 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.11 | 88.48 |
|       building      | 79.85 | 92.56 |
|         sky         |  93.7 | 96.86 |
|        floor        | 77.73 |  90.1 |
|         tree        | 69.96 | 87.71 |
|       ceiling       | 81.61 | 90.26 |
|         road        | 80.53 | 86.64 |
|         bed         | 87.43 | 94.95 |
|      windowpane     | 59.07 | 75.98 |
|        grass        | 62.79 | 77.17 |
|       cabinet       | 56.25 | 69.15 |
|       sidewalk      | 62.48 | 78.84 |
|        person       | 76.47 | 88.61 |
|        earth        | 29.97 | 46.64 |
|         door        | 43.13 | 53.65 |
|        table        | 58.63 | 74.45 |
|       mountain      | 51.14 | 68.63 |
|        plant        | 47.92 | 60.39 |
|       curtain       |  67.5 | 81.93 |
|        chair        | 54.48 | 71.38 |
|         car         | 81.63 | 88.36 |
|        water        | 44.92 | 61.04 |
|       painting      | 65.05 | 81.88 |
|         sofa        | 62.25 | 79.18 |
|        shelf        | 37.34 | 55.06 |
|        house        | 44.48 | 50.98 |
|         sea         | 44.58 | 72.06 |
|        mirror       | 60.67 | 67.54 |
|         rug         | 53.24 | 60.31 |
|        field        | 19.08 | 25.88 |
|       armchair      |  39.4 |  53.9 |
|         seat        | 54.43 | 66.33 |
|        fence        | 38.23 | 50.71 |
|         desk        | 47.23 | 58.64 |
|         rock        | 29.01 | 40.76 |
|       wardrobe      | 41.94 | 58.47 |
|         lamp        | 61.07 | 73.74 |
|       bathtub       | 71.52 | 81.72 |
|       railing       | 30.31 | 51.91 |
|       cushion       | 47.87 | 57.97 |
|         base        | 19.44 | 29.17 |
|         box         | 18.92 | 28.07 |
|        column       | 47.29 | 57.72 |
|      signboard      | 32.94 | 46.24 |
|   chest of drawers  | 39.53 | 57.99 |
|       counter       | 24.29 | 35.39 |
|         sand        | 28.75 | 38.61 |
|         sink        | 63.92 | 79.56 |
|      skyscraper     | 31.49 | 36.16 |
|      fireplace      |  66.3 | 80.37 |
|     refrigerator    | 65.62 | 74.33 |
|      grandstand     | 42.01 | 74.19 |
|         path        | 16.93 | 22.99 |
|        stairs       | 27.82 | 39.22 |
|        runway       | 65.35 | 94.24 |
|         case        |  50.9 | 79.91 |
|      pool table     | 90.58 | 94.11 |
|        pillow       | 54.39 | 71.61 |
|     screen door     | 60.49 | 72.58 |
|       stairway      | 27.82 | 37.31 |
|        river        |  7.56 | 11.76 |
|        bridge       | 25.58 |  28.0 |
|       bookcase      | 36.41 | 47.04 |
|        blind        | 45.97 | 53.67 |
|     coffee table    | 63.27 | 73.33 |
|        toilet       | 77.52 | 90.07 |
|        flower       | 31.24 | 40.52 |
|         book        | 37.83 |  59.6 |
|         hill        |  5.58 |  6.95 |
|        bench        | 39.62 | 45.68 |
|      countertop     | 55.17 | 73.04 |
|        stove        | 66.45 | 69.54 |
|         palm        | 46.83 | 59.52 |
|    kitchen island   | 38.61 | 71.82 |
|       computer      | 54.97 | 65.67 |
|     swivel chair    | 41.05 | 49.03 |
|         boat        | 37.24 | 39.98 |
|         bar         | 24.07 | 27.07 |
|    arcade machine   | 37.58 | 39.77 |
|        hovel        |  6.17 |  6.43 |
|         bus         | 82.02 | 85.91 |
|        towel        | 50.28 | 67.31 |
|        light        | 51.15 | 57.08 |
|        truck        | 13.23 | 16.64 |
|        tower        | 27.42 | 37.53 |
|      chandelier     | 64.61 | 81.06 |
|        awning       | 13.91 | 14.69 |
|     streetlight     | 21.97 | 28.21 |
|        booth        | 39.82 | 40.23 |
| television receiver | 62.48 | 69.33 |
|       airplane      |  51.9 |  68.4 |
|      dirt track     | 11.47 | 19.45 |
|       apparel       | 22.15 | 32.47 |
|         pole        |  21.5 | 29.89 |
|         land        | 10.13 | 14.64 |
|      bannister      |  9.98 | 14.44 |
|      escalator      | 11.28 | 11.43 |
|       ottoman       | 43.78 | 58.48 |
|        bottle       | 13.89 | 21.29 |
|        buffet       | 56.38 | 71.67 |
|        poster       | 23.34 | 34.61 |
|        stage        |  4.19 |  5.0  |
|         van         | 43.05 |  61.8 |
|         ship        |  4.04 |  5.2  |
|       fountain      |  1.22 |  1.23 |
|    conveyer belt    |  74.6 |  77.0 |
|        canopy       | 14.45 | 15.28 |
|        washer       | 65.13 | 66.04 |
|      plaything      | 13.73 | 19.48 |
|    swimming pool    | 30.71 | 44.93 |
|        stool        | 36.67 | 51.03 |
|        barrel       | 39.33 | 41.32 |
|        basket       | 25.02 | 30.05 |
|      waterfall      | 49.19 | 60.84 |
|         tent        | 79.54 | 99.17 |
|         bag         |  7.71 |  8.84 |
|       minibike      | 56.54 | 63.08 |
|        cradle       |  80.0 | 97.27 |
|         oven        | 37.67 | 41.87 |
|         ball        | 37.69 | 56.57 |
|         food        | 31.59 | 34.36 |
|         step        | 21.19 | 26.84 |
|         tank        | 35.51 | 36.11 |
|      trade name     | 17.91 | 20.07 |
|      microwave      | 33.85 |  37.0 |
|         pot         | 36.58 | 41.98 |
|        animal       | 45.12 | 47.38 |
|       bicycle       |  42.9 | 67.33 |
|         lake        | 61.56 | 63.35 |
|      dishwasher     | 67.43 | 73.61 |
|        screen       | 68.19 | 85.51 |
|       blanket       | 12.15 | 14.83 |
|      sculpture      |  32.8 | 47.66 |
|         hood        | 50.76 |  63.4 |
|        sconce       | 35.89 | 45.79 |
|         vase        | 36.96 | 52.35 |
|    traffic light    | 25.21 | 32.94 |
|         tray        |  4.74 |  6.6  |
|        ashcan       |  33.6 | 41.45 |
|         fan         | 52.05 | 62.59 |
|         pier        | 19.63 | 22.52 |
|      crt screen     |  2.52 |  9.32 |
|        plate        | 33.17 | 42.24 |
|       monitor       |  5.57 |  6.75 |
|    bulletin board   | 34.77 | 51.13 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 37.86 | 46.04 |
|        glass        | 12.24 |  14.4 |
|        clock        | 20.31 | 22.84 |
|         flag        | 25.07 | 25.77 |
+---------------------+-------+-------+
09/21 07:22:08 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.3300  mIoU: 41.8800  mAcc: 51.8800  data_time: 0.0016  time: 0.4427
Finished processing corruption type: fog
Processing corruption type: brightness
09/21 07:22:12 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 213293511
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 213293511
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 07:22:12 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='brightness',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/brightness'

09/21 07:22:16 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 07:22:16 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 07:22:16 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 07:22:16 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 07:23:41 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:55:18  time: 0.9667  data_time: 0.0015  memory: 17225  
09/21 07:24:33 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:43:07  time: 1.1770  data_time: 0.0016  memory: 17004  
09/21 07:25:03 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:34:09  time: 0.6369  data_time: 0.0016  memory: 16997  
09/21 07:25:43 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:31:02  time: 0.6936  data_time: 0.0015  memory: 17006  
09/21 07:26:20 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:28:27  time: 0.5392  data_time: 0.0015  memory: 17005  
09/21 07:26:52 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:26:03  time: 0.2362  data_time: 0.0016  memory: 17000  
09/21 07:27:31 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:24:43  time: 0.5405  data_time: 0.0014  memory: 17005  
09/21 07:28:03 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:23:06  time: 0.6277  data_time: 0.0014  memory: 17003  
09/21 07:28:18 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:20:45  time: 0.3424  data_time: 0.0014  memory: 16927  
09/21 07:28:35 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:18:57  time: 0.2213  data_time: 0.0014  memory: 16985  
09/21 07:28:55 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:17:31  time: 0.6522  data_time: 0.0015  memory: 17005  
09/21 07:29:10 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:16:05  time: 0.4225  data_time: 0.0016  memory: 16932  
09/21 07:29:35 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:15:10  time: 0.6303  data_time: 0.0014  memory: 17006  
09/21 07:30:03 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:14:25  time: 0.2415  data_time: 0.0016  memory: 17007  
09/21 07:30:31 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:13:44  time: 1.1118  data_time: 0.0015  memory: 17010  
09/21 07:30:46 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:12:43  time: 0.2278  data_time: 0.0016  memory: 16997  
09/21 07:30:57 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:11:44  time: 0.2298  data_time: 0.0016  memory: 701  
09/21 07:31:11 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:10:53  time: 0.3252  data_time: 0.0014  memory: 16923  
09/21 07:31:38 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:20  time: 0.4726  data_time: 0.0015  memory: 17004  
09/21 07:31:55 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:09:38  time: 0.2131  data_time: 0.0014  memory: 16981  
09/21 07:32:18 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:04  time: 0.7642  data_time: 0.0015  memory: 17008  
09/21 07:32:38 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:28  time: 0.2182  data_time: 0.0015  memory: 16995  
09/21 07:32:53 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:50  time: 0.3530  data_time: 0.0015  memory: 16986  
09/21 07:33:04 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:11  time: 0.2209  data_time: 0.0014  memory: 1897  
09/21 07:33:21 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:38  time: 0.3464  data_time: 0.0014  memory: 16997  
09/21 07:33:31 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:03  time: 0.2325  data_time: 0.0015  memory: 1536  
09/21 07:33:50 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:34  time: 0.3741  data_time: 0.0015  memory: 16983  
09/21 07:34:26 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:12  time: 0.9206  data_time: 0.0014  memory: 17001  
09/21 07:34:50 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:45  time: 0.8848  data_time: 0.0014  memory: 16989  
09/21 07:35:04 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:15  time: 0.2107  data_time: 0.0036  memory: 701  
09/21 07:35:20 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:47  time: 0.2431  data_time: 0.0014  memory: 16932  
09/21 07:35:35 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:19  time: 0.2529  data_time: 0.0015  memory: 1580  
09/21 07:35:57 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:54  time: 0.2041  data_time: 0.0013  memory: 17005  
09/21 07:36:17 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:28  time: 0.3701  data_time: 0.0016  memory: 16996  
09/21 07:36:34 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:02  time: 0.2288  data_time: 0.0014  memory: 16985  
09/21 07:36:49 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:36  time: 0.2306  data_time: 0.0016  memory: 16984  
09/21 07:37:02 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:11  time: 0.2858  data_time: 0.0016  memory: 651  
09/21 07:37:17 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:47  time: 0.2215  data_time: 0.0014  memory: 17008  
09/21 07:37:33 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:23  time: 0.2152  data_time: 0.0014  memory: 16989  
09/21 07:37:49 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2030  data_time: 0.0013  memory: 16936  
09/21 07:37:49 - mmengine - INFO - per class results:
09/21 07:37:49 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.23 | 88.48 |
|       building      | 80.35 | 92.61 |
|         sky         | 93.88 | 97.24 |
|        floor        | 78.48 |  91.0 |
|         tree        | 72.33 |  86.3 |
|       ceiling       | 82.39 | 90.37 |
|         road        | 81.25 | 88.67 |
|         bed         | 87.65 | 94.96 |
|      windowpane     | 60.05 |  76.1 |
|        grass        | 66.18 |  81.1 |
|       cabinet       | 59.11 | 72.09 |
|       sidewalk      | 64.49 | 78.78 |
|        person       | 77.63 | 89.68 |
|        earth        | 31.71 | 45.84 |
|         door        | 46.55 | 61.44 |
|        table        | 60.12 | 75.16 |
|       mountain      | 52.56 | 70.27 |
|        plant        |  49.5 | 64.47 |
|       curtain       | 68.19 | 80.85 |
|        chair        | 56.34 | 69.74 |
|         car         | 82.48 | 89.67 |
|        water        | 47.29 | 62.93 |
|       painting      |  67.5 |  83.1 |
|         sofa        |  64.1 | 81.48 |
|        shelf        | 40.27 | 55.63 |
|        house        | 43.64 | 51.28 |
|         sea         | 44.39 | 72.32 |
|        mirror       | 62.87 | 71.47 |
|         rug         | 55.08 | 61.43 |
|        field        | 28.68 | 44.63 |
|       armchair      | 41.53 | 56.42 |
|         seat        | 54.42 | 75.76 |
|        fence        | 41.14 | 58.16 |
|         desk        | 49.43 | 64.16 |
|         rock        |  27.5 | 38.17 |
|       wardrobe      | 47.25 |  66.5 |
|         lamp        | 61.64 | 73.38 |
|       bathtub       | 74.12 | 80.35 |
|       railing       | 31.73 | 45.83 |
|       cushion       | 52.55 | 66.42 |
|         base        | 26.12 | 34.13 |
|         box         | 24.12 |  33.3 |
|        column       | 44.77 | 54.29 |
|      signboard      | 34.11 | 47.03 |
|   chest of drawers  | 39.98 | 60.77 |
|       counter       | 26.75 | 39.84 |
|         sand        | 34.06 |  47.4 |
|         sink        | 68.27 | 80.06 |
|      skyscraper     | 45.65 | 51.39 |
|      fireplace      | 65.87 | 82.79 |
|     refrigerator    | 74.42 | 81.83 |
|      grandstand     | 39.76 | 68.81 |
|         path        | 15.89 | 21.79 |
|        stairs       | 30.84 | 37.33 |
|        runway       | 62.73 |  83.0 |
|         case        | 55.44 |  72.4 |
|      pool table     | 92.31 | 95.27 |
|        pillow       | 54.18 | 64.89 |
|     screen door     |  64.2 | 76.61 |
|       stairway      | 25.86 | 34.75 |
|        river        |  8.07 | 13.17 |
|        bridge       | 31.69 | 34.89 |
|       bookcase      | 41.19 | 54.45 |
|        blind        | 46.44 |  54.0 |
|     coffee table    | 65.15 | 78.31 |
|        toilet       | 84.57 | 89.18 |
|        flower       | 28.93 | 46.01 |
|         book        | 42.77 | 66.67 |
|         hill        |  7.51 |  9.13 |
|        bench        | 43.19 | 51.83 |
|      countertop     | 51.99 | 67.81 |
|        stove        | 72.02 | 76.67 |
|         palm        | 50.43 | 69.42 |
|    kitchen island   |  44.2 |  77.2 |
|       computer      | 55.56 | 64.37 |
|     swivel chair    |  44.4 | 62.03 |
|         boat        | 35.41 | 37.75 |
|         bar         | 21.21 | 23.75 |
|    arcade machine   | 24.33 | 28.43 |
|        hovel        | 30.88 | 35.95 |
|         bus         | 85.72 | 91.33 |
|        towel        | 55.42 |  65.5 |
|        light        | 53.35 |  61.2 |
|        truck        | 25.11 | 31.46 |
|        tower        | 25.74 | 35.38 |
|      chandelier     | 64.28 |  81.6 |
|        awning       | 21.19 | 23.33 |
|     streetlight     | 23.84 | 29.82 |
|        booth        |  53.2 |  55.5 |
| television receiver | 67.34 | 78.59 |
|       airplane      | 49.83 | 67.03 |
|      dirt track     |  9.45 | 31.74 |
|       apparel       | 30.26 | 45.14 |
|         pole        | 23.69 | 34.36 |
|         land        |  9.05 | 12.34 |
|      bannister      |  4.51 |  6.06 |
|      escalator      | 22.99 | 24.39 |
|       ottoman       | 42.65 | 55.77 |
|        bottle       | 16.02 | 24.07 |
|        buffet       | 54.24 | 65.26 |
|        poster       | 26.48 | 35.47 |
|        stage        | 18.16 | 24.11 |
|         van         | 46.48 | 57.88 |
|         ship        | 13.95 | 18.96 |
|       fountain      |  4.5  |  4.52 |
|    conveyer belt    | 70.27 | 82.92 |
|        canopy       | 16.52 | 18.67 |
|        washer       | 64.23 | 65.08 |
|      plaything      | 20.01 | 33.13 |
|    swimming pool    | 46.43 | 65.58 |
|        stool        | 40.56 | 54.28 |
|        barrel       | 48.45 |  64.5 |
|        basket       | 28.15 |  37.6 |
|      waterfall      |  65.7 | 81.25 |
|         tent        | 95.08 | 98.12 |
|         bag         |  10.6 | 12.32 |
|       minibike      | 58.87 | 67.54 |
|        cradle       |  78.0 | 97.37 |
|         oven        | 27.26 | 56.61 |
|         ball        | 45.88 | 62.42 |
|         food        | 54.44 | 68.35 |
|         step        |  13.9 |  16.5 |
|         tank        | 43.03 | 43.93 |
|      trade name     | 24.63 | 29.32 |
|      microwave      | 35.84 | 38.24 |
|         pot         | 39.91 |  47.8 |
|        animal       | 51.15 | 53.54 |
|       bicycle       | 44.89 | 68.36 |
|         lake        | 60.38 |  63.4 |
|      dishwasher     | 75.49 | 79.12 |
|        screen       | 69.88 |  85.8 |
|       blanket       |  7.46 |  8.6  |
|      sculpture      | 33.34 | 51.49 |
|         hood        | 60.06 |  70.5 |
|        sconce       | 39.37 | 48.35 |
|         vase        | 36.35 | 50.71 |
|    traffic light    | 28.16 | 36.91 |
|         tray        |  5.99 |  9.79 |
|        ashcan       | 35.33 | 44.77 |
|         fan         | 55.61 | 67.21 |
|         pier        |  11.6 | 13.27 |
|      crt screen     |  4.0  | 10.32 |
|        plate        | 39.94 | 53.15 |
|       monitor       | 15.35 |  19.7 |
|    bulletin board   | 46.47 |  55.4 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 40.73 | 46.22 |
|        glass        | 11.11 | 11.98 |
|        clock        | 24.76 | 28.08 |
|         flag        |  29.1 | 31.04 |
+---------------------+-------+-------+
09/21 07:37:49 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.3700  mIoU: 44.7900  mAcc: 55.4200  data_time: 0.0016  time: 0.4660
Finished processing corruption type: brightness
Processing corruption type: contrast
09/21 07:37:52 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1841332268
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1841332268
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 07:37:52 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='contrast',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/contrast'

09/21 07:37:56 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 07:37:56 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 07:37:56 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 07:37:57 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 07:39:33 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:02:42  time: 0.7611  data_time: 0.0015  memory: 17225  
09/21 07:40:24 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:46:38  time: 1.2381  data_time: 0.0016  memory: 17004  
09/21 07:40:48 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:35:07  time: 0.6205  data_time: 0.0015  memory: 16997  
09/21 07:41:21 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:30:37  time: 0.5862  data_time: 0.0014  memory: 17006  
09/21 07:41:52 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:27:27  time: 0.3684  data_time: 0.0014  memory: 17005  
09/21 07:42:17 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:24:32  time: 0.1012  data_time: 0.0015  memory: 17000  
09/21 07:42:47 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:49  time: 0.3784  data_time: 0.0014  memory: 17005  
09/21 07:43:10 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:52  time: 0.4549  data_time: 0.0013  memory: 17003  
09/21 07:43:19 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:29  time: 0.2255  data_time: 0.0014  memory: 16927  
09/21 07:43:29 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:36  time: 0.0933  data_time: 0.0014  memory: 16985  
09/21 07:43:41 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:08  time: 0.4676  data_time: 0.0015  memory: 17005  
09/21 07:43:50 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:43  time: 0.2859  data_time: 0.0015  memory: 16932  
09/21 07:44:07 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:48  time: 0.4662  data_time: 0.0013  memory: 17006  
09/21 07:44:26 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:03  time: 0.1013  data_time: 0.0015  memory: 17007  
09/21 07:44:47 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:24  time: 0.9347  data_time: 0.0014  memory: 17010  
09/21 07:44:55 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:27  time: 0.0923  data_time: 0.0015  memory: 16997  
09/21 07:45:00 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:32  time: 0.0936  data_time: 0.0016  memory: 701  
09/21 07:45:09 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:47  time: 0.2117  data_time: 0.0014  memory: 16923  
09/21 07:45:27 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:17  time: 0.3466  data_time: 0.0014  memory: 17004  
09/21 07:45:38 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:41  time: 0.0868  data_time: 0.0014  memory: 16981  
09/21 07:45:54 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:11  time: 0.5909  data_time: 0.0014  memory: 17008  
09/21 07:46:06 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:40  time: 0.0910  data_time: 0.0014  memory: 16995  
09/21 07:46:15 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:08  time: 0.2206  data_time: 0.0014  memory: 16986  
09/21 07:46:19 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:35  time: 0.0904  data_time: 0.0014  memory: 1897  
09/21 07:46:29 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:07  time: 0.2234  data_time: 0.0014  memory: 16997  
09/21 07:46:33 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:38  time: 0.0915  data_time: 0.0014  memory: 1536  
09/21 07:46:41 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:12  time: 0.0863  data_time: 0.0014  memory: 16983  
09/21 07:46:58 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:52  time: 0.4572  data_time: 0.0014  memory: 17001  
09/21 07:47:07 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:28  time: 0.3871  data_time: 0.0014  memory: 16989  
09/21 07:47:12 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:04  time: 0.0846  data_time: 0.0014  memory: 701  
09/21 07:47:18 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:43  time: 0.0945  data_time: 0.0014  memory: 16932  
09/21 07:47:23 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:21  time: 0.0911  data_time: 0.0015  memory: 1580  
09/21 07:47:34 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:02  time: 0.0830  data_time: 0.0015  memory: 17005  
09/21 07:47:45 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:43  time: 0.0916  data_time: 0.0015  memory: 16996  
09/21 07:47:55 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:25  time: 0.0956  data_time: 0.0013  memory: 16985  
09/21 07:48:02 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:07  time: 0.0926  data_time: 0.0015  memory: 16984  
09/21 07:48:06 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:49  time: 0.0924  data_time: 0.0015  memory: 651  
09/21 07:48:15 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:32  time: 0.0954  data_time: 0.0014  memory: 17008  
09/21 07:48:23 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.0878  data_time: 0.0014  memory: 16989  
09/21 07:48:32 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0845  data_time: 0.0013  memory: 16936  
09/21 07:48:32 - mmengine - INFO - per class results:
09/21 07:48:32 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 73.43 | 88.74 |
|       building      | 80.32 | 92.46 |
|         sky         | 93.65 | 96.84 |
|        floor        |  77.2 | 90.16 |
|         tree        | 70.37 | 87.48 |
|       ceiling       | 81.53 | 90.29 |
|         road        | 79.97 | 85.68 |
|         bed         | 86.99 | 95.15 |
|      windowpane     | 58.63 | 74.07 |
|        grass        | 60.61 | 75.18 |
|       cabinet       | 56.74 | 69.63 |
|       sidewalk      | 62.62 | 78.07 |
|        person       | 76.06 | 87.17 |
|        earth        | 29.74 | 48.02 |
|         door        | 42.89 | 54.03 |
|        table        | 58.45 | 73.94 |
|       mountain      | 50.11 | 67.82 |
|        plant        | 48.23 | 58.67 |
|       curtain       | 67.61 | 81.57 |
|        chair        | 54.48 | 71.55 |
|         car         | 81.52 | 88.06 |
|        water        |  44.0 | 60.37 |
|       painting      | 65.11 | 81.31 |
|         sofa        | 62.26 | 78.74 |
|        shelf        |  38.0 | 55.52 |
|        house        | 45.33 | 52.87 |
|         sea         | 45.08 | 74.83 |
|        mirror       | 58.26 | 65.71 |
|         rug         |  52.5 | 58.97 |
|        field        |  22.0 |  33.3 |
|       armchair      | 41.25 | 55.91 |
|         seat        | 52.53 | 66.45 |
|        fence        | 38.51 | 50.52 |
|         desk        | 45.73 | 55.69 |
|         rock        | 23.77 | 32.27 |
|       wardrobe      | 40.49 | 56.16 |
|         lamp        | 61.05 | 72.74 |
|       bathtub       | 72.52 | 87.43 |
|       railing       | 30.92 | 49.75 |
|       cushion       | 46.58 | 56.03 |
|         base        | 21.91 | 30.85 |
|         box         | 16.96 | 25.31 |
|        column       | 44.81 | 56.54 |
|      signboard      | 33.92 | 45.99 |
|   chest of drawers  | 38.97 | 58.49 |
|       counter       | 24.82 |  38.1 |
|         sand        | 22.26 | 30.69 |
|         sink        | 63.09 | 77.97 |
|      skyscraper     | 42.59 | 50.37 |
|      fireplace      | 63.83 | 78.03 |
|     refrigerator    | 65.89 | 77.77 |
|      grandstand     | 35.31 | 62.41 |
|         path        | 16.39 | 23.13 |
|        stairs       | 26.82 | 38.22 |
|        runway       | 64.84 | 93.54 |
|         case        | 43.37 | 81.63 |
|      pool table     | 91.33 | 94.81 |
|        pillow       | 53.68 | 69.58 |
|     screen door     | 60.38 | 73.33 |
|       stairway      | 28.53 | 35.64 |
|        river        |  7.14 | 11.03 |
|        bridge       | 29.03 | 31.71 |
|       bookcase      | 36.96 | 46.52 |
|        blind        | 45.05 | 52.87 |
|     coffee table    | 59.96 | 70.63 |
|        toilet       | 78.57 | 89.95 |
|        flower       | 28.74 | 38.71 |
|         book        | 36.42 | 54.73 |
|         hill        |  5.23 |  6.35 |
|        bench        | 40.16 | 49.06 |
|      countertop     | 52.53 | 71.11 |
|        stove        | 64.61 | 67.29 |
|         palm        | 42.54 | 51.69 |
|    kitchen island   | 37.61 | 69.69 |
|       computer      |  54.8 | 64.87 |
|     swivel chair    | 38.08 | 45.64 |
|         boat        | 32.95 |  35.9 |
|         bar         | 16.92 | 18.41 |
|    arcade machine   | 17.49 | 17.86 |
|        hovel        |  9.27 |  9.8  |
|         bus         |  82.3 | 87.26 |
|        towel        | 46.49 | 62.02 |
|        light        | 44.77 | 48.63 |
|        truck        | 14.73 | 17.85 |
|        tower        | 28.99 | 39.79 |
|      chandelier     | 67.02 | 83.33 |
|        awning       | 16.03 | 16.58 |
|     streetlight     | 22.09 | 28.09 |
|        booth        | 43.82 | 44.76 |
| television receiver | 56.57 | 59.92 |
|       airplane      | 52.91 | 65.83 |
|      dirt track     |  5.79 | 18.51 |
|       apparel       | 24.76 | 34.43 |
|         pole        | 19.41 | 27.06 |
|         land        | 13.62 | 18.99 |
|      bannister      |  4.29 |  5.93 |
|      escalator      |  9.44 |  9.62 |
|       ottoman       | 42.98 | 56.87 |
|        bottle       | 12.54 | 19.31 |
|        buffet       | 54.08 | 70.24 |
|        poster       | 23.56 | 32.42 |
|        stage        |  8.76 | 10.05 |
|         van         | 43.55 | 61.99 |
|         ship        |  4.55 |  6.35 |
|       fountain      |  0.61 |  0.61 |
|    conveyer belt    | 63.36 | 66.24 |
|        canopy       | 12.95 | 14.11 |
|        washer       | 65.22 | 66.19 |
|      plaything      | 13.42 | 19.32 |
|    swimming pool    | 32.23 | 40.01 |
|        stool        | 34.11 | 44.97 |
|        barrel       | 37.71 | 42.43 |
|        basket       | 24.77 | 30.78 |
|      waterfall      | 40.87 | 48.88 |
|         tent        | 76.11 | 99.19 |
|         bag         |  6.34 |  7.18 |
|       minibike      | 56.27 | 62.21 |
|        cradle       | 73.95 | 92.95 |
|         oven        | 24.96 | 30.33 |
|         ball        | 37.35 | 55.88 |
|         food        | 31.78 |  35.3 |
|         step        | 17.19 | 21.24 |
|         tank        | 33.42 | 34.18 |
|      trade name     | 19.34 | 21.49 |
|      microwave      | 33.86 | 36.78 |
|         pot         | 35.13 | 39.26 |
|        animal       | 47.86 | 49.56 |
|       bicycle       | 42.54 | 65.81 |
|         lake        | 61.93 | 63.36 |
|      dishwasher     | 66.53 | 69.11 |
|        screen       | 72.63 | 85.29 |
|       blanket       | 11.43 | 13.72 |
|      sculpture      | 36.38 | 46.96 |
|         hood        | 55.12 | 64.31 |
|        sconce       | 37.65 | 45.69 |
|         vase        | 34.34 | 50.26 |
|    traffic light    | 24.35 | 32.31 |
|         tray        |  4.13 |  6.38 |
|        ashcan       | 31.77 | 37.97 |
|         fan         | 52.94 | 63.46 |
|         pier        | 16.13 | 18.33 |
|      crt screen     |  2.99 | 10.81 |
|        plate        |  30.9 | 37.86 |
|       monitor       |  3.92 |  4.39 |
|    bulletin board   | 34.93 | 49.18 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 37.33 | 44.67 |
|        glass        | 11.78 | 13.85 |
|        clock        | 18.49 | 20.26 |
|         flag        |  24.5 | 25.12 |
+---------------------+-------+-------+
09/21 07:48:32 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.0800  mIoU: 40.9700  mAcc: 50.6600  data_time: 0.0016  time: 0.3177
Finished processing corruption type: contrast
Processing corruption type: elastic_transform
09/21 07:48:35 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1049241985
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1049241985
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 07:48:36 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/elastic_transform'

09/21 07:48:40 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 07:48:40 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 07:48:40 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 07:48:40 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 07:50:43 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:19:48  time: 1.7782  data_time: 0.0016  memory: 17225  
09/21 07:52:12 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:06:53  time: 1.9586  data_time: 0.0016  memory: 17004  
09/21 07:53:19 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:57:17  time: 1.4068  data_time: 0.0016  memory: 16997  
09/21 07:54:39 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:53:46  time: 1.4886  data_time: 0.0016  memory: 17006  
09/21 07:55:52 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:50:22  time: 1.2790  data_time: 0.0015  memory: 17005  
09/21 07:57:00 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:47:09  time: 0.9907  data_time: 0.0016  memory: 17000  
09/21 07:58:16 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:45:11  time: 1.2482  data_time: 0.0015  memory: 17005  
09/21 07:59:23 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:42:51  time: 1.3911  data_time: 0.0014  memory: 17003  
09/21 08:00:11 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:39:40  time: 1.0191  data_time: 0.0014  memory: 16927  
09/21 08:01:06 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:37:15  time: 0.9408  data_time: 0.0015  memory: 16985  
09/21 08:02:05 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:35:19  time: 1.4197  data_time: 0.0017  memory: 17005  
09/21 08:02:55 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:33:14  time: 1.1743  data_time: 0.0016  memory: 16932  
09/21 08:03:56 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:31:41  time: 1.3644  data_time: 0.0014  memory: 17006  
09/21 08:05:02 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:30:22  time: 1.0060  data_time: 0.0016  memory: 17007  
09/21 08:06:08 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:29:05  time: 1.8335  data_time: 0.0015  memory: 17010  
09/21 08:06:57 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:27:25  time: 0.9753  data_time: 0.0016  memory: 16997  
09/21 08:07:46 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:25:50  time: 0.9852  data_time: 0.0016  memory: 701  
09/21 08:08:34 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:24:19  time: 0.9782  data_time: 0.0014  memory: 16923  
09/21 08:09:38 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:23:09  time: 1.1925  data_time: 0.0016  memory: 17004  
09/21 08:10:31 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:21:50  time: 0.9248  data_time: 0.0015  memory: 16981  
09/21 08:11:32 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:20:41  time: 1.5350  data_time: 0.0015  memory: 17008  
09/21 08:12:29 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:19:28  time: 0.9507  data_time: 0.0015  memory: 16995  
09/21 08:13:21 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:18:13  time: 1.0919  data_time: 0.0015  memory: 16986  
09/21 08:14:10 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:16:59  time: 0.9397  data_time: 0.0015  memory: 1897  
09/21 08:15:01 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:15:48  time: 1.0566  data_time: 0.0014  memory: 16997  
09/21 08:15:46 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:14:35  time: 0.9596  data_time: 0.0015  memory: 1536  
09/21 08:16:36 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:13:26  time: 0.8937  data_time: 0.0015  memory: 16983  
09/21 08:17:39 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:12:25  time: 1.4112  data_time: 0.0014  memory: 17001  
09/21 08:18:30 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:11:18  time: 1.3376  data_time: 0.0015  memory: 16989  
09/21 08:19:16 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:10:11  time: 0.8829  data_time: 0.0014  memory: 701  
09/21 08:20:08 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:09:07  time: 0.9743  data_time: 0.0015  memory: 16932  
09/21 08:20:54 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:08:03  time: 0.9365  data_time: 0.0016  memory: 1580  
09/21 08:21:47 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:01  time: 0.8732  data_time: 0.0014  memory: 17005  
09/21 08:22:42 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:00  time: 0.9560  data_time: 0.0016  memory: 16996  
09/21 08:23:36 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:59  time: 0.9493  data_time: 0.0014  memory: 16985  
09/21 08:24:25 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:58  time: 0.9740  data_time: 0.0016  memory: 16984  
09/21 08:25:13 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:57  time: 0.9636  data_time: 0.0016  memory: 651  
09/21 08:26:02 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:57  time: 0.9299  data_time: 0.0015  memory: 17008  
09/21 08:26:54 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:58  time: 0.9237  data_time: 0.0014  memory: 16989  
09/21 08:27:44 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.8723  data_time: 0.0014  memory: 16936  
09/21 08:27:44 - mmengine - INFO - per class results:
09/21 08:27:44 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 62.24 | 78.65 |
|       building      | 72.75 | 88.52 |
|         sky         | 83.95 | 91.11 |
|        floor        |  67.7 | 82.85 |
|         tree        | 61.41 | 78.91 |
|       ceiling       | 68.75 | 82.04 |
|         road        | 73.53 | 84.23 |
|         bed         | 76.56 | 88.53 |
|      windowpane     | 46.69 | 65.19 |
|        grass        | 59.29 | 75.43 |
|       cabinet       |  48.6 | 62.76 |
|       sidewalk      |  52.2 |  67.7 |
|        person       | 59.49 | 75.77 |
|        earth        | 29.45 | 43.33 |
|         door        | 37.95 | 49.97 |
|        table        | 45.36 | 63.77 |
|       mountain      |  46.3 | 62.78 |
|        plant        | 39.96 | 54.61 |
|       curtain       | 50.14 | 69.02 |
|        chair        | 40.54 | 56.72 |
|         car         | 61.45 | 75.22 |
|        water        | 45.13 | 58.98 |
|       painting      | 46.14 | 64.13 |
|         sofa        | 53.31 | 71.84 |
|        shelf        | 33.98 |  51.5 |
|        house        | 36.84 | 44.64 |
|         sea         |  42.7 | 70.23 |
|        mirror       | 53.28 | 65.18 |
|         rug         | 43.96 | 54.18 |
|        field        | 26.21 | 42.07 |
|       armchair      | 37.47 | 52.29 |
|         seat        | 48.59 | 72.42 |
|        fence        | 28.61 | 43.12 |
|         desk        | 40.51 | 57.22 |
|         rock        | 25.82 |  39.5 |
|       wardrobe      | 41.59 | 57.81 |
|         lamp        | 31.51 | 47.81 |
|       bathtub       | 61.57 |  72.1 |
|       railing       | 23.33 |  35.3 |
|       cushion       | 34.67 | 48.06 |
|         base        | 25.48 | 33.87 |
|         box         | 17.72 | 25.52 |
|        column       |  28.6 |  37.8 |
|      signboard      | 21.56 | 32.29 |
|   chest of drawers  | 34.14 | 50.29 |
|       counter       | 26.55 |  35.6 |
|         sand        | 27.52 | 43.63 |
|         sink        | 48.14 | 63.88 |
|      skyscraper     | 38.36 | 48.92 |
|      fireplace      | 58.86 | 76.12 |
|     refrigerator    | 60.84 | 71.66 |
|      grandstand     | 28.97 | 55.86 |
|         path        | 12.71 | 18.59 |
|        stairs       | 27.18 | 33.08 |
|        runway       | 60.81 |  81.2 |
|         case        | 49.56 | 70.85 |
|      pool table     | 75.84 | 84.98 |
|        pillow       | 42.18 | 54.99 |
|     screen door     | 55.17 | 73.32 |
|       stairway      | 24.86 |  31.5 |
|        river        |  8.88 | 14.24 |
|        bridge       | 44.05 |  53.3 |
|       bookcase      | 28.51 | 42.73 |
|        blind        | 37.47 | 43.91 |
|     coffee table    | 48.19 | 65.86 |
|        toilet       | 57.57 |  69.5 |
|        flower       | 21.29 | 34.82 |
|         book        | 29.01 | 48.01 |
|         hill        |  4.82 |  7.39 |
|        bench        | 36.64 | 46.49 |
|      countertop     | 37.25 | 53.76 |
|        stove        | 61.06 | 71.49 |
|         palm        | 34.21 | 50.79 |
|    kitchen island   | 33.95 | 58.09 |
|       computer      | 45.46 | 56.58 |
|     swivel chair    | 31.74 | 49.68 |
|         boat        | 32.13 | 36.68 |
|         bar         | 23.39 | 27.23 |
|    arcade machine   | 37.86 | 47.33 |
|        hovel        | 16.82 | 18.46 |
|         bus         | 70.56 | 80.61 |
|        towel        | 39.54 | 53.06 |
|        light        | 16.69 | 24.98 |
|        truck        | 14.54 | 21.54 |
|        tower        | 18.63 | 26.26 |
|      chandelier     | 39.71 | 60.05 |
|        awning       | 16.89 | 19.72 |
|     streetlight     |  5.93 |  8.96 |
|        booth        | 42.82 | 44.81 |
| television receiver | 43.61 | 58.34 |
|       airplane      | 35.23 | 55.18 |
|      dirt track     |  6.24 | 17.35 |
|       apparel       | 18.22 | 33.83 |
|         pole        |  6.91 | 10.58 |
|         land        |  5.76 |  7.75 |
|      bannister      |  4.74 |  6.45 |
|      escalator      | 21.59 | 23.35 |
|       ottoman       | 36.21 | 50.28 |
|        bottle       |  8.05 | 16.89 |
|        buffet       | 38.81 | 48.45 |
|        poster       | 21.14 | 30.53 |
|        stage        | 10.38 | 14.74 |
|         van         | 35.48 | 44.49 |
|         ship        | 44.13 | 63.08 |
|       fountain      |  12.3 | 12.52 |
|    conveyer belt    | 61.85 | 70.34 |
|        canopy       | 13.95 | 17.15 |
|        washer       | 58.93 | 61.84 |
|      plaything      | 12.34 | 22.58 |
|    swimming pool    | 37.33 | 57.54 |
|        stool        | 23.91 | 33.51 |
|        barrel       | 45.48 | 57.05 |
|        basket       | 17.98 | 24.64 |
|      waterfall      | 61.14 | 82.76 |
|         tent        | 73.23 | 90.34 |
|         bag         |  8.0  |  9.89 |
|       minibike      | 42.31 | 62.32 |
|        cradle       | 64.09 | 87.98 |
|         oven        | 18.83 | 49.72 |
|         ball        | 39.81 | 56.18 |
|         food        | 44.97 | 62.94 |
|         step        |  8.46 |  10.1 |
|         tank        | 38.51 | 41.31 |
|      trade name     | 13.24 | 16.86 |
|      microwave      | 27.69 | 32.47 |
|         pot         | 20.39 | 27.47 |
|        animal       | 40.65 | 45.51 |
|       bicycle       | 32.55 | 53.07 |
|         lake        | 57.59 | 61.58 |
|      dishwasher     | 56.23 | 62.87 |
|        screen       | 57.95 | 79.68 |
|       blanket       |  4.85 |  5.63 |
|      sculpture      | 27.75 | 43.03 |
|         hood        |  38.8 | 60.26 |
|        sconce       | 19.35 | 28.25 |
|         vase        | 16.85 | 30.53 |
|    traffic light    | 15.48 | 25.05 |
|         tray        |  4.01 |  6.82 |
|        ashcan       | 25.35 | 39.34 |
|         fan         | 20.26 |  33.4 |
|         pier        |  7.94 |  9.67 |
|      crt screen     |  4.07 | 10.05 |
|        plate        | 28.88 | 40.93 |
|       monitor       | 15.23 | 19.75 |
|    bulletin board   | 33.38 | 41.01 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 31.92 | 40.13 |
|        glass        |  6.58 |  7.67 |
|        clock        |  9.09 | 12.54 |
|         flag        |  24.2 | 29.64 |
+---------------------+-------+-------+
09/21 08:27:44 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 73.5000  mIoU: 35.3400  mAcc: 47.0700  data_time: 0.0016  time: 1.1719
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
09/21 08:27:48 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 623855215
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 623855215
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 08:27:48 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/pixelate'

09/21 08:27:52 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 08:27:52 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 08:27:53 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 08:27:53 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 08:29:07 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:48:17  time: 0.7353  data_time: 0.0014  memory: 17225  
09/21 08:29:48 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:36:24  time: 0.9572  data_time: 0.0015  memory: 17004  
09/21 08:30:10 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:28:02  time: 0.4492  data_time: 0.0014  memory: 16997  
09/21 08:30:41 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:25:11  time: 0.5769  data_time: 0.0013  memory: 17006  
09/21 08:31:09 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:22:51  time: 0.3588  data_time: 0.0013  memory: 17005  
09/21 08:31:33 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:46  time: 0.0902  data_time: 0.0015  memory: 17000  
09/21 08:32:02 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:33  time: 0.3691  data_time: 0.0013  memory: 17005  
09/21 08:32:24 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:18:03  time: 0.4438  data_time: 0.0013  memory: 17003  
09/21 08:32:33 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:16:02  time: 0.2155  data_time: 0.0013  memory: 16927  
09/21 08:32:42 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:14:27  time: 0.0829  data_time: 0.0013  memory: 16985  
09/21 08:32:54 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:13:12  time: 0.4575  data_time: 0.0014  memory: 17005  
09/21 08:33:02 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:12:00  time: 0.2741  data_time: 0.0014  memory: 16932  
09/21 08:33:18 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:15  time: 0.4535  data_time: 0.0012  memory: 17006  
09/21 08:33:37 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:39  time: 0.0903  data_time: 0.0014  memory: 17007  
09/21 08:33:58 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:07  time: 0.9339  data_time: 0.0014  memory: 17010  
09/21 08:34:05 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:09:18  time: 0.0810  data_time: 0.0015  memory: 16997  
09/21 08:34:09 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:28  time: 0.0814  data_time: 0.0015  memory: 701  
09/21 08:34:17 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:49  time: 0.2015  data_time: 0.0013  memory: 16923  
09/21 08:34:35 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:24  time: 0.3360  data_time: 0.0014  memory: 17004  
09/21 08:34:46 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:52  time: 0.0761  data_time: 0.0013  memory: 16981  
09/21 08:35:01 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:26  time: 0.5785  data_time: 0.0013  memory: 17008  
09/21 08:35:12 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:59  time: 0.0809  data_time: 0.0014  memory: 16995  
09/21 08:35:21 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:30  time: 0.2098  data_time: 0.0013  memory: 16986  
09/21 08:35:25 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:01  time: 0.0797  data_time: 0.0013  memory: 1897  
09/21 08:35:34 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:36  time: 0.2127  data_time: 0.0013  memory: 16997  
09/21 08:35:38 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:10  time: 0.0800  data_time: 0.0013  memory: 1536  
09/21 08:35:44 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:46  time: 0.0758  data_time: 0.0013  memory: 16983  
09/21 08:36:02 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:29  time: 0.4454  data_time: 0.0013  memory: 17001  
09/21 08:36:10 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:08  time: 0.3750  data_time: 0.0013  memory: 16989  
09/21 08:36:14 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:46  time: 0.0740  data_time: 0.0013  memory: 701  
09/21 08:36:20 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:27  time: 0.0840  data_time: 0.0014  memory: 16932  
09/21 08:36:24 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:07  time: 0.0782  data_time: 0.0014  memory: 1580  
09/21 08:36:35 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:50  time: 0.0726  data_time: 0.0012  memory: 17005  
09/21 08:36:45 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:33  time: 0.0805  data_time: 0.0014  memory: 16996  
09/21 08:36:54 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:17  time: 0.0840  data_time: 0.0012  memory: 16985  
09/21 08:37:01 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:00  time: 0.0824  data_time: 0.0015  memory: 16984  
09/21 08:37:05 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:44  time: 0.0819  data_time: 0.0015  memory: 651  
09/21 08:37:12 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:29  time: 0.0843  data_time: 0.0013  memory: 17008  
09/21 08:37:20 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.0771  data_time: 0.0013  memory: 16989  
09/21 08:37:29 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0743  data_time: 0.0011  memory: 16936  
09/21 08:37:29 - mmengine - INFO - per class results:
09/21 08:37:29 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.31 | 88.33 |
|       building      | 80.58 | 93.58 |
|         sky         |  93.9 | 96.94 |
|        floor        | 79.19 | 91.27 |
|         tree        | 72.06 | 85.89 |
|       ceiling       |  82.1 | 90.03 |
|         road        | 82.29 | 89.84 |
|         bed         | 87.55 |  94.4 |
|      windowpane     | 59.88 | 76.43 |
|        grass        | 65.92 | 80.89 |
|       cabinet       | 59.17 | 72.47 |
|       sidewalk      |  64.6 | 78.02 |
|        person       | 77.87 | 88.34 |
|        earth        | 34.25 | 49.42 |
|         door        | 45.43 | 59.31 |
|        table        | 60.41 | 76.55 |
|       mountain      |  53.6 | 70.06 |
|        plant        | 49.26 | 62.32 |
|       curtain       | 69.63 | 82.45 |
|        chair        | 56.02 |  68.5 |
|         car         | 82.27 | 88.65 |
|        water        |  48.1 | 63.94 |
|       painting      | 69.26 | 83.64 |
|         sofa        | 63.76 | 83.46 |
|        shelf        | 41.45 |  58.1 |
|        house        | 52.52 | 59.25 |
|         sea         | 42.89 | 68.74 |
|        mirror       | 62.89 | 71.83 |
|         rug         | 58.08 | 64.75 |
|        field        | 30.45 | 46.47 |
|       armchair      | 42.96 | 56.28 |
|         seat        | 53.76 | 75.31 |
|        fence        | 39.04 | 55.42 |
|         desk        | 49.61 | 63.53 |
|         rock        | 28.26 | 38.62 |
|       wardrobe      | 50.31 | 68.92 |
|         lamp        | 62.09 | 73.43 |
|       bathtub       | 75.72 | 81.17 |
|       railing       | 32.32 | 45.83 |
|       cushion       |  52.9 | 65.14 |
|         base        | 27.79 | 37.25 |
|         box         | 24.33 | 33.88 |
|        column       | 43.53 | 51.43 |
|      signboard      | 33.51 | 44.79 |
|   chest of drawers  | 38.74 | 60.03 |
|       counter       | 28.61 | 43.17 |
|         sand        | 32.64 | 46.99 |
|         sink        | 69.84 | 79.55 |
|      skyscraper     | 46.59 | 52.09 |
|      fireplace      | 65.12 | 83.07 |
|     refrigerator    | 73.54 |  81.9 |
|      grandstand     | 39.58 | 69.88 |
|         path        | 17.96 | 24.29 |
|        stairs       | 29.12 |  37.1 |
|        runway       |  65.9 | 87.15 |
|         case        | 53.08 | 73.31 |
|      pool table     | 91.87 | 95.25 |
|        pillow       | 54.94 | 64.99 |
|     screen door     | 65.37 | 75.61 |
|       stairway      |  26.8 | 37.83 |
|        river        |  8.53 |  15.3 |
|        bridge       | 44.65 | 50.11 |
|       bookcase      | 41.13 | 55.03 |
|        blind        | 46.04 | 53.03 |
|     coffee table    | 65.32 | 79.85 |
|        toilet       | 85.45 |  89.4 |
|        flower       | 28.94 | 45.81 |
|         book        | 44.96 | 68.11 |
|         hill        |  8.75 | 11.23 |
|        bench        | 42.83 | 51.78 |
|      countertop     | 52.56 | 67.93 |
|        stove        | 72.99 | 78.09 |
|         palm        | 46.84 | 61.84 |
|    kitchen island   | 44.52 | 78.53 |
|       computer      | 55.37 | 64.35 |
|     swivel chair    | 44.64 |  62.3 |
|         boat        | 34.41 | 36.46 |
|         bar         | 27.63 | 33.75 |
|    arcade machine   | 24.87 | 28.52 |
|        hovel        | 34.68 | 38.35 |
|         bus         |  84.6 | 92.26 |
|        towel        | 57.67 | 66.69 |
|        light        | 54.86 | 62.85 |
|        truck        | 34.07 | 45.05 |
|        tower        | 21.23 | 29.21 |
|      chandelier     | 65.09 | 82.61 |
|        awning       | 22.11 | 23.87 |
|     streetlight     |  23.7 | 30.67 |
|        booth        |  54.3 | 56.78 |
| television receiver | 67.39 | 81.93 |
|       airplane      | 49.76 | 64.48 |
|      dirt track     |  9.36 | 21.93 |
|       apparel       | 30.98 | 45.95 |
|         pole        |  22.1 | 31.59 |
|         land        | 11.04 | 14.25 |
|      bannister      |  4.65 |  6.41 |
|      escalator      | 18.69 | 19.23 |
|       ottoman       | 44.66 | 57.61 |
|        bottle       |  16.3 | 23.57 |
|        buffet       | 53.86 | 67.52 |
|        poster       | 26.04 | 36.42 |
|        stage        |  12.0 |  16.9 |
|         van         | 47.65 | 63.61 |
|         ship        | 37.67 | 51.69 |
|       fountain      |  7.81 |  7.87 |
|    conveyer belt    | 74.57 | 88.39 |
|        canopy       | 17.86 |  19.1 |
|        washer       | 66.29 |  66.9 |
|      plaything      | 18.95 |  27.7 |
|    swimming pool    | 40.39 |  60.1 |
|        stool        | 39.68 | 55.01 |
|        barrel       | 34.57 | 67.65 |
|        basket       | 29.61 | 36.45 |
|      waterfall      | 66.66 | 82.39 |
|         tent        | 95.07 | 97.63 |
|         bag         |  9.8  | 11.03 |
|       minibike      | 57.79 | 64.05 |
|        cradle       | 75.75 | 97.44 |
|         oven        | 24.55 | 58.14 |
|         ball        | 46.75 | 60.34 |
|         food        | 50.43 | 59.73 |
|         step        | 12.46 | 15.99 |
|         tank        | 43.15 | 44.21 |
|      trade name     | 24.98 |  29.7 |
|      microwave      | 38.05 | 41.17 |
|         pot         | 38.19 | 44.96 |
|        animal       | 49.66 | 53.08 |
|       bicycle       | 41.07 | 59.57 |
|         lake        | 60.79 | 63.24 |
|      dishwasher     | 73.08 | 78.55 |
|        screen       |  68.8 | 87.89 |
|       blanket       |  5.08 |  5.61 |
|      sculpture      | 33.61 | 52.85 |
|         hood        | 55.34 | 70.16 |
|        sconce       | 38.71 | 48.04 |
|         vase        | 35.09 | 47.29 |
|    traffic light    | 28.45 | 39.25 |
|         tray        |  5.99 |  9.32 |
|        ashcan       | 35.64 | 45.36 |
|         fan         | 55.35 | 65.82 |
|         pier        | 24.77 | 29.53 |
|      crt screen     |  4.97 | 11.99 |
|        plate        | 42.17 | 52.37 |
|       monitor       | 26.38 | 34.49 |
|    bulletin board   | 42.93 | 53.03 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 40.45 | 45.25 |
|        glass        | 10.27 | 10.97 |
|        clock        | 23.49 | 26.51 |
|         flag        | 33.56 | 35.21 |
+---------------------+-------+-------+
09/21 08:37:29 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.6200  mIoU: 45.2700  mAcc: 56.0800  data_time: 0.0015  time: 0.2879
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
09/21 08:37:32 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 747737688
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 747737688
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 08:37:32 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/jpeg_compression'

09/21 08:37:36 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 08:37:36 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 08:37:37 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 08:37:37 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 08:38:52 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:48:22  time: 0.7401  data_time: 0.0014  memory: 17225  
09/21 08:39:32 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:36:30  time: 0.9568  data_time: 0.0015  memory: 17004  
09/21 08:39:54 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:28:08  time: 0.4538  data_time: 0.0014  memory: 16997  
09/21 08:40:26 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:25:18  time: 0.5807  data_time: 0.0014  memory: 17006  
09/21 08:40:54 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:22:57  time: 0.3649  data_time: 0.0014  memory: 17005  
09/21 08:41:18 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:53  time: 0.0963  data_time: 0.0014  memory: 17000  
09/21 08:41:47 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:39  time: 0.3738  data_time: 0.0013  memory: 17005  
09/21 08:42:10 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:18:09  time: 0.4497  data_time: 0.0012  memory: 17003  
09/21 08:42:19 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:16:09  time: 0.2202  data_time: 0.0013  memory: 16927  
09/21 08:42:28 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:14:33  time: 0.0890  data_time: 0.0014  memory: 16985  
09/21 08:42:40 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:13:19  time: 0.4627  data_time: 0.0015  memory: 17005  
09/21 08:42:49 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:12:06  time: 0.2795  data_time: 0.0015  memory: 16932  
09/21 08:43:05 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:21  time: 0.4573  data_time: 0.0012  memory: 17006  
09/21 08:43:25 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:45  time: 0.0958  data_time: 0.0014  memory: 17007  
09/21 08:43:45 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:13  time: 0.9268  data_time: 0.0013  memory: 17010  
09/21 08:43:53 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:09:23  time: 0.0871  data_time: 0.0015  memory: 16997  
09/21 08:43:57 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:34  time: 0.0884  data_time: 0.0015  memory: 701  
09/21 08:44:06 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:54  time: 0.2064  data_time: 0.0013  memory: 16923  
09/21 08:44:24 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:29  time: 0.3413  data_time: 0.0024  memory: 17004  
09/21 08:44:35 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:57  time: 0.0817  data_time: 0.0013  memory: 16981  
09/21 08:44:50 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:31  time: 0.5842  data_time: 0.0014  memory: 17008  
09/21 08:45:02 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:03  time: 0.0861  data_time: 0.0014  memory: 16995  
09/21 08:45:10 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:34  time: 0.2150  data_time: 0.0013  memory: 16986  
09/21 08:45:15 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:05  time: 0.0852  data_time: 0.0013  memory: 1897  
09/21 08:45:24 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:40  time: 0.2189  data_time: 0.0013  memory: 16997  
09/21 08:45:28 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:13  time: 0.0859  data_time: 0.0013  memory: 1536  
09/21 08:45:35 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:50  time: 0.0814  data_time: 0.0013  memory: 16983  
09/21 08:45:53 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:32  time: 0.4512  data_time: 0.0013  memory: 17001  
09/21 08:46:01 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:11  time: 0.3809  data_time: 0.0013  memory: 16989  
09/21 08:46:05 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:49  time: 0.0798  data_time: 0.0013  memory: 701  
09/21 08:46:12 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:29  time: 0.0896  data_time: 0.0013  memory: 16932  
09/21 08:46:16 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:09  time: 0.0841  data_time: 0.0014  memory: 1580  
09/21 08:46:27 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:52  time: 0.0777  data_time: 0.0012  memory: 17005  
09/21 08:46:38 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:35  time: 0.0870  data_time: 0.0015  memory: 16996  
09/21 08:46:47 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:18  time: 0.0896  data_time: 0.0012  memory: 16985  
09/21 08:46:54 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:01  time: 0.0880  data_time: 0.0014  memory: 16984  
09/21 08:46:58 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:45  time: 0.0878  data_time: 0.0015  memory: 651  
09/21 08:47:06 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:29  time: 0.0893  data_time: 0.0013  memory: 17008  
09/21 08:47:15 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.0828  data_time: 0.0013  memory: 16989  
09/21 08:47:23 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0786  data_time: 0.0011  memory: 16936  
09/21 08:47:23 - mmengine - INFO - per class results:
09/21 08:47:23 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 73.47 | 88.82 |
|       building      | 79.52 | 92.88 |
|         sky         | 93.54 |  96.9 |
|        floor        | 77.47 | 91.67 |
|         tree        | 71.49 | 85.11 |
|       ceiling       | 79.19 |  86.9 |
|         road        | 80.58 | 88.28 |
|         bed         | 86.45 | 93.73 |
|      windowpane     | 59.63 |  75.1 |
|        grass        | 64.72 | 78.97 |
|       cabinet       | 58.03 | 71.27 |
|       sidewalk      | 62.39 | 75.56 |
|        person       | 77.31 | 87.72 |
|        earth        | 33.05 | 49.51 |
|         door        | 43.29 | 56.56 |
|        table        |  57.3 | 73.23 |
|       mountain      | 52.36 | 70.88 |
|        plant        | 49.13 | 62.13 |
|       curtain       |  68.4 | 79.43 |
|        chair        | 54.62 | 64.38 |
|         car         | 82.06 | 89.09 |
|        water        | 47.58 | 63.12 |
|       painting      | 67.86 | 80.82 |
|         sofa        | 62.59 | 82.91 |
|        shelf        | 38.02 | 52.92 |
|        house        | 39.82 |  46.0 |
|         sea         | 41.83 | 68.53 |
|        mirror       | 62.05 | 70.39 |
|         rug         | 47.67 | 50.98 |
|        field        | 29.84 | 43.94 |
|       armchair      | 41.96 | 54.93 |
|         seat        | 51.19 | 75.22 |
|        fence        |  40.7 | 55.01 |
|         desk        |  49.8 | 64.04 |
|         rock        | 25.56 |  36.3 |
|       wardrobe      | 50.65 |  72.1 |
|         lamp        | 61.44 | 72.08 |
|       bathtub       | 75.27 | 80.96 |
|       railing       | 29.38 | 39.83 |
|       cushion       | 51.02 | 64.39 |
|         base        | 25.83 | 34.07 |
|         box         | 22.13 | 30.91 |
|        column       | 45.64 | 54.24 |
|      signboard      | 33.31 | 43.04 |
|   chest of drawers  | 38.28 | 57.71 |
|       counter       | 28.68 | 41.85 |
|         sand        | 28.36 | 43.46 |
|         sink        |  70.5 | 78.36 |
|      skyscraper     | 42.49 |  47.5 |
|      fireplace      | 65.45 | 82.89 |
|     refrigerator    | 78.04 | 85.29 |
|      grandstand     |  37.5 | 66.43 |
|         path        | 14.84 | 23.87 |
|        stairs       | 27.88 | 35.78 |
|        runway       | 69.56 | 92.14 |
|         case        | 49.17 | 69.95 |
|      pool table     | 92.09 | 95.51 |
|        pillow       |  49.5 | 57.04 |
|     screen door     | 61.24 | 67.52 |
|       stairway      | 32.06 | 40.42 |
|        river        |  8.28 | 14.04 |
|        bridge       | 33.57 | 38.11 |
|       bookcase      | 41.59 | 53.48 |
|        blind        | 41.98 | 45.08 |
|     coffee table    | 65.56 |  78.8 |
|        toilet       | 84.18 | 88.79 |
|        flower       | 32.04 | 46.25 |
|         book        | 43.69 | 62.71 |
|         hill        |  9.22 | 11.38 |
|        bench        | 43.88 | 51.09 |
|      countertop     | 54.98 | 67.95 |
|        stove        | 71.91 | 79.52 |
|         palm        | 46.88 |  63.7 |
|    kitchen island   | 39.33 | 69.28 |
|       computer      | 54.85 | 62.89 |
|     swivel chair    | 43.14 | 59.34 |
|         boat        |  32.7 | 34.82 |
|         bar         | 28.28 | 34.23 |
|    arcade machine   | 40.08 |  44.1 |
|        hovel        | 28.71 | 38.22 |
|         bus         | 84.96 |  91.1 |
|        towel        | 50.42 | 58.37 |
|        light        | 51.02 | 56.51 |
|        truck        | 23.55 |  30.8 |
|        tower        | 24.94 | 38.07 |
|      chandelier     | 65.87 | 84.07 |
|        awning       |  20.4 |  21.8 |
|     streetlight     |  21.2 | 25.97 |
|        booth        | 52.76 | 59.75 |
| television receiver | 66.62 | 78.44 |
|       airplane      | 50.06 | 64.94 |
|      dirt track     |  9.79 | 26.35 |
|       apparel       | 33.33 | 48.77 |
|         pole        | 21.66 | 31.17 |
|         land        |  7.08 |  8.51 |
|      bannister      |  3.92 |  5.43 |
|      escalator      | 21.25 | 22.03 |
|       ottoman       | 45.09 | 54.02 |
|        bottle       | 14.19 | 21.49 |
|        buffet       | 49.26 | 58.87 |
|        poster       | 27.86 | 36.42 |
|        stage        |  9.33 | 12.32 |
|         van         | 46.23 | 60.16 |
|         ship        |  52.4 | 68.46 |
|       fountain      |  6.55 |  6.65 |
|    conveyer belt    | 57.33 | 80.63 |
|        canopy       | 19.94 | 21.37 |
|        washer       | 63.67 | 65.17 |
|      plaything      | 21.09 | 28.98 |
|    swimming pool    | 33.48 | 50.24 |
|        stool        | 31.71 | 44.97 |
|        barrel       | 27.94 | 51.69 |
|        basket       | 24.49 | 31.81 |
|      waterfall      | 66.63 | 81.03 |
|         tent        | 93.98 | 98.01 |
|         bag         |  7.95 |  8.79 |
|       minibike      | 58.03 | 67.68 |
|        cradle       | 75.41 | 97.55 |
|         oven        |  22.0 | 51.99 |
|         ball        | 43.01 | 54.44 |
|         food        | 54.36 | 69.27 |
|         step        |  8.1  |  9.6  |
|         tank        | 43.19 | 44.39 |
|      trade name     | 23.46 | 27.77 |
|      microwave      | 35.77 | 38.87 |
|         pot         | 37.34 | 43.48 |
|        animal       | 50.12 | 53.49 |
|       bicycle       | 45.41 | 65.87 |
|         lake        | 60.05 | 62.48 |
|      dishwasher     | 60.06 | 65.03 |
|        screen       | 60.59 | 73.38 |
|       blanket       |  4.64 |  4.84 |
|      sculpture      | 32.65 |  55.7 |
|         hood        | 55.46 | 66.44 |
|        sconce       | 36.01 | 41.48 |
|         vase        | 34.71 | 46.94 |
|    traffic light    |  25.3 | 31.56 |
|         tray        |  4.2  |  6.54 |
|        ashcan       | 35.11 |  42.4 |
|         fan         | 54.26 | 64.89 |
|         pier        | 11.94 | 13.75 |
|      crt screen     |  2.95 |  7.92 |
|        plate        | 40.59 | 50.97 |
|       monitor       | 16.78 | 19.64 |
|    bulletin board   | 41.76 | 50.94 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 34.86 | 37.93 |
|        glass        | 10.15 | 10.76 |
|        clock        | 23.61 | 26.64 |
|         flag        | 23.84 |  25.4 |
+---------------------+-------+-------+
09/21 08:47:23 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.6300  mIoU: 43.6600  mAcc: 53.9200  data_time: 0.0015  time: 0.2931
Finished processing corruption type: jpeg_compression
Processing corruption type: elastic_transform
09/21 08:47:27 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1758156644
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1758156644
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 08:47:27 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/elastic_transform'

09/21 08:47:31 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 08:47:31 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 08:47:31 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 08:47:32 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 08:49:34 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:19:44  time: 1.7668  data_time: 0.0015  memory: 17225  
09/21 08:51:03 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:06:53  time: 1.9570  data_time: 0.0015  memory: 17004  
09/21 08:52:11 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:57:19  time: 1.4100  data_time: 0.0015  memory: 16997  
09/21 08:53:30 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:53:46  time: 1.4904  data_time: 0.0015  memory: 17006  
09/21 08:54:43 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:50:22  time: 1.2791  data_time: 0.0015  memory: 17005  
09/21 08:55:51 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:47:09  time: 0.9923  data_time: 0.0016  memory: 17000  
09/21 08:57:07 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:45:10  time: 1.2483  data_time: 0.0015  memory: 17005  
09/21 08:58:14 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:42:50  time: 1.3911  data_time: 0.0014  memory: 17003  
09/21 08:59:03 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:39:39  time: 1.0174  data_time: 0.0014  memory: 16927  
09/21 08:59:57 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:37:14  time: 0.9309  data_time: 0.0014  memory: 16985  
09/21 09:00:56 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:35:19  time: 1.4186  data_time: 0.0015  memory: 17005  
09/21 09:01:47 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:33:14  time: 1.1784  data_time: 0.0016  memory: 16932  
09/21 09:02:47 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:31:41  time: 1.3614  data_time: 0.0013  memory: 17006  
09/21 09:03:53 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:30:22  time: 1.0074  data_time: 0.0015  memory: 17007  
09/21 09:04:59 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:29:05  time: 1.8308  data_time: 0.0014  memory: 17010  
09/21 09:05:49 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:27:25  time: 0.9750  data_time: 0.0015  memory: 16997  
09/21 09:06:38 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:25:50  time: 0.9832  data_time: 0.0016  memory: 701  
09/21 09:07:26 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:24:19  time: 0.9789  data_time: 0.0014  memory: 16923  
09/21 09:08:29 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:23:10  time: 1.1930  data_time: 0.0028  memory: 17004  
09/21 09:09:23 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:21:50  time: 0.9251  data_time: 0.0014  memory: 16981  
09/21 09:10:24 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:20:41  time: 1.5345  data_time: 0.0014  memory: 17008  
09/21 09:11:20 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:19:28  time: 0.9517  data_time: 0.0015  memory: 16995  
09/21 09:12:12 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:18:14  time: 1.0972  data_time: 0.0014  memory: 16986  
09/21 09:13:00 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:16:59  time: 0.9328  data_time: 0.0014  memory: 1897  
09/21 09:13:52 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:15:48  time: 1.0622  data_time: 0.0014  memory: 16997  
09/21 09:14:37 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:14:35  time: 0.9727  data_time: 0.0014  memory: 1536  
09/21 09:15:28 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:13:26  time: 0.8945  data_time: 0.0014  memory: 16983  
09/21 09:16:30 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:12:25  time: 1.4046  data_time: 0.0014  memory: 17001  
09/21 09:17:21 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:11:18  time: 1.3346  data_time: 0.0014  memory: 16989  
09/21 09:18:07 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:10:11  time: 0.8823  data_time: 0.0014  memory: 701  
09/21 09:18:59 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:09:07  time: 0.9785  data_time: 0.0014  memory: 16932  
09/21 09:19:45 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:08:03  time: 0.9381  data_time: 0.0015  memory: 1580  
09/21 09:20:38 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:01  time: 0.8679  data_time: 0.0013  memory: 17005  
09/21 09:21:33 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:00  time: 0.9555  data_time: 0.0015  memory: 16996  
09/21 09:22:27 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:59  time: 0.9496  data_time: 0.0014  memory: 16985  
09/21 09:23:16 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:58  time: 0.9787  data_time: 0.0016  memory: 16984  
09/21 09:24:04 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:57  time: 0.9628  data_time: 0.0016  memory: 651  
09/21 09:24:53 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:57  time: 0.9272  data_time: 0.0014  memory: 17008  
09/21 09:25:45 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:58  time: 0.9231  data_time: 0.0014  memory: 16989  
09/21 09:26:35 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.8691  data_time: 0.0013  memory: 16936  
09/21 09:26:35 - mmengine - INFO - per class results:
09/21 09:26:35 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 62.37 | 78.82 |
|       building      | 72.99 | 88.89 |
|         sky         | 84.35 | 91.58 |
|        floor        | 66.96 | 81.79 |
|         tree        |  61.5 | 78.37 |
|       ceiling       | 68.85 | 81.86 |
|         road        | 73.03 | 83.71 |
|         bed         |  76.0 | 87.86 |
|      windowpane     | 48.61 | 67.65 |
|        grass        | 60.09 | 76.29 |
|       cabinet       | 48.45 | 62.02 |
|       sidewalk      | 51.54 | 67.78 |
|        person       | 59.06 | 75.98 |
|        earth        |  30.1 | 44.98 |
|         door        |  35.8 | 48.24 |
|        table        | 43.59 | 62.23 |
|       mountain      | 45.76 | 60.91 |
|        plant        | 40.56 | 55.27 |
|       curtain       | 51.53 |  69.3 |
|        chair        | 39.15 | 54.92 |
|         car         | 61.35 | 74.79 |
|        water        | 45.66 | 60.63 |
|       painting      | 47.01 | 65.61 |
|         sofa        | 51.31 | 68.05 |
|        shelf        | 35.31 | 51.84 |
|        house        | 33.35 | 39.01 |
|         sea         | 41.63 | 68.53 |
|        mirror       | 50.99 | 63.26 |
|         rug         | 43.58 | 52.87 |
|        field        | 25.12 | 42.28 |
|       armchair      | 35.04 | 52.26 |
|         seat        | 49.06 | 72.66 |
|        fence        |  31.2 | 48.47 |
|         desk        | 40.41 | 56.04 |
|         rock        | 27.79 | 40.14 |
|       wardrobe      | 40.58 | 57.26 |
|         lamp        | 29.61 | 44.62 |
|       bathtub       | 57.16 | 69.05 |
|       railing       | 25.85 | 38.56 |
|       cushion       | 37.89 | 52.07 |
|         base        | 25.02 | 34.23 |
|         box         | 16.89 | 22.69 |
|        column       | 27.53 | 39.49 |
|      signboard      | 20.98 | 31.34 |
|   chest of drawers  | 33.21 | 50.37 |
|       counter       | 26.39 | 37.05 |
|         sand        | 27.72 | 44.93 |
|         sink        | 44.76 | 60.77 |
|      skyscraper     | 44.82 | 52.43 |
|      fireplace      | 56.91 | 75.31 |
|     refrigerator    |  58.6 | 71.99 |
|      grandstand     | 32.49 | 56.63 |
|         path        | 12.36 | 17.26 |
|        stairs       | 24.99 | 31.06 |
|        runway       | 60.33 | 80.96 |
|         case        | 51.05 | 73.19 |
|      pool table     | 75.86 | 85.35 |
|        pillow       | 42.08 | 55.04 |
|     screen door     | 53.16 | 69.53 |
|       stairway      | 25.71 | 31.55 |
|        river        | 11.48 | 17.61 |
|        bridge       | 43.87 | 52.18 |
|       bookcase      | 31.76 | 48.26 |
|        blind        | 41.25 | 49.11 |
|     coffee table    | 50.06 | 66.98 |
|        toilet       | 56.11 | 69.58 |
|        flower       | 20.89 | 36.52 |
|         book        | 27.68 | 45.34 |
|         hill        |  5.42 |  8.11 |
|        bench        |  34.3 | 45.53 |
|      countertop     | 42.42 | 57.59 |
|        stove        | 60.86 | 70.67 |
|         palm        | 34.16 | 53.08 |
|    kitchen island   | 35.84 | 63.84 |
|       computer      | 45.99 | 58.87 |
|     swivel chair    | 34.16 |  52.6 |
|         boat        | 30.15 | 37.42 |
|         bar         | 21.28 | 24.93 |
|    arcade machine   | 23.77 | 27.56 |
|        hovel        |  9.2  |  10.5 |
|         bus         | 65.53 |  77.9 |
|        towel        | 38.75 | 52.57 |
|        light        | 14.88 | 22.64 |
|        truck        | 24.79 | 33.85 |
|        tower        | 18.01 |  26.5 |
|      chandelier     |  39.5 | 58.17 |
|        awning       | 14.57 | 17.38 |
|     streetlight     |  9.84 | 14.42 |
|        booth        | 50.56 | 56.53 |
| television receiver | 50.03 | 65.24 |
|       airplane      | 33.63 | 52.48 |
|      dirt track     |  7.78 | 25.46 |
|       apparel       | 19.29 | 37.25 |
|         pole        |  5.33 |  8.16 |
|         land        |  7.31 |  9.76 |
|      bannister      |  1.97 |  2.62 |
|      escalator      |  22.0 | 23.14 |
|       ottoman       | 35.04 | 48.77 |
|        bottle       |  7.41 | 14.67 |
|        buffet       | 39.37 | 50.14 |
|        poster       | 23.71 | 34.74 |
|        stage        | 10.05 | 15.07 |
|         van         | 34.85 | 43.55 |
|         ship        | 62.17 | 74.67 |
|       fountain      |  8.65 |  8.96 |
|    conveyer belt    | 50.01 | 58.85 |
|        canopy       | 14.05 | 17.79 |
|        washer       | 57.05 |  61.3 |
|      plaything      | 11.79 | 21.85 |
|    swimming pool    | 40.57 | 62.61 |
|        stool        | 25.53 | 40.51 |
|        barrel       |  30.6 | 64.31 |
|        basket       | 15.79 | 22.28 |
|      waterfall      | 59.57 | 78.33 |
|         tent        | 79.86 |  98.0 |
|         bag         |  7.05 |  9.01 |
|       minibike      | 40.08 | 55.34 |
|        cradle       | 61.64 | 86.63 |
|         oven        | 18.75 | 45.64 |
|         ball        | 38.55 | 52.96 |
|         food        | 47.15 | 63.99 |
|         step        |  9.78 |  11.4 |
|         tank        | 39.15 | 41.07 |
|      trade name     | 14.67 | 17.61 |
|      microwave      | 30.48 | 34.85 |
|         pot         | 19.79 | 26.89 |
|        animal       | 44.43 | 49.33 |
|       bicycle       | 32.48 |  54.0 |
|         lake        | 58.69 | 62.93 |
|      dishwasher     | 54.28 | 61.61 |
|        screen       | 52.66 | 73.84 |
|       blanket       |  7.17 |  8.18 |
|      sculpture      | 30.25 | 48.52 |
|         hood        | 41.67 |  58.5 |
|        sconce       |  16.1 |  25.5 |
|         vase        | 18.92 | 32.92 |
|    traffic light    | 15.58 | 24.74 |
|         tray        |  4.89 |  8.26 |
|        ashcan       | 21.93 |  33.4 |
|         fan         | 20.78 | 35.01 |
|         pier        |  9.77 | 11.17 |
|      crt screen     |  2.99 | 10.29 |
|        plate        | 23.56 | 35.11 |
|       monitor       | 17.42 | 20.99 |
|    bulletin board   | 30.83 |  42.7 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  26.2 | 31.95 |
|        glass        |  6.84 |  7.77 |
|        clock        |  9.7  | 13.05 |
|         flag        |  28.6 | 33.22 |
+---------------------+-------+-------+
09/21 09:26:35 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 73.4700  mIoU: 35.2300  mAcc: 47.2200  data_time: 0.0016  time: 1.1715
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
09/21 09:26:38 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1515447076
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1515447076
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 09:26:38 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/pixelate'

09/21 09:26:42 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 09:26:42 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 09:26:42 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 09:26:43 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 09:27:57 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:48:11  time: 0.7347  data_time: 0.0015  memory: 17225  
09/21 09:28:37 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:36:19  time: 0.9524  data_time: 0.0015  memory: 17004  
09/21 09:28:59 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:27:58  time: 0.4492  data_time: 0.0014  memory: 16997  
09/21 09:29:30 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:25:08  time: 0.5755  data_time: 0.0014  memory: 17006  
09/21 09:29:58 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:22:48  time: 0.3589  data_time: 0.0014  memory: 17005  
09/21 09:30:22 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:44  time: 0.0902  data_time: 0.0015  memory: 17000  
09/21 09:30:51 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:31  time: 0.3692  data_time: 0.0014  memory: 17005  
09/21 09:31:13 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:18:01  time: 0.4425  data_time: 0.0013  memory: 17003  
09/21 09:31:22 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:16:00  time: 0.2149  data_time: 0.0013  memory: 16927  
09/21 09:31:31 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:14:25  time: 0.0832  data_time: 0.0013  memory: 16985  
09/21 09:31:43 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:13:11  time: 0.4564  data_time: 0.0015  memory: 17005  
09/21 09:31:51 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:58  time: 0.2732  data_time: 0.0014  memory: 16932  
09/21 09:32:07 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:13  time: 0.4514  data_time: 0.0012  memory: 17006  
09/21 09:32:26 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:38  time: 0.0907  data_time: 0.0014  memory: 17007  
09/21 09:32:47 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:06  time: 0.9330  data_time: 0.0014  memory: 17010  
09/21 09:32:54 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:09:17  time: 0.0806  data_time: 0.0014  memory: 16997  
09/21 09:32:58 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:28  time: 0.0813  data_time: 0.0015  memory: 701  
09/21 09:33:06 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:48  time: 0.2014  data_time: 0.0013  memory: 16923  
09/21 09:33:24 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:23  time: 0.3357  data_time: 0.0014  memory: 17004  
09/21 09:33:35 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:51  time: 0.0761  data_time: 0.0013  memory: 16981  
09/21 09:33:49 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:26  time: 0.5774  data_time: 0.0014  memory: 17008  
09/21 09:34:01 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:58  time: 0.0807  data_time: 0.0014  memory: 16995  
09/21 09:34:09 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:30  time: 0.2095  data_time: 0.0014  memory: 16986  
09/21 09:34:14 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:00  time: 0.0796  data_time: 0.0013  memory: 1897  
09/21 09:34:23 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:35  time: 0.2132  data_time: 0.0014  memory: 16997  
09/21 09:34:27 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:09  time: 0.0799  data_time: 0.0013  memory: 1536  
09/21 09:34:33 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:46  time: 0.0758  data_time: 0.0013  memory: 16983  
09/21 09:34:50 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:29  time: 0.4449  data_time: 0.0013  memory: 17001  
09/21 09:34:59 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:08  time: 0.3749  data_time: 0.0013  memory: 16989  
09/21 09:35:02 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:46  time: 0.0740  data_time: 0.0013  memory: 701  
09/21 09:35:09 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:26  time: 0.0831  data_time: 0.0013  memory: 16932  
09/21 09:35:13 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:07  time: 0.0780  data_time: 0.0014  memory: 1580  
09/21 09:35:23 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:50  time: 0.0726  data_time: 0.0012  memory: 17005  
09/21 09:35:34 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:33  time: 0.0806  data_time: 0.0014  memory: 16996  
09/21 09:35:43 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:17  time: 0.0841  data_time: 0.0013  memory: 16985  
09/21 09:35:49 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:00  time: 0.0816  data_time: 0.0015  memory: 16984  
09/21 09:35:53 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:44  time: 0.0807  data_time: 0.0015  memory: 651  
09/21 09:36:01 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:29  time: 0.0840  data_time: 0.0013  memory: 17008  
09/21 09:36:09 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.0769  data_time: 0.0013  memory: 16989  
09/21 09:36:18 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0745  data_time: 0.0011  memory: 16936  
09/21 09:36:18 - mmengine - INFO - per class results:
09/21 09:36:18 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.31 | 88.33 |
|       building      | 80.58 | 93.58 |
|         sky         |  93.9 | 96.94 |
|        floor        | 79.19 | 91.27 |
|         tree        | 72.06 | 85.89 |
|       ceiling       |  82.1 | 90.03 |
|         road        | 82.29 | 89.84 |
|         bed         | 87.55 |  94.4 |
|      windowpane     | 59.88 | 76.43 |
|        grass        | 65.92 | 80.89 |
|       cabinet       | 59.17 | 72.47 |
|       sidewalk      |  64.6 | 78.02 |
|        person       | 77.87 | 88.34 |
|        earth        | 34.25 | 49.42 |
|         door        | 45.43 | 59.31 |
|        table        | 60.41 | 76.55 |
|       mountain      |  53.6 | 70.06 |
|        plant        | 49.26 | 62.32 |
|       curtain       | 69.63 | 82.45 |
|        chair        | 56.02 |  68.5 |
|         car         | 82.27 | 88.65 |
|        water        |  48.1 | 63.94 |
|       painting      | 69.26 | 83.64 |
|         sofa        | 63.76 | 83.46 |
|        shelf        | 41.45 |  58.1 |
|        house        | 52.52 | 59.25 |
|         sea         | 42.89 | 68.74 |
|        mirror       | 62.89 | 71.83 |
|         rug         | 58.08 | 64.75 |
|        field        | 30.45 | 46.47 |
|       armchair      | 42.96 | 56.28 |
|         seat        | 53.76 | 75.31 |
|        fence        | 39.04 | 55.42 |
|         desk        | 49.61 | 63.53 |
|         rock        | 28.26 | 38.62 |
|       wardrobe      | 50.31 | 68.92 |
|         lamp        | 62.09 | 73.43 |
|       bathtub       | 75.72 | 81.17 |
|       railing       | 32.32 | 45.83 |
|       cushion       |  52.9 | 65.14 |
|         base        | 27.79 | 37.25 |
|         box         | 24.33 | 33.88 |
|        column       | 43.53 | 51.43 |
|      signboard      | 33.51 | 44.79 |
|   chest of drawers  | 38.74 | 60.03 |
|       counter       | 28.61 | 43.17 |
|         sand        | 32.64 | 46.99 |
|         sink        | 69.84 | 79.55 |
|      skyscraper     | 46.59 | 52.09 |
|      fireplace      | 65.12 | 83.07 |
|     refrigerator    | 73.54 |  81.9 |
|      grandstand     | 39.58 | 69.88 |
|         path        | 17.96 | 24.29 |
|        stairs       | 29.12 |  37.1 |
|        runway       |  65.9 | 87.15 |
|         case        | 53.08 | 73.31 |
|      pool table     | 91.87 | 95.25 |
|        pillow       | 54.94 | 64.99 |
|     screen door     | 65.37 | 75.61 |
|       stairway      |  26.8 | 37.83 |
|        river        |  8.53 |  15.3 |
|        bridge       | 44.65 | 50.11 |
|       bookcase      | 41.13 | 55.03 |
|        blind        | 46.04 | 53.03 |
|     coffee table    | 65.32 | 79.85 |
|        toilet       | 85.45 |  89.4 |
|        flower       | 28.94 | 45.81 |
|         book        | 44.96 | 68.11 |
|         hill        |  8.75 | 11.23 |
|        bench        | 42.83 | 51.78 |
|      countertop     | 52.56 | 67.93 |
|        stove        | 72.99 | 78.09 |
|         palm        | 46.84 | 61.84 |
|    kitchen island   | 44.52 | 78.53 |
|       computer      | 55.37 | 64.35 |
|     swivel chair    | 44.64 |  62.3 |
|         boat        | 34.41 | 36.46 |
|         bar         | 27.63 | 33.75 |
|    arcade machine   | 24.87 | 28.52 |
|        hovel        | 34.68 | 38.35 |
|         bus         |  84.6 | 92.26 |
|        towel        | 57.67 | 66.69 |
|        light        | 54.86 | 62.85 |
|        truck        | 34.07 | 45.05 |
|        tower        | 21.23 | 29.21 |
|      chandelier     | 65.09 | 82.61 |
|        awning       | 22.11 | 23.87 |
|     streetlight     |  23.7 | 30.67 |
|        booth        |  54.3 | 56.78 |
| television receiver | 67.39 | 81.93 |
|       airplane      | 49.76 | 64.48 |
|      dirt track     |  9.36 | 21.93 |
|       apparel       | 30.98 | 45.95 |
|         pole        |  22.1 | 31.59 |
|         land        | 11.04 | 14.25 |
|      bannister      |  4.65 |  6.41 |
|      escalator      | 18.69 | 19.23 |
|       ottoman       | 44.66 | 57.61 |
|        bottle       |  16.3 | 23.57 |
|        buffet       | 53.86 | 67.52 |
|        poster       | 26.04 | 36.42 |
|        stage        |  12.0 |  16.9 |
|         van         | 47.65 | 63.61 |
|         ship        | 37.67 | 51.69 |
|       fountain      |  7.81 |  7.87 |
|    conveyer belt    | 74.57 | 88.39 |
|        canopy       | 17.86 |  19.1 |
|        washer       | 66.29 |  66.9 |
|      plaything      | 18.95 |  27.7 |
|    swimming pool    | 40.39 |  60.1 |
|        stool        | 39.68 | 55.01 |
|        barrel       | 34.57 | 67.65 |
|        basket       | 29.61 | 36.45 |
|      waterfall      | 66.66 | 82.39 |
|         tent        | 95.07 | 97.63 |
|         bag         |  9.8  | 11.03 |
|       minibike      | 57.79 | 64.05 |
|        cradle       | 75.75 | 97.44 |
|         oven        | 24.55 | 58.14 |
|         ball        | 46.75 | 60.34 |
|         food        | 50.43 | 59.73 |
|         step        | 12.46 | 15.99 |
|         tank        | 43.15 | 44.21 |
|      trade name     | 24.98 |  29.7 |
|      microwave      | 38.05 | 41.17 |
|         pot         | 38.19 | 44.96 |
|        animal       | 49.66 | 53.08 |
|       bicycle       | 41.07 | 59.57 |
|         lake        | 60.79 | 63.24 |
|      dishwasher     | 73.08 | 78.55 |
|        screen       |  68.8 | 87.89 |
|       blanket       |  5.08 |  5.61 |
|      sculpture      | 33.61 | 52.85 |
|         hood        | 55.34 | 70.16 |
|        sconce       | 38.71 | 48.04 |
|         vase        | 35.09 | 47.29 |
|    traffic light    | 28.45 | 39.25 |
|         tray        |  5.99 |  9.32 |
|        ashcan       | 35.64 | 45.36 |
|         fan         | 55.35 | 65.82 |
|         pier        | 24.77 | 29.53 |
|      crt screen     |  4.97 | 11.99 |
|        plate        | 42.17 | 52.37 |
|       monitor       | 26.38 | 34.49 |
|    bulletin board   | 42.93 | 53.03 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 40.45 | 45.25 |
|        glass        | 10.27 | 10.97 |
|        clock        | 23.49 | 26.51 |
|         flag        | 33.56 | 35.21 |
+---------------------+-------+-------+
09/21 09:36:18 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.6200  mIoU: 45.2700  mAcc: 56.0800  data_time: 0.0015  time: 0.2874
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
09/21 09:36:21 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 671022128
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 671022128
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/21 09:36:21 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    size=(
        512,
        512,
    ),
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        c1_channels=48,
        c1_in_channels=256,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='DepthwiseSeparableASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_4xb4-160k_ade20k-512x512/jpeg_compression'

09/21 09:36:25 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/21 09:36:25 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/21 09:36:26 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 09:36:26 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3plus/deeplabv3plus_r101-d8_512x512_160k_ade20k_20200615_123232-38ed86bb.pth
09/21 09:37:41 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:48:29  time: 0.7423  data_time: 0.0014  memory: 17225  
09/21 09:38:22 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:36:35  time: 0.9600  data_time: 0.0014  memory: 17004  
09/21 09:38:43 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:28:12  time: 0.4550  data_time: 0.0014  memory: 16997  
09/21 09:39:15 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:25:22  time: 0.5840  data_time: 0.0014  memory: 17006  
09/21 09:39:43 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:23:00  time: 0.3641  data_time: 0.0013  memory: 17005  
09/21 09:40:08 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:55  time: 0.0959  data_time: 0.0015  memory: 17000  
09/21 09:40:37 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:42  time: 0.3742  data_time: 0.0013  memory: 17005  
09/21 09:40:59 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:18:12  time: 0.4506  data_time: 0.0013  memory: 17003  
09/21 09:41:08 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:16:10  time: 0.2207  data_time: 0.0013  memory: 16927  
09/21 09:41:18 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:14:35  time: 0.0889  data_time: 0.0013  memory: 16985  
09/21 09:41:30 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:13:20  time: 0.4635  data_time: 0.0014  memory: 17005  
09/21 09:41:38 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:12:07  time: 0.2807  data_time: 0.0014  memory: 16932  
09/21 09:41:55 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:11:22  time: 0.4584  data_time: 0.0012  memory: 17006  
09/21 09:42:14 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:46  time: 0.0969  data_time: 0.0014  memory: 17007  
09/21 09:42:35 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:14  time: 0.9237  data_time: 0.0013  memory: 17010  
09/21 09:42:43 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:09:24  time: 0.0869  data_time: 0.0014  memory: 16997  
09/21 09:42:47 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:35  time: 0.0883  data_time: 0.0015  memory: 701  
09/21 09:42:55 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:55  time: 0.2073  data_time: 0.0013  memory: 16923  
09/21 09:43:13 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:30  time: 0.3413  data_time: 0.0014  memory: 17004  
09/21 09:43:24 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:58  time: 0.0826  data_time: 0.0013  memory: 16981  
09/21 09:43:39 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:31  time: 0.5848  data_time: 0.0013  memory: 17008  
09/21 09:43:52 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:04  time: 0.0860  data_time: 0.0014  memory: 16995  
09/21 09:44:00 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:35  time: 0.2162  data_time: 0.0013  memory: 16986  
09/21 09:44:04 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:05  time: 0.0855  data_time: 0.0013  memory: 1897  
09/21 09:44:14 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:40  time: 0.2187  data_time: 0.0013  memory: 16997  
09/21 09:44:18 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:13  time: 0.0858  data_time: 0.0013  memory: 1536  
09/21 09:44:25 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:50  time: 0.0814  data_time: 0.0013  memory: 16983  
09/21 09:44:42 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:32  time: 0.4530  data_time: 0.0028  memory: 17001  
09/21 09:44:51 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:11  time: 0.3810  data_time: 0.0013  memory: 16989  
09/21 09:44:55 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:49  time: 0.0807  data_time: 0.0013  memory: 701  
09/21 09:45:02 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:29  time: 0.0894  data_time: 0.0013  memory: 16932  
09/21 09:45:06 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:09  time: 0.0842  data_time: 0.0014  memory: 1580  
09/21 09:45:17 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:52  time: 0.0774  data_time: 0.0012  memory: 17005  
09/21 09:45:28 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:35  time: 0.0863  data_time: 0.0014  memory: 16996  
09/21 09:45:37 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:18  time: 0.0897  data_time: 0.0012  memory: 16985  
09/21 09:45:44 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:01  time: 0.0878  data_time: 0.0014  memory: 16984  
09/21 09:45:48 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:45  time: 0.0876  data_time: 0.0014  memory: 651  
09/21 09:45:56 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:29  time: 0.0894  data_time: 0.0013  memory: 17008  
09/21 09:46:04 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.0824  data_time: 0.0013  memory: 16989  
09/21 09:46:13 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0795  data_time: 0.0019  memory: 16936  
09/21 09:46:13 - mmengine - INFO - per class results:
09/21 09:46:13 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 73.47 | 88.82 |
|       building      | 79.52 | 92.88 |
|         sky         | 93.54 |  96.9 |
|        floor        | 77.47 | 91.67 |
|         tree        | 71.49 | 85.11 |
|       ceiling       | 79.19 |  86.9 |
|         road        | 80.58 | 88.28 |
|         bed         | 86.45 | 93.73 |
|      windowpane     | 59.63 |  75.1 |
|        grass        | 64.72 | 78.97 |
|       cabinet       | 58.03 | 71.27 |
|       sidewalk      | 62.39 | 75.56 |
|        person       | 77.31 | 87.72 |
|        earth        | 33.05 | 49.51 |
|         door        | 43.29 | 56.56 |
|        table        |  57.3 | 73.23 |
|       mountain      | 52.36 | 70.88 |
|        plant        | 49.13 | 62.13 |
|       curtain       |  68.4 | 79.43 |
|        chair        | 54.62 | 64.38 |
|         car         | 82.06 | 89.09 |
|        water        | 47.58 | 63.12 |
|       painting      | 67.86 | 80.82 |
|         sofa        | 62.59 | 82.91 |
|        shelf        | 38.02 | 52.92 |
|        house        | 39.82 |  46.0 |
|         sea         | 41.83 | 68.53 |
|        mirror       | 62.05 | 70.39 |
|         rug         | 47.67 | 50.98 |
|        field        | 29.84 | 43.94 |
|       armchair      | 41.96 | 54.93 |
|         seat        | 51.19 | 75.22 |
|        fence        |  40.7 | 55.01 |
|         desk        |  49.8 | 64.04 |
|         rock        | 25.56 |  36.3 |
|       wardrobe      | 50.65 |  72.1 |
|         lamp        | 61.44 | 72.08 |
|       bathtub       | 75.27 | 80.96 |
|       railing       | 29.38 | 39.83 |
|       cushion       | 51.02 | 64.39 |
|         base        | 25.83 | 34.07 |
|         box         | 22.13 | 30.91 |
|        column       | 45.64 | 54.24 |
|      signboard      | 33.31 | 43.04 |
|   chest of drawers  | 38.28 | 57.71 |
|       counter       | 28.68 | 41.85 |
|         sand        | 28.36 | 43.46 |
|         sink        |  70.5 | 78.36 |
|      skyscraper     | 42.49 |  47.5 |
|      fireplace      | 65.45 | 82.89 |
|     refrigerator    | 78.04 | 85.29 |
|      grandstand     |  37.5 | 66.43 |
|         path        | 14.84 | 23.87 |
|        stairs       | 27.88 | 35.78 |
|        runway       | 69.56 | 92.14 |
|         case        | 49.17 | 69.95 |
|      pool table     | 92.09 | 95.51 |
|        pillow       |  49.5 | 57.04 |
|     screen door     | 61.24 | 67.52 |
|       stairway      | 32.06 | 40.42 |
|        river        |  8.28 | 14.04 |
|        bridge       | 33.57 | 38.11 |
|       bookcase      | 41.59 | 53.48 |
|        blind        | 41.98 | 45.08 |
|     coffee table    | 65.56 |  78.8 |
|        toilet       | 84.18 | 88.79 |
|        flower       | 32.04 | 46.25 |
|         book        | 43.69 | 62.71 |
|         hill        |  9.22 | 11.38 |
|        bench        | 43.88 | 51.09 |
|      countertop     | 54.98 | 67.95 |
|        stove        | 71.91 | 79.52 |
|         palm        | 46.88 |  63.7 |
|    kitchen island   | 39.33 | 69.28 |
|       computer      | 54.85 | 62.89 |
|     swivel chair    | 43.14 | 59.34 |
|         boat        |  32.7 | 34.82 |
|         bar         | 28.28 | 34.23 |
|    arcade machine   | 40.08 |  44.1 |
|        hovel        | 28.71 | 38.22 |
|         bus         | 84.96 |  91.1 |
|        towel        | 50.42 | 58.37 |
|        light        | 51.02 | 56.51 |
|        truck        | 23.55 |  30.8 |
|        tower        | 24.94 | 38.07 |
|      chandelier     | 65.87 | 84.07 |
|        awning       |  20.4 |  21.8 |
|     streetlight     |  21.2 | 25.97 |
|        booth        | 52.76 | 59.75 |
| television receiver | 66.62 | 78.44 |
|       airplane      | 50.06 | 64.94 |
|      dirt track     |  9.79 | 26.35 |
|       apparel       | 33.33 | 48.77 |
|         pole        | 21.66 | 31.17 |
|         land        |  7.08 |  8.51 |
|      bannister      |  3.92 |  5.43 |
|      escalator      | 21.25 | 22.03 |
|       ottoman       | 45.09 | 54.02 |
|        bottle       | 14.19 | 21.49 |
|        buffet       | 49.26 | 58.87 |
|        poster       | 27.86 | 36.42 |
|        stage        |  9.33 | 12.32 |
|         van         | 46.23 | 60.16 |
|         ship        |  52.4 | 68.46 |
|       fountain      |  6.55 |  6.65 |
|    conveyer belt    | 57.33 | 80.63 |
|        canopy       | 19.94 | 21.37 |
|        washer       | 63.67 | 65.17 |
|      plaything      | 21.09 | 28.98 |
|    swimming pool    | 33.48 | 50.24 |
|        stool        | 31.71 | 44.97 |
|        barrel       | 27.94 | 51.69 |
|        basket       | 24.49 | 31.81 |
|      waterfall      | 66.63 | 81.03 |
|         tent        | 93.98 | 98.01 |
|         bag         |  7.95 |  8.79 |
|       minibike      | 58.03 | 67.68 |
|        cradle       | 75.41 | 97.55 |
|         oven        |  22.0 | 51.99 |
|         ball        | 43.01 | 54.44 |
|         food        | 54.36 | 69.27 |
|         step        |  8.1  |  9.6  |
|         tank        | 43.19 | 44.39 |
|      trade name     | 23.46 | 27.77 |
|      microwave      | 35.77 | 38.87 |
|         pot         | 37.34 | 43.48 |
|        animal       | 50.12 | 53.49 |
|       bicycle       | 45.41 | 65.87 |
|         lake        | 60.05 | 62.48 |
|      dishwasher     | 60.06 | 65.03 |
|        screen       | 60.59 | 73.38 |
|       blanket       |  4.64 |  4.84 |
|      sculpture      | 32.65 |  55.7 |
|         hood        | 55.46 | 66.44 |
|        sconce       | 36.01 | 41.48 |
|         vase        | 34.71 | 46.94 |
|    traffic light    |  25.3 | 31.56 |
|         tray        |  4.2  |  6.54 |
|        ashcan       | 35.11 |  42.4 |
|         fan         | 54.26 | 64.89 |
|         pier        | 11.94 | 13.75 |
|      crt screen     |  2.95 |  7.92 |
|        plate        | 40.59 | 50.97 |
|       monitor       | 16.78 | 19.64 |
|    bulletin board   | 41.76 | 50.94 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 34.86 | 37.93 |
|        glass        | 10.15 | 10.76 |
|        clock        | 23.61 | 26.64 |
|         flag        | 23.84 |  25.4 |
+---------------------+-------+-------+
09/21 09:46:13 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.6300  mIoU: 43.6600  mAcc: 53.9200  data_time: 0.0015  time: 0.2935
Finished processing corruption type: jpeg_compression
Runtime: 1726904774

============================= JOB FEEDBACK =============================

NodeName=uc2n485
Job ID: 24247159
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 07:24:26
CPU Efficiency: 5.14% of 6-00:03:12 core-walltime
Job Wall-clock time: 09:00:12
Memory Utilized: 3.46 GB
Memory Efficiency: 3.46% of 100.00 GB
