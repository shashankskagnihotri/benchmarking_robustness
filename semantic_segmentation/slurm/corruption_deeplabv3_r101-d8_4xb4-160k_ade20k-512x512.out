Started at Fri Sep 20 03:18:14 CEST 2024
/var/spool/slurmd/job24247146/slurm_script: line 15: activate: No such file or directory
Processing corruption type: gaussian_noise
09/20 03:18:25 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1245430746
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1245430746
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 03:18:25 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='gaussian_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/gaussian_noise'

09/20 03:18:34 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 03:18:34 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 03:18:34 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 03:18:34 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 03:20:04 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:58:29  time: 0.9291  data_time: 0.0016  memory: 17318  
09/20 03:20:55 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:44:21  time: 1.0790  data_time: 0.0017  memory: 17098  
09/20 03:21:22 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:34:24  time: 0.5457  data_time: 0.0017  memory: 17091  
09/20 03:22:02 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:31:03  time: 0.7151  data_time: 0.0017  memory: 17100  
09/20 03:22:37 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:28:19  time: 0.5181  data_time: 0.0016  memory: 17098  
09/20 03:23:05 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:25:33  time: 0.1923  data_time: 0.0016  memory: 17094  
09/20 03:23:41 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:24:07  time: 0.5153  data_time: 0.0015  memory: 17098  
09/20 03:24:08 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:22:15  time: 0.5502  data_time: 0.0015  memory: 17096  
09/20 03:24:19 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:19:46  time: 0.2462  data_time: 0.0015  memory: 17020  
09/20 03:24:33 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:17:54  time: 0.1602  data_time: 0.0015  memory: 17079  
09/20 03:24:49 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:16:27  time: 0.5918  data_time: 0.0016  memory: 17098  
09/20 03:25:00 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:15:00  time: 0.3688  data_time: 0.0016  memory: 17026  
09/20 03:25:21 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:14:03  time: 0.5523  data_time: 0.0014  memory: 17100  
09/20 03:25:45 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:13:18  time: 0.1541  data_time: 0.0016  memory: 17101  
09/20 03:26:09 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:37  time: 1.0842  data_time: 0.0015  memory: 17104  
09/20 03:26:21 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:39  time: 0.1409  data_time: 0.0016  memory: 17091  
09/20 03:26:31 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:43  time: 0.2267  data_time: 0.0016  memory: 878  
09/20 03:26:42 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:55  time: 0.3182  data_time: 0.0015  memory: 17017  
09/20 03:27:06 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:09:24  time: 0.3966  data_time: 0.0016  memory: 17097  
09/20 03:27:21 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:45  time: 0.1351  data_time: 0.0016  memory: 17074  
09/20 03:27:41 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:08:14  time: 0.7535  data_time: 0.0015  memory: 17101  
09/20 03:27:58 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:40  time: 0.1403  data_time: 0.0016  memory: 17088  
09/20 03:28:11 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:05  time: 0.3304  data_time: 0.0015  memory: 17080  
09/20 03:28:19 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:29  time: 0.2227  data_time: 0.0015  memory: 1991  
09/20 03:28:32 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:58  time: 0.2469  data_time: 0.0015  memory: 17091  
09/20 03:28:39 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:25  time: 0.1399  data_time: 0.0015  memory: 1630  
09/20 03:28:51 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:56  time: 0.1453  data_time: 0.0015  memory: 17076  
09/20 03:29:16 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:34  time: 0.5802  data_time: 0.0014  memory: 17095  
09/20 03:29:28 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:07  time: 0.5811  data_time: 0.0015  memory: 17083  
09/20 03:29:37 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:40  time: 0.1534  data_time: 0.0015  memory: 878  
09/20 03:29:47 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:15  time: 0.1453  data_time: 0.0015  memory: 17025  
09/20 03:29:55 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:50  time: 0.1570  data_time: 0.0016  memory: 1674  
09/20 03:30:12 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:27  time: 0.1306  data_time: 0.0014  memory: 17098  
09/20 03:30:28 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:05  time: 0.1647  data_time: 0.0016  memory: 17089  
09/20 03:30:42 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:43  time: 0.1452  data_time: 0.0014  memory: 17078  
09/20 03:30:55 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:22  time: 0.2365  data_time: 0.0016  memory: 17078  
09/20 03:31:02 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:00  time: 0.1528  data_time: 0.0016  memory: 878  
09/20 03:31:14 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:39  time: 0.1428  data_time: 0.0015  memory: 17101  
09/20 03:31:27 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:19  time: 0.1840  data_time: 0.0015  memory: 17082  
09/20 03:31:39 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1289  data_time: 0.0014  memory: 17030  
09/20 03:31:39 - mmengine - INFO - per class results:
09/20 03:31:39 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 59.87 |  89.7 |
|       building      | 73.56 | 86.01 |
|         sky         | 87.24 | 90.96 |
|        floor        | 65.06 | 86.08 |
|         tree        | 61.33 | 87.13 |
|       ceiling       | 69.55 | 78.51 |
|         road        | 59.75 | 67.69 |
|         bed         | 77.41 |  87.7 |
|      windowpane     | 45.31 | 57.59 |
|        grass        | 48.11 | 78.89 |
|       cabinet       | 38.19 | 47.03 |
|       sidewalk      | 33.33 | 36.04 |
|        person       | 64.49 | 81.74 |
|        earth        | 22.23 | 55.86 |
|         door        | 17.25 | 21.09 |
|        table        | 42.94 | 54.58 |
|       mountain      | 38.17 | 49.18 |
|        plant        | 33.22 | 61.61 |
|       curtain       | 47.96 | 62.44 |
|        chair        | 43.08 | 53.61 |
|         car         | 74.33 | 82.25 |
|        water        | 35.75 | 49.62 |
|       painting      | 60.67 | 70.19 |
|         sofa        | 56.77 | 75.38 |
|        shelf        | 25.36 | 32.44 |
|        house        |  9.55 | 10.18 |
|         sea         | 25.66 | 38.66 |
|        mirror       | 34.02 | 37.12 |
|         rug         | 23.34 | 24.11 |
|        field        |  7.16 | 10.31 |
|       armchair      | 31.47 | 44.97 |
|         seat        | 39.13 | 48.19 |
|        fence        | 22.02 | 32.98 |
|         desk        | 27.65 | 37.45 |
|         rock        | 26.34 | 50.01 |
|       wardrobe      | 28.71 | 37.29 |
|         lamp        | 52.31 |  60.8 |
|       bathtub       | 36.01 |  38.4 |
|       railing       | 23.82 | 28.19 |
|       cushion       | 36.96 | 42.77 |
|         base        |  5.24 |  5.77 |
|         box         |  9.63 | 11.59 |
|        column       | 32.96 | 48.43 |
|      signboard      | 28.05 | 38.63 |
|   chest of drawers  | 41.52 | 52.98 |
|       counter       | 11.82 | 21.46 |
|         sand        |  9.75 | 10.23 |
|         sink        | 40.97 | 48.04 |
|      skyscraper     | 36.13 | 40.55 |
|      fireplace      | 38.59 | 41.81 |
|     refrigerator    | 31.82 | 33.06 |
|      grandstand     | 25.69 | 49.11 |
|         path        | 14.81 | 21.08 |
|        stairs       | 22.95 | 40.73 |
|        runway       |  0.03 |  0.03 |
|         case        | 24.59 | 28.01 |
|      pool table     |  77.6 | 80.19 |
|        pillow       | 28.15 | 31.14 |
|     screen door     |  2.07 |  2.07 |
|       stairway      | 21.77 | 25.22 |
|        river        |  1.4  |  1.99 |
|        bridge       | 29.96 | 31.91 |
|       bookcase      | 21.89 | 26.96 |
|        blind        |  8.93 |  9.11 |
|     coffee table    | 47.69 | 55.88 |
|        toilet       | 27.99 | 28.32 |
|        flower       | 29.31 | 40.19 |
|         book        | 35.57 | 44.56 |
|         hill        |  4.37 |  9.21 |
|        bench        | 17.81 | 20.13 |
|      countertop     | 25.11 |  27.6 |
|        stove        | 35.07 | 35.83 |
|         palm        | 33.83 | 38.38 |
|    kitchen island   | 16.59 | 19.15 |
|       computer      | 22.34 | 22.89 |
|     swivel chair    | 15.14 | 16.24 |
|         boat        | 15.72 | 16.24 |
|         bar         | 19.63 | 23.47 |
|    arcade machine   |  6.24 |  6.29 |
|        hovel        | 35.74 | 37.53 |
|         bus         | 29.25 | 29.53 |
|        towel        | 18.93 | 20.86 |
|        light        | 20.47 | 21.12 |
|        truck        |  3.85 |  4.26 |
|        tower        | 13.89 | 18.34 |
|      chandelier     | 56.67 | 70.56 |
|        awning       |  8.32 |  8.48 |
|     streetlight     | 18.46 | 20.76 |
|        booth        | 23.27 | 27.63 |
| television receiver | 32.25 | 34.11 |
|       airplane      | 18.67 | 18.95 |
|      dirt track     |  4.96 |  9.31 |
|       apparel       | 24.07 | 33.69 |
|         pole        | 15.56 |  23.3 |
|         land        |  0.0  |  0.0  |
|      bannister      |  2.74 |  2.98 |
|      escalator      |  0.69 |  0.69 |
|       ottoman       | 23.87 | 26.72 |
|        bottle       | 15.45 | 16.96 |
|        buffet       |  3.93 |  4.08 |
|        poster       |  5.39 |  5.92 |
|        stage        |  9.16 | 10.98 |
|         van         | 35.79 | 40.92 |
|         ship        |  3.29 |  3.29 |
|       fountain      |  4.68 |  5.8  |
|    conveyer belt    | 25.48 | 25.88 |
|        canopy       |  1.21 |  1.23 |
|        washer       |  9.73 |  9.73 |
|      plaything      |  24.4 | 26.29 |
|    swimming pool    | 20.25 | 20.44 |
|        stool        | 27.73 | 46.17 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  13.4 | 15.04 |
|      waterfall      |  30.4 | 31.97 |
|         tent        |  2.95 |  2.96 |
|         bag         |  1.21 |  1.29 |
|       minibike      | 22.47 | 24.38 |
|        cradle       |  46.7 |  49.7 |
|         oven        | 14.76 | 16.93 |
|         ball        | 30.07 | 63.33 |
|         food        | 45.92 | 55.95 |
|         step        |  0.97 |  1.1  |
|         tank        |  18.3 | 18.38 |
|      trade name     | 10.26 | 10.73 |
|      microwave      | 14.01 |  14.1 |
|         pot         | 17.26 | 18.51 |
|        animal       | 43.62 | 45.83 |
|       bicycle       | 37.64 | 66.05 |
|         lake        |  1.4  |  1.4  |
|      dishwasher     | 35.76 | 36.07 |
|        screen       | 19.77 | 19.96 |
|       blanket       |  4.19 |  4.26 |
|      sculpture      |  5.12 |  5.65 |
|         hood        | 22.07 | 22.22 |
|        sconce       |  15.5 | 16.86 |
|         vase        | 37.04 | 47.47 |
|    traffic light    | 12.24 | 13.03 |
|         tray        |  4.04 |  5.08 |
|        ashcan       | 16.17 | 16.93 |
|         fan         | 39.31 | 42.48 |
|         pier        |  16.7 | 17.34 |
|      crt screen     |  2.76 |  3.71 |
|        plate        |  21.5 | 23.62 |
|       monitor       |  3.0  |  3.6  |
|    bulletin board   | 12.89 | 14.42 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  7.46 |  7.5  |
|        glass        |  5.99 |  6.39 |
|        clock        |  16.2 | 17.07 |
|         flag        | 13.32 | 13.75 |
+---------------------+-------+-------+
09/20 03:31:39 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 70.3400  mIoU: 25.5000  mAcc: 31.2700  data_time: 0.0018  time: 0.3919
Finished processing corruption type: gaussian_noise
Processing corruption type: shot_noise
09/20 03:31:42 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 923879016
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 923879016
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 03:31:42 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='shot_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/shot_noise'

09/20 03:31:46 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 03:31:46 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 03:31:47 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 03:31:47 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 03:33:19 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:59:50  time: 1.0160  data_time: 0.0016  memory: 17318  
09/20 03:34:11 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:45:42  time: 1.1692  data_time: 0.0017  memory: 17098  
09/20 03:34:42 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:35:56  time: 0.6383  data_time: 0.0015  memory: 17091  
09/20 03:35:24 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:32:35  time: 0.7671  data_time: 0.0015  memory: 17100  
09/20 03:36:04 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:29:56  time: 0.5626  data_time: 0.0015  memory: 17098  
09/20 03:36:35 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:27:09  time: 0.2615  data_time: 0.0016  memory: 17094  
09/20 03:37:14 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:25:43  time: 0.5416  data_time: 0.0015  memory: 17098  
09/20 03:37:45 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:23:52  time: 0.6436  data_time: 0.0014  memory: 17096  
09/20 03:37:59 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:21:22  time: 0.3141  data_time: 0.0015  memory: 17020  
09/20 03:38:17 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:19:30  time: 0.2110  data_time: 0.0015  memory: 17079  
09/20 03:38:37 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:18:01  time: 0.6310  data_time: 0.0015  memory: 17098  
09/20 03:38:51 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:16:29  time: 0.3887  data_time: 0.0016  memory: 17026  
09/20 03:39:16 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:15:31  time: 0.6262  data_time: 0.0014  memory: 17100  
09/20 03:39:43 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:14:43  time: 0.2297  data_time: 0.0016  memory: 17101  
09/20 03:40:11 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:14:00  time: 1.0565  data_time: 0.0015  memory: 17104  
09/20 03:40:26 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:12:57  time: 0.2136  data_time: 0.0016  memory: 17091  
09/20 03:40:37 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:11:56  time: 0.2175  data_time: 0.0016  memory: 878  
09/20 03:40:50 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:03  time: 0.2916  data_time: 0.0014  memory: 17017  
09/20 03:41:16 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:28  time: 0.4640  data_time: 0.0015  memory: 17097  
09/20 03:41:33 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:09:46  time: 0.2032  data_time: 0.0015  memory: 17074  
09/20 03:41:56 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:10  time: 0.7304  data_time: 0.0016  memory: 17101  
09/20 03:42:14 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:33  time: 0.2086  data_time: 0.0015  memory: 17088  
09/20 03:42:29 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:54  time: 0.3183  data_time: 0.0015  memory: 17080  
09/20 03:42:40 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:15  time: 0.2086  data_time: 0.0015  memory: 1991  
09/20 03:42:57 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:41  time: 0.3158  data_time: 0.0015  memory: 17091  
09/20 03:43:07 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:06  time: 0.2103  data_time: 0.0015  memory: 1630  
09/20 03:43:22 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:34  time: 0.2004  data_time: 0.0015  memory: 17076  
09/20 03:43:48 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:08  time: 0.6311  data_time: 0.0015  memory: 17095  
09/20 03:44:04 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:39  time: 0.5694  data_time: 0.0015  memory: 17083  
09/20 03:44:14 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:08  time: 0.1957  data_time: 0.0014  memory: 903  
09/20 03:44:27 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:40  time: 0.2171  data_time: 0.0015  memory: 17025  
09/20 03:44:37 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:12  time: 0.2054  data_time: 0.0016  memory: 1674  
09/20 03:44:55 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:47  time: 0.1937  data_time: 0.0014  memory: 17098  
09/20 03:45:12 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:22  time: 0.2172  data_time: 0.0016  memory: 17089  
09/20 03:45:29 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:57  time: 0.2405  data_time: 0.0014  memory: 17078  
09/20 03:45:42 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:32  time: 0.2200  data_time: 0.0016  memory: 17078  
09/20 03:45:53 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:08  time: 0.2141  data_time: 0.0016  memory: 878  
09/20 03:46:07 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:45  time: 0.2083  data_time: 0.0015  memory: 17101  
09/20 03:46:23 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:22  time: 0.2071  data_time: 0.0014  memory: 17082  
09/20 03:46:37 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1901  data_time: 0.0014  memory: 17030  
09/20 03:46:37 - mmengine - INFO - per class results:
09/20 03:46:37 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 59.23 | 90.12 |
|       building      | 74.19 | 86.77 |
|         sky         | 83.38 | 86.27 |
|        floor        | 64.79 | 87.04 |
|         tree        | 61.44 |  87.4 |
|       ceiling       | 64.14 | 72.65 |
|         road        | 60.02 | 67.35 |
|         bed         | 77.36 | 88.44 |
|      windowpane     | 42.53 | 54.69 |
|        grass        | 49.72 | 82.05 |
|       cabinet       | 38.82 | 47.96 |
|       sidewalk      | 31.47 | 34.31 |
|        person       | 65.63 | 84.12 |
|        earth        | 22.15 | 55.78 |
|         door        | 17.29 | 21.15 |
|        table        | 45.83 | 57.22 |
|       mountain      | 34.98 | 43.45 |
|        plant        | 38.49 | 60.06 |
|       curtain       | 46.54 | 60.26 |
|        chair        | 46.28 | 58.54 |
|         car         |  78.1 | 86.61 |
|        water        | 33.78 |  50.8 |
|       painting      |  58.4 | 68.76 |
|         sofa        | 57.61 | 75.58 |
|        shelf        | 28.18 | 37.64 |
|        house        | 11.42 | 12.31 |
|         sea         | 26.09 | 38.93 |
|        mirror       | 27.06 | 29.51 |
|         rug         | 24.68 | 25.83 |
|        field        |  5.61 |  7.73 |
|       armchair      | 31.77 | 47.11 |
|         seat        | 39.33 | 50.99 |
|        fence        |  22.8 | 33.62 |
|         desk        | 27.32 | 36.17 |
|         rock        | 30.51 | 62.24 |
|       wardrobe      | 25.28 | 32.96 |
|         lamp        | 49.23 | 57.62 |
|       bathtub       | 23.95 |  25.4 |
|       railing       | 25.62 |  30.7 |
|       cushion       | 35.61 | 41.03 |
|         base        |  7.28 |  8.12 |
|         box         |  8.95 | 10.62 |
|        column       | 30.74 |  45.6 |
|      signboard      | 29.35 | 39.07 |
|   chest of drawers  | 40.49 | 53.05 |
|       counter       | 14.35 | 24.47 |
|         sand        |  6.8  |  7.0  |
|         sink        |  33.9 | 39.19 |
|      skyscraper     | 46.27 | 52.55 |
|      fireplace      | 40.62 | 46.79 |
|     refrigerator    | 28.84 | 29.53 |
|      grandstand     | 28.85 | 52.01 |
|         path        |  14.4 | 19.96 |
|        stairs       | 24.18 | 40.93 |
|        runway       |  0.0  |  0.0  |
|         case        | 26.41 | 29.01 |
|      pool table     | 87.31 | 90.67 |
|        pillow       | 24.94 | 28.17 |
|     screen door     |  7.2  |  7.2  |
|       stairway      | 24.84 | 28.38 |
|        river        |  2.03 |  2.53 |
|        bridge       | 23.78 |  25.6 |
|       bookcase      | 24.54 | 31.17 |
|        blind        | 10.65 | 10.76 |
|     coffee table    |  48.7 | 57.46 |
|        toilet       | 19.65 | 19.75 |
|        flower       |  27.5 |  38.3 |
|         book        | 33.97 | 42.29 |
|         hill        |  3.63 |  7.23 |
|        bench        | 23.25 | 26.75 |
|      countertop     | 23.14 | 25.09 |
|        stove        | 38.31 |  39.4 |
|         palm        | 38.54 | 44.26 |
|    kitchen island   | 14.71 | 17.88 |
|       computer      | 18.81 | 19.37 |
|     swivel chair    | 26.28 | 29.16 |
|         boat        | 16.55 | 17.17 |
|         bar         | 12.77 | 16.02 |
|    arcade machine   |  14.7 | 15.11 |
|        hovel        | 38.95 | 41.03 |
|         bus         | 43.93 | 45.21 |
|        towel        |  9.85 | 10.83 |
|        light        | 16.32 | 16.75 |
|        truck        |  8.14 |  8.72 |
|        tower        |  6.83 |  9.42 |
|      chandelier     | 51.36 | 65.56 |
|        awning       | 10.81 | 11.21 |
|     streetlight     | 19.94 | 22.98 |
|        booth        | 23.01 |  28.8 |
| television receiver | 49.48 | 53.72 |
|       airplane      | 13.79 | 13.93 |
|      dirt track     |  0.07 |  0.13 |
|       apparel       | 22.52 | 32.22 |
|         pole        | 20.68 | 31.18 |
|         land        |  0.0  |  0.0  |
|      bannister      |  3.25 |  3.68 |
|      escalator      |  0.85 |  0.85 |
|       ottoman       | 21.26 | 24.03 |
|        bottle       | 14.99 | 16.59 |
|        buffet       | 19.88 | 20.33 |
|        poster       |  4.55 |  4.84 |
|        stage        |  7.49 |  9.22 |
|         van         | 39.04 | 45.61 |
|         ship        |  2.53 |  2.54 |
|       fountain      |  6.29 |  7.28 |
|    conveyer belt    | 15.78 | 16.21 |
|        canopy       |  0.26 |  0.26 |
|        washer       | 14.59 | 14.59 |
|      plaything      | 21.92 | 23.27 |
|    swimming pool    | 19.14 | 19.43 |
|        stool        | 29.33 | 51.75 |
|        barrel       |  0.08 |  0.24 |
|        basket       | 15.74 | 18.56 |
|      waterfall      | 20.42 | 21.14 |
|         tent        |  1.39 |  1.39 |
|         bag         |  1.36 |  1.46 |
|       minibike      | 23.69 | 25.57 |
|        cradle       | 43.23 | 46.06 |
|         oven        | 14.73 | 19.11 |
|         ball        | 28.03 | 64.23 |
|         food        | 46.37 | 55.84 |
|         step        |  4.63 |  5.41 |
|         tank        |  12.7 | 12.72 |
|      trade name     | 11.42 | 12.12 |
|      microwave      | 18.34 | 18.46 |
|         pot         | 25.95 | 27.47 |
|        animal       | 43.52 | 45.56 |
|       bicycle       | 39.19 | 68.59 |
|         lake        |  0.09 |  0.09 |
|      dishwasher     | 36.57 | 36.94 |
|        screen       | 19.86 | 19.86 |
|       blanket       |  5.94 |  5.98 |
|      sculpture      |  7.61 |  8.55 |
|         hood        | 20.03 | 20.18 |
|        sconce       | 13.21 | 13.91 |
|         vase        | 35.33 | 46.85 |
|    traffic light    | 13.97 | 15.36 |
|         tray        |  4.23 |  5.49 |
|        ashcan       | 20.08 | 21.04 |
|         fan         | 37.34 | 39.91 |
|         pier        |  6.86 |  7.02 |
|      crt screen     |  3.32 |  6.42 |
|        plate        | 19.79 | 21.86 |
|       monitor       |  7.18 |  8.6  |
|    bulletin board   | 13.97 | 15.53 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  6.82 |  6.87 |
|        glass        |  6.65 |  6.98 |
|        clock        | 15.49 | 16.22 |
|         flag        | 12.34 | 12.73 |
+---------------------+-------+-------+
09/20 03:46:37 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 70.0300  mIoU: 25.6500  mAcc: 31.6500  data_time: 0.0017  time: 0.4450
Finished processing corruption type: shot_noise
Processing corruption type: impulse_noise
09/20 03:46:40 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 586150025
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 586150025
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 03:46:40 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='impulse_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/impulse_noise'

09/20 03:46:44 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 03:46:44 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 03:46:45 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 03:46:45 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 03:48:10 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:54:58  time: 0.8649  data_time: 0.0016  memory: 17318  
09/20 03:48:56 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:41:29  time: 1.0488  data_time: 0.0016  memory: 17098  
09/20 03:49:22 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:32:12  time: 0.6090  data_time: 0.0016  memory: 17091  
09/20 03:49:59 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:29:06  time: 0.6419  data_time: 0.0016  memory: 17100  
09/20 03:50:32 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:27  time: 0.4488  data_time: 0.0015  memory: 17098  
09/20 03:50:59 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:59  time: 0.2077  data_time: 0.0016  memory: 17094  
09/20 03:51:33 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:38  time: 0.4558  data_time: 0.0015  memory: 17098  
09/20 03:51:59 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:56  time: 0.5518  data_time: 0.0015  memory: 17096  
09/20 03:52:09 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:36  time: 0.2306  data_time: 0.0015  memory: 17020  
09/20 03:52:22 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:50  time: 0.1262  data_time: 0.0015  memory: 17079  
09/20 03:52:37 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:26  time: 0.5380  data_time: 0.0016  memory: 17098  
09/20 03:52:46 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:02  time: 0.2946  data_time: 0.0017  memory: 17026  
09/20 03:53:05 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:09  time: 0.5368  data_time: 0.0015  memory: 17100  
09/20 03:53:27 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:26  time: 0.1358  data_time: 0.0017  memory: 17101  
09/20 03:53:50 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:47  time: 0.9759  data_time: 0.0015  memory: 17104  
09/20 03:54:00 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:51  time: 0.1235  data_time: 0.0016  memory: 17091  
09/20 03:54:06 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:57  time: 0.1250  data_time: 0.0016  memory: 878  
09/20 03:54:16 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:10  time: 0.2157  data_time: 0.0015  memory: 17017  
09/20 03:54:36 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:40  time: 0.3294  data_time: 0.0016  memory: 17097  
09/20 03:54:49 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:03  time: 0.1173  data_time: 0.0015  memory: 17074  
09/20 03:55:06 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:33  time: 0.6364  data_time: 0.0016  memory: 17101  
09/20 03:55:20 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:01  time: 0.1245  data_time: 0.0016  memory: 17088  
09/20 03:55:30 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:28  time: 0.2293  data_time: 0.0015  memory: 17080  
09/20 03:55:37 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:54  time: 0.1225  data_time: 0.0015  memory: 1991  
09/20 03:55:48 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:25  time: 0.2303  data_time: 0.0015  memory: 17091  
09/20 03:55:54 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:55  time: 0.1236  data_time: 0.0015  memory: 1630  
09/20 03:56:04 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:28  time: 0.1175  data_time: 0.0016  memory: 17076  
09/20 03:56:26 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:09  time: 0.6051  data_time: 0.0015  memory: 17095  
09/20 03:56:37 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:44  time: 0.4807  data_time: 0.0015  memory: 17083  
09/20 03:56:43 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:19  time: 0.1158  data_time: 0.0015  memory: 891  
09/20 03:56:51 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:55  time: 0.1276  data_time: 0.0015  memory: 17025  
09/20 03:56:57 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:33  time: 0.1209  data_time: 0.0016  memory: 1674  
09/20 03:57:11 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:12  time: 0.1144  data_time: 0.0014  memory: 17098  
09/20 03:57:24 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:52  time: 0.1240  data_time: 0.0016  memory: 17089  
09/20 03:57:36 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:32  time: 0.1289  data_time: 0.0015  memory: 17078  
09/20 03:57:45 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:13  time: 0.1242  data_time: 0.0016  memory: 17078  
09/20 03:57:51 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:53  time: 0.1230  data_time: 0.0017  memory: 878  
09/20 03:58:01 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:35  time: 0.1278  data_time: 0.0016  memory: 17101  
09/20 03:58:12 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.1194  data_time: 0.0015  memory: 17082  
09/20 03:58:22 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1129  data_time: 0.0014  memory: 17030  
09/20 03:58:22 - mmengine - INFO - per class results:
09/20 03:58:22 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 53.94 | 90.82 |
|       building      | 70.77 | 81.15 |
|         sky         | 73.27 | 75.98 |
|        floor        |  57.8 | 83.77 |
|         tree        | 57.92 | 84.38 |
|       ceiling       | 62.86 |  72.3 |
|         road        | 51.44 | 55.92 |
|         bed         | 69.08 | 77.69 |
|      windowpane     | 41.75 | 52.49 |
|        grass        | 47.46 | 83.89 |
|       cabinet       | 23.63 | 26.98 |
|       sidewalk      | 33.84 | 37.65 |
|        person       |  57.2 | 67.74 |
|        earth        | 19.62 | 50.73 |
|         door        | 11.24 | 13.18 |
|        table        |  35.3 |  43.6 |
|       mountain      | 32.32 | 43.48 |
|        plant        | 30.76 | 60.37 |
|       curtain       | 44.82 | 54.25 |
|        chair        | 31.67 | 34.53 |
|         car         | 70.56 | 77.88 |
|        water        | 16.88 |  62.8 |
|       painting      |  56.2 | 66.43 |
|         sofa        | 50.18 | 63.22 |
|        shelf        | 26.84 | 37.43 |
|        house        |  4.95 |  5.1  |
|         sea         | 14.12 | 20.17 |
|        mirror       | 22.66 | 24.06 |
|         rug         | 13.02 | 13.28 |
|        field        |  2.97 |  3.62 |
|       armchair      | 24.99 | 32.83 |
|         seat        | 26.47 | 30.55 |
|        fence        |  22.2 | 29.59 |
|         desk        |  19.0 | 21.51 |
|         rock        | 18.81 | 55.09 |
|       wardrobe      |  9.11 | 10.97 |
|         lamp        | 43.81 | 48.41 |
|       bathtub       | 17.95 | 19.65 |
|       railing       | 21.86 | 26.54 |
|       cushion       | 27.79 | 31.31 |
|         base        |  5.51 |  6.66 |
|         box         |  9.47 | 12.76 |
|        column       | 26.11 | 38.81 |
|      signboard      | 27.39 | 38.59 |
|   chest of drawers  | 18.61 | 22.25 |
|       counter       |  4.61 |  6.75 |
|         sand        |  9.5  | 10.14 |
|         sink        | 24.66 | 32.35 |
|      skyscraper     |  5.32 |  5.46 |
|      fireplace      | 35.35 | 38.53 |
|     refrigerator    | 12.51 | 12.58 |
|      grandstand     | 24.78 | 58.46 |
|         path        | 14.28 | 18.56 |
|        stairs       | 21.69 | 39.53 |
|        runway       |  0.0  |  0.0  |
|         case        | 14.32 | 15.39 |
|      pool table     | 53.64 | 54.69 |
|        pillow       | 18.42 | 19.54 |
|     screen door     |  0.78 |  0.78 |
|       stairway      | 17.79 | 18.64 |
|        river        |  0.75 |  0.97 |
|        bridge       | 14.18 |  14.7 |
|       bookcase      |  13.2 | 14.54 |
|        blind        |  2.2  |  2.22 |
|     coffee table    | 31.83 | 35.83 |
|        toilet       | 14.15 | 14.22 |
|        flower       | 25.62 | 36.17 |
|         book        | 32.31 | 38.43 |
|         hill        |  4.98 | 10.39 |
|        bench        | 19.32 | 20.24 |
|      countertop     | 19.12 | 19.92 |
|        stove        | 28.55 | 29.37 |
|         palm        | 33.63 | 38.07 |
|    kitchen island   | 17.16 | 17.66 |
|       computer      | 16.53 | 16.68 |
|     swivel chair    |  7.68 |  7.76 |
|         boat        | 11.92 | 12.12 |
|         bar         |  3.47 |  3.53 |
|    arcade machine   |  6.93 |  7.06 |
|        hovel        |  32.6 |  35.1 |
|         bus         | 22.08 | 22.41 |
|        towel        |  3.26 |  3.28 |
|        light        | 10.91 | 10.97 |
|        truck        |  3.43 |  3.88 |
|        tower        | 15.38 | 23.89 |
|      chandelier     |  44.2 | 64.41 |
|        awning       |  7.69 |  7.88 |
|     streetlight     | 16.71 | 18.75 |
|        booth        |  22.3 | 28.16 |
| television receiver | 13.21 | 13.52 |
|       airplane      | 10.14 | 10.21 |
|      dirt track     |  3.72 |  7.32 |
|       apparel       | 21.06 | 27.07 |
|         pole        | 15.86 | 24.84 |
|         land        |  0.1  |  0.1  |
|      bannister      |  2.69 |  3.13 |
|      escalator      |  1.13 |  1.15 |
|       ottoman       |  9.17 |  9.78 |
|        bottle       | 11.09 | 11.74 |
|        buffet       |  3.01 |  3.14 |
|        poster       |  5.93 |  6.73 |
|        stage        |  8.22 |  9.2  |
|         van         | 39.69 | 46.71 |
|         ship        |  2.58 |  2.59 |
|       fountain      |  4.01 |  6.09 |
|    conveyer belt    | 12.82 | 12.85 |
|        canopy       |  0.88 |  0.89 |
|        washer       |  4.45 |  4.45 |
|      plaything      | 15.84 |  18.2 |
|    swimming pool    | 15.67 | 15.88 |
|        stool        | 18.62 | 27.26 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 11.65 | 12.97 |
|      waterfall      | 19.42 | 19.78 |
|         tent        |  1.11 |  1.11 |
|         bag         |  1.28 |  1.34 |
|       minibike      | 24.34 | 26.18 |
|        cradle       | 14.35 | 15.11 |
|         oven        | 11.84 | 14.17 |
|         ball        | 30.46 | 65.45 |
|         food        | 44.67 |  55.4 |
|         step        |  0.01 |  0.01 |
|         tank        |  6.52 |  6.73 |
|      trade name     |  7.19 |  7.52 |
|      microwave      | 10.33 | 10.37 |
|         pot         | 14.49 | 15.42 |
|        animal       | 16.21 | 16.54 |
|       bicycle       | 36.46 | 62.67 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 15.57 | 15.65 |
|        screen       |  1.72 |  1.72 |
|       blanket       |  0.09 |  0.09 |
|      sculpture      |  3.64 |  3.89 |
|         hood        | 12.89 | 12.92 |
|        sconce       |  11.1 | 11.43 |
|         vase        | 32.71 | 40.36 |
|    traffic light    | 10.42 | 10.96 |
|         tray        |  3.58 |  4.82 |
|        ashcan       | 10.27 | 10.51 |
|         fan         | 31.01 | 32.47 |
|         pier        |  5.67 |  5.76 |
|      crt screen     |  3.5  |  7.43 |
|        plate        | 19.43 | 21.59 |
|       monitor       |  1.38 |  1.52 |
|    bulletin board   |  8.27 |  9.6  |
|        shower       |  0.0  |  0.0  |
|       radiator      |  6.56 |  6.56 |
|        glass        |  6.45 |  6.91 |
|        clock        | 14.02 | 15.21 |
|         flag        |  9.89 |  9.96 |
+---------------------+-------+-------+
09/20 03:58:22 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 64.5300  mIoU: 19.4800  mAcc: 24.6900  data_time: 0.0017  time: 0.3484
Finished processing corruption type: impulse_noise
Processing corruption type: defocus_blur
09/20 03:58:26 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1698552253
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1698552253
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 03:58:26 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='defocus_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/defocus_blur'

09/20 03:58:29 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 03:58:29 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 03:58:30 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 03:58:30 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 03:59:55 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:55:02  time: 0.8668  data_time: 0.0016  memory: 17318  
09/20 04:00:42 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:41:43  time: 1.0805  data_time: 0.0017  memory: 17098  
09/20 04:01:07 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:32:15  time: 0.5349  data_time: 0.0016  memory: 17091  
09/20 04:01:46 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:29:21  time: 0.7177  data_time: 0.0016  memory: 17100  
09/20 04:02:19 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:40  time: 0.4513  data_time: 0.0016  memory: 17098  
09/20 04:02:46 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:24:06  time: 0.1399  data_time: 0.0017  memory: 17094  
09/20 04:03:19 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:42  time: 0.4590  data_time: 0.0016  memory: 17098  
09/20 04:03:45 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:59  time: 0.5385  data_time: 0.0014  memory: 17096  
09/20 04:03:55 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:39  time: 0.2356  data_time: 0.0015  memory: 17020  
09/20 04:04:08 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:53  time: 0.1294  data_time: 0.0015  memory: 17079  
09/20 04:04:24 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:31  time: 0.5424  data_time: 0.0016  memory: 17098  
09/20 04:04:34 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:07  time: 0.2988  data_time: 0.0016  memory: 17026  
09/20 04:04:54 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:16  time: 0.5476  data_time: 0.0014  memory: 17100  
09/20 04:05:16 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:33  time: 0.1397  data_time: 0.0016  memory: 17101  
09/20 04:05:39 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:54  time: 1.0181  data_time: 0.0015  memory: 17104  
09/20 04:05:49 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:58  time: 0.1270  data_time: 0.0016  memory: 17091  
09/20 04:05:56 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:02  time: 0.1282  data_time: 0.0016  memory: 878  
09/20 04:06:05 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:15  time: 0.2196  data_time: 0.0014  memory: 17017  
09/20 04:06:26 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:45  time: 0.3520  data_time: 0.0015  memory: 17097  
09/20 04:06:39 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:08  time: 0.1227  data_time: 0.0015  memory: 17074  
09/20 04:06:57 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:38  time: 0.6417  data_time: 0.0015  memory: 17101  
09/20 04:07:11 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:05  time: 0.1275  data_time: 0.0015  memory: 17088  
09/20 04:07:22 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:32  time: 0.2329  data_time: 0.0015  memory: 17080  
09/20 04:07:29 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:58  time: 0.1254  data_time: 0.0016  memory: 1991  
09/20 04:07:40 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:29  time: 0.2337  data_time: 0.0015  memory: 17091  
09/20 04:07:47 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:59  time: 0.1777  data_time: 0.0015  memory: 1630  
09/20 04:07:57 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:32  time: 0.1221  data_time: 0.0015  memory: 17076  
09/20 04:08:19 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:12  time: 0.5421  data_time: 0.0015  memory: 17095  
09/20 04:08:30 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:47  time: 0.4816  data_time: 0.0015  memory: 17083  
09/20 04:08:36 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:21  time: 0.1198  data_time: 0.0015  memory: 903  
09/20 04:08:44 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:58  time: 0.1314  data_time: 0.0015  memory: 17025  
09/20 04:08:51 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:35  time: 0.1244  data_time: 0.0016  memory: 1674  
09/20 04:09:05 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:14  time: 0.1194  data_time: 0.0024  memory: 17098  
09/20 04:09:18 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:54  time: 0.1270  data_time: 0.0016  memory: 17089  
09/20 04:09:30 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:34  time: 0.1304  data_time: 0.0014  memory: 17078  
09/20 04:09:39 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:14  time: 0.1287  data_time: 0.0016  memory: 17078  
09/20 04:09:45 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:54  time: 0.1270  data_time: 0.0016  memory: 878  
09/20 04:09:56 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:36  time: 0.1310  data_time: 0.0015  memory: 17101  
09/20 04:10:07 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.1229  data_time: 0.0015  memory: 17082  
09/20 04:10:17 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1170  data_time: 0.0014  memory: 17030  
09/20 04:10:17 - mmengine - INFO - per class results:
09/20 04:10:17 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.64 | 87.75 |
|       building      | 78.08 | 92.78 |
|         sky         | 92.86 | 96.15 |
|        floor        | 77.01 | 88.92 |
|         tree        | 70.66 | 85.07 |
|       ceiling       | 81.02 | 88.32 |
|         road        | 79.47 | 90.92 |
|         bed         |  85.8 | 94.19 |
|      windowpane     | 56.78 | 76.21 |
|        grass        | 64.64 |  81.6 |
|       cabinet       |  55.3 | 67.39 |
|       sidewalk      | 58.83 | 69.83 |
|        person       | 71.52 | 87.36 |
|        earth        | 29.18 | 40.86 |
|         door        | 41.48 |  50.7 |
|        table        | 52.94 | 70.04 |
|       mountain      | 50.02 | 67.44 |
|        plant        | 43.91 | 57.32 |
|       curtain       | 67.24 | 77.42 |
|        chair        | 50.61 | 65.77 |
|         car         | 78.81 | 87.73 |
|        water        | 45.41 | 54.39 |
|       painting      | 65.88 | 81.84 |
|         sofa        | 60.26 | 77.47 |
|        shelf        | 38.32 | 57.53 |
|        house        | 42.61 | 53.37 |
|         sea         | 53.04 | 83.13 |
|        mirror       | 60.74 | 70.05 |
|         rug         |  52.4 | 62.39 |
|        field        | 27.34 | 43.37 |
|       armchair      |  40.7 | 59.14 |
|         seat        | 49.12 | 67.94 |
|        fence        | 35.67 | 46.79 |
|         desk        | 41.68 | 55.93 |
|         rock        | 42.25 |  64.5 |
|       wardrobe      | 44.22 | 64.76 |
|         lamp        | 55.83 |  71.0 |
|       bathtub       |  70.2 | 76.02 |
|       railing       | 28.43 |  42.5 |
|       cushion       | 50.03 | 61.03 |
|         base        | 22.91 | 33.18 |
|         box         | 16.71 |  21.1 |
|        column       | 41.97 | 53.17 |
|      signboard      | 26.62 | 33.98 |
|   chest of drawers  | 39.95 |  53.7 |
|       counter       | 21.61 | 27.16 |
|         sand        | 22.95 | 32.12 |
|         sink        | 61.69 | 73.04 |
|      skyscraper     | 46.14 | 54.52 |
|      fireplace      | 60.77 | 76.25 |
|     refrigerator    | 70.56 | 78.51 |
|      grandstand     | 37.84 | 66.28 |
|         path        | 19.11 | 27.61 |
|        stairs       | 26.97 |  31.3 |
|        runway       |  66.1 | 90.11 |
|         case        | 43.82 | 65.55 |
|      pool table     | 89.84 | 94.99 |
|        pillow       |  48.6 | 56.18 |
|     screen door     | 55.88 | 61.57 |
|       stairway      | 26.88 | 34.23 |
|        river        |  9.22 | 16.34 |
|        bridge       | 32.52 | 36.41 |
|       bookcase      |  35.2 | 52.25 |
|        blind        | 21.42 | 21.97 |
|     coffee table    | 55.04 | 78.55 |
|        toilet       | 78.14 | 83.72 |
|        flower       | 24.79 | 43.72 |
|         book        | 36.22 | 49.96 |
|         hill        |  4.32 |  7.71 |
|        bench        | 44.39 |  50.1 |
|      countertop     | 53.29 | 67.55 |
|        stove        | 70.43 | 77.73 |
|         palm        | 47.58 | 58.83 |
|    kitchen island   |  37.3 | 63.76 |
|       computer      | 52.03 | 59.77 |
|     swivel chair    | 46.08 | 63.09 |
|         boat        | 32.78 | 47.36 |
|         bar         | 29.41 | 38.04 |
|    arcade machine   | 44.72 | 49.26 |
|        hovel        | 19.37 | 21.01 |
|         bus         | 78.34 | 88.16 |
|        towel        | 43.83 | 50.26 |
|        light        | 45.68 | 56.46 |
|        truck        | 16.95 |  22.5 |
|        tower        |  7.66 |  10.4 |
|      chandelier     | 62.45 | 77.12 |
|        awning       | 20.68 | 23.25 |
|     streetlight     | 20.74 | 28.56 |
|        booth        | 48.94 | 52.74 |
| television receiver | 39.46 | 67.67 |
|       airplane      | 53.39 |  68.6 |
|      dirt track     |  9.97 | 17.34 |
|       apparel       | 24.16 | 33.38 |
|         pole        | 16.56 |  20.9 |
|         land        |  1.24 |  2.39 |
|      bannister      |  2.73 |  4.06 |
|      escalator      | 16.42 | 18.11 |
|       ottoman       | 41.21 | 55.45 |
|        bottle       | 12.94 | 17.22 |
|        buffet       | 40.53 | 44.21 |
|        poster       | 23.08 | 26.83 |
|        stage        |  6.43 |  9.96 |
|         van         | 29.96 | 34.46 |
|         ship        |  52.4 | 68.74 |
|       fountain      | 16.55 |  19.7 |
|    conveyer belt    | 80.74 | 91.13 |
|        canopy       | 19.95 | 22.49 |
|        washer       | 60.56 | 64.37 |
|      plaything      | 20.05 | 43.81 |
|    swimming pool    | 33.42 |  48.3 |
|        stool        | 38.85 | 48.31 |
|        barrel       | 54.69 | 59.89 |
|        basket       | 14.98 | 15.91 |
|      waterfall      | 56.37 | 95.32 |
|         tent        |  87.5 | 98.96 |
|         bag         |  4.95 |  5.84 |
|       minibike      | 62.56 | 75.11 |
|        cradle       | 73.53 | 97.39 |
|         oven        | 29.83 |  34.7 |
|         ball        | 36.18 | 64.18 |
|         food        | 48.31 | 56.98 |
|         step        |  3.19 |  4.19 |
|         tank        | 34.37 | 35.17 |
|      trade name     |  17.2 | 18.27 |
|      microwave      | 36.73 | 39.07 |
|         pot         | 37.62 | 45.37 |
|        animal       | 44.72 | 49.61 |
|       bicycle       | 40.34 |  50.7 |
|         lake        | 29.58 | 62.01 |
|      dishwasher     | 63.66 | 66.06 |
|        screen       | 58.51 | 75.74 |
|       blanket       |  7.31 |  8.18 |
|      sculpture      | 20.39 |  26.3 |
|         hood        | 59.15 | 64.43 |
|        sconce       | 35.16 |  47.6 |
|         vase        | 31.28 | 40.28 |
|    traffic light    | 22.83 | 44.33 |
|         tray        |  5.39 |  7.53 |
|        ashcan       | 32.06 | 43.32 |
|         fan         | 49.04 | 56.55 |
|         pier        | 13.64 | 15.85 |
|      crt screen     |  6.02 |  12.1 |
|        plate        | 33.01 | 42.79 |
|       monitor       | 37.21 |  49.7 |
|    bulletin board   | 32.77 | 36.38 |
|        shower       |  0.8  |  1.74 |
|       radiator      | 34.96 | 36.67 |
|        glass        |  4.58 |  4.75 |
|        clock        | 28.56 | 31.03 |
|         flag        | 23.09 | 25.21 |
+---------------------+-------+-------+
09/20 04:10:17 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.5600  mIoU: 41.2100  mAcc: 51.6700  data_time: 0.0017  time: 0.3534
Finished processing corruption type: defocus_blur
Processing corruption type: glass_blur
09/20 04:10:20 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1744482676
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1744482676
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 04:10:21 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='glass_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/glass_blur'

09/20 04:10:24 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 04:10:24 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 04:10:25 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 04:10:25 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 04:16:57 - mmengine - INFO - Iter(test) [  50/2000]    eta: 4:14:48  time: 7.3883  data_time: 0.0017  memory: 17318  
09/20 04:22:44 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 3:54:05  time: 7.3100  data_time: 0.0018  memory: 17098  
09/20 04:28:12 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 3:39:22  time: 6.7653  data_time: 0.0017  memory: 17091  
09/20 04:33:56 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 3:31:41  time: 6.6269  data_time: 0.0016  memory: 17100  
09/20 04:39:21 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 3:22:33  time: 6.3540  data_time: 0.0016  memory: 17098  
09/20 04:44:39 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 3:13:59  time: 6.2702  data_time: 0.0017  memory: 17094  
09/20 04:50:12 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 3:07:31  time: 6.1564  data_time: 0.0016  memory: 17098  
09/20 04:55:34 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 3:00:34  time: 6.6253  data_time: 0.0018  memory: 17096  
09/20 05:00:16 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 2:51:43  time: 5.7408  data_time: 0.0015  memory: 17020  
09/20 05:05:26 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 2:45:03  time: 5.9126  data_time: 0.0015  memory: 17079  
09/20 05:10:55 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 2:39:29  time: 6.8085  data_time: 0.0016  memory: 17098  
09/20 05:16:20 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 2:33:48  time: 7.7656  data_time: 0.1217  memory: 17026  
09/20 05:21:42 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 2:28:02  time: 6.6374  data_time: 0.0015  memory: 17100  
09/20 05:27:23 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 2:22:55  time: 6.4785  data_time: 0.0017  memory: 17101  
09/20 05:32:57 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 2:17:33  time: 6.9702  data_time: 0.0015  memory: 17104  
09/20 05:37:55 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 2:11:15  time: 6.2737  data_time: 0.0017  memory: 17091  
09/20 05:43:11 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 2:05:30  time: 6.3383  data_time: 0.0018  memory: 878  
09/20 05:48:03 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 1:59:19  time: 5.6869  data_time: 0.0016  memory: 17017  
09/20 05:53:35 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 1:54:01  time: 6.3411  data_time: 0.0017  memory: 17097  
09/20 05:58:43 - mmengine - INFO - Iter(test) [1000/2000]    eta: 1:48:17  time: 6.0166  data_time: 0.0016  memory: 17074  
09/20 06:04:15 - mmengine - INFO - Iter(test) [1050/2000]    eta: 1:42:59  time: 7.0530  data_time: 0.0016  memory: 17101  
09/20 06:09:37 - mmengine - INFO - Iter(test) [1100/2000]    eta: 1:37:31  time: 6.1980  data_time: 0.0017  memory: 17088  
09/20 06:14:49 - mmengine - INFO - Iter(test) [1150/2000]    eta: 1:31:56  time: 6.3909  data_time: 0.0016  memory: 17080  
09/20 06:20:09 - mmengine - INFO - Iter(test) [1200/2000]    eta: 1:26:29  time: 6.1377  data_time: 0.0043  memory: 1991  
09/20 06:25:22 - mmengine - INFO - Iter(test) [1250/2000]    eta: 1:20:58  time: 6.1880  data_time: 0.0016  memory: 17091  
09/20 06:30:20 - mmengine - INFO - Iter(test) [1300/2000]    eta: 1:15:20  time: 6.5636  data_time: 0.0016  memory: 1630  
09/20 06:35:32 - mmengine - INFO - Iter(test) [1350/2000]    eta: 1:09:52  time: 5.8016  data_time: 0.0016  memory: 17076  
09/20 06:40:59 - mmengine - INFO - Iter(test) [1400/2000]    eta: 1:04:31  time: 6.9554  data_time: 0.0016  memory: 17095  
09/20 06:46:02 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:59:01  time: 6.8304  data_time: 0.0016  memory: 17083  
09/20 06:51:05 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:53:33  time: 5.8274  data_time: 0.0017  memory: 878  
09/20 06:56:34 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:48:14  time: 6.4190  data_time: 0.0016  memory: 17025  
09/20 07:01:38 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:42:48  time: 6.1902  data_time: 0.0017  memory: 1674  
09/20 07:06:51 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:37:25  time: 5.7590  data_time: 0.0015  memory: 17098  
09/20 07:12:14 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:32:05  time: 6.2922  data_time: 0.0017  memory: 17089  
09/20 07:17:40 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:26:44  time: 6.2230  data_time: 0.0016  memory: 17078  
09/20 07:22:45 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:21:22  time: 6.4246  data_time: 0.0017  memory: 17078  
09/20 07:28:02 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:16:01  time: 6.3260  data_time: 0.0017  memory: 878  
09/20 07:33:02 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:10:39  time: 6.1270  data_time: 0.0016  memory: 17101  
09/20 07:38:25 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:05:19  time: 6.0994  data_time: 0.0015  memory: 17082  
09/20 07:43:30 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 5.7138  data_time: 0.0014  memory: 17030  
09/20 07:43:30 - mmengine - INFO - per class results:
09/20 07:43:30 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.63 | 88.68 |
|       building      | 78.41 | 93.08 |
|         sky         | 93.14 | 96.96 |
|        floor        | 77.92 | 88.41 |
|         tree        | 70.36 | 85.79 |
|       ceiling       | 81.49 | 89.99 |
|         road        | 80.18 | 90.79 |
|         bed         | 86.69 | 94.45 |
|      windowpane     | 56.98 | 75.22 |
|        grass        | 64.31 | 82.27 |
|       cabinet       | 53.33 |  65.0 |
|       sidewalk      | 57.72 | 66.73 |
|        person       | 72.82 | 89.31 |
|        earth        | 27.94 | 43.88 |
|         door        | 37.43 | 42.49 |
|        table        | 56.25 | 72.48 |
|       mountain      |  49.4 |  67.6 |
|        plant        | 44.37 | 58.08 |
|       curtain       | 63.05 | 81.53 |
|        chair        | 51.57 | 64.74 |
|         car         | 79.78 | 85.85 |
|        water        | 46.25 | 59.05 |
|       painting      | 65.89 | 80.06 |
|         sofa        | 62.37 | 82.61 |
|        shelf        | 39.18 | 55.27 |
|        house        | 27.68 | 29.99 |
|         sea         | 53.26 |  84.8 |
|        mirror       | 60.36 | 71.85 |
|         rug         | 55.55 | 67.54 |
|        field        | 21.44 | 32.73 |
|       armchair      | 40.02 | 53.43 |
|         seat        | 52.09 | 70.84 |
|        fence        | 35.97 | 51.87 |
|         desk        | 39.42 | 48.07 |
|         rock        | 34.07 | 51.91 |
|       wardrobe      | 43.67 |  60.4 |
|         lamp        | 57.57 |  70.6 |
|       bathtub       | 71.21 |  76.6 |
|       railing       | 28.48 | 38.09 |
|       cushion       | 51.05 | 65.96 |
|         base        | 19.03 | 24.21 |
|         box         | 16.18 | 21.66 |
|        column       | 42.77 | 53.67 |
|      signboard      | 28.91 | 35.45 |
|   chest of drawers  | 37.37 | 58.48 |
|       counter       | 20.86 | 27.65 |
|         sand        | 20.55 |  29.6 |
|         sink        | 65.44 | 75.18 |
|      skyscraper     | 45.84 |  55.4 |
|      fireplace      |  63.7 | 84.48 |
|     refrigerator    | 72.98 | 78.53 |
|      grandstand     | 36.96 | 73.98 |
|         path        | 18.16 | 24.24 |
|        stairs       | 28.07 | 33.91 |
|        runway       | 51.88 | 64.55 |
|         case        | 48.12 | 64.38 |
|      pool table     | 90.68 | 94.97 |
|        pillow       | 48.09 | 54.59 |
|     screen door     | 47.96 | 49.35 |
|       stairway      | 25.71 | 29.05 |
|        river        | 14.36 | 19.09 |
|        bridge       | 40.09 |  43.9 |
|       bookcase      | 33.31 | 43.92 |
|        blind        | 24.48 | 25.39 |
|     coffee table    | 60.38 | 78.77 |
|        toilet       | 81.05 | 86.26 |
|        flower       | 29.15 | 47.18 |
|         book        | 38.44 | 53.52 |
|         hill        |  5.05 | 10.29 |
|        bench        | 42.65 |  47.9 |
|      countertop     |  52.7 | 64.76 |
|        stove        | 69.38 |  74.6 |
|         palm        | 41.11 |  55.7 |
|    kitchen island   | 39.62 | 58.45 |
|       computer      | 49.44 | 55.11 |
|     swivel chair    | 41.15 | 55.89 |
|         boat        | 35.99 | 38.09 |
|         bar         | 16.93 | 20.28 |
|    arcade machine   |  39.9 | 43.47 |
|        hovel        | 34.86 | 46.61 |
|         bus         | 81.35 | 92.04 |
|        towel        |  47.5 | 55.27 |
|        light        | 42.46 |  49.8 |
|        truck        | 20.07 | 26.95 |
|        tower        | 11.39 |  17.1 |
|      chandelier     | 65.28 |  81.8 |
|        awning       | 21.58 | 26.25 |
|     streetlight     | 21.34 | 27.82 |
|        booth        | 31.82 | 34.15 |
| television receiver | 45.98 | 61.65 |
|       airplane      |  48.9 |  56.9 |
|      dirt track     |  7.93 | 22.69 |
|       apparel       | 29.23 | 44.62 |
|         pole        | 19.33 | 28.63 |
|         land        |  1.25 |  2.28 |
|      bannister      |  4.52 |  5.66 |
|      escalator      | 10.39 |  11.6 |
|       ottoman       | 36.84 | 49.36 |
|        bottle       | 19.98 | 24.44 |
|        buffet       | 38.16 | 41.59 |
|        poster       | 22.93 | 28.92 |
|        stage        | 14.99 | 24.59 |
|         van         | 41.17 | 52.05 |
|         ship        | 16.59 | 21.93 |
|       fountain      |  13.2 | 18.52 |
|    conveyer belt    | 83.52 | 90.62 |
|        canopy       | 20.79 | 22.52 |
|        washer       | 59.67 | 60.56 |
|      plaything      | 25.84 | 41.06 |
|    swimming pool    | 28.52 | 42.24 |
|        stool        |  35.3 | 56.33 |
|        barrel       | 55.41 | 64.11 |
|        basket       | 17.69 |  19.7 |
|      waterfall      | 60.78 | 89.61 |
|         tent        | 92.63 | 98.27 |
|         bag         |  6.8  |  7.63 |
|       minibike      | 63.43 | 72.34 |
|        cradle       | 75.64 | 95.24 |
|         oven        | 30.31 | 33.42 |
|         ball        | 37.16 | 65.11 |
|         food        | 50.97 | 65.95 |
|         step        |  9.18 | 10.67 |
|         tank        | 37.75 | 40.44 |
|      trade name     | 13.27 | 13.96 |
|      microwave      | 35.05 | 36.96 |
|         pot         | 36.37 | 41.54 |
|        animal       | 52.97 | 56.82 |
|       bicycle       | 43.41 | 57.26 |
|         lake        |  32.0 | 62.89 |
|      dishwasher     | 67.93 | 69.91 |
|        screen       |  47.5 |  59.2 |
|       blanket       |  6.06 |  6.55 |
|      sculpture      | 27.84 | 36.16 |
|         hood        | 56.43 | 61.43 |
|        sconce       | 34.39 | 44.75 |
|         vase        | 32.04 | 40.43 |
|    traffic light    | 31.39 | 45.22 |
|         tray        |  6.62 | 10.07 |
|        ashcan       | 31.89 | 42.95 |
|         fan         | 50.68 | 58.87 |
|         pier        | 14.62 | 16.07 |
|      crt screen     |  8.41 | 17.49 |
|        plate        | 35.36 | 41.08 |
|       monitor       | 50.99 | 61.31 |
|    bulletin board   | 35.77 | 41.09 |
|        shower       |  1.55 |  3.07 |
|       radiator      | 36.91 | 41.82 |
|        glass        |  6.2  |  6.44 |
|        clock        | 25.77 |  27.8 |
|         flag        | 22.43 | 23.46 |
+---------------------+-------+-------+
09/20 07:43:30 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.5700  mIoU: 41.4000  mAcc: 51.2300  data_time: 0.0029  time: 6.3926
Finished processing corruption type: glass_blur
Processing corruption type: motion_blur
09/20 07:43:34 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1839463619
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1839463619
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 07:43:34 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='motion_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/motion_blur'

09/20 07:43:38 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 07:43:38 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 07:43:38 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 07:43:39 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 07:45:36 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:16:39  time: 1.5869  data_time: 0.0017  memory: 17318  
09/20 07:46:58 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:03:06  time: 1.7701  data_time: 0.0018  memory: 17098  
09/20 07:47:58 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:53:24  time: 1.2476  data_time: 0.0016  memory: 17091  
09/20 07:49:11 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:49:48  time: 1.3244  data_time: 0.0016  memory: 17100  
09/20 07:50:18 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:46:36  time: 1.1873  data_time: 0.0015  memory: 17098  
09/20 07:51:18 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:43:26  time: 0.8989  data_time: 0.0017  memory: 17094  
09/20 07:52:27 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:41:29  time: 1.1168  data_time: 0.0016  memory: 17098  
09/20 07:53:28 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:39:19  time: 1.3199  data_time: 0.0015  memory: 17096  
09/20 07:54:09 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:36:13  time: 0.8779  data_time: 0.0015  memory: 17020  
09/20 07:54:57 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:33:53  time: 0.7759  data_time: 0.0015  memory: 17079  
09/20 07:55:47 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:32:00  time: 1.2811  data_time: 0.0016  memory: 17098  
09/20 07:56:29 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:29:58  time: 0.9882  data_time: 0.0017  memory: 17026  
09/20 07:57:25 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:28:36  time: 1.3481  data_time: 0.0015  memory: 17100  
09/20 07:58:26 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:27:28  time: 0.8878  data_time: 0.0016  memory: 17101  
09/20 07:59:28 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:26:22  time: 1.7427  data_time: 0.0016  memory: 17104  
09/20 08:00:10 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:24:47  time: 0.8103  data_time: 0.0017  memory: 17091  
09/20 08:00:50 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:23:15  time: 0.7865  data_time: 0.0017  memory: 878  
09/20 08:01:32 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:21:51  time: 0.8432  data_time: 0.0015  memory: 17017  
09/20 08:02:29 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:20:49  time: 1.1004  data_time: 0.0017  memory: 17097  
09/20 08:03:17 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:19:38  time: 0.8108  data_time: 0.0015  memory: 17074  
09/20 08:04:11 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:18:35  time: 1.4259  data_time: 0.0016  memory: 17101  
09/20 08:05:00 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:17:28  time: 0.8435  data_time: 0.0017  memory: 17088  
09/20 08:05:46 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:16:21  time: 0.9452  data_time: 0.0016  memory: 17080  
09/20 08:06:28 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:15:12  time: 0.8048  data_time: 0.0015  memory: 1991  
09/20 08:07:13 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:14:08  time: 0.9073  data_time: 0.0015  memory: 17091  
09/20 08:07:52 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:13:02  time: 0.8168  data_time: 0.0015  memory: 1630  
09/20 08:08:36 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:12:00  time: 0.7634  data_time: 0.0015  memory: 17076  
09/20 08:09:33 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:11:06  time: 1.2912  data_time: 0.0015  memory: 17095  
09/20 08:10:19 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:10:06  time: 1.3800  data_time: 0.0201  memory: 17083  
09/20 08:10:59 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:09:06  time: 0.7404  data_time: 0.0015  memory: 878  
09/20 08:11:44 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:08:09  time: 0.8403  data_time: 0.0015  memory: 17025  
09/20 08:12:22 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:10  time: 0.7738  data_time: 0.0016  memory: 1674  
09/20 08:13:10 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:15  time: 0.7625  data_time: 0.0014  memory: 17098  
09/20 08:13:58 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:21  time: 0.8345  data_time: 0.0017  memory: 17089  
09/20 08:14:45 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:26  time: 0.8583  data_time: 0.0014  memory: 17078  
09/20 08:15:27 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:32  time: 0.8085  data_time: 0.0016  memory: 17078  
09/20 08:16:07 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:37  time: 0.8026  data_time: 0.0016  memory: 878  
09/20 08:16:50 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:44  time: 0.8141  data_time: 0.0015  memory: 17101  
09/20 08:17:37 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:52  time: 0.8169  data_time: 0.0015  memory: 17082  
09/20 08:18:20 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7145  data_time: 0.0014  memory: 17030  
09/20 08:18:20 - mmengine - INFO - per class results:
09/20 08:18:20 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  71.8 | 85.27 |
|       building      |  76.5 | 93.21 |
|         sky         | 92.21 | 95.51 |
|        floor        | 74.83 | 88.77 |
|         tree        | 65.98 | 77.26 |
|       ceiling       |  80.8 | 91.29 |
|         road        | 77.06 | 85.09 |
|         bed         | 85.63 | 95.36 |
|      windowpane     | 56.83 | 75.86 |
|        grass        | 62.05 | 81.31 |
|       cabinet       | 54.86 | 66.68 |
|       sidewalk      | 56.51 | 76.85 |
|        person       | 71.37 | 87.95 |
|        earth        | 20.84 | 26.68 |
|         door        | 40.93 | 49.15 |
|        table        | 55.04 | 72.78 |
|       mountain      | 43.76 |  67.9 |
|        plant        | 43.72 | 60.61 |
|       curtain       | 65.34 | 77.76 |
|        chair        | 50.96 |  67.3 |
|         car         | 78.54 | 88.97 |
|        water        | 35.79 | 52.82 |
|       painting      |  63.4 | 81.12 |
|         sofa        | 62.61 | 80.39 |
|        shelf        | 36.77 |  55.2 |
|        house        | 35.67 | 43.66 |
|         sea         | 42.06 | 75.84 |
|        mirror       | 62.55 | 69.86 |
|         rug         | 46.69 | 56.12 |
|        field        | 18.82 |  31.2 |
|       armchair      | 45.38 | 57.06 |
|         seat        |  50.4 | 68.55 |
|        fence        | 32.31 | 48.36 |
|         desk        | 45.51 | 60.35 |
|         rock        | 28.48 |  36.0 |
|       wardrobe      | 44.22 | 63.78 |
|         lamp        | 56.03 | 70.75 |
|       bathtub       | 70.64 |  76.2 |
|       railing       | 26.85 | 43.88 |
|       cushion       | 51.06 | 63.95 |
|         base        | 22.42 | 33.76 |
|         box         |  16.1 | 22.45 |
|        column       | 41.44 | 53.56 |
|      signboard      | 30.21 | 38.59 |
|   chest of drawers  | 38.84 | 56.84 |
|       counter       | 26.39 |  35.3 |
|         sand        | 20.19 | 40.38 |
|         sink        | 64.87 | 75.86 |
|      skyscraper     | 42.68 | 47.02 |
|      fireplace      | 62.06 | 82.63 |
|     refrigerator    | 70.17 | 80.76 |
|      grandstand     | 38.28 | 64.15 |
|         path        | 14.96 | 21.66 |
|        stairs       | 21.85 | 24.96 |
|        runway       | 62.64 | 84.32 |
|         case        | 45.65 | 62.12 |
|      pool table     | 90.22 | 94.67 |
|        pillow       | 53.76 | 66.03 |
|     screen door     | 60.38 | 69.46 |
|       stairway      | 22.94 | 26.54 |
|        river        |  7.7  | 20.05 |
|        bridge       | 42.61 | 47.37 |
|       bookcase      | 34.45 | 45.91 |
|        blind        | 32.71 | 38.92 |
|     coffee table    | 58.25 | 76.46 |
|        toilet       | 81.46 | 87.77 |
|        flower       | 24.54 | 28.91 |
|         book        | 39.27 | 55.69 |
|         hill        |  6.77 |  11.2 |
|        bench        | 41.53 |  49.2 |
|      countertop     | 58.87 |  75.5 |
|        stove        | 71.82 | 77.95 |
|         palm        | 29.97 | 64.59 |
|    kitchen island   | 43.01 | 74.48 |
|       computer      | 52.35 | 62.35 |
|     swivel chair    | 42.96 | 61.16 |
|         boat        | 39.54 | 50.22 |
|         bar         | 16.85 | 20.17 |
|    arcade machine   | 23.14 | 24.18 |
|        hovel        |  6.35 |  6.56 |
|         bus         | 83.87 | 90.31 |
|        towel        | 40.94 | 52.71 |
|        light        | 48.27 | 58.93 |
|        truck        |  22.1 |  28.0 |
|        tower        |  6.66 |  7.87 |
|      chandelier     |  54.3 | 62.86 |
|        awning       | 17.44 | 19.73 |
|     streetlight     | 17.99 | 22.94 |
|        booth        | 53.43 | 57.74 |
| television receiver | 65.43 | 74.25 |
|       airplane      | 48.91 | 65.78 |
|      dirt track     |  8.77 | 19.46 |
|       apparel       |  20.7 | 27.56 |
|         pole        | 20.18 | 30.26 |
|         land        |  0.88 |  1.06 |
|      bannister      |  3.94 |  4.94 |
|      escalator      | 29.91 |  38.2 |
|       ottoman       |  40.5 | 54.57 |
|        bottle       | 12.98 |  15.8 |
|        buffet       | 34.47 |  36.3 |
|        poster       | 23.67 | 29.33 |
|        stage        |  6.09 |  8.03 |
|         van         | 29.59 | 33.46 |
|         ship        | 41.19 | 44.17 |
|       fountain      |  3.32 |  3.34 |
|    conveyer belt    |  65.9 | 88.45 |
|        canopy       | 17.16 | 18.23 |
|        washer       | 62.18 | 66.23 |
|      plaything      | 21.39 | 33.61 |
|    swimming pool    | 27.29 | 39.29 |
|        stool        | 38.66 | 51.67 |
|        barrel       | 58.45 | 63.95 |
|        basket       | 16.71 | 24.82 |
|      waterfall      | 34.92 | 45.65 |
|         tent        |  91.9 | 98.79 |
|         bag         |  7.86 |  9.6  |
|       minibike      | 51.19 |  76.8 |
|        cradle       | 78.74 |  95.6 |
|         oven        | 21.25 | 42.07 |
|         ball        | 37.91 | 65.73 |
|         food        | 49.24 | 62.22 |
|         step        |  3.8  |  4.54 |
|         tank        | 36.31 | 38.47 |
|      trade name     | 20.39 | 22.72 |
|      microwave      | 35.04 |  37.8 |
|         pot         | 34.53 |  41.2 |
|        animal       | 39.63 | 55.65 |
|       bicycle       | 43.27 |  56.1 |
|         lake        | 22.44 | 31.46 |
|      dishwasher     | 70.88 | 74.88 |
|        screen       | 57.25 | 77.68 |
|       blanket       |  9.79 |  11.4 |
|      sculpture      |  14.7 | 17.18 |
|         hood        | 61.52 | 74.64 |
|        sconce       | 36.28 | 50.37 |
|         vase        | 32.52 | 40.58 |
|    traffic light    | 24.37 | 41.18 |
|         tray        |  3.74 |  7.15 |
|        ashcan       |  26.1 | 43.41 |
|         fan         | 51.61 | 62.65 |
|         pier        | 27.44 | 35.15 |
|      crt screen     |  4.31 |  6.33 |
|        plate        | 39.07 | 53.19 |
|       monitor       | 43.76 | 53.73 |
|    bulletin board   | 36.12 | 38.71 |
|        shower       |  1.67 |  3.95 |
|       radiator      | 42.66 | 46.74 |
|        glass        |  7.01 |  7.69 |
|        clock        | 22.85 | 24.43 |
|         flag        | 23.66 |  24.9 |
+---------------------+-------+-------+
09/20 08:18:20 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.3700  mIoU: 40.4700  mAcc: 51.0700  data_time: 0.0018  time: 1.0405
Finished processing corruption type: motion_blur
Processing corruption type: zoom_blur
09/20 08:18:40 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 404341422
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 404341422
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 08:18:40 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='zoom_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/zoom_blur'

09/20 08:18:48 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 08:18:48 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 08:18:49 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 08:18:49 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 08:20:45 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:15:08  time: 1.5042  data_time: 0.0017  memory: 17318  
09/20 08:22:02 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:00:58  time: 1.7132  data_time: 0.0016  memory: 17098  
09/20 08:22:58 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:51:04  time: 1.1655  data_time: 0.0016  memory: 17091  
09/20 08:24:06 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:47:32  time: 1.2660  data_time: 0.0016  memory: 17100  
09/20 08:25:10 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:44:23  time: 1.0731  data_time: 0.0016  memory: 17098  
09/20 08:26:05 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:41:10  time: 0.7756  data_time: 0.0017  memory: 17094  
09/20 08:27:10 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:39:20  time: 1.0489  data_time: 0.0015  memory: 17098  
09/20 08:28:07 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:37:09  time: 1.1623  data_time: 0.0015  memory: 17096  
09/20 08:28:45 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:34:13  time: 0.8244  data_time: 0.0015  memory: 17020  
09/20 08:29:31 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:32:04  time: 0.7351  data_time: 0.0015  memory: 17079  
09/20 08:30:20 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:30:22  time: 1.2572  data_time: 0.0016  memory: 17098  
09/20 08:31:02 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:28:29  time: 0.9524  data_time: 0.0017  memory: 17026  
09/20 08:31:54 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:27:09  time: 1.2469  data_time: 0.0015  memory: 17100  
09/20 08:32:51 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:26:03  time: 0.8583  data_time: 0.0016  memory: 17101  
09/20 08:33:48 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:24:57  time: 1.6921  data_time: 0.0015  memory: 17104  
09/20 08:34:28 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:23:27  time: 0.8004  data_time: 0.0016  memory: 17091  
09/20 08:35:06 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:22:01  time: 0.7735  data_time: 0.0017  memory: 941  
09/20 08:35:44 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:20:40  time: 0.7710  data_time: 0.0015  memory: 17017  
09/20 08:36:37 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:19:40  time: 0.9848  data_time: 0.0016  memory: 17097  
09/20 08:37:21 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:18:31  time: 0.7244  data_time: 0.0016  memory: 17074  
09/20 08:38:11 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:17:30  time: 1.2768  data_time: 0.0016  memory: 17101  
09/20 08:38:55 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:16:26  time: 0.7385  data_time: 0.0016  memory: 17088  
09/20 08:39:37 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:15:22  time: 0.8765  data_time: 0.0016  memory: 17080  
09/20 08:40:16 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:14:17  time: 0.7449  data_time: 0.0015  memory: 1991  
09/20 08:40:58 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:13:17  time: 0.8250  data_time: 0.0015  memory: 17091  
09/20 08:41:33 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:12:14  time: 0.7519  data_time: 0.0015  memory: 1630  
09/20 08:42:14 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:11:16  time: 0.7530  data_time: 0.0015  memory: 17076  
09/20 08:43:07 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:10:24  time: 1.2151  data_time: 0.0015  memory: 17095  
09/20 08:43:47 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:09:28  time: 1.1115  data_time: 0.0015  memory: 17083  
09/20 08:44:23 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:08:31  time: 0.6919  data_time: 0.0014  memory: 941  
09/20 08:45:04 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:07:37  time: 0.7470  data_time: 0.0015  memory: 17025  
09/20 08:45:39 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:06:42  time: 0.7246  data_time: 0.0016  memory: 1674  
09/20 08:46:23 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:05:50  time: 0.6711  data_time: 0.0014  memory: 17098  
09/20 08:47:08 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:59  time: 0.7640  data_time: 0.0017  memory: 17089  
09/20 08:47:53 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:09  time: 0.7710  data_time: 0.0015  memory: 17078  
09/20 08:48:34 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:18  time: 0.7790  data_time: 0.0016  memory: 17078  
09/20 08:49:12 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:27  time: 0.7356  data_time: 0.0016  memory: 878  
09/20 08:49:52 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:38  time: 0.7585  data_time: 0.0015  memory: 17101  
09/20 08:50:36 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:48  time: 0.7427  data_time: 0.0015  memory: 17082  
09/20 08:51:17 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6718  data_time: 0.0014  memory: 17030  
09/20 08:51:17 - mmengine - INFO - per class results:
09/20 08:51:17 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 51.49 | 83.93 |
|       building      | 59.49 | 78.02 |
|         sky         | 82.74 | 86.32 |
|        floor        | 48.66 |  76.7 |
|         tree        | 24.32 | 26.44 |
|       ceiling       | 60.54 | 84.07 |
|         road        | 48.66 | 54.97 |
|         bed         | 66.83 | 88.06 |
|      windowpane     | 39.71 | 61.85 |
|        grass        | 39.89 | 55.34 |
|       cabinet       | 38.18 | 46.01 |
|       sidewalk      | 26.07 | 35.68 |
|        person       | 45.67 | 68.37 |
|        earth        |  4.03 |  4.78 |
|         door        | 16.16 | 17.26 |
|        table        | 35.28 | 47.34 |
|       mountain      | 32.38 | 48.95 |
|        plant        | 19.72 | 43.02 |
|       curtain       | 37.18 | 58.99 |
|        chair        | 25.32 | 30.77 |
|         car         | 51.93 | 63.56 |
|        water        |  22.9 | 36.93 |
|       painting      | 41.01 | 63.88 |
|         sofa        | 41.87 | 59.83 |
|        shelf        | 20.56 | 28.39 |
|        house        |  0.21 |  0.22 |
|         sea         | 33.62 | 68.93 |
|        mirror       | 40.75 | 46.06 |
|         rug         | 16.52 | 17.35 |
|        field        | 12.35 | 21.02 |
|       armchair      | 15.83 | 20.18 |
|         seat        | 20.49 | 32.63 |
|        fence        |  5.63 |  9.49 |
|         desk        | 27.44 | 33.29 |
|         rock        | 10.78 | 13.29 |
|       wardrobe      | 19.94 | 27.96 |
|         lamp        | 35.21 | 48.19 |
|       bathtub       | 62.72 | 80.84 |
|       railing       | 11.17 | 14.83 |
|       cushion       |  24.5 | 30.16 |
|         base        | 10.73 | 13.98 |
|         box         |  1.17 |  1.31 |
|        column       | 22.74 |  27.1 |
|      signboard      | 12.99 | 14.21 |
|   chest of drawers  | 22.88 | 28.91 |
|       counter       |  9.17 | 15.05 |
|         sand        |  8.43 | 23.86 |
|         sink        | 41.37 | 59.77 |
|      skyscraper     | 14.75 | 19.86 |
|      fireplace      | 51.36 | 63.76 |
|     refrigerator    | 45.43 | 61.43 |
|      grandstand     | 14.21 | 15.71 |
|         path        |  2.12 |  2.27 |
|        stairs       |  2.25 |  2.83 |
|        runway       | 60.86 | 83.62 |
|         case        | 16.26 | 51.69 |
|      pool table     | 73.79 | 85.71 |
|        pillow       | 38.52 | 53.88 |
|     screen door     |  42.5 | 57.28 |
|       stairway      |  7.7  |  8.06 |
|        river        |  4.41 | 11.88 |
|        bridge       | 16.94 | 19.96 |
|       bookcase      | 14.37 | 15.68 |
|        blind        | 15.43 | 24.08 |
|     coffee table    | 38.22 | 44.16 |
|        toilet       | 60.63 | 72.12 |
|        flower       | 15.19 | 18.61 |
|         book        | 12.82 | 14.94 |
|         hill        |  4.83 |  7.15 |
|        bench        | 33.15 | 38.61 |
|      countertop     | 39.29 | 46.55 |
|        stove        | 49.95 | 57.25 |
|         palm        |  5.65 | 39.18 |
|    kitchen island   | 30.28 | 49.49 |
|       computer      | 38.67 | 44.76 |
|     swivel chair    | 11.74 | 12.92 |
|         boat        | 18.22 | 19.24 |
|         bar         | 11.33 |  12.8 |
|    arcade machine   |  0.91 |  0.91 |
|        hovel        |  1.55 |  1.55 |
|         bus         | 60.96 | 66.94 |
|        towel        | 14.87 | 19.41 |
|        light        | 14.94 | 18.37 |
|        truck        |  0.02 |  0.02 |
|        tower        |  3.75 |  4.28 |
|      chandelier     | 23.82 | 26.67 |
|        awning       |  8.6  |  9.35 |
|     streetlight     |  2.22 |  2.36 |
|        booth        |  9.88 | 10.22 |
| television receiver | 33.26 |  37.7 |
|       airplane      | 30.54 | 55.32 |
|      dirt track     |  3.8  |  5.32 |
|       apparel       |  0.46 |  0.61 |
|         pole        |  4.01 |  4.42 |
|         land        |  0.5  |  0.61 |
|      bannister      |  0.79 |  1.04 |
|      escalator      | 19.91 | 43.34 |
|       ottoman       | 19.18 | 26.42 |
|        bottle       |  0.83 |  0.91 |
|        buffet       |  0.05 |  0.05 |
|        poster       |  6.34 |  8.08 |
|        stage        |  7.68 | 12.28 |
|         van         |  2.0  |  2.01 |
|         ship        |  2.02 |  2.65 |
|       fountain      |  1.92 |  3.48 |
|    conveyer belt    | 32.49 |  39.4 |
|        canopy       |  4.27 |  4.3  |
|        washer       | 59.48 | 63.74 |
|      plaything      | 11.11 | 11.98 |
|    swimming pool    | 30.97 | 45.76 |
|        stool        | 15.29 | 20.04 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  6.92 |  9.02 |
|      waterfall      |  10.0 | 94.61 |
|         tent        | 34.27 | 36.03 |
|         bag         |  2.01 |  2.28 |
|       minibike      | 23.77 | 25.55 |
|        cradle       | 55.94 | 71.74 |
|         oven        | 15.63 | 23.91 |
|         ball        | 19.39 | 21.91 |
|         food        |  8.79 |  9.03 |
|         step        |  0.25 |  0.35 |
|         tank        | 10.96 | 16.69 |
|      trade name     |  4.22 |  4.25 |
|      microwave      | 20.91 | 23.41 |
|         pot         |  4.6  |  4.8  |
|        animal       | 35.06 | 38.46 |
|       bicycle       |  2.2  |  2.36 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     |  28.2 | 31.43 |
|        screen       |  51.1 | 73.94 |
|       blanket       |  1.77 |  2.04 |
|      sculpture      |  4.44 |  7.6  |
|         hood        | 38.18 | 51.16 |
|        sconce       | 14.06 | 17.99 |
|         vase        | 16.04 | 21.74 |
|    traffic light    |  5.06 |  5.27 |
|         tray        |  1.64 |  3.14 |
|        ashcan       |  11.5 | 12.68 |
|         fan         | 23.48 | 28.95 |
|         pier        |  8.8  |  9.3  |
|      crt screen     |  3.66 |  5.29 |
|        plate        |  17.5 | 23.55 |
|       monitor       |  4.2  |  4.44 |
|    bulletin board   | 10.26 | 10.51 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 24.39 | 37.22 |
|        glass        |  1.16 |  1.22 |
|        clock        |  5.49 |  5.61 |
|         flag        | 10.25 | 11.14 |
+---------------------+-------+-------+
09/20 08:51:17 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 61.4600  mIoU: 21.3500  mAcc: 29.0100  data_time: 0.0017  time: 0.9741
Finished processing corruption type: zoom_blur
Processing corruption type: snow
09/20 08:51:21 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 949155565
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 949155565
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 08:51:21 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='snow',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/snow'

09/20 08:51:25 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 08:51:25 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 08:51:25 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 08:51:26 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 08:53:03 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:03:16  time: 1.1333  data_time: 0.0017  memory: 17318  
09/20 08:54:02 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:49:34  time: 1.2838  data_time: 0.0016  memory: 17098  
09/20 08:54:39 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:39:46  time: 0.7916  data_time: 0.0016  memory: 17091  
09/20 08:55:28 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:36:21  time: 0.8375  data_time: 0.0016  memory: 17100  
09/20 08:56:13 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:33:32  time: 0.6981  data_time: 0.0015  memory: 17098  
09/20 08:56:49 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:30:34  time: 0.3498  data_time: 0.0016  memory: 17094  
09/20 08:57:34 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:28:57  time: 0.6561  data_time: 0.0015  memory: 17098  
09/20 08:58:12 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:27:03  time: 0.7887  data_time: 0.0016  memory: 17096  
09/20 08:58:32 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:24:29  time: 0.4633  data_time: 0.0015  memory: 17020  
09/20 08:58:58 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:22:36  time: 0.3502  data_time: 0.0015  memory: 17079  
09/20 08:59:26 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:21:04  time: 0.8244  data_time: 0.0016  memory: 17098  
09/20 08:59:47 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:19:29  time: 0.5460  data_time: 0.0017  memory: 17026  
09/20 09:00:20 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:18:29  time: 0.8314  data_time: 0.0015  memory: 17100  
09/20 09:00:55 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:17:36  time: 0.3631  data_time: 0.0017  memory: 17101  
09/20 09:01:30 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:16:46  time: 1.2821  data_time: 0.0016  memory: 17104  
09/20 09:01:51 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:15:37  time: 0.3311  data_time: 0.0017  memory: 17091  
09/20 09:02:09 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:14:29  time: 0.3680  data_time: 0.0017  memory: 878  
09/20 09:02:29 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:13:30  time: 0.4575  data_time: 0.0025  memory: 17017  
09/20 09:03:02 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:12:49  time: 0.5862  data_time: 0.0017  memory: 17097  
09/20 09:03:27 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:12:01  time: 0.3485  data_time: 0.0016  memory: 17074  
09/20 09:03:57 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:11:19  time: 0.9202  data_time: 0.0016  memory: 17101  
09/20 09:04:22 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:10:34  time: 0.3327  data_time: 0.0016  memory: 17088  
09/20 09:04:43 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:09:49  time: 0.4971  data_time: 0.0016  memory: 17080  
09/20 09:05:00 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:09:03  time: 0.3219  data_time: 0.0016  memory: 1991  
09/20 09:05:22 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:08:21  time: 0.4281  data_time: 0.0016  memory: 17091  
09/20 09:05:39 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:07:39  time: 0.3324  data_time: 0.0016  memory: 1630  
09/20 09:05:59 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:07:00  time: 0.3066  data_time: 0.0016  memory: 17076  
09/20 09:06:33 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:06:28  time: 0.7596  data_time: 0.0015  memory: 17095  
09/20 09:06:54 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:05:52  time: 0.6874  data_time: 0.0015  memory: 17083  
09/20 09:07:10 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:05:14  time: 0.3067  data_time: 0.0015  memory: 891  
09/20 09:07:30 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:04:40  time: 0.3368  data_time: 0.0015  memory: 17025  
09/20 09:07:47 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:04:05  time: 0.3458  data_time: 0.0017  memory: 1674  
09/20 09:08:12 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:03:33  time: 0.3073  data_time: 0.0015  memory: 17098  
09/20 09:08:36 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:01  time: 0.3398  data_time: 0.0017  memory: 17089  
09/20 09:08:59 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:30  time: 0.3327  data_time: 0.0015  memory: 17078  
09/20 09:09:19 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:59  time: 0.3341  data_time: 0.0017  memory: 17078  
09/20 09:09:36 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:28  time: 0.3383  data_time: 0.0017  memory: 878  
09/20 09:09:56 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:58  time: 0.3665  data_time: 0.0016  memory: 17101  
09/20 09:10:19 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:29  time: 0.3157  data_time: 0.0015  memory: 17082  
09/20 09:10:39 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2954  data_time: 0.0014  memory: 17030  
09/20 09:10:39 - mmengine - INFO - per class results:
09/20 09:10:39 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 52.17 | 89.45 |
|       building      | 65.09 |  89.3 |
|         sky         | 70.52 | 73.25 |
|        floor        | 59.89 | 84.68 |
|         tree        | 63.51 | 83.15 |
|       ceiling       | 52.56 | 61.58 |
|         road        | 57.56 | 61.69 |
|         bed         | 65.65 | 71.02 |
|      windowpane     | 47.54 |  58.3 |
|        grass        | 58.35 | 81.93 |
|       cabinet       | 32.72 | 37.81 |
|       sidewalk      | 44.52 | 62.73 |
|        person       | 62.86 | 76.45 |
|        earth        | 26.82 | 40.81 |
|         door        | 14.69 | 16.92 |
|        table        | 39.39 | 50.35 |
|       mountain      | 32.59 | 42.74 |
|        plant        | 42.97 | 59.34 |
|       curtain       | 37.04 | 41.59 |
|        chair        | 40.33 | 51.83 |
|         car         | 73.42 | 82.77 |
|        water        | 31.99 | 43.67 |
|       painting      | 57.27 | 69.49 |
|         sofa        | 45.55 | 52.85 |
|        shelf        | 26.85 | 39.02 |
|        house        | 10.65 | 11.38 |
|         sea         | 22.29 |  32.1 |
|        mirror       | 31.29 | 32.83 |
|         rug         | 21.06 | 21.69 |
|        field        |  13.0 | 18.96 |
|       armchair      | 24.19 | 29.67 |
|         seat        | 25.55 |  42.4 |
|        fence        | 19.77 | 39.83 |
|         desk        | 17.72 | 19.29 |
|         rock        | 17.76 | 23.26 |
|       wardrobe      | 15.24 |  19.3 |
|         lamp        | 50.44 | 56.72 |
|       bathtub       | 31.73 | 33.99 |
|       railing       | 19.17 | 23.94 |
|       cushion       | 34.93 | 43.34 |
|         base        |  9.31 |  24.0 |
|         box         |  9.88 | 14.24 |
|        column       | 15.45 | 16.34 |
|      signboard      | 28.33 | 40.58 |
|   chest of drawers  | 25.97 | 33.52 |
|       counter       |  4.87 |  6.73 |
|         sand        |  8.56 |  9.73 |
|         sink        | 42.05 | 52.68 |
|      skyscraper     | 12.32 | 13.19 |
|      fireplace      | 52.29 | 58.58 |
|     refrigerator    | 37.14 | 38.65 |
|      grandstand     | 18.33 | 68.54 |
|         path        | 11.35 | 15.51 |
|        stairs       | 23.28 | 28.73 |
|        runway       | 34.59 | 40.97 |
|         case        | 25.88 | 38.87 |
|      pool table     | 40.46 | 41.04 |
|        pillow       | 30.65 | 33.94 |
|     screen door     | 10.58 | 10.59 |
|       stairway      |  7.01 |  7.41 |
|        river        |  3.68 |  5.44 |
|        bridge       | 51.81 | 57.19 |
|       bookcase      | 17.54 |  19.4 |
|        blind        | 10.67 | 10.98 |
|     coffee table    | 28.12 | 29.72 |
|        toilet       | 37.31 | 38.24 |
|        flower       | 33.28 | 40.88 |
|         book        | 32.29 | 40.25 |
|         hill        |  2.47 |  2.81 |
|        bench        | 17.78 | 19.22 |
|      countertop     | 22.69 | 23.33 |
|        stove        | 54.09 | 58.38 |
|         palm        |  37.4 | 52.63 |
|    kitchen island   | 22.69 | 26.22 |
|       computer      | 40.32 | 45.72 |
|     swivel chair    |  13.7 | 14.21 |
|         boat        |  19.8 | 20.26 |
|         bar         | 12.39 | 13.36 |
|    arcade machine   | 14.65 |  15.3 |
|        hovel        | 32.44 | 36.19 |
|         bus         | 82.91 | 92.41 |
|        towel        |  8.68 |  8.92 |
|        light        | 24.08 | 25.02 |
|        truck        |  6.09 |  7.89 |
|        tower        |  5.09 |  6.44 |
|      chandelier     | 53.65 |  67.0 |
|        awning       | 11.12 | 11.84 |
|     streetlight     | 17.87 | 19.96 |
|        booth        | 24.16 | 24.17 |
| television receiver | 23.12 | 24.06 |
|       airplane      | 25.37 | 33.51 |
|      dirt track     |  0.0  |  0.0  |
|       apparel       | 18.77 | 30.85 |
|         pole        | 16.48 | 24.28 |
|         land        |  0.18 |  0.18 |
|      bannister      |  2.16 |  2.32 |
|      escalator      | 15.69 | 19.03 |
|       ottoman       | 18.98 | 20.55 |
|        bottle       |  7.41 | 14.76 |
|        buffet       | 23.26 | 25.31 |
|        poster       | 15.67 | 21.56 |
|        stage        |  9.94 | 11.76 |
|         van         | 40.27 |  56.2 |
|         ship        |  3.88 |  4.5  |
|       fountain      |  1.98 |  3.28 |
|    conveyer belt    | 13.15 | 14.69 |
|        canopy       |  0.62 |  0.63 |
|        washer       | 44.08 | 44.13 |
|      plaything      | 12.16 | 20.38 |
|    swimming pool    | 12.24 |  12.4 |
|        stool        |  20.7 | 31.19 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 14.84 | 24.37 |
|      waterfall      | 31.69 | 42.89 |
|         tent        | 15.14 | 15.51 |
|         bag         |  3.36 |  6.91 |
|       minibike      | 42.45 | 56.98 |
|        cradle       | 43.06 | 53.09 |
|         oven        | 16.19 | 19.49 |
|         ball        | 33.64 | 41.71 |
|         food        | 41.72 | 59.16 |
|         step        |  1.49 |  1.58 |
|         tank        | 15.86 | 17.79 |
|      trade name     | 12.53 | 13.47 |
|      microwave      | 18.73 | 19.28 |
|         pot         | 20.95 | 22.65 |
|        animal       | 39.34 | 40.92 |
|       bicycle       |  31.4 |  67.5 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 19.69 | 19.93 |
|        screen       | 46.29 | 48.88 |
|       blanket       |  1.3  |  1.32 |
|      sculpture      |  8.53 | 10.99 |
|         hood        | 24.76 | 26.46 |
|        sconce       |  18.9 | 20.69 |
|         vase        | 34.32 | 40.06 |
|    traffic light    | 27.51 | 32.56 |
|         tray        |  3.09 |  4.16 |
|        ashcan       | 22.76 | 28.82 |
|         fan         | 34.42 | 36.79 |
|         pier        |  1.25 |  1.26 |
|      crt screen     |  5.88 | 29.56 |
|        plate        |  37.9 | 43.64 |
|       monitor       | 10.27 | 10.96 |
|    bulletin board   | 31.03 | 36.84 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  4.34 |  4.36 |
|        glass        |  8.28 | 11.46 |
|        clock        | 11.44 | 12.52 |
|         flag        |  17.0 | 18.49 |
+---------------------+-------+-------+
09/20 09:10:39 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 66.5300  mIoU: 25.4700  mAcc: 31.7200  data_time: 0.0018  time: 0.5768
Finished processing corruption type: snow
Processing corruption type: frost
09/20 09:10:43 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 46973618
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 46973618
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 09:10:44 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='frost',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/frost'

09/20 09:10:47 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 09:10:47 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 09:10:48 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 09:10:48 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 09:12:12 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:54:37  time: 0.8949  data_time: 0.0015  memory: 17318  
09/20 09:12:58 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:41:09  time: 1.0435  data_time: 0.0016  memory: 17098  
09/20 09:13:23 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:31:56  time: 0.5799  data_time: 0.0015  memory: 17091  
09/20 09:14:00 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:48  time: 0.6777  data_time: 0.0015  memory: 17100  
09/20 09:14:37 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:45  time: 0.5272  data_time: 0.0015  memory: 17098  
09/20 09:15:07 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:24:24  time: 0.1764  data_time: 0.0016  memory: 17094  
09/20 09:15:42 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:23:06  time: 0.4831  data_time: 0.0015  memory: 17098  
09/20 09:16:10 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:29  time: 0.5679  data_time: 0.0013  memory: 17096  
09/20 09:16:21 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:19:07  time: 0.2905  data_time: 0.0014  memory: 17020  
09/20 09:16:34 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:17:18  time: 0.1224  data_time: 0.0014  memory: 17079  
09/20 09:16:49 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:51  time: 0.5349  data_time: 0.0016  memory: 17098  
09/20 09:16:59 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:24  time: 0.2899  data_time: 0.0015  memory: 17026  
09/20 09:17:20 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:33  time: 0.5517  data_time: 0.0014  memory: 17100  
09/20 09:17:43 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:50  time: 0.1310  data_time: 0.0015  memory: 17101  
09/20 09:18:08 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:12  time: 1.0755  data_time: 0.0014  memory: 17104  
09/20 09:18:19 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:16  time: 0.1207  data_time: 0.0016  memory: 17091  
09/20 09:18:26 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:19  time: 0.1328  data_time: 0.0016  memory: 878  
09/20 09:18:36 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:31  time: 0.2239  data_time: 0.0014  memory: 17017  
09/20 09:18:59 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:09:02  time: 0.3722  data_time: 0.0015  memory: 17097  
09/20 09:19:13 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:24  time: 0.1670  data_time: 0.0014  memory: 17074  
09/20 09:19:31 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:53  time: 0.6305  data_time: 0.0015  memory: 17101  
09/20 09:19:47 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:20  time: 0.1389  data_time: 0.0015  memory: 17088  
09/20 09:19:58 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:46  time: 0.2224  data_time: 0.0015  memory: 17080  
09/20 09:20:04 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:10  time: 0.1395  data_time: 0.0014  memory: 1991  
09/20 09:20:16 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:40  time: 0.2389  data_time: 0.0015  memory: 17091  
09/20 09:20:22 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:09  time: 0.1190  data_time: 0.0014  memory: 1630  
09/20 09:20:32 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:41  time: 0.1156  data_time: 0.0013  memory: 17076  
09/20 09:20:54 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:19  time: 0.5293  data_time: 0.0014  memory: 17095  
09/20 09:21:06 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:54  time: 0.5057  data_time: 0.0014  memory: 17083  
09/20 09:21:12 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:27  time: 0.1127  data_time: 0.0014  memory: 878  
09/20 09:21:20 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:03  time: 0.1438  data_time: 0.0015  memory: 17025  
09/20 09:21:27 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:39  time: 0.1352  data_time: 0.0015  memory: 1674  
09/20 09:21:41 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:18  time: 0.1106  data_time: 0.0014  memory: 17098  
09/20 09:21:54 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:57  time: 0.1663  data_time: 0.0016  memory: 17089  
09/20 09:22:07 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:36  time: 0.2155  data_time: 0.0014  memory: 17078  
09/20 09:22:16 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:16  time: 0.1201  data_time: 0.0016  memory: 17078  
09/20 09:22:22 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:56  time: 0.1230  data_time: 0.0015  memory: 878  
09/20 09:22:33 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:37  time: 0.1264  data_time: 0.0014  memory: 17101  
09/20 09:22:47 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:18  time: 0.1147  data_time: 0.0015  memory: 17082  
09/20 09:22:57 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1120  data_time: 0.0013  memory: 17030  
09/20 09:22:57 - mmengine - INFO - per class results:
09/20 09:22:57 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 64.41 | 86.78 |
|       building      | 77.86 | 91.76 |
|         sky         | 75.45 | 78.14 |
|        floor        | 70.67 | 87.36 |
|         tree        | 65.68 | 86.48 |
|       ceiling       | 70.76 | 80.65 |
|         road        | 70.49 | 76.59 |
|         bed         | 81.84 | 90.39 |
|      windowpane     | 53.62 |  66.5 |
|        grass        | 62.12 | 79.69 |
|       cabinet       | 45.45 | 53.45 |
|       sidewalk      | 52.17 | 64.84 |
|        person       | 70.47 |  86.0 |
|        earth        | 24.64 | 48.96 |
|         door        | 27.12 | 32.83 |
|        table        | 50.78 | 68.74 |
|       mountain      | 26.13 | 72.45 |
|        plant        |  45.9 | 58.16 |
|       curtain       | 55.22 |  67.1 |
|        chair        | 48.28 | 61.77 |
|         car         | 78.79 | 86.05 |
|        water        | 45.06 |  60.1 |
|       painting      | 57.56 | 81.11 |
|         sofa        | 58.39 | 75.36 |
|        shelf        |  35.7 | 47.83 |
|        house        | 30.14 | 34.52 |
|         sea         |  31.2 | 48.94 |
|        mirror       | 49.25 | 54.37 |
|         rug         | 44.93 |  49.7 |
|        field        | 18.78 | 25.37 |
|       armchair      | 34.57 | 48.57 |
|         seat        | 42.01 | 48.74 |
|        fence        | 32.56 |  47.4 |
|         desk        | 27.66 | 35.89 |
|         rock        | 27.63 |  40.7 |
|       wardrobe      | 29.34 | 38.84 |
|         lamp        | 55.42 | 66.75 |
|       bathtub       | 36.66 | 40.09 |
|       railing       | 28.46 | 41.29 |
|       cushion       | 45.21 |  57.6 |
|         base        | 12.82 | 16.31 |
|         box         | 12.57 | 15.88 |
|        column       | 36.08 | 49.09 |
|      signboard      | 30.92 |  41.8 |
|   chest of drawers  | 35.49 | 41.35 |
|       counter       | 15.83 | 27.18 |
|         sand        | 18.09 | 22.63 |
|         sink        | 54.03 | 59.92 |
|      skyscraper     | 43.34 | 47.85 |
|      fireplace      | 58.37 | 70.75 |
|     refrigerator    | 54.64 | 59.82 |
|      grandstand     |  42.1 | 71.13 |
|         path        | 15.39 | 22.93 |
|        stairs       | 23.16 | 39.68 |
|        runway       | 41.85 |  51.8 |
|         case        | 41.66 | 64.66 |
|      pool table     | 79.87 | 83.75 |
|        pillow       | 42.54 | 49.28 |
|     screen door     | 30.91 | 70.91 |
|       stairway      | 23.74 | 29.25 |
|        river        |  8.75 | 13.32 |
|        bridge       | 56.27 | 61.39 |
|       bookcase      | 36.66 | 44.24 |
|        blind        | 26.22 | 28.35 |
|     coffee table    | 58.83 | 71.81 |
|        toilet       | 68.33 | 71.89 |
|        flower       |  33.5 | 43.35 |
|         book        |  37.3 | 52.71 |
|         hill        |  6.72 |  12.0 |
|        bench        |  29.9 | 32.81 |
|      countertop     | 45.01 | 62.59 |
|        stove        | 55.96 | 59.56 |
|         palm        | 40.38 | 53.98 |
|    kitchen island   | 29.71 | 48.13 |
|       computer      | 47.81 |  52.8 |
|     swivel chair    | 33.69 | 37.75 |
|         boat        | 33.57 | 35.48 |
|         bar         | 21.39 | 23.31 |
|    arcade machine   | 18.13 | 18.79 |
|        hovel        | 35.48 | 40.14 |
|         bus         |  86.4 | 91.93 |
|        towel        | 36.12 | 44.39 |
|        light        |  35.7 | 39.92 |
|        truck        | 22.62 | 29.41 |
|        tower        |  5.18 |  7.05 |
|      chandelier     | 59.23 | 74.96 |
|        awning       |  13.9 | 14.65 |
|     streetlight     | 20.99 | 23.81 |
|        booth        | 30.97 | 35.66 |
| television receiver | 41.68 | 44.43 |
|       airplane      | 33.11 | 40.18 |
|      dirt track     | 12.33 | 33.62 |
|       apparel       | 24.75 | 31.09 |
|         pole        |  21.0 |  30.3 |
|         land        |  0.41 |  0.44 |
|      bannister      |  4.24 |  5.46 |
|      escalator      | 14.98 | 15.99 |
|       ottoman       | 39.46 | 45.96 |
|        bottle       | 14.86 | 17.24 |
|        buffet       | 33.36 | 40.39 |
|        poster       | 12.55 |  14.6 |
|        stage        | 12.19 | 12.88 |
|         van         | 42.49 | 56.68 |
|         ship        | 15.84 | 16.13 |
|       fountain      |  0.92 |  0.94 |
|    conveyer belt    | 68.59 | 69.24 |
|        canopy       |  3.97 |  4.08 |
|        washer       | 58.94 | 59.06 |
|      plaything      | 30.87 | 37.38 |
|    swimming pool    | 49.04 | 49.78 |
|        stool        | 32.74 | 48.33 |
|        barrel       | 16.48 | 25.91 |
|        basket       | 22.39 | 30.46 |
|      waterfall      | 43.45 | 54.18 |
|         tent        | 19.64 | 20.62 |
|         bag         |  6.36 |  8.15 |
|       minibike      | 46.26 |  52.0 |
|        cradle       | 76.03 | 91.09 |
|         oven        | 10.18 | 12.87 |
|         ball        | 33.69 | 64.26 |
|         food        | 46.12 | 62.91 |
|         step        |  2.34 |  3.49 |
|         tank        | 22.26 | 22.93 |
|      trade name     | 18.62 | 21.15 |
|      microwave      | 30.03 | 32.14 |
|         pot         | 31.32 | 35.02 |
|        animal       | 50.91 | 57.86 |
|       bicycle       | 39.28 | 68.04 |
|         lake        | 57.44 | 58.44 |
|      dishwasher     | 48.27 | 50.92 |
|        screen       | 60.25 | 65.18 |
|       blanket       |  11.3 | 12.23 |
|      sculpture      |  9.33 | 15.99 |
|         hood        |  37.3 | 40.11 |
|        sconce       | 29.09 | 35.71 |
|         vase        | 34.19 | 48.13 |
|    traffic light    | 27.47 | 32.51 |
|         tray        |  3.83 |  5.91 |
|        ashcan       | 27.88 | 30.89 |
|         fan         | 45.44 | 53.04 |
|         pier        | 12.32 | 13.26 |
|      crt screen     |  3.6  |  5.99 |
|        plate        | 45.39 |  54.1 |
|       monitor       |  5.66 |  6.12 |
|    bulletin board   | 30.96 | 34.16 |
|        shower       |  0.09 |  0.25 |
|       radiator      | 10.87 | 11.04 |
|        glass        |  9.97 | 11.23 |
|        clock        | 18.04 | 19.13 |
|         flag        | 31.52 | 33.62 |
+---------------------+-------+-------+
09/20 09:22:57 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 74.0200  mIoU: 35.6000  mAcc: 44.0300  data_time: 0.0016  time: 0.3644
Finished processing corruption type: frost
Processing corruption type: fog
09/20 09:23:00 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1609363913
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1609363913
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 09:23:00 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='fog',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/fog'

09/20 09:23:04 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 09:23:04 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 09:23:05 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 09:23:05 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 09:24:37 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:59:48  time: 0.9741  data_time: 0.0015  memory: 17318  
09/20 09:25:30 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:45:54  time: 1.1637  data_time: 0.0015  memory: 17098  
09/20 09:26:01 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:36:15  time: 0.6477  data_time: 0.0015  memory: 17091  
09/20 09:26:45 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:33:02  time: 0.7512  data_time: 0.0015  memory: 17100  
09/20 09:27:25 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:30:22  time: 0.5991  data_time: 0.0014  memory: 17098  
09/20 09:27:57 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:27:34  time: 0.2603  data_time: 0.0016  memory: 17094  
09/20 09:28:37 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:26:06  time: 0.5987  data_time: 0.0014  memory: 17098  
09/20 09:29:10 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:24:18  time: 0.6604  data_time: 0.0014  memory: 17096  
09/20 09:29:26 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:21:50  time: 0.3544  data_time: 0.0014  memory: 17020  
09/20 09:29:45 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:19:59  time: 0.2787  data_time: 0.0014  memory: 17079  
09/20 09:30:06 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:18:28  time: 0.6627  data_time: 0.0015  memory: 17098  
09/20 09:30:23 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:17:00  time: 0.4775  data_time: 0.0016  memory: 17026  
09/20 09:30:51 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:16:07  time: 0.7370  data_time: 0.0014  memory: 17100  
09/20 09:31:21 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:15:21  time: 0.2916  data_time: 0.0015  memory: 17101  
09/20 09:31:53 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:14:40  time: 1.2882  data_time: 0.0014  memory: 17104  
09/20 09:32:11 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:13:39  time: 0.2599  data_time: 0.0015  memory: 17091  
09/20 09:32:25 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:12:37  time: 0.2873  data_time: 0.0017  memory: 878  
09/20 09:32:41 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:44  time: 0.3812  data_time: 0.0014  memory: 17017  
09/20 09:33:10 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:11:08  time: 0.4876  data_time: 0.0014  memory: 17097  
09/20 09:33:30 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:10:25  time: 0.2543  data_time: 0.0015  memory: 17074  
09/20 09:33:57 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:49  time: 0.8691  data_time: 0.0015  memory: 17101  
09/20 09:34:18 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:09:10  time: 0.2424  data_time: 0.0015  memory: 17088  
09/20 09:34:37 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:08:31  time: 0.4120  data_time: 0.0015  memory: 17080  
09/20 09:34:51 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:50  time: 0.2797  data_time: 0.0015  memory: 1991  
09/20 09:35:11 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:07:15  time: 0.3516  data_time: 0.0015  memory: 17091  
09/20 09:35:24 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:37  time: 0.2481  data_time: 0.0014  memory: 1630  
09/20 09:35:41 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:06:03  time: 0.2922  data_time: 0.0014  memory: 17076  
09/20 09:36:10 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:36  time: 0.7393  data_time: 0.0014  memory: 17095  
09/20 09:36:28 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:05:04  time: 0.6775  data_time: 0.0014  memory: 17083  
09/20 09:36:41 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:32  time: 0.2842  data_time: 0.0014  memory: 891  
09/20 09:36:57 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:04:01  time: 0.2943  data_time: 0.0015  memory: 17025  
09/20 09:37:11 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:31  time: 0.2487  data_time: 0.0015  memory: 1674  
09/20 09:37:31 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:03:03  time: 0.2503  data_time: 0.0014  memory: 17098  
09/20 09:37:52 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:36  time: 0.2447  data_time: 0.0015  memory: 17089  
09/20 09:38:10 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:09  time: 0.2506  data_time: 0.0014  memory: 17078  
09/20 09:38:27 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:42  time: 0.2767  data_time: 0.0016  memory: 17078  
09/20 09:38:40 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:15  time: 0.2451  data_time: 0.0016  memory: 878  
09/20 09:38:56 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:50  time: 0.2712  data_time: 0.0015  memory: 17101  
09/20 09:39:15 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:24  time: 0.2534  data_time: 0.0015  memory: 17082  
09/20 09:39:32 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2388  data_time: 0.0013  memory: 17030  
09/20 09:39:32 - mmengine - INFO - per class results:
09/20 09:39:32 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  73.1 | 88.62 |
|       building      | 79.27 | 92.37 |
|         sky         | 92.89 | 96.51 |
|        floor        | 77.16 | 89.18 |
|         tree        | 69.75 | 86.77 |
|       ceiling       | 81.74 | 90.73 |
|         road        | 79.97 | 87.97 |
|         bed         | 87.02 | 95.17 |
|      windowpane     | 58.87 | 76.35 |
|        grass        | 62.04 | 77.36 |
|       cabinet       |  57.2 | 69.34 |
|       sidewalk      | 62.07 | 77.03 |
|        person       |  75.0 | 89.04 |
|        earth        | 29.21 | 43.92 |
|         door        | 43.44 | 53.26 |
|        table        | 58.05 | 73.89 |
|       mountain      | 51.55 | 72.44 |
|        plant        | 47.51 | 60.11 |
|       curtain       | 67.96 | 78.82 |
|        chair        | 51.87 | 70.02 |
|         car         | 80.59 | 87.95 |
|        water        | 43.88 |  60.7 |
|       painting      | 65.67 | 81.36 |
|         sofa        |  63.5 | 81.05 |
|        shelf        | 40.64 | 59.46 |
|        house        | 33.54 |  39.1 |
|         sea         | 37.52 | 60.49 |
|        mirror       | 62.19 | 69.88 |
|         rug         | 49.08 | 57.09 |
|        field        | 18.26 | 24.39 |
|       armchair      | 36.91 | 48.71 |
|         seat        | 53.09 | 66.72 |
|        fence        | 38.59 | 51.15 |
|         desk        | 45.47 | 56.55 |
|         rock        |  25.2 | 36.01 |
|       wardrobe      | 43.92 | 61.66 |
|         lamp        | 60.42 | 74.15 |
|       bathtub       | 68.34 |  81.4 |
|       railing       | 31.12 | 53.12 |
|       cushion       | 49.13 | 61.55 |
|         base        | 15.57 | 21.32 |
|         box         | 18.13 | 23.59 |
|        column       | 45.74 | 55.92 |
|      signboard      | 33.71 | 44.91 |
|   chest of drawers  |  41.6 |  59.2 |
|       counter       | 23.52 | 29.96 |
|         sand        | 20.49 | 30.51 |
|         sink        |  65.7 | 79.72 |
|      skyscraper     | 33.24 | 35.99 |
|      fireplace      |  70.5 | 84.72 |
|     refrigerator    | 71.65 | 79.82 |
|      grandstand     | 45.69 | 71.19 |
|         path        | 19.34 | 27.01 |
|        stairs       | 31.09 | 37.57 |
|        runway       | 60.87 | 84.05 |
|         case        | 44.83 | 67.75 |
|      pool table     | 90.03 | 94.64 |
|        pillow       | 54.41 | 68.52 |
|     screen door     | 68.37 | 82.22 |
|       stairway      | 27.82 | 32.03 |
|        river        |  7.18 | 11.89 |
|        bridge       | 34.74 |  37.3 |
|       bookcase      | 39.08 | 48.42 |
|        blind        | 39.19 | 48.59 |
|     coffee table    | 61.23 | 76.01 |
|        toilet       | 81.21 | 90.38 |
|        flower       |  29.7 | 36.48 |
|         book        | 37.84 | 55.02 |
|         hill        |  7.19 | 11.48 |
|        bench        | 41.07 | 48.61 |
|      countertop     | 52.05 | 68.74 |
|        stove        | 67.09 | 70.12 |
|         palm        | 47.59 | 65.03 |
|    kitchen island   | 41.86 | 68.72 |
|       computer      | 52.74 | 64.15 |
|     swivel chair    |  38.2 | 49.59 |
|         boat        | 40.84 | 44.68 |
|         bar         | 17.16 | 19.02 |
|    arcade machine   | 19.78 | 20.59 |
|        hovel        |  7.5  |  7.56 |
|         bus         | 82.12 | 85.87 |
|        towel        | 46.27 | 60.68 |
|        light        | 48.32 | 56.38 |
|        truck        | 23.53 | 29.31 |
|        tower        | 17.56 | 21.88 |
|      chandelier     | 67.08 | 82.35 |
|        awning       |  9.43 |  9.9  |
|     streetlight     | 23.43 | 30.42 |
|        booth        | 41.76 | 42.72 |
| television receiver | 47.66 | 68.78 |
|       airplane      | 48.27 | 61.53 |
|      dirt track     |  9.16 | 27.66 |
|       apparel       |  24.4 | 34.24 |
|         pole        | 19.77 | 28.85 |
|         land        |  3.59 |  5.64 |
|      bannister      | 12.05 | 16.96 |
|      escalator      |  6.83 |  6.94 |
|       ottoman       |  39.8 | 49.79 |
|        bottle       | 17.33 | 21.06 |
|        buffet       | 37.18 | 47.72 |
|        poster       | 19.03 | 26.86 |
|        stage        |  5.58 |  6.12 |
|         van         | 37.65 | 51.72 |
|         ship        | 25.26 | 34.92 |
|       fountain      |  0.28 |  0.29 |
|    conveyer belt    | 73.31 | 81.82 |
|        canopy       | 18.27 |  19.4 |
|        washer       | 61.95 | 64.16 |
|      plaything      | 26.59 |  44.1 |
|    swimming pool    | 36.63 | 38.74 |
|        stool        | 40.29 | 53.43 |
|        barrel       | 40.88 | 62.92 |
|        basket       | 26.25 | 34.31 |
|      waterfall      | 51.84 | 68.68 |
|         tent        | 89.43 | 96.53 |
|         bag         |  6.23 |  8.05 |
|       minibike      | 58.48 | 65.04 |
|        cradle       | 78.91 | 96.42 |
|         oven        | 24.38 | 27.43 |
|         ball        | 37.64 | 58.35 |
|         food        | 39.12 | 43.45 |
|         step        |  9.51 | 12.34 |
|         tank        | 28.59 | 29.76 |
|      trade name     | 24.63 | 28.04 |
|      microwave      | 37.86 | 41.84 |
|         pot         | 37.73 |  42.8 |
|        animal       | 43.48 | 45.78 |
|       bicycle       | 44.92 | 63.11 |
|         lake        | 51.53 | 61.77 |
|      dishwasher     | 68.16 | 74.46 |
|        screen       | 50.27 |  64.1 |
|       blanket       | 10.73 |  12.5 |
|      sculpture      | 21.13 | 24.12 |
|         hood        | 60.52 | 66.49 |
|        sconce       | 38.37 | 47.74 |
|         vase        | 38.78 | 56.72 |
|    traffic light    | 28.86 | 38.84 |
|         tray        |  8.06 |  11.5 |
|        ashcan       | 32.92 | 39.48 |
|         fan         | 55.49 | 65.72 |
|         pier        | 12.02 |  13.3 |
|      crt screen     |  0.04 |  0.14 |
|        plate        | 38.23 | 48.61 |
|       monitor       |  2.34 |  2.73 |
|    bulletin board   | 35.01 | 43.94 |
|        shower       |  0.05 |  0.06 |
|       radiator      |  41.8 |  54.9 |
|        glass        | 11.92 | 14.42 |
|        clock        |  19.8 | 22.04 |
|         flag        | 30.77 | 32.12 |
+---------------------+-------+-------+
09/20 09:39:32 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.9500  mIoU: 41.3700  mAcc: 51.1000  data_time: 0.0016  time: 0.4932
Finished processing corruption type: fog
Processing corruption type: brightness
09/20 09:39:35 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1400538377
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1400538377
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 09:39:36 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='brightness',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/brightness'

09/20 09:39:39 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 09:39:39 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 09:39:40 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 09:39:40 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 09:41:12 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:59:45  time: 1.0576  data_time: 0.0015  memory: 17318  
09/20 09:42:09 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:46:56  time: 1.2909  data_time: 0.0016  memory: 17098  
09/20 09:42:42 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:37:19  time: 0.6880  data_time: 0.0015  memory: 17091  
09/20 09:43:28 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:34:05  time: 0.7753  data_time: 0.0016  memory: 17100  
09/20 09:44:09 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:31:20  time: 0.6170  data_time: 0.0015  memory: 17098  
09/20 09:44:43 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:28:35  time: 0.2741  data_time: 0.0016  memory: 17094  
09/20 09:45:25 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:27:05  time: 0.6478  data_time: 0.0015  memory: 17098  
09/20 09:45:57 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:25:07  time: 0.6710  data_time: 0.0014  memory: 17096  
09/20 09:46:13 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:22:33  time: 0.3510  data_time: 0.0015  memory: 17020  
09/20 09:46:33 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:20:37  time: 0.2573  data_time: 0.0015  memory: 17079  
09/20 09:46:56 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:19:07  time: 0.7434  data_time: 0.0018  memory: 17098  
09/20 09:47:12 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:17:34  time: 0.4731  data_time: 0.0016  memory: 17026  
09/20 09:47:39 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:16:34  time: 0.6850  data_time: 0.0014  memory: 17100  
09/20 09:48:08 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:15:43  time: 0.2685  data_time: 0.0016  memory: 17101  
09/20 09:48:39 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:14:57  time: 1.1546  data_time: 0.0015  memory: 17104  
09/20 09:48:56 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:13:52  time: 0.2606  data_time: 0.0016  memory: 17091  
09/20 09:49:09 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:12:49  time: 0.2630  data_time: 0.0017  memory: 878  
09/20 09:49:25 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:55  time: 0.3914  data_time: 0.0015  memory: 17017  
09/20 09:49:53 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:11:17  time: 0.4574  data_time: 0.0016  memory: 17097  
09/20 09:50:13 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:10:32  time: 0.2468  data_time: 0.0015  memory: 17074  
09/20 09:50:38 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:54  time: 0.7917  data_time: 0.0016  memory: 17101  
09/20 09:50:58 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:09:14  time: 0.2483  data_time: 0.0015  memory: 17088  
09/20 09:51:16 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:08:33  time: 0.3593  data_time: 0.0015  memory: 17080  
09/20 09:51:29 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:52  time: 0.2467  data_time: 0.0015  memory: 1991  
09/20 09:51:48 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:07:16  time: 0.3652  data_time: 0.0014  memory: 17091  
09/20 09:52:00 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:38  time: 0.2520  data_time: 0.0014  memory: 1630  
09/20 09:52:17 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:06:04  time: 0.2459  data_time: 0.0015  memory: 17076  
09/20 09:52:45 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:36  time: 0.6696  data_time: 0.0014  memory: 17095  
09/20 09:53:02 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:05:04  time: 0.6122  data_time: 0.0015  memory: 17083  
09/20 09:53:15 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:31  time: 0.2425  data_time: 0.0014  memory: 878  
09/20 09:53:30 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:04:00  time: 0.2596  data_time: 0.0016  memory: 17025  
09/20 09:53:42 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:30  time: 0.2531  data_time: 0.0016  memory: 1674  
09/20 09:54:03 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:03:02  time: 0.2344  data_time: 0.0014  memory: 17098  
09/20 09:54:23 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:35  time: 0.2542  data_time: 0.0016  memory: 17089  
09/20 09:54:41 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:08  time: 0.2537  data_time: 0.0014  memory: 17078  
09/20 09:54:56 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:41  time: 0.2612  data_time: 0.0015  memory: 17078  
09/20 09:55:09 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:15  time: 0.2588  data_time: 0.0016  memory: 878  
09/20 09:55:26 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:49  time: 0.2540  data_time: 0.0015  memory: 17101  
09/20 09:55:44 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:24  time: 0.2481  data_time: 0.0014  memory: 17082  
09/20 09:56:00 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2311  data_time: 0.0014  memory: 17030  
09/20 09:56:00 - mmengine - INFO - per class results:
09/20 09:56:00 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.29 | 88.35 |
|       building      | 79.37 | 92.33 |
|         sky         | 93.17 | 96.93 |
|        floor        | 78.64 | 90.55 |
|         tree        |  72.3 | 86.57 |
|       ceiling       | 82.76 | 91.16 |
|         road        | 81.61 |  90.2 |
|         bed         | 87.75 | 95.35 |
|      windowpane     | 59.11 | 75.65 |
|        grass        | 65.88 | 84.28 |
|       cabinet       | 58.88 | 71.34 |
|       sidewalk      | 64.22 | 77.13 |
|        person       | 75.83 | 89.88 |
|        earth        |  33.1 | 45.83 |
|         door        | 44.18 | 56.21 |
|        table        | 59.75 | 75.39 |
|       mountain      | 51.75 | 71.34 |
|        plant        | 48.39 | 62.32 |
|       curtain       |  67.7 | 79.05 |
|        chair        |  54.8 | 69.11 |
|         car         | 81.16 | 88.42 |
|        water        | 46.01 | 59.38 |
|       painting      | 64.99 |  84.6 |
|         sofa        | 64.16 | 82.97 |
|        shelf        | 42.66 | 60.02 |
|        house        | 36.44 | 41.95 |
|         sea         | 46.78 | 76.44 |
|        mirror       | 65.37 | 73.33 |
|         rug         |  52.3 | 59.68 |
|        field        | 23.11 |  32.1 |
|       armchair      | 41.77 | 54.51 |
|         seat        | 54.64 | 71.01 |
|        fence        | 40.32 | 57.49 |
|         desk        | 48.87 | 61.38 |
|         rock        | 30.19 | 45.02 |
|       wardrobe      | 45.24 | 64.14 |
|         lamp        | 60.93 | 73.85 |
|       bathtub       | 72.72 | 78.16 |
|       railing       | 32.09 | 46.79 |
|       cushion       | 53.36 | 67.72 |
|         base        | 20.17 | 26.92 |
|         box         | 20.24 | 27.37 |
|        column       | 43.33 | 52.97 |
|      signboard      |  33.6 | 46.78 |
|   chest of drawers  |  42.0 | 61.97 |
|       counter       | 24.86 | 34.31 |
|         sand        | 30.13 | 41.82 |
|         sink        | 67.39 | 79.37 |
|      skyscraper     | 35.53 |  38.8 |
|      fireplace      | 70.54 | 86.58 |
|     refrigerator    | 74.62 | 82.33 |
|      grandstand     | 44.05 | 70.22 |
|         path        | 18.37 | 25.74 |
|        stairs       | 31.45 | 37.82 |
|        runway       | 59.71 | 79.18 |
|         case        | 46.72 | 63.89 |
|      pool table     |  91.3 | 94.91 |
|        pillow       | 53.38 | 62.46 |
|     screen door     | 65.95 | 76.55 |
|       stairway      | 27.51 | 32.08 |
|        river        | 11.05 | 19.73 |
|        bridge       |  39.5 | 42.92 |
|       bookcase      | 41.72 | 52.06 |
|        blind        | 42.12 | 49.04 |
|     coffee table    | 62.31 | 78.71 |
|        toilet       | 83.25 | 90.31 |
|        flower       | 35.27 | 50.59 |
|         book        |  43.8 | 64.17 |
|         hill        |  9.18 | 11.75 |
|        bench        | 43.61 | 48.83 |
|      countertop     | 52.05 | 68.15 |
|        stove        | 71.69 | 76.38 |
|         palm        | 46.28 | 67.78 |
|    kitchen island   | 44.56 | 71.82 |
|       computer      | 54.08 | 63.63 |
|     swivel chair    | 42.32 | 58.77 |
|         boat        | 41.19 | 44.82 |
|         bar         | 16.93 | 19.84 |
|    arcade machine   | 40.17 | 42.94 |
|        hovel        | 37.13 | 40.42 |
|         bus         | 87.28 | 93.81 |
|        towel        | 49.49 | 59.59 |
|        light        | 50.68 | 58.59 |
|        truck        | 32.59 | 40.34 |
|        tower        | 13.15 | 15.84 |
|      chandelier     | 66.09 | 82.71 |
|        awning       |  21.2 | 23.06 |
|     streetlight     | 24.97 | 32.63 |
|        booth        | 43.09 |  46.3 |
| television receiver | 68.63 | 78.08 |
|       airplane      | 49.59 | 64.13 |
|      dirt track     | 13.96 | 38.43 |
|       apparel       | 29.49 | 43.34 |
|         pole        |  22.9 | 32.37 |
|         land        |  1.21 |  1.67 |
|      bannister      |  5.69 |  7.22 |
|      escalator      | 18.65 | 20.54 |
|       ottoman       | 36.75 | 48.44 |
|        bottle       | 17.76 |  22.3 |
|        buffet       | 46.83 | 55.82 |
|        poster       | 21.05 | 25.29 |
|        stage        | 11.95 | 17.47 |
|         van         | 45.41 | 59.48 |
|         ship        | 71.06 |  84.8 |
|       fountain      |  3.93 |  3.94 |
|    conveyer belt    | 77.94 | 86.81 |
|        canopy       | 18.03 | 19.14 |
|        washer       | 67.09 | 69.92 |
|      plaything      | 27.46 | 43.27 |
|    swimming pool    | 47.05 | 60.97 |
|        stool        |  41.3 | 58.41 |
|        barrel       | 35.09 | 64.71 |
|        basket       | 28.58 | 38.22 |
|      waterfall      | 55.91 | 67.51 |
|         tent        | 90.68 | 97.91 |
|         bag         |  7.72 |  9.89 |
|       minibike      | 63.07 |  72.6 |
|        cradle       | 78.52 | 97.32 |
|         oven        | 38.64 |  55.8 |
|         ball        | 36.72 | 66.85 |
|         food        | 53.55 | 66.01 |
|         step        | 16.43 | 19.23 |
|         tank        | 32.33 |  34.9 |
|      trade name     | 24.14 | 28.83 |
|      microwave      | 36.69 | 39.99 |
|         pot         | 41.44 |  49.1 |
|        animal       | 52.95 | 56.68 |
|       bicycle       | 51.77 | 70.92 |
|         lake        | 52.41 | 60.25 |
|      dishwasher     | 74.67 | 79.37 |
|        screen       | 55.88 | 69.83 |
|       blanket       |  9.31 | 10.83 |
|      sculpture      | 27.51 |  34.4 |
|         hood        | 61.34 | 71.35 |
|        sconce       | 39.86 | 48.62 |
|         vase        | 38.86 | 55.18 |
|    traffic light    | 30.62 | 45.75 |
|         tray        |  7.21 | 11.46 |
|        ashcan       | 39.95 | 50.85 |
|         fan         | 57.33 | 69.62 |
|         pier        | 11.21 | 12.47 |
|      crt screen     |  2.42 |  7.29 |
|        plate        | 44.49 | 56.45 |
|       monitor       | 11.83 | 13.55 |
|    bulletin board   | 41.29 | 49.93 |
|        shower       |  1.99 |  2.42 |
|       radiator      | 38.89 | 47.08 |
|        glass        | 11.19 | 12.63 |
|        clock        | 25.81 |  28.6 |
|         flag        | 27.89 | 30.16 |
+---------------------+-------+-------+
09/20 09:56:00 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.0700  mIoU: 44.5600  mAcc: 55.0100  data_time: 0.0017  time: 0.4898
Finished processing corruption type: brightness
Processing corruption type: contrast
09/20 09:56:03 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 624002881
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 624002881
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 09:56:04 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='contrast',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/contrast'

09/20 09:56:07 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 09:56:07 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 09:56:08 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 09:56:08 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 09:57:31 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:53:52  time: 0.8557  data_time: 0.0015  memory: 17318  
09/20 09:58:18 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:41:08  time: 1.0517  data_time: 0.0015  memory: 17098  
09/20 09:58:44 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:31:58  time: 0.5206  data_time: 0.0016  memory: 17091  
09/20 09:59:20 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:45  time: 0.6353  data_time: 0.0016  memory: 17100  
09/20 09:59:55 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:25  time: 0.4411  data_time: 0.0014  memory: 17098  
09/20 10:00:21 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:53  time: 0.1291  data_time: 0.0016  memory: 17094  
09/20 10:00:54 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:29  time: 0.4491  data_time: 0.0014  memory: 17098  
09/20 10:01:20 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:45  time: 0.5288  data_time: 0.0013  memory: 17096  
09/20 10:01:29 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:25  time: 0.2250  data_time: 0.0015  memory: 17020  
09/20 10:01:41 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:39  time: 0.1196  data_time: 0.0014  memory: 17079  
09/20 10:01:56 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:16  time: 0.5325  data_time: 0.0015  memory: 17098  
09/20 10:02:05 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:52  time: 0.2882  data_time: 0.0015  memory: 17026  
09/20 10:02:24 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:00  time: 0.5519  data_time: 0.0014  memory: 17100  
09/20 10:02:46 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:19  time: 0.1279  data_time: 0.0015  memory: 17101  
09/20 10:03:09 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:41  time: 0.9844  data_time: 0.0016  memory: 17104  
09/20 10:03:19 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:46  time: 0.1204  data_time: 0.0016  memory: 17091  
09/20 10:03:25 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:50  time: 0.1200  data_time: 0.0016  memory: 878  
09/20 10:03:34 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:05  time: 0.2094  data_time: 0.0013  memory: 17017  
09/20 10:03:55 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:35  time: 0.3216  data_time: 0.0014  memory: 17097  
09/20 10:04:07 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:58  time: 0.1314  data_time: 0.0014  memory: 17074  
09/20 10:04:25 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:29  time: 0.6666  data_time: 0.0014  memory: 17101  
09/20 10:04:38 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:57  time: 0.1167  data_time: 0.0016  memory: 17088  
09/20 10:04:49 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:24  time: 0.2201  data_time: 0.0015  memory: 17080  
09/20 10:04:55 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:51  time: 0.1179  data_time: 0.0018  memory: 1991  
09/20 10:05:07 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:23  time: 0.2232  data_time: 0.0015  memory: 17091  
09/20 10:05:12 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:52  time: 0.1192  data_time: 0.0015  memory: 1630  
09/20 10:05:22 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:26  time: 0.1142  data_time: 0.0015  memory: 17076  
09/20 10:05:43 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:06  time: 0.5546  data_time: 0.0014  memory: 17095  
09/20 10:05:54 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:42  time: 0.4701  data_time: 0.0014  memory: 17083  
09/20 10:05:59 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:17  time: 0.1104  data_time: 0.0015  memory: 878  
09/20 10:06:08 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:54  time: 0.1219  data_time: 0.0015  memory: 17025  
09/20 10:06:14 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:31  time: 0.1164  data_time: 0.0016  memory: 1674  
09/20 10:06:27 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:11  time: 0.1084  data_time: 0.0014  memory: 17098  
09/20 10:06:39 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:51  time: 0.1181  data_time: 0.0016  memory: 17089  
09/20 10:06:51 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:31  time: 0.2174  data_time: 0.0014  memory: 17078  
09/20 10:07:00 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:12  time: 0.1189  data_time: 0.0016  memory: 17078  
09/20 10:07:06 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:53  time: 0.1188  data_time: 0.0016  memory: 878  
09/20 10:07:16 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:35  time: 0.1211  data_time: 0.0015  memory: 17101  
09/20 10:07:27 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.1141  data_time: 0.0015  memory: 17082  
09/20 10:07:37 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1100  data_time: 0.0014  memory: 17030  
09/20 10:07:37 - mmengine - INFO - per class results:
09/20 10:07:37 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.73 | 88.73 |
|       building      | 79.16 | 92.18 |
|         sky         | 93.11 | 96.53 |
|        floor        | 76.81 | 89.24 |
|         tree        | 69.66 | 86.52 |
|       ceiling       | 81.93 | 91.24 |
|         road        | 79.74 | 87.37 |
|         bed         | 86.74 | 95.17 |
|      windowpane     | 58.49 |  74.3 |
|        grass        | 61.73 | 77.81 |
|       cabinet       | 57.47 | 70.34 |
|       sidewalk      | 61.57 | 76.16 |
|        person       | 75.41 | 88.59 |
|        earth        |  31.0 | 48.52 |
|         door        | 44.58 | 54.59 |
|        table        | 58.63 | 74.48 |
|       mountain      | 48.41 | 69.87 |
|        plant        | 46.53 | 56.61 |
|       curtain       | 68.03 | 78.52 |
|        chair        | 51.48 | 70.12 |
|         car         | 80.19 | 87.22 |
|        water        | 47.73 | 67.49 |
|       painting      | 62.85 | 82.11 |
|         sofa        | 64.46 | 81.25 |
|        shelf        | 39.43 | 57.88 |
|        house        | 33.65 | 38.49 |
|         sea         | 47.25 | 67.58 |
|        mirror       | 59.34 | 68.53 |
|         rug         | 48.39 | 55.79 |
|        field        | 20.67 | 28.31 |
|       armchair      | 39.39 |  52.8 |
|         seat        | 53.43 | 68.63 |
|        fence        |  32.6 | 43.49 |
|         desk        | 41.51 | 50.55 |
|         rock        | 24.15 | 32.59 |
|       wardrobe      | 44.64 | 61.24 |
|         lamp        | 59.94 |  73.6 |
|       bathtub       | 67.37 | 79.43 |
|       railing       | 30.81 | 51.31 |
|       cushion       | 49.47 | 61.79 |
|         base        |  18.4 | 24.93 |
|         box         | 16.79 |  22.0 |
|        column       | 44.84 | 56.07 |
|      signboard      | 33.16 | 44.13 |
|   chest of drawers  | 41.63 | 58.51 |
|       counter       | 23.23 | 30.68 |
|         sand        | 23.22 |  30.7 |
|         sink        | 63.52 | 78.34 |
|      skyscraper     | 32.71 | 36.46 |
|      fireplace      | 70.32 | 84.15 |
|     refrigerator    |  70.1 | 75.86 |
|      grandstand     | 40.64 | 64.42 |
|         path        | 19.74 | 26.09 |
|        stairs       | 30.16 | 36.93 |
|        runway       | 58.27 | 81.27 |
|         case        | 38.35 | 68.72 |
|      pool table     | 90.06 | 94.21 |
|        pillow       | 52.25 | 64.43 |
|     screen door     | 69.31 | 81.16 |
|       stairway      | 26.29 | 30.09 |
|        river        |  3.81 |  6.32 |
|        bridge       | 30.27 | 32.52 |
|       bookcase      |  38.3 | 46.91 |
|        blind        | 41.32 | 50.91 |
|     coffee table    | 61.78 | 76.55 |
|        toilet       | 81.59 | 90.28 |
|        flower       | 29.71 | 35.87 |
|         book        | 37.51 | 52.87 |
|         hill        |  8.29 | 10.34 |
|        bench        | 41.01 | 47.67 |
|      countertop     | 53.19 | 71.96 |
|        stove        | 64.59 | 67.11 |
|         palm        | 45.53 | 62.17 |
|    kitchen island   | 40.61 | 68.16 |
|       computer      | 53.04 | 63.32 |
|     swivel chair    | 37.41 | 48.03 |
|         boat        | 38.33 | 41.24 |
|         bar         | 14.51 | 15.99 |
|    arcade machine   | 18.12 | 18.99 |
|        hovel        | 17.93 | 18.81 |
|         bus         | 84.22 | 88.95 |
|        towel        | 43.95 | 56.81 |
|        light        | 42.75 | 47.71 |
|        truck        | 21.83 |  25.7 |
|        tower        | 19.73 | 23.89 |
|      chandelier     | 66.28 | 80.74 |
|        awning       | 10.31 | 10.75 |
|     streetlight     | 23.54 | 30.49 |
|        booth        | 45.32 | 46.95 |
| television receiver | 54.12 | 58.31 |
|       airplane      | 44.43 | 61.91 |
|      dirt track     |  5.13 | 18.56 |
|       apparel       | 26.38 | 33.75 |
|         pole        | 19.63 | 27.95 |
|         land        |  7.54 | 12.01 |
|      bannister      |  9.31 | 13.18 |
|      escalator      | 11.96 | 12.94 |
|       ottoman       | 39.88 | 50.46 |
|        bottle       | 16.75 |  20.0 |
|        buffet       | 36.86 | 45.96 |
|        poster       | 20.28 | 24.89 |
|        stage        |  7.62 |  8.69 |
|         van         | 41.67 | 56.48 |
|         ship        | 38.09 | 53.71 |
|       fountain      |  0.01 |  0.01 |
|    conveyer belt    | 75.23 | 79.24 |
|        canopy       | 18.41 | 19.67 |
|        washer       | 63.37 |  65.5 |
|      plaything      | 27.58 | 44.41 |
|    swimming pool    | 31.39 |  34.9 |
|        stool        | 41.02 | 51.16 |
|        barrel       | 47.25 |  64.1 |
|        basket       |  24.2 | 33.09 |
|      waterfall      | 45.12 | 54.81 |
|         tent        | 88.14 | 93.95 |
|         bag         |  6.85 |  8.16 |
|       minibike      | 58.23 | 65.32 |
|        cradle       | 79.04 | 96.47 |
|         oven        | 31.08 | 33.88 |
|         ball        | 37.14 | 60.48 |
|         food        | 39.81 | 46.14 |
|         step        | 15.06 | 20.55 |
|         tank        | 29.56 | 30.53 |
|      trade name     |  22.3 | 25.02 |
|      microwave      | 37.95 |  41.2 |
|         pot         | 35.29 | 39.17 |
|        animal       | 47.04 | 49.36 |
|       bicycle       | 44.62 | 62.59 |
|         lake        | 51.38 | 63.12 |
|      dishwasher     | 70.85 | 75.91 |
|        screen       | 50.43 | 61.37 |
|       blanket       | 11.24 | 13.34 |
|      sculpture      | 14.17 | 16.04 |
|         hood        | 59.78 | 66.76 |
|        sconce       | 38.27 | 46.78 |
|         vase        | 38.53 | 53.47 |
|    traffic light    | 27.23 | 37.17 |
|         tray        |  6.84 |  9.94 |
|        ashcan       | 32.08 | 37.86 |
|         fan         | 55.02 | 66.33 |
|         pier        | 11.23 | 12.14 |
|      crt screen     |  1.27 |  4.09 |
|        plate        | 35.49 | 43.46 |
|       monitor       |  3.01 |  3.41 |
|    bulletin board   | 31.42 | 41.58 |
|        shower       |  0.5  |  0.58 |
|       radiator      | 41.03 | 54.85 |
|        glass        | 11.72 | 14.26 |
|        clock        | 17.84 | 19.41 |
|         flag        | 27.96 | 29.06 |
+---------------------+-------+-------+
09/20 10:07:37 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.8900  mIoU: 41.2700  mAcc: 50.6200  data_time: 0.0016  time: 0.3442
Finished processing corruption type: contrast
Processing corruption type: elastic_transform
09/20 10:07:40 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 2075475358
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 2075475358
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 10:07:40 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/elastic_transform'

09/20 10:07:44 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 10:07:44 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 10:07:44 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 10:07:45 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 10:09:52 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:22:39  time: 1.7997  data_time: 0.0016  memory: 17318  
09/20 10:11:22 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:08:51  time: 2.0257  data_time: 0.0016  memory: 17098  
09/20 10:12:31 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:58:55  time: 1.4381  data_time: 0.0016  memory: 17091  
09/20 10:13:54 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:55:21  time: 1.5103  data_time: 0.0017  memory: 17100  
09/20 10:15:11 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:52:00  time: 1.3501  data_time: 0.0015  memory: 17098  
09/20 10:16:19 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:48:35  time: 1.0517  data_time: 0.0017  memory: 17094  
09/20 10:17:37 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:46:32  time: 1.3096  data_time: 0.0016  memory: 17098  
09/20 10:18:47 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:44:10  time: 1.4538  data_time: 0.0015  memory: 17096  
09/20 10:19:38 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:40:56  time: 1.0447  data_time: 0.0015  memory: 17020  
09/20 10:20:34 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:38:29  time: 0.9866  data_time: 0.0016  memory: 17079  
09/20 10:21:37 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:36:33  time: 1.5255  data_time: 0.0016  memory: 17098  
09/20 10:22:30 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:34:25  time: 1.2266  data_time: 0.0016  memory: 17026  
09/20 10:23:36 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:32:55  time: 1.5148  data_time: 0.0014  memory: 17100  
09/20 10:24:48 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:31:39  time: 1.0809  data_time: 0.0016  memory: 17101  
09/20 10:25:59 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:30:23  time: 2.0101  data_time: 0.0016  memory: 17104  
09/20 10:26:53 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:28:43  time: 1.0648  data_time: 0.0017  memory: 17091  
09/20 10:27:48 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:27:07  time: 1.0730  data_time: 0.0016  memory: 878  
09/20 10:28:39 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:25:33  time: 1.0520  data_time: 0.0015  memory: 17017  
09/20 10:29:46 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:24:20  time: 1.2448  data_time: 0.0015  memory: 17097  
09/20 10:30:43 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:22:58  time: 0.9912  data_time: 0.0016  memory: 17074  
09/20 10:31:48 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:21:45  time: 1.6292  data_time: 0.0015  memory: 17101  
09/20 10:32:49 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:20:30  time: 1.0184  data_time: 0.0016  memory: 17088  
09/20 10:33:45 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:19:13  time: 1.1568  data_time: 0.0016  memory: 17080  
09/20 10:34:38 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:17:55  time: 1.0077  data_time: 0.0015  memory: 1991  
09/20 10:35:35 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:16:42  time: 1.1139  data_time: 0.0016  memory: 17091  
09/20 10:36:24 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:15:25  time: 1.0342  data_time: 0.0015  memory: 1630  
09/20 10:37:18 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:14:13  time: 0.9584  data_time: 0.0015  memory: 17076  
09/20 10:38:27 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:13:09  time: 1.4976  data_time: 0.0015  memory: 17095  
09/20 10:39:22 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:11:59  time: 1.4666  data_time: 0.0015  memory: 17083  
09/20 10:40:11 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:10:48  time: 0.9480  data_time: 0.0015  memory: 878  
09/20 10:41:07 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:09:41  time: 1.0942  data_time: 0.0016  memory: 17025  
09/20 10:41:58 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:08:33  time: 1.0505  data_time: 0.0017  memory: 1674  
09/20 10:42:56 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:27  time: 0.9506  data_time: 0.0015  memory: 17098  
09/20 10:43:55 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:22  time: 1.0486  data_time: 0.0017  memory: 17089  
09/20 10:44:53 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:05:18  time: 1.0510  data_time: 0.0015  memory: 17078  
09/20 10:45:45 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:04:13  time: 1.0224  data_time: 0.0016  memory: 17078  
09/20 10:46:37 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:03:09  time: 1.0166  data_time: 0.0017  memory: 878  
09/20 10:47:30 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:02:05  time: 1.0197  data_time: 0.0016  memory: 17101  
09/20 10:48:26 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:02  time: 0.9857  data_time: 0.0015  memory: 17082  
09/20 10:49:19 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.9486  data_time: 0.0014  memory: 17030  
09/20 10:49:19 - mmengine - INFO - per class results:
09/20 10:49:19 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 61.93 | 79.04 |
|       building      |  72.2 | 88.37 |
|         sky         | 83.65 | 91.29 |
|        floor        | 67.21 |  81.7 |
|         tree        |  62.5 |  79.5 |
|       ceiling       | 68.59 | 81.92 |
|         road        | 74.15 | 85.83 |
|         bed         | 75.77 | 87.24 |
|      windowpane     | 47.57 | 66.18 |
|        grass        | 58.29 | 77.29 |
|       cabinet       | 48.78 | 62.47 |
|       sidewalk      | 52.05 | 66.95 |
|        person       | 58.68 | 77.11 |
|        earth        | 31.93 | 45.23 |
|         door        |  36.6 | 47.87 |
|        table        | 43.78 | 63.09 |
|       mountain      | 49.38 | 67.73 |
|        plant        | 40.16 | 54.52 |
|       curtain       | 49.96 | 67.54 |
|        chair        | 38.95 | 55.39 |
|         car         | 60.85 | 74.16 |
|        water        | 45.54 | 57.69 |
|       painting      | 44.44 | 63.85 |
|         sofa        | 52.95 |  72.7 |
|        shelf        | 34.42 | 50.94 |
|        house        |  28.3 | 32.68 |
|         sea         | 45.27 | 74.81 |
|        mirror       | 50.77 | 62.93 |
|         rug         | 41.69 | 53.41 |
|        field        | 22.79 | 33.02 |
|       armchair      | 32.37 | 44.89 |
|         seat        | 48.93 | 66.93 |
|        fence        | 30.72 | 46.17 |
|         desk        | 39.04 |  53.6 |
|         rock        | 31.88 |  49.2 |
|       wardrobe      | 39.69 | 56.69 |
|         lamp        |  29.8 | 46.84 |
|       bathtub       | 61.68 | 70.74 |
|       railing       | 25.33 | 40.66 |
|       cushion       | 38.23 | 53.35 |
|         base        | 18.96 | 26.45 |
|         box         | 14.51 | 19.64 |
|        column       | 23.59 | 32.19 |
|      signboard      |  21.4 | 32.02 |
|   chest of drawers  |  35.7 | 53.36 |
|       counter       | 22.03 | 31.32 |
|         sand        | 29.67 | 41.16 |
|         sink        | 46.57 | 63.19 |
|      skyscraper     | 34.36 | 39.82 |
|      fireplace      |  62.2 | 82.55 |
|     refrigerator    | 59.51 | 71.54 |
|      grandstand     | 40.04 |  68.0 |
|         path        | 13.79 | 19.59 |
|        stairs       | 24.26 | 30.27 |
|        runway       | 58.32 | 78.44 |
|         case        | 44.53 | 60.42 |
|      pool table     |  78.1 | 89.43 |
|        pillow       | 37.82 | 48.34 |
|     screen door     | 59.27 | 69.87 |
|       stairway      | 23.91 | 28.11 |
|        river        |  7.36 | 13.09 |
|        bridge       |  43.2 | 51.69 |
|       bookcase      | 30.62 | 43.62 |
|        blind        |  34.2 | 40.16 |
|     coffee table    | 47.83 | 64.28 |
|        toilet       | 58.09 | 70.89 |
|        flower       |  28.3 | 40.97 |
|         book        |  30.2 | 46.41 |
|         hill        |  6.28 |  9.61 |
|        bench        |  35.1 | 40.76 |
|      countertop     | 39.64 | 56.01 |
|        stove        | 59.68 | 69.08 |
|         palm        | 35.55 | 54.76 |
|    kitchen island   | 36.09 | 59.34 |
|       computer      | 41.43 |  53.4 |
|     swivel chair    | 33.08 | 48.92 |
|         boat        |  27.9 | 37.27 |
|         bar         | 16.89 | 20.08 |
|    arcade machine   | 22.03 | 24.32 |
|        hovel        | 32.74 | 35.15 |
|         bus         | 70.08 | 84.09 |
|        towel        | 30.21 |  43.2 |
|        light        | 15.46 | 23.64 |
|        truck        | 24.35 | 35.04 |
|        tower        |  5.5  |  6.97 |
|      chandelier     | 41.82 | 59.63 |
|        awning       | 14.98 | 17.86 |
|     streetlight     |  7.82 | 12.54 |
|        booth        | 45.89 | 52.64 |
| television receiver | 47.47 | 60.32 |
|       airplane      | 30.79 | 49.83 |
|      dirt track     | 12.01 | 29.33 |
|       apparel       | 20.55 | 36.56 |
|         pole        |  8.03 |  12.8 |
|         land        |  2.34 |  3.22 |
|      bannister      |  1.09 |  1.51 |
|      escalator      | 11.66 | 13.22 |
|       ottoman       | 31.58 |  44.6 |
|        bottle       | 13.87 | 19.63 |
|        buffet       |  37.4 | 45.78 |
|        poster       | 18.14 | 22.95 |
|        stage        | 13.15 | 18.16 |
|         van         | 37.79 | 51.26 |
|         ship        | 54.54 | 78.83 |
|       fountain      | 15.42 | 16.12 |
|    conveyer belt    | 64.82 | 78.95 |
|        canopy       | 15.54 |  17.6 |
|        washer       | 60.77 | 65.96 |
|      plaything      | 21.46 | 36.44 |
|    swimming pool    | 39.77 | 55.44 |
|        stool        | 23.08 | 36.41 |
|        barrel       | 33.68 | 61.02 |
|        basket       | 17.47 | 24.49 |
|      waterfall      | 50.61 | 67.09 |
|         tent        | 81.48 | 92.94 |
|         bag         |  5.96 |  7.64 |
|       minibike      | 42.74 | 57.84 |
|        cradle       | 66.92 |  91.7 |
|         oven        | 20.01 | 45.56 |
|         ball        | 35.36 | 63.29 |
|         food        |  49.1 | 65.35 |
|         step        |  7.78 | 10.28 |
|         tank        | 32.07 | 34.86 |
|      trade name     | 14.45 | 18.04 |
|      microwave      | 29.37 | 34.25 |
|         pot         | 21.62 | 29.87 |
|        animal       | 43.44 | 49.94 |
|       bicycle       | 34.89 | 51.64 |
|         lake        | 51.35 |  62.3 |
|      dishwasher     | 58.36 | 68.07 |
|        screen       | 51.29 | 68.23 |
|       blanket       |  6.76 |  7.81 |
|      sculpture      | 14.82 | 20.73 |
|         hood        | 39.12 | 53.69 |
|        sconce       | 17.69 | 26.61 |
|         vase        | 17.48 | 31.82 |
|    traffic light    | 15.23 | 27.97 |
|         tray        |  6.24 | 10.96 |
|        ashcan       | 27.24 | 42.02 |
|         fan         | 22.16 | 33.13 |
|         pier        |  8.26 |  9.75 |
|      crt screen     |  5.99 | 17.83 |
|        plate        | 33.16 | 48.89 |
|       monitor       |  7.72 |  9.07 |
|    bulletin board   | 25.47 | 32.49 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 33.43 | 42.63 |
|        glass        |  5.16 |  6.22 |
|        clock        | 18.04 | 23.53 |
|         flag        |  18.0 | 21.18 |
+---------------------+-------+-------+
09/20 10:49:19 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 73.3900  mIoU: 34.9900  mAcc: 46.6600  data_time: 0.0017  time: 1.2472
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
09/20 10:49:23 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1030019566
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1030019566
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 10:49:23 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/pixelate'

09/20 10:49:27 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 10:49:27 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 10:49:28 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 10:49:28 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 10:50:55 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:56:13  time: 0.9106  data_time: 0.0014  memory: 17318  
09/20 10:51:42 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:42:16  time: 1.0640  data_time: 0.0015  memory: 17098  
09/20 10:52:06 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:32:28  time: 0.5610  data_time: 0.0015  memory: 17091  
09/20 10:52:43 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:29:15  time: 0.6494  data_time: 0.0015  memory: 17100  
09/20 10:53:17 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:40  time: 0.4838  data_time: 0.0014  memory: 17098  
09/20 10:53:43 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:24:03  time: 0.1520  data_time: 0.0015  memory: 17094  
09/20 10:54:18 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:46  time: 0.4879  data_time: 0.0014  memory: 17098  
09/20 10:54:43 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:59  time: 0.5325  data_time: 0.0013  memory: 17096  
09/20 10:54:52 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:36  time: 0.2154  data_time: 0.0013  memory: 17020  
09/20 10:55:04 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:47  time: 0.1088  data_time: 0.0013  memory: 17079  
09/20 10:55:18 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:22  time: 0.5716  data_time: 0.0014  memory: 17098  
09/20 10:55:27 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:57  time: 0.2765  data_time: 0.0015  memory: 17026  
09/20 10:55:46 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:04  time: 0.5383  data_time: 0.0013  memory: 17100  
09/20 10:56:07 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:20  time: 0.1186  data_time: 0.0015  memory: 17101  
09/20 10:56:29 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:41  time: 1.0455  data_time: 0.0014  memory: 17104  
09/20 10:56:39 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:46  time: 0.1082  data_time: 0.0014  memory: 17091  
09/20 10:56:44 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:50  time: 0.1080  data_time: 0.0015  memory: 941  
09/20 10:56:53 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:03  time: 0.2021  data_time: 0.0014  memory: 17017  
09/20 10:57:12 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:33  time: 0.3122  data_time: 0.0014  memory: 17097  
09/20 10:57:24 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:56  time: 0.1019  data_time: 0.0013  memory: 17074  
09/20 10:57:41 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:25  time: 0.6181  data_time: 0.0014  memory: 17101  
09/20 10:57:54 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:53  time: 0.1074  data_time: 0.0014  memory: 17088  
09/20 10:58:04 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:21  time: 0.2125  data_time: 0.0014  memory: 17080  
09/20 10:58:10 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:47  time: 0.1059  data_time: 0.0015  memory: 1991  
09/20 10:58:21 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:19  time: 0.2330  data_time: 0.0014  memory: 17091  
09/20 10:58:26 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:49  time: 0.1078  data_time: 0.0014  memory: 1630  
09/20 10:58:34 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:23  time: 0.1053  data_time: 0.0014  memory: 17076  
09/20 10:58:55 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:03  time: 0.5186  data_time: 0.0015  memory: 17095  
09/20 10:59:05 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:38  time: 0.4607  data_time: 0.0014  memory: 17083  
09/20 10:59:11 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:14  time: 0.1015  data_time: 0.0014  memory: 941  
09/20 10:59:19 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:51  time: 0.1111  data_time: 0.0014  memory: 17025  
09/20 10:59:24 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:29  time: 0.1048  data_time: 0.0015  memory: 1674  
09/20 10:59:37 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:09  time: 0.0980  data_time: 0.0013  memory: 17098  
09/20 10:59:49 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:49  time: 0.1071  data_time: 0.0015  memory: 17089  
09/20 10:59:59 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:30  time: 0.1103  data_time: 0.0013  memory: 17078  
09/20 11:00:08 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:11  time: 0.1085  data_time: 0.0015  memory: 17078  
09/20 11:00:13 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:52  time: 0.1092  data_time: 0.0015  memory: 878  
09/20 11:00:23 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:34  time: 0.1260  data_time: 0.0013  memory: 17101  
09/20 11:00:34 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.1036  data_time: 0.0013  memory: 17082  
09/20 11:00:43 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1000  data_time: 0.0013  memory: 17030  
09/20 11:00:43 - mmengine - INFO - per class results:
09/20 11:00:43 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.42 | 88.52 |
|       building      | 79.82 | 93.45 |
|         sky         | 93.53 | 96.81 |
|        floor        | 78.86 | 90.61 |
|         tree        | 72.36 | 86.55 |
|       ceiling       | 82.61 | 90.77 |
|         road        | 82.25 | 91.35 |
|         bed         | 87.54 | 94.95 |
|      windowpane     | 59.08 | 76.39 |
|        grass        | 65.27 | 83.32 |
|       cabinet       | 58.73 |  71.6 |
|       sidewalk      | 64.52 | 77.41 |
|        person       | 76.15 | 88.25 |
|        earth        | 35.53 | 49.42 |
|         door        | 44.72 | 56.49 |
|        table        | 59.32 | 75.95 |
|       mountain      | 53.67 | 69.03 |
|        plant        |  48.6 | 60.55 |
|       curtain       | 69.23 | 80.44 |
|        chair        |  54.6 | 67.89 |
|         car         | 80.64 | 87.13 |
|        water        | 45.48 | 59.09 |
|       painting      | 69.31 | 84.74 |
|         sofa        | 61.46 |  82.7 |
|        shelf        |  43.7 | 61.26 |
|        house        | 38.85 | 43.45 |
|         sea         | 46.37 | 74.42 |
|        mirror       | 65.23 | 72.83 |
|         rug         |  53.0 | 60.18 |
|        field        | 21.91 | 31.76 |
|       armchair      | 38.37 | 49.27 |
|         seat        | 55.35 | 72.54 |
|        fence        | 40.59 | 56.81 |
|         desk        | 49.92 | 62.02 |
|         rock        | 32.07 | 47.68 |
|       wardrobe      | 45.75 | 62.81 |
|         lamp        | 60.97 | 73.72 |
|       bathtub       | 74.91 | 80.06 |
|       railing       | 33.11 | 48.15 |
|       cushion       | 53.82 | 66.59 |
|         base        | 21.31 | 27.81 |
|         box         | 20.84 | 28.07 |
|        column       | 43.83 | 52.36 |
|      signboard      | 33.21 | 44.48 |
|   chest of drawers  | 42.61 | 63.48 |
|       counter       | 22.71 |  33.0 |
|         sand        | 27.46 | 36.72 |
|         sink        |  69.3 | 79.41 |
|      skyscraper     | 35.06 | 37.57 |
|      fireplace      | 67.99 | 85.78 |
|     refrigerator    | 75.98 |  84.1 |
|      grandstand     | 43.58 | 71.21 |
|         path        | 16.89 | 23.29 |
|        stairs       | 30.61 | 37.67 |
|        runway       | 61.21 | 81.47 |
|         case        | 44.99 | 66.55 |
|      pool table     | 91.23 | 95.12 |
|        pillow       | 54.27 |  63.8 |
|     screen door     | 69.36 | 78.52 |
|       stairway      |  28.0 | 34.49 |
|        river        | 10.74 | 20.13 |
|        bridge       | 57.07 | 62.83 |
|       bookcase      | 40.42 | 52.71 |
|        blind        | 43.49 | 50.02 |
|     coffee table    | 62.31 | 78.88 |
|        toilet       | 83.34 | 90.31 |
|        flower       | 33.57 | 47.39 |
|         book        | 43.37 | 62.57 |
|         hill        |  8.78 | 11.49 |
|        bench        | 43.52 | 48.41 |
|      countertop     | 51.82 | 67.31 |
|        stove        | 72.87 | 77.88 |
|         palm        |  47.3 |  65.7 |
|    kitchen island   | 46.77 |  77.0 |
|       computer      |  54.6 | 64.05 |
|     swivel chair    | 41.32 | 56.81 |
|         boat        | 39.72 | 42.27 |
|         bar         | 22.13 | 27.34 |
|    arcade machine   | 32.21 | 34.09 |
|        hovel        | 38.85 | 41.37 |
|         bus         | 86.98 | 94.72 |
|        towel        | 52.64 | 59.67 |
|        light        | 50.92 | 58.44 |
|        truck        | 29.23 | 40.04 |
|        tower        |  8.44 | 10.19 |
|      chandelier     | 66.04 | 84.36 |
|        awning       | 22.38 | 24.27 |
|     streetlight     | 25.21 | 33.62 |
|        booth        | 44.72 | 51.81 |
| television receiver | 66.17 | 78.09 |
|       airplane      | 48.08 |  62.6 |
|      dirt track     | 17.43 | 38.45 |
|       apparel       | 29.47 | 44.14 |
|         pole        | 22.46 | 31.92 |
|         land        |  3.42 |  4.56 |
|      bannister      |  5.23 |  6.64 |
|      escalator      | 13.51 | 14.72 |
|       ottoman       |  36.9 | 48.26 |
|        bottle       | 16.84 | 22.07 |
|        buffet       | 50.92 | 61.74 |
|        poster       | 24.72 | 29.45 |
|        stage        | 11.21 | 16.82 |
|         van         | 44.52 | 64.79 |
|         ship        | 60.53 | 80.51 |
|       fountain      | 10.56 | 10.77 |
|    conveyer belt    |  75.1 | 87.76 |
|        canopy       | 16.58 | 17.28 |
|        washer       | 64.67 | 66.72 |
|      plaything      | 26.13 | 36.75 |
|    swimming pool    | 40.66 | 54.78 |
|        stool        | 40.34 | 59.57 |
|        barrel       | 32.58 | 64.69 |
|        basket       | 28.59 | 36.21 |
|      waterfall      | 59.17 | 74.22 |
|         tent        | 94.51 | 98.12 |
|         bag         |  8.85 |  10.6 |
|       minibike      |  60.4 | 67.49 |
|        cradle       | 76.13 | 97.15 |
|         oven        | 22.78 | 54.67 |
|         ball        | 38.63 | 66.79 |
|         food        | 53.32 | 60.98 |
|         step        |  12.0 | 14.13 |
|         tank        | 32.32 | 35.17 |
|      trade name     | 25.81 | 30.59 |
|      microwave      | 37.68 | 41.43 |
|         pot         | 39.03 | 45.98 |
|        animal       | 52.69 | 57.23 |
|       bicycle       | 46.81 | 62.83 |
|         lake        | 43.89 | 58.67 |
|      dishwasher     | 74.18 | 79.51 |
|        screen       | 60.08 | 76.06 |
|       blanket       |  6.78 |  7.42 |
|      sculpture      | 26.32 | 32.61 |
|         hood        | 59.48 | 72.79 |
|        sconce       | 38.96 | 47.45 |
|         vase        | 36.72 | 53.32 |
|    traffic light    | 32.38 | 46.29 |
|         tray        |  6.84 | 10.88 |
|        ashcan       |  38.8 | 53.48 |
|         fan         | 56.95 | 68.76 |
|         pier        | 29.58 | 35.23 |
|      crt screen     |  5.59 | 14.47 |
|        plate        | 43.53 | 51.64 |
|       monitor       | 19.84 | 22.94 |
|    bulletin board   | 43.38 | 53.48 |
|        shower       |  1.02 |  1.23 |
|       radiator      | 37.55 | 45.37 |
|        glass        | 11.34 | 12.72 |
|        clock        | 24.15 | 27.12 |
|         flag        | 26.33 | 28.07 |
+---------------------+-------+-------+
09/20 11:00:43 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.2600  mIoU: 44.5500  mAcc: 55.2200  data_time: 0.0016  time: 0.3372
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
09/20 11:00:46 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1766459614
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1766459614
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 11:00:46 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/jpeg_compression'

09/20 11:00:50 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 11:00:50 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 11:00:50 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 11:00:51 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 11:02:16 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:55:38  time: 0.9528  data_time: 0.0016  memory: 17318  
09/20 11:03:03 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:41:47  time: 1.0336  data_time: 0.0015  memory: 17098  
09/20 11:03:27 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:32:06  time: 0.5143  data_time: 0.0015  memory: 17091  
09/20 11:04:03 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:47  time: 0.6329  data_time: 0.0015  memory: 17100  
09/20 11:04:35 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:08  time: 0.4372  data_time: 0.0014  memory: 17098  
09/20 11:05:01 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:37  time: 0.1257  data_time: 0.0016  memory: 17094  
09/20 11:05:35 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:22  time: 0.5002  data_time: 0.0014  memory: 17098  
09/20 11:06:00 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:39  time: 0.5238  data_time: 0.0013  memory: 17096  
09/20 11:06:10 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:19  time: 0.2216  data_time: 0.0014  memory: 17020  
09/20 11:06:22 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:34  time: 0.1161  data_time: 0.0013  memory: 17079  
09/20 11:06:36 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:10  time: 0.5257  data_time: 0.0014  memory: 17098  
09/20 11:06:46 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:48  time: 0.2829  data_time: 0.0015  memory: 17026  
09/20 11:07:05 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:56  time: 0.5227  data_time: 0.0013  memory: 17100  
09/20 11:07:26 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:13  time: 0.1247  data_time: 0.0015  memory: 17101  
09/20 11:07:49 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:36  time: 0.9719  data_time: 0.0014  memory: 17104  
09/20 11:07:58 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:41  time: 0.1149  data_time: 0.0015  memory: 17091  
09/20 11:08:04 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:46  time: 0.1152  data_time: 0.0015  memory: 878  
09/20 11:08:13 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:01  time: 0.2470  data_time: 0.0014  memory: 17017  
09/20 11:08:33 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:31  time: 0.3181  data_time: 0.0015  memory: 17097  
09/20 11:08:46 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:54  time: 0.1087  data_time: 0.0014  memory: 17074  
09/20 11:09:04 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:25  time: 0.6414  data_time: 0.0015  memory: 17101  
09/20 11:09:17 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:54  time: 0.1127  data_time: 0.0015  memory: 17088  
09/20 11:09:28 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:22  time: 0.2181  data_time: 0.0014  memory: 17080  
09/20 11:09:33 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:48  time: 0.1114  data_time: 0.0014  memory: 1991  
09/20 11:09:44 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:20  time: 0.2201  data_time: 0.0015  memory: 17091  
09/20 11:09:50 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:50  time: 0.1148  data_time: 0.0015  memory: 1630  
09/20 11:09:59 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:23  time: 0.1099  data_time: 0.0015  memory: 17076  
09/20 11:10:20 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:04  time: 0.5257  data_time: 0.0014  memory: 17095  
09/20 11:10:30 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:39  time: 0.4673  data_time: 0.0014  memory: 17083  
09/20 11:10:36 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:14  time: 0.1072  data_time: 0.0014  memory: 903  
09/20 11:10:43 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:52  time: 0.1180  data_time: 0.0014  memory: 17025  
09/20 11:10:49 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:29  time: 0.1106  data_time: 0.0015  memory: 1674  
09/20 11:11:02 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:09  time: 0.1046  data_time: 0.0014  memory: 17098  
09/20 11:11:14 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:50  time: 0.1133  data_time: 0.0015  memory: 17089  
09/20 11:11:25 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:30  time: 0.1163  data_time: 0.0013  memory: 17078  
09/20 11:11:34 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:11  time: 0.1659  data_time: 0.0016  memory: 17078  
09/20 11:11:40 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:52  time: 0.1157  data_time: 0.0016  memory: 878  
09/20 11:11:50 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:34  time: 0.1168  data_time: 0.0014  memory: 17101  
09/20 11:12:00 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.1113  data_time: 0.0014  memory: 17082  
09/20 11:12:10 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1040  data_time: 0.0012  memory: 17030  
09/20 11:12:10 - mmengine - INFO - per class results:
09/20 11:12:10 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.45 | 88.96 |
|       building      |  79.6 | 92.81 |
|         sky         | 93.16 | 96.77 |
|        floor        |  77.3 | 91.18 |
|         tree        | 71.77 | 86.08 |
|       ceiling       | 79.86 | 88.25 |
|         road        | 80.66 | 89.89 |
|         bed         |  86.3 | 93.85 |
|      windowpane     | 58.08 | 74.48 |
|        grass        | 63.79 | 80.22 |
|       cabinet       | 57.59 | 70.57 |
|       sidewalk      | 61.68 | 75.38 |
|        person       | 75.63 | 88.35 |
|        earth        | 32.52 | 48.14 |
|         door        | 40.71 | 51.19 |
|        table        | 57.55 | 73.44 |
|       mountain      | 49.61 | 69.61 |
|        plant        |  48.4 |  60.0 |
|       curtain       | 66.72 | 76.56 |
|        chair        | 52.42 | 64.05 |
|         car         |  80.7 |  87.7 |
|        water        | 47.96 | 62.25 |
|       painting      | 69.05 | 82.17 |
|         sofa        | 61.73 | 81.87 |
|        shelf        | 39.93 | 56.82 |
|        house        | 34.56 | 38.65 |
|         sea         | 46.83 | 75.62 |
|        mirror       | 62.93 | 70.27 |
|         rug         | 47.88 | 51.98 |
|        field        | 22.14 | 32.38 |
|       armchair      |  37.1 | 48.33 |
|         seat        | 54.38 |  72.6 |
|        fence        | 39.45 | 54.25 |
|         desk        | 49.75 | 62.76 |
|         rock        | 29.94 | 44.36 |
|       wardrobe      | 45.05 | 63.31 |
|         lamp        | 61.65 | 72.56 |
|       bathtub       | 76.62 | 82.16 |
|       railing       | 31.52 | 43.39 |
|       cushion       | 51.94 | 66.57 |
|         base        | 18.02 | 23.61 |
|         box         | 18.14 | 24.27 |
|        column       | 44.54 | 52.81 |
|      signboard      | 33.03 | 43.49 |
|   chest of drawers  | 42.79 | 62.77 |
|       counter       |  20.1 | 28.01 |
|         sand        |  20.3 | 27.92 |
|         sink        | 69.92 | 78.49 |
|      skyscraper     | 32.91 | 35.46 |
|      fireplace      | 71.29 | 84.67 |
|     refrigerator    | 74.01 | 82.57 |
|      grandstand     | 42.54 | 67.53 |
|         path        | 16.63 | 25.31 |
|        stairs       | 29.86 | 37.77 |
|        runway       | 61.02 | 81.77 |
|         case        | 43.83 | 60.97 |
|      pool table     | 90.78 | 94.62 |
|        pillow       | 51.19 | 58.28 |
|     screen door     | 67.32 | 72.63 |
|       stairway      | 26.92 | 30.63 |
|        river        |  8.36 | 14.45 |
|        bridge       | 48.98 | 53.84 |
|       bookcase      | 37.34 | 46.63 |
|        blind        |  28.7 | 30.65 |
|     coffee table    | 62.97 |  76.6 |
|        toilet       | 83.21 | 88.67 |
|        flower       | 34.37 |  48.7 |
|         book        |  42.8 | 59.72 |
|         hill        |  9.85 | 12.35 |
|        bench        | 45.23 |  49.5 |
|      countertop     | 51.78 | 63.11 |
|        stove        | 72.51 | 79.89 |
|         palm        | 45.63 | 64.55 |
|    kitchen island   | 41.88 | 65.58 |
|       computer      | 53.99 | 63.14 |
|     swivel chair    | 40.78 | 53.39 |
|         boat        | 37.06 | 41.72 |
|         bar         | 17.12 | 21.86 |
|    arcade machine   | 37.76 | 40.08 |
|        hovel        | 38.02 |  42.5 |
|         bus         | 86.29 | 94.17 |
|        towel        | 46.94 | 51.26 |
|        light        | 46.86 | 52.31 |
|        truck        |  26.8 | 34.02 |
|        tower        | 17.62 | 22.67 |
|      chandelier     | 66.16 | 83.42 |
|        awning       | 19.68 | 21.39 |
|     streetlight     | 23.04 | 28.55 |
|        booth        | 39.85 | 47.17 |
| television receiver | 63.43 | 74.28 |
|       airplane      | 52.69 | 62.03 |
|      dirt track     | 19.47 | 43.46 |
|       apparel       | 30.36 | 43.77 |
|         pole        | 22.16 | 31.57 |
|         land        |  1.39 |  1.86 |
|      bannister      |  4.68 |  5.95 |
|      escalator      | 15.23 | 16.32 |
|       ottoman       |  41.9 | 49.84 |
|        bottle       | 17.28 | 20.51 |
|        buffet       |  42.0 | 48.72 |
|        poster       | 20.61 |  24.6 |
|        stage        | 11.26 | 16.69 |
|         van         | 43.83 | 60.84 |
|         ship        | 73.82 | 89.25 |
|       fountain      |  7.97 |  8.24 |
|    conveyer belt    |  69.2 | 87.66 |
|        canopy       | 16.22 |  16.9 |
|        washer       | 66.28 | 66.64 |
|      plaything      | 34.52 |  42.6 |
|    swimming pool    | 36.38 | 45.77 |
|        stool        | 37.05 | 53.99 |
|        barrel       | 27.18 | 64.03 |
|        basket       | 24.49 | 32.48 |
|      waterfall      | 57.11 | 69.83 |
|         tent        |  92.4 | 98.21 |
|         bag         |  8.34 |  9.97 |
|       minibike      | 62.36 | 72.77 |
|        cradle       |  75.8 | 96.22 |
|         oven        | 22.12 | 47.69 |
|         ball        | 36.92 | 63.84 |
|         food        | 52.83 | 65.87 |
|         step        | 11.66 | 13.72 |
|         tank        | 32.25 | 35.78 |
|      trade name     | 24.47 | 29.34 |
|      microwave      | 36.29 | 39.86 |
|         pot         | 38.71 | 44.79 |
|        animal       |  53.2 | 58.06 |
|       bicycle       | 47.78 | 67.39 |
|         lake        | 54.07 | 57.52 |
|      dishwasher     |  61.2 | 69.22 |
|        screen       | 54.81 | 68.18 |
|       blanket       |  5.41 |  5.85 |
|      sculpture      | 34.14 | 45.77 |
|         hood        | 59.84 | 65.58 |
|        sconce       | 34.64 | 39.85 |
|         vase        | 34.73 | 47.83 |
|    traffic light    | 30.92 | 42.21 |
|         tray        |  6.09 | 10.35 |
|        ashcan       | 34.88 | 44.74 |
|         fan         | 54.31 | 65.19 |
|         pier        | 18.32 |  21.2 |
|      crt screen     |  2.32 |  6.95 |
|        plate        | 45.51 |  54.9 |
|       monitor       |  15.9 | 17.97 |
|    bulletin board   | 38.29 | 45.75 |
|        shower       |  1.21 |  1.45 |
|       radiator      | 35.29 | 40.37 |
|        glass        |  9.54 | 10.42 |
|        clock        | 20.53 | 22.75 |
|         flag        |  24.7 | 26.36 |
+---------------------+-------+-------+
09/20 11:12:10 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.2900  mIoU: 43.2800  mAcc: 53.1100  data_time: 0.0016  time: 0.3395
Finished processing corruption type: jpeg_compression
Processing corruption type: elastic_transform
09/20 11:12:13 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1787887935
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1787887935
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 11:12:13 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/elastic_transform'

09/20 11:12:17 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 11:12:17 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 11:12:18 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 11:12:18 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 11:14:28 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:24:27  time: 1.8299  data_time: 0.0016  memory: 17318  
09/20 11:16:00 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:10:18  time: 1.9942  data_time: 0.0017  memory: 17098  
09/20 11:17:10 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:00:05  time: 1.4557  data_time: 0.0016  memory: 17091  
09/20 11:18:33 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:56:15  time: 1.5283  data_time: 0.0016  memory: 17100  
09/20 11:19:50 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:52:42  time: 1.3560  data_time: 0.0016  memory: 17098  
09/20 11:20:59 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:49:09  time: 1.0504  data_time: 0.0017  memory: 17094  
09/20 11:22:17 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:47:03  time: 1.3150  data_time: 0.0015  memory: 17098  
09/20 11:23:27 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:44:36  time: 1.4604  data_time: 0.0017  memory: 17096  
09/20 11:24:17 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:41:18  time: 1.0562  data_time: 0.0015  memory: 17020  
09/20 11:25:14 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:38:48  time: 0.9865  data_time: 0.0016  memory: 17079  
09/20 11:26:19 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:36:57  time: 1.6094  data_time: 0.0016  memory: 17098  
09/20 11:27:14 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:34:51  time: 1.3188  data_time: 0.0016  memory: 17026  
09/20 11:28:19 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:33:16  time: 1.4706  data_time: 0.0015  memory: 17100  
09/20 11:29:30 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:31:57  time: 1.0694  data_time: 0.0017  memory: 17101  
09/20 11:30:42 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:30:39  time: 1.9258  data_time: 0.0016  memory: 17104  
09/20 11:31:36 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:28:56  time: 1.0536  data_time: 0.0017  memory: 17091  
09/20 11:32:28 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:27:17  time: 1.0461  data_time: 0.0017  memory: 878  
09/20 11:33:20 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:25:42  time: 1.0232  data_time: 0.0014  memory: 17017  
09/20 11:34:27 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:24:29  time: 1.2081  data_time: 0.0016  memory: 17097  
09/20 11:35:24 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:23:06  time: 1.0048  data_time: 0.0016  memory: 17074  
09/20 11:36:30 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:21:53  time: 1.6951  data_time: 0.0015  memory: 17101  
09/20 11:37:31 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:20:38  time: 1.1234  data_time: 0.0016  memory: 17088  
09/20 11:38:27 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:19:20  time: 1.1658  data_time: 0.0015  memory: 17080  
09/20 11:39:20 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:18:01  time: 1.0211  data_time: 0.0015  memory: 1991  
09/20 11:40:16 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:16:46  time: 1.0980  data_time: 0.0015  memory: 17091  
09/20 11:41:05 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:15:30  time: 1.0210  data_time: 0.0015  memory: 1630  
09/20 11:41:59 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:14:17  time: 0.9531  data_time: 0.0015  memory: 17076  
09/20 11:43:08 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:13:12  time: 1.4971  data_time: 0.0016  memory: 17095  
09/20 11:44:02 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:12:02  time: 1.4072  data_time: 0.0015  memory: 17083  
09/20 11:44:52 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:10:51  time: 0.9566  data_time: 0.0014  memory: 903  
09/20 11:45:47 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:09:43  time: 1.0357  data_time: 0.0015  memory: 17025  
09/20 11:46:38 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:08:34  time: 1.1289  data_time: 0.0018  memory: 1674  
09/20 11:47:38 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:29  time: 0.9303  data_time: 0.0015  memory: 17098  
09/20 11:48:42 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:25  time: 1.0446  data_time: 0.0017  memory: 17089  
09/20 11:49:39 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:05:20  time: 1.0164  data_time: 0.0015  memory: 17078  
09/20 11:50:32 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:04:14  time: 1.0403  data_time: 0.0017  memory: 17078  
09/20 11:51:23 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:03:10  time: 1.0264  data_time: 0.0017  memory: 878  
09/20 11:52:15 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:02:06  time: 0.9941  data_time: 0.0016  memory: 17101  
09/20 11:53:12 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:02  time: 0.9881  data_time: 0.0015  memory: 17082  
09/20 11:54:04 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.9306  data_time: 0.0015  memory: 17030  
09/20 11:54:04 - mmengine - INFO - per class results:
09/20 11:54:04 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  61.7 | 78.64 |
|       building      | 72.06 | 88.11 |
|         sky         |  83.9 | 91.15 |
|        floor        |  67.0 | 81.99 |
|         tree        | 62.49 | 79.51 |
|       ceiling       | 67.98 | 81.44 |
|         road        | 73.58 | 85.55 |
|         bed         | 76.22 |  88.0 |
|      windowpane     | 48.18 | 66.93 |
|        grass        | 58.77 | 77.13 |
|       cabinet       |  48.2 | 62.28 |
|       sidewalk      | 51.51 | 66.41 |
|        person       | 58.83 | 77.73 |
|        earth        | 31.69 | 44.52 |
|         door        | 36.76 | 47.21 |
|        table        |  43.8 | 62.01 |
|       mountain      |  47.0 | 65.18 |
|        plant        | 41.54 | 55.62 |
|       curtain       | 53.32 | 68.91 |
|        chair        | 38.48 | 54.64 |
|         car         | 60.42 | 74.83 |
|        water        |  42.5 | 53.43 |
|       painting      | 45.65 | 66.28 |
|         sofa        | 51.62 | 71.65 |
|        shelf        | 36.25 | 53.62 |
|        house        |  34.0 | 40.83 |
|         sea         | 43.37 | 71.92 |
|        mirror       | 52.22 | 63.66 |
|         rug         | 37.71 | 49.21 |
|        field        | 23.81 |  35.6 |
|       armchair      | 33.41 | 46.45 |
|         seat        | 49.37 | 68.63 |
|        fence        |  29.4 | 45.74 |
|         desk        | 38.73 | 54.61 |
|         rock        | 29.85 | 46.15 |
|       wardrobe      | 38.42 | 56.33 |
|         lamp        | 30.23 | 46.94 |
|       bathtub       | 59.93 | 69.11 |
|       railing       |  24.8 | 40.08 |
|       cushion       | 36.56 | 51.11 |
|         base        |  16.6 | 22.69 |
|         box         | 14.76 | 20.87 |
|        column       |  31.4 | 43.21 |
|      signboard      | 21.33 | 31.91 |
|   chest of drawers  | 35.97 | 53.64 |
|       counter       |  21.9 | 28.88 |
|         sand        | 23.15 | 35.26 |
|         sink        | 45.61 | 62.72 |
|      skyscraper     | 35.49 | 42.46 |
|      fireplace      | 60.61 | 78.71 |
|     refrigerator    | 59.41 | 72.41 |
|      grandstand     | 41.12 | 72.24 |
|         path        | 15.13 | 21.17 |
|        stairs       | 22.29 | 26.72 |
|        runway       | 58.66 | 80.45 |
|         case        | 44.02 |  61.4 |
|      pool table     | 80.02 | 87.87 |
|        pillow       | 39.45 |  52.1 |
|     screen door     | 63.97 | 72.72 |
|       stairway      | 21.83 | 26.98 |
|        river        | 12.66 | 22.04 |
|        bridge       | 52.51 | 59.32 |
|       bookcase      | 35.93 | 51.41 |
|        blind        | 36.86 | 42.52 |
|     coffee table    | 45.91 | 64.55 |
|        toilet       | 59.12 |  72.8 |
|        flower       | 25.67 | 40.04 |
|         book        | 32.71 | 49.42 |
|         hill        |  7.27 | 10.64 |
|        bench        | 35.59 | 42.44 |
|      countertop     |  35.2 | 51.12 |
|        stove        | 58.95 | 67.45 |
|         palm        | 34.95 | 55.51 |
|    kitchen island   | 38.11 | 61.49 |
|       computer      | 45.02 | 57.63 |
|     swivel chair    | 32.35 | 47.94 |
|         boat        | 31.61 | 38.29 |
|         bar         |  16.5 |  20.2 |
|    arcade machine   | 33.49 | 36.33 |
|        hovel        | 22.27 | 23.66 |
|         bus         | 73.45 | 87.78 |
|        towel        | 30.64 | 44.13 |
|        light        | 14.79 | 23.03 |
|        truck        | 23.67 | 34.06 |
|        tower        |  7.5  |  9.91 |
|      chandelier     |  42.9 | 60.47 |
|        awning       | 11.07 | 13.86 |
|     streetlight     |  8.57 | 13.76 |
|        booth        | 41.73 | 45.79 |
| television receiver | 41.31 | 60.54 |
|       airplane      | 36.88 | 54.12 |
|      dirt track     | 11.28 | 20.55 |
|       apparel       | 22.62 | 40.73 |
|         pole        | 11.69 | 18.78 |
|         land        |  2.53 |  3.63 |
|      bannister      |  1.69 |  2.35 |
|      escalator      | 20.36 | 24.78 |
|       ottoman       | 36.01 | 45.56 |
|        bottle       |  9.62 |  13.2 |
|        buffet       | 36.22 | 44.33 |
|        poster       | 19.17 | 24.17 |
|        stage        | 11.63 | 17.23 |
|         van         | 32.45 | 43.88 |
|         ship        | 50.83 |  69.6 |
|       fountain      | 12.35 | 13.19 |
|    conveyer belt    | 65.24 | 77.78 |
|        canopy       | 13.86 | 16.15 |
|        washer       | 59.48 | 62.51 |
|      plaything      | 18.52 | 30.47 |
|    swimming pool    | 35.86 | 47.83 |
|        stool        | 24.26 |  39.5 |
|        barrel       | 39.71 | 67.72 |
|        basket       | 20.56 | 28.05 |
|      waterfall      | 47.29 | 64.09 |
|         tent        | 81.47 | 97.91 |
|         bag         |  5.62 |  7.25 |
|       minibike      | 48.43 | 66.23 |
|        cradle       | 68.05 | 91.15 |
|         oven        | 25.01 |  48.0 |
|         ball        | 34.87 | 63.85 |
|         food        | 44.11 | 57.51 |
|         step        |  9.77 | 11.96 |
|         tank        | 33.46 | 35.56 |
|      trade name     | 15.16 | 18.57 |
|      microwave      | 31.49 | 35.53 |
|         pot         | 22.08 | 30.97 |
|        animal       | 46.16 | 51.19 |
|       bicycle       | 33.61 | 52.01 |
|         lake        | 37.69 | 61.77 |
|      dishwasher     | 55.18 | 64.49 |
|        screen       | 49.44 | 68.26 |
|       blanket       |  6.48 |  7.58 |
|      sculpture      | 19.59 | 29.78 |
|         hood        | 43.28 | 59.51 |
|        sconce       | 17.29 | 25.26 |
|         vase        | 16.33 | 29.43 |
|    traffic light    | 14.98 | 27.62 |
|         tray        |  5.44 |  9.57 |
|        ashcan       | 23.75 | 36.78 |
|         fan         | 21.29 | 33.29 |
|         pier        | 16.29 | 19.54 |
|      crt screen     |  2.61 |  7.96 |
|        plate        | 33.92 | 48.69 |
|       monitor       |  7.96 | 10.05 |
|    bulletin board   | 26.82 | 37.34 |
|        shower       |  1.23 |  1.62 |
|       radiator      | 29.41 | 37.48 |
|        glass        |  7.33 |  8.69 |
|        clock        |  9.32 | 12.12 |
|         flag        | 15.03 |  18.6 |
+---------------------+-------+-------+
09/20 11:54:04 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 73.3200  mIoU: 35.0800  mAcc: 46.8300  data_time: 0.0017  time: 1.2532
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
09/20 11:54:08 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1147391149
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1147391149
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 11:54:08 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/pixelate'

09/20 11:54:12 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 11:54:12 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 11:54:12 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 11:54:13 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 11:55:35 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:53:42  time: 0.8450  data_time: 0.0015  memory: 17318  
09/20 11:56:21 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:40:33  time: 1.0304  data_time: 0.0017  memory: 17098  
09/20 11:56:45 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:31:14  time: 0.5095  data_time: 0.0016  memory: 17091  
09/20 11:57:20 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:07  time: 0.6267  data_time: 0.0015  memory: 17100  
09/20 11:57:52 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:25:35  time: 0.4326  data_time: 0.0014  memory: 17098  
09/20 11:58:17 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:07  time: 0.1174  data_time: 0.0015  memory: 17094  
09/20 11:58:50 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:21:48  time: 0.4399  data_time: 0.0014  memory: 17098  
09/20 11:59:15 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:09  time: 0.5171  data_time: 0.0014  memory: 17096  
09/20 11:59:24 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:17:52  time: 0.2159  data_time: 0.0014  memory: 17020  
09/20 11:59:36 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:09  time: 0.1101  data_time: 0.0014  memory: 17079  
09/20 11:59:49 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:14:48  time: 0.5185  data_time: 0.0015  memory: 17098  
09/20 11:59:58 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:26  time: 0.2760  data_time: 0.0015  memory: 17026  
09/20 12:00:17 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:35  time: 0.5174  data_time: 0.0013  memory: 17100  
09/20 12:00:37 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:54  time: 0.1191  data_time: 0.0016  memory: 17101  
09/20 12:00:59 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:17  time: 0.9679  data_time: 0.0015  memory: 17104  
09/20 12:01:08 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:23  time: 0.1079  data_time: 0.0016  memory: 17091  
09/20 12:01:14 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:29  time: 0.1105  data_time: 0.0017  memory: 878  
09/20 12:01:22 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:45  time: 0.2011  data_time: 0.0014  memory: 17017  
09/20 12:01:42 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:16  time: 0.3124  data_time: 0.0016  memory: 17097  
09/20 12:01:54 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:41  time: 0.1042  data_time: 0.0017  memory: 17074  
09/20 12:02:11 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:12  time: 0.6170  data_time: 0.0015  memory: 17101  
09/20 12:02:23 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:41  time: 0.1077  data_time: 0.0014  memory: 17088  
09/20 12:02:33 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:09  time: 0.2121  data_time: 0.0014  memory: 17080  
09/20 12:02:39 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:37  time: 0.1058  data_time: 0.0014  memory: 1991  
09/20 12:02:49 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:09  time: 0.2139  data_time: 0.0015  memory: 17091  
09/20 12:02:54 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:40  time: 0.1077  data_time: 0.0014  memory: 1630  
09/20 12:03:03 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:15  time: 0.1054  data_time: 0.0015  memory: 17076  
09/20 12:03:24 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:56  time: 0.5175  data_time: 0.0014  memory: 17095  
09/20 12:03:34 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:32  time: 0.4599  data_time: 0.0015  memory: 17083  
09/20 12:03:39 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:08  time: 0.1009  data_time: 0.0014  memory: 891  
09/20 12:03:46 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:46  time: 0.1109  data_time: 0.0014  memory: 17025  
09/20 12:03:52 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:24  time: 0.1047  data_time: 0.0015  memory: 1674  
09/20 12:04:04 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:05  time: 0.0998  data_time: 0.0030  memory: 17098  
09/20 12:04:16 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:46  time: 0.1073  data_time: 0.0015  memory: 17089  
09/20 12:04:27 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:27  time: 0.1107  data_time: 0.0013  memory: 17078  
09/20 12:04:35 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:09  time: 0.1088  data_time: 0.0015  memory: 17078  
09/20 12:04:40 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:50  time: 0.1079  data_time: 0.0015  memory: 878  
09/20 12:04:50 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:33  time: 0.1105  data_time: 0.0014  memory: 17101  
09/20 12:05:00 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.1026  data_time: 0.0014  memory: 17082  
09/20 12:05:09 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1004  data_time: 0.0012  memory: 17030  
09/20 12:05:09 - mmengine - INFO - per class results:
09/20 12:05:09 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.42 | 88.52 |
|       building      | 79.82 | 93.45 |
|         sky         | 93.53 | 96.81 |
|        floor        | 78.86 | 90.61 |
|         tree        | 72.36 | 86.55 |
|       ceiling       | 82.61 | 90.77 |
|         road        | 82.25 | 91.35 |
|         bed         | 87.54 | 94.95 |
|      windowpane     | 59.08 | 76.39 |
|        grass        | 65.27 | 83.32 |
|       cabinet       | 58.73 |  71.6 |
|       sidewalk      | 64.52 | 77.41 |
|        person       | 76.15 | 88.25 |
|        earth        | 35.53 | 49.42 |
|         door        | 44.72 | 56.49 |
|        table        | 59.32 | 75.95 |
|       mountain      | 53.67 | 69.03 |
|        plant        |  48.6 | 60.55 |
|       curtain       | 69.23 | 80.44 |
|        chair        |  54.6 | 67.89 |
|         car         | 80.64 | 87.13 |
|        water        | 45.48 | 59.09 |
|       painting      | 69.31 | 84.74 |
|         sofa        | 61.46 |  82.7 |
|        shelf        |  43.7 | 61.26 |
|        house        | 38.85 | 43.45 |
|         sea         | 46.37 | 74.42 |
|        mirror       | 65.23 | 72.83 |
|         rug         |  53.0 | 60.18 |
|        field        | 21.91 | 31.76 |
|       armchair      | 38.37 | 49.27 |
|         seat        | 55.35 | 72.54 |
|        fence        | 40.59 | 56.81 |
|         desk        | 49.92 | 62.02 |
|         rock        | 32.07 | 47.68 |
|       wardrobe      | 45.75 | 62.81 |
|         lamp        | 60.97 | 73.72 |
|       bathtub       | 74.91 | 80.06 |
|       railing       | 33.11 | 48.15 |
|       cushion       | 53.82 | 66.59 |
|         base        | 21.31 | 27.81 |
|         box         | 20.84 | 28.07 |
|        column       | 43.83 | 52.36 |
|      signboard      | 33.21 | 44.48 |
|   chest of drawers  | 42.61 | 63.48 |
|       counter       | 22.71 |  33.0 |
|         sand        | 27.46 | 36.72 |
|         sink        |  69.3 | 79.41 |
|      skyscraper     | 35.06 | 37.57 |
|      fireplace      | 67.99 | 85.78 |
|     refrigerator    | 75.98 |  84.1 |
|      grandstand     | 43.58 | 71.21 |
|         path        | 16.89 | 23.29 |
|        stairs       | 30.61 | 37.67 |
|        runway       | 61.21 | 81.47 |
|         case        | 44.99 | 66.55 |
|      pool table     | 91.23 | 95.12 |
|        pillow       | 54.27 |  63.8 |
|     screen door     | 69.36 | 78.52 |
|       stairway      |  28.0 | 34.49 |
|        river        | 10.74 | 20.13 |
|        bridge       | 57.07 | 62.83 |
|       bookcase      | 40.42 | 52.71 |
|        blind        | 43.49 | 50.02 |
|     coffee table    | 62.31 | 78.88 |
|        toilet       | 83.34 | 90.31 |
|        flower       | 33.57 | 47.39 |
|         book        | 43.37 | 62.57 |
|         hill        |  8.78 | 11.49 |
|        bench        | 43.52 | 48.41 |
|      countertop     | 51.82 | 67.31 |
|        stove        | 72.87 | 77.88 |
|         palm        |  47.3 |  65.7 |
|    kitchen island   | 46.77 |  77.0 |
|       computer      |  54.6 | 64.05 |
|     swivel chair    | 41.32 | 56.81 |
|         boat        | 39.72 | 42.27 |
|         bar         | 22.13 | 27.34 |
|    arcade machine   | 32.21 | 34.09 |
|        hovel        | 38.85 | 41.37 |
|         bus         | 86.98 | 94.72 |
|        towel        | 52.64 | 59.67 |
|        light        | 50.92 | 58.44 |
|        truck        | 29.23 | 40.04 |
|        tower        |  8.44 | 10.19 |
|      chandelier     | 66.04 | 84.36 |
|        awning       | 22.38 | 24.27 |
|     streetlight     | 25.21 | 33.62 |
|        booth        | 44.72 | 51.81 |
| television receiver | 66.17 | 78.09 |
|       airplane      | 48.08 |  62.6 |
|      dirt track     | 17.43 | 38.45 |
|       apparel       | 29.47 | 44.14 |
|         pole        | 22.46 | 31.92 |
|         land        |  3.42 |  4.56 |
|      bannister      |  5.23 |  6.64 |
|      escalator      | 13.51 | 14.72 |
|       ottoman       |  36.9 | 48.26 |
|        bottle       | 16.84 | 22.07 |
|        buffet       | 50.92 | 61.74 |
|        poster       | 24.72 | 29.45 |
|        stage        | 11.21 | 16.82 |
|         van         | 44.52 | 64.79 |
|         ship        | 60.53 | 80.51 |
|       fountain      | 10.56 | 10.77 |
|    conveyer belt    |  75.1 | 87.76 |
|        canopy       | 16.58 | 17.28 |
|        washer       | 64.67 | 66.72 |
|      plaything      | 26.13 | 36.75 |
|    swimming pool    | 40.66 | 54.78 |
|        stool        | 40.34 | 59.57 |
|        barrel       | 32.58 | 64.69 |
|        basket       | 28.59 | 36.21 |
|      waterfall      | 59.17 | 74.22 |
|         tent        | 94.51 | 98.12 |
|         bag         |  8.85 |  10.6 |
|       minibike      |  60.4 | 67.49 |
|        cradle       | 76.13 | 97.15 |
|         oven        | 22.78 | 54.67 |
|         ball        | 38.63 | 66.79 |
|         food        | 53.32 | 60.98 |
|         step        |  12.0 | 14.13 |
|         tank        | 32.32 | 35.17 |
|      trade name     | 25.81 | 30.59 |
|      microwave      | 37.68 | 41.43 |
|         pot         | 39.03 | 45.98 |
|        animal       | 52.69 | 57.23 |
|       bicycle       | 46.81 | 62.83 |
|         lake        | 43.89 | 58.67 |
|      dishwasher     | 74.18 | 79.51 |
|        screen       | 60.08 | 76.06 |
|       blanket       |  6.78 |  7.42 |
|      sculpture      | 26.32 | 32.61 |
|         hood        | 59.48 | 72.79 |
|        sconce       | 38.96 | 47.45 |
|         vase        | 36.72 | 53.32 |
|    traffic light    | 32.38 | 46.29 |
|         tray        |  6.84 | 10.88 |
|        ashcan       |  38.8 | 53.48 |
|         fan         | 56.95 | 68.76 |
|         pier        | 29.58 | 35.23 |
|      crt screen     |  5.59 | 14.47 |
|        plate        | 43.53 | 51.64 |
|       monitor       | 19.84 | 22.94 |
|    bulletin board   | 43.38 | 53.48 |
|        shower       |  1.02 |  1.23 |
|       radiator      | 37.55 | 45.37 |
|        glass        | 11.34 | 12.72 |
|        clock        | 24.15 | 27.12 |
|         flag        | 26.33 | 28.07 |
+---------------------+-------+-------+
09/20 12:05:09 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.2600  mIoU: 44.5500  mAcc: 55.2200  data_time: 0.0016  time: 0.3282
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
09/20 12:05:13 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1882886801
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1882886801
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/20 12:05:13 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=101,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dilations=(
            1,
            12,
            24,
            36,
        ),
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='ASPPHead'),
    pretrained='open-mmlab://resnet101_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/deeplabv3/deeplabv3_r101-d8_4xb4-160k_ade20k-512x512/jpeg_compression'

09/20 12:05:17 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/20 12:05:17 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/20 12:05:18 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 12:05:18 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/deeplabv3/deeplabv3_r101-d8_512x512_160k_ade20k_20200615_105816-b1f72b3b.pth
09/20 12:06:41 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:53:48  time: 0.8514  data_time: 0.0016  memory: 17318  
09/20 12:07:27 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:40:41  time: 1.0347  data_time: 0.0016  memory: 17098  
09/20 12:07:51 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:31:24  time: 0.5180  data_time: 0.0015  memory: 17091  
09/20 12:08:27 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:28:18  time: 0.6330  data_time: 0.0015  memory: 17100  
09/20 12:08:59 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:25:45  time: 0.4399  data_time: 0.0015  memory: 17098  
09/20 12:09:25 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:18  time: 0.1264  data_time: 0.0016  memory: 17094  
09/20 12:09:58 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:21:59  time: 0.4464  data_time: 0.0015  memory: 17098  
09/20 12:10:23 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:19  time: 0.5254  data_time: 0.0015  memory: 17096  
09/20 12:10:33 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:02  time: 0.2221  data_time: 0.0014  memory: 17020  
09/20 12:10:45 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:19  time: 0.1173  data_time: 0.0015  memory: 17079  
09/20 12:10:59 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:14:57  time: 0.5272  data_time: 0.0015  memory: 17098  
09/20 12:11:08 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:35  time: 0.2845  data_time: 0.0015  memory: 17026  
09/20 12:11:27 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:45  time: 0.5258  data_time: 0.0014  memory: 17100  
09/20 12:11:48 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:03  time: 0.1254  data_time: 0.0015  memory: 17101  
09/20 12:12:10 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:26  time: 0.9721  data_time: 0.0015  memory: 17104  
09/20 12:12:19 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:31  time: 0.1158  data_time: 0.0017  memory: 17091  
09/20 12:12:25 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:37  time: 0.1184  data_time: 0.0023  memory: 878  
09/20 12:12:34 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:52  time: 0.2072  data_time: 0.0014  memory: 17017  
09/20 12:12:54 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:23  time: 0.3183  data_time: 0.0015  memory: 17097  
09/20 12:13:06 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:48  time: 0.1105  data_time: 0.0015  memory: 17074  
09/20 12:13:23 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:18  time: 0.6249  data_time: 0.0015  memory: 17101  
09/20 12:13:36 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:47  time: 0.1145  data_time: 0.0016  memory: 17088  
09/20 12:13:46 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:15  time: 0.2173  data_time: 0.0015  memory: 17080  
09/20 12:13:52 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:42  time: 0.1158  data_time: 0.0015  memory: 1991  
09/20 12:14:03 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:15  time: 0.2211  data_time: 0.0015  memory: 17091  
09/20 12:14:09 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:45  time: 0.1141  data_time: 0.0015  memory: 1630  
09/20 12:14:18 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:19  time: 0.1113  data_time: 0.0015  memory: 17076  
09/20 12:14:39 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:00  time: 0.5261  data_time: 0.0015  memory: 17095  
09/20 12:14:49 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:36  time: 0.4676  data_time: 0.0015  memory: 17083  
09/20 12:14:55 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:12  time: 0.1090  data_time: 0.0015  memory: 903  
09/20 12:15:02 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:49  time: 0.1187  data_time: 0.0015  memory: 17025  
09/20 12:15:08 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:27  time: 0.1123  data_time: 0.0015  memory: 1674  
09/20 12:15:21 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:07  time: 0.1053  data_time: 0.0014  memory: 17098  
09/20 12:15:33 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:48  time: 0.1164  data_time: 0.0017  memory: 17089  
09/20 12:15:44 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:29  time: 0.1174  data_time: 0.0014  memory: 17078  
09/20 12:15:53 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:10  time: 0.1180  data_time: 0.0017  memory: 17078  
09/20 12:15:59 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:51  time: 0.1162  data_time: 0.0016  memory: 878  
09/20 12:16:08 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:34  time: 0.1171  data_time: 0.0015  memory: 17101  
09/20 12:16:19 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.1094  data_time: 0.0014  memory: 17082  
09/20 12:16:29 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1062  data_time: 0.0013  memory: 17030  
09/20 12:16:29 - mmengine - INFO - per class results:
09/20 12:16:29 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.45 | 88.96 |
|       building      |  79.6 | 92.81 |
|         sky         | 93.16 | 96.77 |
|        floor        |  77.3 | 91.18 |
|         tree        | 71.77 | 86.08 |
|       ceiling       | 79.86 | 88.25 |
|         road        | 80.66 | 89.89 |
|         bed         |  86.3 | 93.85 |
|      windowpane     | 58.08 | 74.48 |
|        grass        | 63.79 | 80.22 |
|       cabinet       | 57.59 | 70.57 |
|       sidewalk      | 61.68 | 75.38 |
|        person       | 75.63 | 88.35 |
|        earth        | 32.52 | 48.14 |
|         door        | 40.71 | 51.19 |
|        table        | 57.55 | 73.44 |
|       mountain      | 49.61 | 69.61 |
|        plant        |  48.4 |  60.0 |
|       curtain       | 66.72 | 76.56 |
|        chair        | 52.42 | 64.05 |
|         car         |  80.7 |  87.7 |
|        water        | 47.96 | 62.25 |
|       painting      | 69.05 | 82.17 |
|         sofa        | 61.73 | 81.87 |
|        shelf        | 39.93 | 56.82 |
|        house        | 34.56 | 38.65 |
|         sea         | 46.83 | 75.62 |
|        mirror       | 62.93 | 70.27 |
|         rug         | 47.88 | 51.98 |
|        field        | 22.14 | 32.38 |
|       armchair      |  37.1 | 48.33 |
|         seat        | 54.38 |  72.6 |
|        fence        | 39.45 | 54.25 |
|         desk        | 49.75 | 62.76 |
|         rock        | 29.94 | 44.36 |
|       wardrobe      | 45.05 | 63.31 |
|         lamp        | 61.65 | 72.56 |
|       bathtub       | 76.62 | 82.16 |
|       railing       | 31.52 | 43.39 |
|       cushion       | 51.94 | 66.57 |
|         base        | 18.02 | 23.61 |
|         box         | 18.14 | 24.27 |
|        column       | 44.54 | 52.81 |
|      signboard      | 33.03 | 43.49 |
|   chest of drawers  | 42.79 | 62.77 |
|       counter       |  20.1 | 28.01 |
|         sand        |  20.3 | 27.92 |
|         sink        | 69.92 | 78.49 |
|      skyscraper     | 32.91 | 35.46 |
|      fireplace      | 71.29 | 84.67 |
|     refrigerator    | 74.01 | 82.57 |
|      grandstand     | 42.54 | 67.53 |
|         path        | 16.63 | 25.31 |
|        stairs       | 29.86 | 37.77 |
|        runway       | 61.02 | 81.77 |
|         case        | 43.83 | 60.97 |
|      pool table     | 90.78 | 94.62 |
|        pillow       | 51.19 | 58.28 |
|     screen door     | 67.32 | 72.63 |
|       stairway      | 26.92 | 30.63 |
|        river        |  8.36 | 14.45 |
|        bridge       | 48.98 | 53.84 |
|       bookcase      | 37.34 | 46.63 |
|        blind        |  28.7 | 30.65 |
|     coffee table    | 62.97 |  76.6 |
|        toilet       | 83.21 | 88.67 |
|        flower       | 34.37 |  48.7 |
|         book        |  42.8 | 59.72 |
|         hill        |  9.85 | 12.35 |
|        bench        | 45.23 |  49.5 |
|      countertop     | 51.78 | 63.11 |
|        stove        | 72.51 | 79.89 |
|         palm        | 45.63 | 64.55 |
|    kitchen island   | 41.88 | 65.58 |
|       computer      | 53.99 | 63.14 |
|     swivel chair    | 40.78 | 53.39 |
|         boat        | 37.06 | 41.72 |
|         bar         | 17.12 | 21.86 |
|    arcade machine   | 37.76 | 40.08 |
|        hovel        | 38.02 |  42.5 |
|         bus         | 86.29 | 94.17 |
|        towel        | 46.94 | 51.26 |
|        light        | 46.86 | 52.31 |
|        truck        |  26.8 | 34.02 |
|        tower        | 17.62 | 22.67 |
|      chandelier     | 66.16 | 83.42 |
|        awning       | 19.68 | 21.39 |
|     streetlight     | 23.04 | 28.55 |
|        booth        | 39.85 | 47.17 |
| television receiver | 63.43 | 74.28 |
|       airplane      | 52.69 | 62.03 |
|      dirt track     | 19.47 | 43.46 |
|       apparel       | 30.36 | 43.77 |
|         pole        | 22.16 | 31.57 |
|         land        |  1.39 |  1.86 |
|      bannister      |  4.68 |  5.95 |
|      escalator      | 15.23 | 16.32 |
|       ottoman       |  41.9 | 49.84 |
|        bottle       | 17.28 | 20.51 |
|        buffet       |  42.0 | 48.72 |
|        poster       | 20.61 |  24.6 |
|        stage        | 11.26 | 16.69 |
|         van         | 43.83 | 60.84 |
|         ship        | 73.82 | 89.25 |
|       fountain      |  7.97 |  8.24 |
|    conveyer belt    |  69.2 | 87.66 |
|        canopy       | 16.22 |  16.9 |
|        washer       | 66.28 | 66.64 |
|      plaything      | 34.52 |  42.6 |
|    swimming pool    | 36.38 | 45.77 |
|        stool        | 37.05 | 53.99 |
|        barrel       | 27.18 | 64.03 |
|        basket       | 24.49 | 32.48 |
|      waterfall      | 57.11 | 69.83 |
|         tent        |  92.4 | 98.21 |
|         bag         |  8.34 |  9.97 |
|       minibike      | 62.36 | 72.77 |
|        cradle       |  75.8 | 96.22 |
|         oven        | 22.12 | 47.69 |
|         ball        | 36.92 | 63.84 |
|         food        | 52.83 | 65.87 |
|         step        | 11.66 | 13.72 |
|         tank        | 32.25 | 35.78 |
|      trade name     | 24.47 | 29.34 |
|      microwave      | 36.29 | 39.86 |
|         pot         | 38.71 | 44.79 |
|        animal       |  53.2 | 58.06 |
|       bicycle       | 47.78 | 67.39 |
|         lake        | 54.07 | 57.52 |
|      dishwasher     |  61.2 | 69.22 |
|        screen       | 54.81 | 68.18 |
|       blanket       |  5.41 |  5.85 |
|      sculpture      | 34.14 | 45.77 |
|         hood        | 59.84 | 65.58 |
|        sconce       | 34.64 | 39.85 |
|         vase        | 34.73 | 47.83 |
|    traffic light    | 30.92 | 42.21 |
|         tray        |  6.09 | 10.35 |
|        ashcan       | 34.88 | 44.74 |
|         fan         | 54.31 | 65.19 |
|         pier        | 18.32 |  21.2 |
|      crt screen     |  2.32 |  6.95 |
|        plate        | 45.51 |  54.9 |
|       monitor       |  15.9 | 17.97 |
|    bulletin board   | 38.29 | 45.75 |
|        shower       |  1.21 |  1.45 |
|       radiator      | 35.29 | 40.37 |
|        glass        |  9.54 | 10.42 |
|        clock        | 20.53 | 22.75 |
|         flag        |  24.7 | 26.36 |
+---------------------+-------+-------+
09/20 12:16:29 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.2900  mIoU: 43.2800  mAcc: 53.1100  data_time: 0.0016  time: 0.3351
Finished processing corruption type: jpeg_compression
Runtime: 1726827389

============================= JOB FEEDBACK =============================

NodeName=uc2n487
Job ID: 24247146
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 07:28:55
CPU Efficiency: 5.21% of 5-23:40:00 core-walltime
Job Wall-clock time: 08:58:45
Memory Utilized: 2.56 GB
Memory Efficiency: 2.56% of 100.00 GB
