Started at Sun Oct  6 01:02:49 CEST 2024
Processing corruption type: gaussian_noise
10/06 01:04:31 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1278069771
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1278069771
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 01:04:32 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='gaussian_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/gaussian_noise'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 01:05:29,564 - mmseg - INFO - using core type: DCNv3
2024-10-06 01:05:29,564 - mmseg - INFO - using activation layer: GELU
2024-10-06 01:05:29,564 - mmseg - INFO - using main norm layer: LN
2024-10-06 01:05:29,564 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 01:05:29,564 - mmseg - INFO - level2_post_norm: False
2024-10-06 01:05:29,564 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 01:05:29,564 - mmseg - INFO - res_post_norm: False
2024-10-06 01:05:29,564 - mmseg - INFO - use_dcn_v4_op: False
10/06 01:05:34 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 01:05:34 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 01:05:36 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 01:05:38 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 01:06:57 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:50:59  time: 0.5083  data_time: 0.0016  memory: 29516  
10/06 01:07:25 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:33:46  time: 0.6925  data_time: 0.0040  memory: 15185  
10/06 01:07:41 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:25:17  time: 0.3462  data_time: 0.0017  memory: 15170  
10/06 01:08:05 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:21:59  time: 0.4282  data_time: 0.0016  memory: 15186  
10/06 01:08:27 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:19:44  time: 0.2536  data_time: 0.0016  memory: 15182  
10/06 01:08:46 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:17:44  time: 0.1202  data_time: 0.0017  memory: 15176  
10/06 01:09:07 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:16:24  time: 0.2841  data_time: 0.0016  memory: 15183  
10/06 01:09:24 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:15:02  time: 0.2873  data_time: 0.0015  memory: 15181  
10/06 01:09:33 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:13:28  time: 0.2149  data_time: 0.0015  memory: 9791  
10/06 01:09:42 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:12:12  time: 0.1566  data_time: 0.0036  memory: 15149  
10/06 01:09:52 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:11:09  time: 0.2992  data_time: 0.0017  memory: 15183  
10/06 01:10:01 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:10:12  time: 0.2684  data_time: 0.0017  memory: 9975  
10/06 01:10:14 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:09:32  time: 0.3151  data_time: 0.0014  memory: 15188  
10/06 01:10:29 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:09:00  time: 0.1219  data_time: 0.0017  memory: 15187  
10/06 01:10:46 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:08:32  time: 0.6627  data_time: 0.0015  memory: 15192  
10/06 01:10:53 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:07:51  time: 0.1143  data_time: 0.0017  memory: 15170  
10/06 01:10:59 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:07:13  time: 0.1157  data_time: 0.0018  memory: 967  
10/06 01:11:08 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:06:42  time: 0.2090  data_time: 0.0015  memory: 9232  
10/06 01:11:23 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:06:21  time: 0.3791  data_time: 0.0016  memory: 15181  
10/06 01:11:33 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:55  time: 0.1098  data_time: 0.0016  memory: 15139  
10/06 01:11:47 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:05:33  time: 0.4784  data_time: 0.0016  memory: 15191  
10/06 01:11:58 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:10  time: 0.1133  data_time: 0.0016  memory: 15164  
10/06 01:12:07 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:47  time: 0.2807  data_time: 0.0015  memory: 15151  
10/06 01:12:13 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:23  time: 0.1120  data_time: 0.0015  memory: 2148  
10/06 01:12:22 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:02  time: 0.2381  data_time: 0.0015  memory: 15172  
10/06 01:12:27 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:40  time: 0.1134  data_time: 0.0015  memory: 969  
10/06 01:12:35 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:20  time: 0.1071  data_time: 0.0015  memory: 15146  
10/06 01:12:48 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:04  time: 0.3186  data_time: 0.0015  memory: 15176  
10/06 01:12:56 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:46  time: 0.2849  data_time: 0.0015  memory: 15158  
10/06 01:13:02 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:27  time: 0.1059  data_time: 0.0015  memory: 968  
10/06 01:13:10 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:11  time: 0.1195  data_time: 0.0016  memory: 10910  
10/06 01:13:15 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:54  time: 0.1116  data_time: 0.0016  memory: 966  
10/06 01:13:27 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:39  time: 0.1053  data_time: 0.0015  memory: 15182  
10/06 01:13:37 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:24  time: 0.1146  data_time: 0.0017  memory: 15165  
10/06 01:13:46 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:09  time: 0.1169  data_time: 0.0015  memory: 15148  
10/06 01:13:53 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:54  time: 0.1145  data_time: 0.0016  memory: 15148  
10/06 01:13:58 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:40  time: 0.1113  data_time: 0.0016  memory: 915  
10/06 01:14:05 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:26  time: 0.1119  data_time: 0.0015  memory: 15188  
10/06 01:14:15 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:13  time: 0.1078  data_time: 0.0014  memory: 15154  
10/06 01:14:24 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1005  data_time: 0.0014  memory: 8857  
10/06 01:14:24 - mmengine - INFO - per class results:
10/06 01:14:24 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 71.72 | 87.34 |
|       building      | 79.11 | 88.54 |
|         sky         |  92.7 | 97.06 |
|        floor        |  75.5 | 88.93 |
|         tree        | 68.75 | 90.48 |
|       ceiling       | 78.73 | 89.49 |
|         road        | 76.12 | 86.31 |
|         bed         | 84.94 | 92.66 |
|      windowpane     | 57.32 | 73.14 |
|        grass        | 58.72 | 71.19 |
|       cabinet       | 53.61 | 63.63 |
|       sidewalk      | 49.08 | 58.65 |
|        person       | 76.69 | 90.27 |
|        earth        | 29.39 | 58.37 |
|         door        | 40.74 | 48.47 |
|        table        | 55.56 | 73.15 |
|       mountain      | 47.41 | 56.22 |
|        plant        | 45.08 | 55.75 |
|       curtain       | 58.03 |  67.6 |
|        chair        |  51.4 | 61.31 |
|         car         | 82.24 | 89.86 |
|        water        | 44.12 | 55.86 |
|       painting      | 68.69 | 81.44 |
|         sofa        | 62.75 | 79.04 |
|        shelf        | 33.02 | 45.52 |
|        house        | 44.59 | 65.16 |
|         sea         | 46.08 | 65.75 |
|        mirror       |  64.2 | 70.35 |
|         rug         | 41.47 | 47.53 |
|        field        | 28.66 | 55.62 |
|       armchair      | 40.43 | 60.19 |
|         seat        | 55.47 | 69.51 |
|        fence        | 36.62 | 47.73 |
|         desk        | 43.86 | 64.72 |
|         rock        | 34.07 | 62.45 |
|       wardrobe      |  43.3 | 60.51 |
|         lamp        | 58.34 |  68.9 |
|       bathtub       | 68.73 | 74.68 |
|       railing       | 28.39 |  40.4 |
|       cushion       | 50.72 |  62.9 |
|         base        | 21.27 | 26.26 |
|         box         | 20.98 | 26.27 |
|        column       | 38.74 | 60.92 |
|      signboard      | 34.47 | 45.91 |
|   chest of drawers  | 39.44 | 64.39 |
|       counter       | 26.96 | 32.01 |
|         sand        | 32.18 | 54.75 |
|         sink        | 68.14 | 76.61 |
|      skyscraper     | 45.36 | 58.08 |
|      fireplace      | 70.86 | 81.55 |
|     refrigerator    | 74.08 |  86.8 |
|      grandstand     | 44.49 | 71.54 |
|         path        | 22.37 | 38.09 |
|        stairs       | 32.53 | 40.73 |
|        runway       |  62.5 | 71.18 |
|         case        | 32.88 |  46.0 |
|      pool table     | 90.35 | 93.48 |
|        pillow       |  52.5 | 69.27 |
|     screen door     |  62.9 | 64.94 |
|       stairway      | 30.45 | 39.48 |
|        river        |  2.11 |  3.55 |
|        bridge       | 33.07 | 41.06 |
|       bookcase      | 34.26 | 48.43 |
|        blind        | 28.54 | 30.62 |
|     coffee table    | 63.36 |  77.4 |
|        toilet       | 81.05 |  86.5 |
|        flower       | 40.78 | 64.05 |
|         book        | 45.98 | 60.17 |
|         hill        | 14.49 | 18.64 |
|        bench        | 38.61 | 51.11 |
|      countertop     | 46.56 | 71.47 |
|        stove        | 74.88 | 80.95 |
|         palm        | 41.07 | 44.69 |
|    kitchen island   | 23.23 | 48.02 |
|       computer      |  55.6 | 62.84 |
|     swivel chair    | 41.66 | 51.82 |
|         boat        | 39.95 | 42.62 |
|         bar         | 17.78 |  20.9 |
|    arcade machine   | 11.48 | 11.71 |
|        hovel        | 38.25 | 54.77 |
|         bus         | 88.16 | 95.39 |
|        towel        | 53.57 | 60.15 |
|        light        | 39.96 | 43.61 |
|        truck        | 18.28 |  25.6 |
|        tower        |  7.03 |  9.47 |
|      chandelier     | 60.92 | 79.24 |
|        awning       | 22.18 |  24.9 |
|     streetlight     | 22.12 | 29.78 |
|        booth        | 36.12 | 38.03 |
| television receiver | 55.86 | 68.91 |
|       airplane      | 59.99 | 68.93 |
|      dirt track     |  7.16 | 17.92 |
|       apparel       | 33.81 | 46.65 |
|         pole        | 21.89 | 35.42 |
|         land        |  0.0  |  0.0  |
|      bannister      | 13.42 | 19.88 |
|      escalator      |  9.45 |  9.67 |
|       ottoman       | 40.83 | 57.94 |
|        bottle       | 33.82 | 62.77 |
|        buffet       | 48.47 | 64.86 |
|        poster       | 16.28 | 18.59 |
|        stage        | 16.77 | 25.71 |
|         van         | 47.18 | 64.64 |
|         ship        |  7.51 | 10.99 |
|       fountain      | 16.55 | 17.28 |
|    conveyer belt    | 75.75 | 78.37 |
|        canopy       | 14.18 | 15.84 |
|        washer       | 71.55 | 74.83 |
|      plaything      | 15.37 | 17.55 |
|    swimming pool    |  7.83 | 12.46 |
|        stool        | 37.49 | 49.29 |
|        barrel       |  8.94 | 41.56 |
|        basket       | 27.95 | 31.22 |
|      waterfall      | 40.11 | 48.98 |
|         tent        | 93.25 | 98.89 |
|         bag         |  9.15 |  10.8 |
|       minibike      | 67.15 | 83.68 |
|        cradle       | 81.85 | 90.37 |
|         oven        |  35.0 |  60.6 |
|         ball        | 27.56 | 34.85 |
|         food        |  47.5 |  62.6 |
|         step        | 11.41 | 14.77 |
|         tank        | 35.35 | 39.81 |
|      trade name     | 23.88 | 28.41 |
|      microwave      | 69.79 | 81.46 |
|         pot         | 40.32 | 44.95 |
|        animal       | 58.52 | 60.67 |
|       bicycle       | 52.28 | 77.88 |
|         lake        |  2.48 |  2.73 |
|      dishwasher     | 49.05 | 65.62 |
|        screen       | 57.67 | 83.65 |
|       blanket       | 13.31 | 14.76 |
|      sculpture      | 42.85 | 57.01 |
|         hood        | 48.99 | 50.58 |
|        sconce       | 28.65 | 33.54 |
|         vase        | 37.67 | 55.55 |
|    traffic light    | 27.22 | 32.93 |
|         tray        |  9.77 |  16.5 |
|        ashcan       | 33.88 | 43.54 |
|         fan         | 54.56 | 66.72 |
|         pier        | 29.33 |  37.8 |
|      crt screen     |  0.0  |  0.0  |
|        plate        | 51.32 |  63.4 |
|       monitor       |  1.58 |  1.82 |
|    bulletin board   | 38.17 | 54.02 |
|        shower       |  0.93 |  3.94 |
|       radiator      | 40.13 | 44.48 |
|        glass        | 12.26 | 12.86 |
|        clock        | 35.38 | 45.34 |
|         flag        | 42.68 | 47.72 |
+---------------------+-------+-------+
10/06 01:14:24 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.8500  mIoU: 41.9300  mAcc: 52.5100  data_time: 0.0024  time: 0.2630
Finished processing corruption type: gaussian_noise
Processing corruption type: shot_noise
10/06 01:15:00 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1296765651
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1296765651
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 01:15:02 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='shot_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/shot_noise'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 01:15:18,431 - mmseg - INFO - using core type: DCNv3
2024-10-06 01:15:18,431 - mmseg - INFO - using activation layer: GELU
2024-10-06 01:15:18,431 - mmseg - INFO - using main norm layer: LN
2024-10-06 01:15:18,431 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 01:15:18,431 - mmseg - INFO - level2_post_norm: False
2024-10-06 01:15:18,431 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 01:15:18,431 - mmseg - INFO - res_post_norm: False
2024-10-06 01:15:18,431 - mmseg - INFO - use_dcn_v4_op: False
10/06 01:15:22 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 01:15:22 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 01:15:23 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 01:15:25 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 01:16:26 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:39:36  time: 0.5858  data_time: 0.0015  memory: 29516  
10/06 01:16:58 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:29:10  time: 0.7242  data_time: 0.0016  memory: 15185  
10/06 01:17:17 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:23:00  time: 0.3816  data_time: 0.0016  memory: 15170  
10/06 01:17:44 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:20:48  time: 0.4877  data_time: 0.0016  memory: 15186  
10/06 01:18:11 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:19:17  time: 0.3302  data_time: 0.0015  memory: 15182  
10/06 01:18:33 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:17:45  time: 0.2046  data_time: 0.0016  memory: 15176  
10/06 01:18:58 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:16:41  time: 0.3548  data_time: 0.0015  memory: 15183  
10/06 01:19:19 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:15:33  time: 0.3625  data_time: 0.0015  memory: 15181  
10/06 01:19:31 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:14:06  time: 0.2841  data_time: 0.0015  memory: 9791  
10/06 01:19:44 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:12:54  time: 0.1855  data_time: 0.0015  memory: 15149  
10/06 01:19:57 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:11:56  time: 0.3677  data_time: 0.0016  memory: 15183  
10/06 01:20:10 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:03  time: 0.3443  data_time: 0.0017  memory: 9975  
10/06 01:20:26 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:10:24  time: 0.3887  data_time: 0.0014  memory: 15188  
10/06 01:20:45 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:09:54  time: 0.1980  data_time: 0.0017  memory: 15187  
10/06 01:21:06 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:09:27  time: 0.7318  data_time: 0.0016  memory: 15192  
10/06 01:21:17 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:08:46  time: 0.1899  data_time: 0.0017  memory: 15170  
10/06 01:21:26 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:08  time: 0.1921  data_time: 0.0018  memory: 967  
10/06 01:21:39 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:36  time: 0.2737  data_time: 0.0015  memory: 9232  
10/06 01:21:58 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:13  time: 0.4500  data_time: 0.0016  memory: 15181  
10/06 01:22:12 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:46  time: 0.1796  data_time: 0.0015  memory: 15139  
10/06 01:22:29 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:22  time: 0.5515  data_time: 0.0016  memory: 15191  
10/06 01:22:44 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:58  time: 0.1848  data_time: 0.0016  memory: 15164  
10/06 01:22:56 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:32  time: 0.3181  data_time: 0.0015  memory: 15151  
10/06 01:23:05 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:06  time: 0.1849  data_time: 0.0015  memory: 2148  
10/06 01:23:18 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:43  time: 0.3092  data_time: 0.0015  memory: 15172  
10/06 01:23:27 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:19  time: 0.1889  data_time: 0.0015  memory: 969  
10/06 01:23:38 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:57  time: 0.1771  data_time: 0.0015  memory: 15146  
10/06 01:23:55 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:38  time: 0.3969  data_time: 0.0015  memory: 15176  
10/06 01:24:07 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:17  time: 0.3843  data_time: 0.0015  memory: 15158  
10/06 01:24:16 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:56  time: 0.1728  data_time: 0.0015  memory: 968  
10/06 01:24:28 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:37  time: 0.1945  data_time: 0.0015  memory: 10910  
10/06 01:24:37 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:17  time: 0.1849  data_time: 0.0016  memory: 966  
10/06 01:24:52 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:00  time: 0.1745  data_time: 0.0015  memory: 15182  
10/06 01:25:06 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:42  time: 0.1913  data_time: 0.0016  memory: 15165  
10/06 01:25:18 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:24  time: 0.1927  data_time: 0.0015  memory: 15148  
10/06 01:25:29 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:07  time: 0.1938  data_time: 0.0017  memory: 15148  
10/06 01:25:38 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:49  time: 0.1897  data_time: 0.0016  memory: 915  
10/06 01:25:49 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:32  time: 0.1828  data_time: 0.0015  memory: 15188  
10/06 01:26:02 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.1856  data_time: 0.0015  memory: 15154  
10/06 01:26:15 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1700  data_time: 0.0014  memory: 8857  
10/06 01:26:15 - mmengine - INFO - per class results:
10/06 01:26:15 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 71.08 | 87.93 |
|       building      |  79.6 | 88.81 |
|         sky         | 92.34 | 96.79 |
|        floor        | 75.52 | 88.84 |
|         tree        | 69.28 | 90.65 |
|       ceiling       | 77.18 | 87.52 |
|         road        | 75.61 | 85.46 |
|         bed         | 84.69 | 92.63 |
|      windowpane     | 56.25 | 70.97 |
|        grass        | 57.08 | 68.79 |
|       cabinet       | 54.54 | 63.78 |
|       sidewalk      | 49.16 | 58.21 |
|        person       | 77.63 | 90.71 |
|        earth        | 29.02 | 61.16 |
|         door        | 39.23 | 45.91 |
|        table        | 55.99 | 73.82 |
|       mountain      | 45.54 | 52.67 |
|        plant        | 45.84 | 55.94 |
|       curtain       | 56.64 | 65.72 |
|        chair        | 53.53 | 63.86 |
|         car         | 82.43 | 89.59 |
|        water        | 46.19 | 58.03 |
|       painting      | 69.18 | 81.21 |
|         sofa        | 62.66 | 77.37 |
|        shelf        | 34.07 | 46.48 |
|        house        | 48.85 | 68.56 |
|         sea         | 47.01 | 67.58 |
|        mirror       | 63.75 | 69.91 |
|         rug         | 41.35 | 47.49 |
|        field        | 27.14 | 57.42 |
|       armchair      | 40.24 | 61.67 |
|         seat        |  55.6 | 70.73 |
|        fence        | 35.71 | 47.13 |
|         desk        | 44.79 | 65.28 |
|         rock        | 36.07 | 62.96 |
|       wardrobe      | 42.22 | 58.62 |
|         lamp        | 56.42 | 66.06 |
|       bathtub       | 60.41 | 66.88 |
|       railing       | 28.09 | 40.44 |
|       cushion       | 49.23 | 60.05 |
|         base        | 20.71 |  26.3 |
|         box         | 18.94 | 24.07 |
|        column       |  38.4 | 59.85 |
|      signboard      | 35.02 | 46.56 |
|   chest of drawers  | 39.88 | 69.05 |
|       counter       | 30.71 | 36.58 |
|         sand        | 31.35 | 56.86 |
|         sink        | 64.34 | 75.21 |
|      skyscraper     | 48.92 | 63.11 |
|      fireplace      | 69.37 | 79.68 |
|     refrigerator    | 75.11 | 85.68 |
|      grandstand     | 43.81 |  70.1 |
|         path        | 20.42 | 38.24 |
|        stairs       | 33.95 | 42.13 |
|        runway       | 36.68 | 40.44 |
|         case        | 29.26 | 38.48 |
|      pool table     | 90.57 | 93.94 |
|        pillow       | 51.07 | 67.38 |
|     screen door     | 59.36 | 60.49 |
|       stairway      | 33.79 | 42.08 |
|        river        |  3.6  |  5.22 |
|        bridge       | 31.42 | 39.62 |
|       bookcase      | 31.02 | 46.09 |
|        blind        |  28.9 | 30.56 |
|     coffee table    | 64.44 | 79.22 |
|        toilet       | 78.65 |  85.0 |
|        flower       | 36.67 | 56.17 |
|         book        | 45.94 | 58.79 |
|         hill        | 13.16 |  17.5 |
|        bench        | 37.25 | 47.82 |
|      countertop     | 43.39 | 71.99 |
|        stove        | 70.19 | 76.98 |
|         palm        |  42.8 |  46.3 |
|    kitchen island   | 25.96 |  50.9 |
|       computer      | 56.51 | 62.32 |
|     swivel chair    | 42.12 | 55.56 |
|         boat        | 42.16 | 45.11 |
|         bar         |  19.1 | 22.05 |
|    arcade machine   | 11.58 | 11.76 |
|        hovel        | 30.91 | 45.91 |
|         bus         | 88.86 | 95.39 |
|        towel        | 45.12 | 49.85 |
|        light        | 37.31 | 40.06 |
|        truck        | 18.92 | 27.73 |
|        tower        |  7.46 |  9.29 |
|      chandelier     | 57.74 | 76.83 |
|        awning       | 23.04 | 25.93 |
|     streetlight     | 22.91 | 31.14 |
|        booth        | 34.96 | 37.19 |
| television receiver |  61.2 | 72.22 |
|       airplane      | 60.02 | 68.26 |
|      dirt track     |  5.91 | 12.82 |
|       apparel       | 32.96 | 47.41 |
|         pole        | 20.62 | 33.66 |
|         land        |  0.0  |  0.0  |
|      bannister      | 13.75 | 18.51 |
|      escalator      | 15.04 | 15.42 |
|       ottoman       | 44.26 |  58.6 |
|        bottle       | 33.56 | 62.22 |
|        buffet       | 47.99 | 61.32 |
|        poster       | 20.77 | 23.35 |
|        stage        | 15.97 | 23.88 |
|         van         |  45.5 | 64.73 |
|         ship        |  7.73 | 10.95 |
|       fountain      | 17.37 | 18.77 |
|    conveyer belt    | 80.22 | 82.95 |
|        canopy       | 12.77 |  14.2 |
|        washer       | 69.18 | 72.21 |
|      plaything      | 10.04 |  11.4 |
|    swimming pool    |  7.98 | 12.39 |
|        stool        |  38.9 | 52.68 |
|        barrel       |  9.0  | 59.14 |
|        basket       | 30.81 | 34.76 |
|      waterfall      | 35.89 | 41.14 |
|         tent        |  90.9 |  98.8 |
|         bag         |  6.53 |  7.63 |
|       minibike      | 68.34 | 85.21 |
|        cradle       | 79.03 | 86.43 |
|         oven        | 40.71 | 71.84 |
|         ball        | 29.26 | 37.68 |
|         food        | 47.31 |  62.5 |
|         step        | 12.94 | 16.31 |
|         tank        | 35.65 |  39.7 |
|      trade name     | 23.47 | 28.13 |
|      microwave      | 69.27 | 80.95 |
|         pot         | 40.57 | 44.93 |
|        animal       | 60.96 | 62.86 |
|       bicycle       | 54.41 | 79.85 |
|         lake        |  0.13 |  0.14 |
|      dishwasher     | 52.57 | 64.84 |
|        screen       | 57.29 | 83.99 |
|       blanket       | 13.08 | 13.85 |
|      sculpture      | 48.79 | 69.93 |
|         hood        | 44.88 | 46.28 |
|        sconce       |  28.2 | 32.46 |
|         vase        | 36.91 | 54.78 |
|    traffic light    | 26.97 | 32.27 |
|         tray        |  7.84 | 13.77 |
|        ashcan       | 36.43 | 50.34 |
|         fan         | 52.92 | 63.21 |
|         pier        | 31.84 | 41.79 |
|      crt screen     |  0.1  |  0.3  |
|        plate        | 50.17 | 62.34 |
|       monitor       |  1.54 |  1.79 |
|    bulletin board   | 42.22 | 51.86 |
|        shower       |  0.35 |  1.56 |
|       radiator      | 33.99 | 36.95 |
|        glass        | 12.33 | 12.95 |
|        clock        | 33.25 | 43.09 |
|         flag        | 43.59 |  48.5 |
+---------------------+-------+-------+
10/06 01:26:15 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.6200  mIoU: 41.5500  mAcc: 52.1400  data_time: 0.0018  time: 0.3249
Finished processing corruption type: shot_noise
Processing corruption type: impulse_noise
10/06 01:26:19 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 632897076
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 632897076
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 01:26:20 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='impulse_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/impulse_noise'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 01:26:23,798 - mmseg - INFO - using core type: DCNv3
2024-10-06 01:26:23,798 - mmseg - INFO - using activation layer: GELU
2024-10-06 01:26:23,798 - mmseg - INFO - using main norm layer: LN
2024-10-06 01:26:23,798 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 01:26:23,798 - mmseg - INFO - level2_post_norm: False
2024-10-06 01:26:23,798 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 01:26:23,798 - mmseg - INFO - res_post_norm: False
2024-10-06 01:26:23,798 - mmseg - INFO - use_dcn_v4_op: False
10/06 01:26:26 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 01:26:26 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 01:26:27 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 01:26:29 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 01:27:17 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:32  time: 0.4798  data_time: 0.0016  memory: 29516  
10/06 01:27:44 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:44  time: 0.6266  data_time: 0.0017  memory: 15185  
10/06 01:27:59 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:29  time: 0.2871  data_time: 0.0016  memory: 15170  
10/06 01:28:22 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:59  time: 0.4201  data_time: 0.0016  memory: 15186  
10/06 01:28:45 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:50  time: 0.2375  data_time: 0.0016  memory: 15182  
10/06 01:29:03 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:14:32  time: 0.1118  data_time: 0.0017  memory: 15176  
10/06 01:29:23 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:41  time: 0.2761  data_time: 0.0015  memory: 15183  
10/06 01:29:40 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:43  time: 0.2719  data_time: 0.0015  memory: 15181  
10/06 01:29:48 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:11:26  time: 0.1986  data_time: 0.0015  memory: 9791  
10/06 01:29:56 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:10:22  time: 0.0934  data_time: 0.0015  memory: 15149  
10/06 01:30:05 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:30  time: 0.2769  data_time: 0.0016  memory: 15183  
10/06 01:30:13 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:42  time: 0.2490  data_time: 0.0018  memory: 9975  
10/06 01:30:25 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:08:09  time: 0.2941  data_time: 0.0015  memory: 15188  
10/06 01:30:39 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:44  time: 0.1018  data_time: 0.0016  memory: 15187  
10/06 01:30:55 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:22  time: 0.6509  data_time: 0.0015  memory: 15192  
10/06 01:31:01 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:48  time: 0.0942  data_time: 0.0017  memory: 15170  
10/06 01:31:06 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:14  time: 0.0968  data_time: 0.0017  memory: 967  
10/06 01:31:14 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:48  time: 0.1923  data_time: 0.0015  memory: 9232  
10/06 01:31:29 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:31  time: 0.3634  data_time: 0.0016  memory: 15181  
10/06 01:31:38 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:09  time: 0.1130  data_time: 0.0016  memory: 15139  
10/06 01:31:50 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:50  time: 0.4589  data_time: 0.0015  memory: 15191  
10/06 01:32:01 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:31  time: 0.0939  data_time: 0.0016  memory: 15164  
10/06 01:32:09 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:11  time: 0.2292  data_time: 0.0015  memory: 15151  
10/06 01:32:14 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:49  time: 0.0946  data_time: 0.0015  memory: 2148  
10/06 01:32:22 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:31  time: 0.2214  data_time: 0.0016  memory: 15172  
10/06 01:32:27 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:12  time: 0.0961  data_time: 0.0015  memory: 969  
10/06 01:32:33 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:55  time: 0.0896  data_time: 0.0015  memory: 15146  
10/06 01:32:45 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:41  time: 0.2989  data_time: 0.0015  memory: 15176  
10/06 01:32:53 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:25  time: 0.2645  data_time: 0.0015  memory: 15158  
10/06 01:32:57 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:09  time: 0.0874  data_time: 0.0015  memory: 968  
10/06 01:33:04 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:54  time: 0.0987  data_time: 0.0016  memory: 10910  
10/06 01:33:09 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:39  time: 0.0941  data_time: 0.0017  memory: 966  
10/06 01:33:19 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:26  time: 0.0894  data_time: 0.0014  memory: 15182  
10/06 01:33:28 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:14  time: 0.0952  data_time: 0.0017  memory: 15165  
10/06 01:33:36 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:01  time: 0.0971  data_time: 0.0015  memory: 15148  
10/06 01:33:42 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:48  time: 0.0956  data_time: 0.0017  memory: 15148  
10/06 01:33:47 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:35  time: 0.0959  data_time: 0.0017  memory: 915  
10/06 01:33:53 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:23  time: 0.0946  data_time: 0.0015  memory: 15188  
10/06 01:34:02 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:11  time: 0.0920  data_time: 0.0015  memory: 15154  
10/06 01:34:11 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0846  data_time: 0.0014  memory: 8857  
10/06 01:34:11 - mmengine - INFO - per class results:
10/06 01:34:11 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  71.5 | 88.26 |
|       building      | 79.49 | 90.16 |
|         sky         | 92.75 | 96.53 |
|        floor        |  75.5 | 88.84 |
|         tree        | 69.55 |  89.5 |
|       ceiling       | 76.33 | 84.09 |
|         road        | 77.36 | 86.45 |
|         bed         | 84.47 | 91.76 |
|      windowpane     | 57.14 | 75.11 |
|        grass        | 59.15 | 73.36 |
|       cabinet       |  54.0 | 63.76 |
|       sidewalk      | 53.29 | 65.89 |
|        person       | 76.93 | 89.12 |
|        earth        | 32.67 | 56.42 |
|         door        |  40.4 | 47.49 |
|        table        |  53.5 |  71.7 |
|       mountain      | 45.63 | 54.08 |
|        plant        | 45.45 | 53.86 |
|       curtain       | 57.55 | 69.42 |
|        chair        | 50.37 | 59.43 |
|         car         | 81.42 | 90.14 |
|        water        | 49.67 | 62.54 |
|       painting      | 69.15 | 81.09 |
|         sofa        | 62.63 | 79.77 |
|        shelf        | 36.87 | 54.43 |
|        house        | 46.78 | 66.84 |
|         sea         | 47.04 |  68.3 |
|        mirror       | 62.19 | 69.52 |
|         rug         | 39.53 | 45.37 |
|        field        | 28.18 | 55.62 |
|       armchair      |  40.6 | 61.38 |
|         seat        | 56.82 | 69.32 |
|        fence        | 36.62 | 50.54 |
|         desk        | 45.35 | 69.18 |
|         rock        | 32.87 | 72.12 |
|       wardrobe      | 47.91 | 65.06 |
|         lamp        | 57.01 |  66.4 |
|       bathtub       | 69.74 | 76.92 |
|       railing       | 30.01 | 40.29 |
|       cushion       | 47.89 | 56.97 |
|         base        | 21.06 | 26.24 |
|         box         | 18.58 | 23.33 |
|        column       | 41.87 | 61.87 |
|      signboard      | 34.28 | 44.36 |
|   chest of drawers  | 34.17 | 62.52 |
|       counter       | 33.61 | 41.26 |
|         sand        | 32.82 | 50.53 |
|         sink        | 65.22 | 75.16 |
|      skyscraper     | 57.44 | 74.07 |
|      fireplace      | 71.27 | 79.64 |
|     refrigerator    | 71.89 | 82.42 |
|      grandstand     | 41.56 | 71.33 |
|         path        | 21.43 | 39.39 |
|        stairs       | 32.75 |  40.7 |
|        runway       | 72.51 | 83.22 |
|         case        |  36.7 | 50.27 |
|      pool table     | 89.56 |  94.2 |
|        pillow       |  51.1 | 69.31 |
|     screen door     | 54.09 | 56.29 |
|       stairway      | 31.51 | 41.84 |
|        river        |  4.57 |  6.61 |
|        bridge       | 43.67 |  58.0 |
|       bookcase      | 37.16 | 53.17 |
|        blind        | 16.27 | 16.69 |
|     coffee table    |  61.5 | 78.75 |
|        toilet       | 77.54 | 85.96 |
|        flower       | 40.59 | 59.18 |
|         book        | 44.64 | 58.86 |
|         hill        | 12.74 | 19.64 |
|        bench        | 38.35 | 47.25 |
|      countertop     | 47.22 | 69.85 |
|        stove        | 72.98 | 81.09 |
|         palm        | 43.49 | 48.26 |
|    kitchen island   | 26.42 | 57.66 |
|       computer      | 54.23 | 60.39 |
|     swivel chair    | 40.23 | 48.79 |
|         boat        | 41.83 | 46.37 |
|         bar         | 25.37 | 28.69 |
|    arcade machine   | 18.21 | 18.81 |
|        hovel        | 36.28 |  45.0 |
|         bus         | 88.97 | 94.93 |
|        towel        | 49.51 |  53.2 |
|        light        | 40.47 | 43.82 |
|        truck        | 17.98 | 23.53 |
|        tower        |  7.77 | 10.03 |
|      chandelier     | 60.63 | 79.51 |
|        awning       | 13.15 |  14.5 |
|     streetlight     | 21.32 | 28.25 |
|        booth        |  39.0 | 42.43 |
| television receiver |  58.6 | 68.26 |
|       airplane      | 59.11 | 66.79 |
|      dirt track     |  4.83 | 10.59 |
|       apparel       | 37.06 | 46.01 |
|         pole        | 21.94 | 31.44 |
|         land        |  0.01 |  0.01 |
|      bannister      | 10.67 | 16.18 |
|      escalator      | 11.02 | 11.23 |
|       ottoman       | 41.28 | 56.75 |
|        bottle       | 29.31 | 43.89 |
|        buffet       | 49.77 | 68.68 |
|        poster       | 14.77 |  17.0 |
|        stage        | 14.54 | 19.54 |
|         van         | 44.37 | 63.88 |
|         ship        |  7.0  | 10.45 |
|       fountain      | 16.39 | 17.29 |
|    conveyer belt    | 75.12 | 77.96 |
|        canopy       | 10.34 | 12.79 |
|        washer       |  73.0 | 76.86 |
|      plaything      | 13.57 | 16.39 |
|    swimming pool    | 16.17 | 22.79 |
|        stool        | 33.36 | 46.12 |
|        barrel       | 11.18 | 43.73 |
|        basket       | 27.01 | 30.06 |
|      waterfall      | 46.58 | 56.22 |
|         tent        | 90.78 | 99.26 |
|         bag         |  8.44 |  9.03 |
|       minibike      | 62.11 |  76.7 |
|        cradle       | 81.34 | 91.24 |
|         oven        | 36.88 | 54.82 |
|         ball        | 30.25 | 37.08 |
|         food        | 32.12 | 39.62 |
|         step        |  18.9 | 22.37 |
|         tank        | 35.16 | 40.84 |
|      trade name     | 25.06 | 30.55 |
|      microwave      | 71.66 | 83.54 |
|         pot         | 41.48 |  46.3 |
|        animal       | 54.94 | 56.97 |
|       bicycle       | 52.11 | 74.45 |
|         lake        |  5.67 |  6.2  |
|      dishwasher     | 46.46 | 56.91 |
|        screen       | 63.25 | 84.47 |
|       blanket       |  8.51 |  9.09 |
|      sculpture      | 50.96 | 64.89 |
|         hood        | 50.63 |  51.8 |
|        sconce       | 27.79 |  32.5 |
|         vase        | 37.55 | 54.64 |
|    traffic light    | 23.79 | 28.36 |
|         tray        |  7.61 | 16.24 |
|        ashcan       | 30.68 | 37.99 |
|         fan         | 56.65 |  67.5 |
|         pier        | 27.26 |  34.7 |
|      crt screen     |  0.0  |  0.0  |
|        plate        | 49.77 | 61.37 |
|       monitor       |  2.22 |  2.55 |
|    bulletin board   | 39.58 | 44.92 |
|        shower       |  1.39 | 11.72 |
|       radiator      | 37.69 |  40.8 |
|        glass        |  9.99 | 10.25 |
|        clock        | 30.96 | 40.21 |
|         flag        | 43.65 | 47.66 |
+---------------------+-------+-------+
10/06 01:34:11 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.0600  mIoU: 41.9800  mAcc: 52.2800  data_time: 0.0017  time: 0.2308
Finished processing corruption type: impulse_noise
Processing corruption type: defocus_blur
10/06 01:34:14 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1933430213
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1933430213
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 01:34:15 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='defocus_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/defocus_blur'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 01:34:19,101 - mmseg - INFO - using core type: DCNv3
2024-10-06 01:34:19,101 - mmseg - INFO - using activation layer: GELU
2024-10-06 01:34:19,101 - mmseg - INFO - using main norm layer: LN
2024-10-06 01:34:19,101 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 01:34:19,101 - mmseg - INFO - level2_post_norm: False
2024-10-06 01:34:19,101 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 01:34:19,101 - mmseg - INFO - res_post_norm: False
2024-10-06 01:34:19,101 - mmseg - INFO - use_dcn_v4_op: False
10/06 01:34:21 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 01:34:21 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 01:34:23 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 01:34:24 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 01:35:14 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:32:02  time: 0.4882  data_time: 0.0016  memory: 29516  
10/06 01:35:41 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:24:09  time: 0.6402  data_time: 0.0017  memory: 15185  
10/06 01:35:57 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:19:07  time: 0.3552  data_time: 0.0016  memory: 15170  
10/06 01:36:21 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:17:32  time: 0.4007  data_time: 0.0015  memory: 15186  
10/06 01:36:44 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:16:17  time: 0.2463  data_time: 0.0015  memory: 15182  
10/06 01:37:02 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:14:56  time: 0.1104  data_time: 0.0017  memory: 15176  
10/06 01:37:23 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:14:04  time: 0.2827  data_time: 0.0015  memory: 15183  
10/06 01:37:40 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:13:03  time: 0.2803  data_time: 0.0015  memory: 15181  
10/06 01:37:49 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:11:45  time: 0.2109  data_time: 0.0015  memory: 9791  
10/06 01:37:57 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:10:39  time: 0.1031  data_time: 0.0015  memory: 15149  
10/06 01:38:07 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:46  time: 0.2826  data_time: 0.0016  memory: 15183  
10/06 01:38:15 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:57  time: 0.2581  data_time: 0.0016  memory: 9975  
10/06 01:38:27 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:08:24  time: 0.3034  data_time: 0.0014  memory: 15188  
10/06 01:38:42 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:58  time: 0.1121  data_time: 0.0016  memory: 15187  
10/06 01:38:58 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:36  time: 0.6497  data_time: 0.0015  memory: 15192  
10/06 01:39:05 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:07:01  time: 0.1077  data_time: 0.0017  memory: 15170  
10/06 01:39:10 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:27  time: 0.1049  data_time: 0.0017  memory: 967  
10/06 01:39:19 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:06:00  time: 0.2013  data_time: 0.0015  memory: 9232  
10/06 01:39:34 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:42  time: 0.3776  data_time: 0.0016  memory: 15181  
10/06 01:39:44 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:19  time: 0.0996  data_time: 0.0015  memory: 15139  
10/06 01:39:57 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:05:00  time: 0.4893  data_time: 0.0015  memory: 15191  
10/06 01:40:08 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:40  time: 0.1098  data_time: 0.0016  memory: 15164  
10/06 01:40:16 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:19  time: 0.2350  data_time: 0.0015  memory: 15151  
10/06 01:40:21 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:57  time: 0.1004  data_time: 0.0015  memory: 2148  
10/06 01:40:30 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:39  time: 0.2305  data_time: 0.0015  memory: 15172  
10/06 01:40:35 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:19  time: 0.1047  data_time: 0.0015  memory: 969  
10/06 01:40:41 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:01  time: 0.0996  data_time: 0.0015  memory: 15146  
10/06 01:40:54 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:47  time: 0.3107  data_time: 0.0015  memory: 15176  
10/06 01:41:02 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:30  time: 0.2767  data_time: 0.0015  memory: 15158  
10/06 01:41:07 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:14  time: 0.0959  data_time: 0.0014  memory: 968  
10/06 01:41:15 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:59  time: 0.1076  data_time: 0.0015  memory: 10910  
10/06 01:41:20 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:43  time: 0.1025  data_time: 0.0016  memory: 966  
10/06 01:41:31 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:30  time: 0.0967  data_time: 0.0014  memory: 15182  
10/06 01:41:41 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:16  time: 0.1044  data_time: 0.0017  memory: 15165  
10/06 01:41:49 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:03  time: 0.1088  data_time: 0.0015  memory: 15148  
10/06 01:41:56 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:50  time: 0.1049  data_time: 0.0017  memory: 15148  
10/06 01:42:01 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:37  time: 0.1036  data_time: 0.0016  memory: 915  
10/06 01:42:08 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:24  time: 0.1047  data_time: 0.0015  memory: 15188  
10/06 01:42:17 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:12  time: 0.0999  data_time: 0.0015  memory: 15154  
10/06 01:42:26 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0936  data_time: 0.0014  memory: 8857  
10/06 01:42:26 - mmengine - INFO - per class results:
10/06 01:42:26 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.99 | 87.36 |
|       building      | 79.06 | 93.08 |
|         sky         | 93.91 | 97.42 |
|        floor        | 80.55 | 89.72 |
|         tree        | 72.83 | 84.53 |
|       ceiling       | 82.82 | 91.17 |
|         road        | 83.46 | 90.07 |
|         bed         | 87.33 | 95.63 |
|      windowpane     | 60.01 | 78.63 |
|        grass        | 62.89 | 76.23 |
|       cabinet       |  59.1 | 72.53 |
|       sidewalk      | 62.63 | 77.23 |
|        person       | 77.62 | 88.81 |
|        earth        | 36.61 | 49.72 |
|         door        | 48.04 | 62.77 |
|        table        | 58.03 | 75.08 |
|       mountain      | 57.57 | 72.47 |
|        plant        | 48.19 | 61.68 |
|       curtain       |  68.6 | 80.07 |
|        chair        | 55.49 | 70.25 |
|         car         | 81.14 | 90.87 |
|        water        | 58.67 | 71.37 |
|       painting      | 69.81 | 83.32 |
|         sofa        | 63.31 |  81.3 |
|        shelf        |  40.2 | 58.93 |
|        house        | 30.56 | 37.19 |
|         sea         | 63.53 | 77.87 |
|        mirror       | 67.19 |  74.3 |
|         rug         |  60.1 | 72.08 |
|        field        | 27.45 |  50.9 |
|       armchair      | 42.03 | 56.38 |
|         seat        | 57.48 | 75.41 |
|        fence        | 42.54 | 55.76 |
|         desk        | 47.61 | 62.58 |
|         rock        | 36.34 | 64.66 |
|       wardrobe      | 45.58 | 65.84 |
|         lamp        | 58.41 | 75.97 |
|       bathtub       | 77.41 | 82.52 |
|       railing       | 31.22 | 47.82 |
|       cushion       | 54.63 | 67.04 |
|         base        | 34.48 | 52.54 |
|         box         | 24.32 | 32.56 |
|        column       |  45.7 | 56.43 |
|      signboard      | 32.96 | 41.79 |
|   chest of drawers  | 42.69 | 59.62 |
|       counter       | 29.18 | 35.27 |
|         sand        | 39.94 | 63.06 |
|         sink        | 68.19 | 77.96 |
|      skyscraper     | 40.72 | 50.09 |
|      fireplace      | 71.32 |  86.7 |
|     refrigerator    |  74.3 | 81.16 |
|      grandstand     | 35.96 |  73.5 |
|         path        | 25.22 | 42.29 |
|        stairs       | 23.08 | 27.84 |
|        runway       | 69.43 | 94.94 |
|         case        |  58.4 | 76.13 |
|      pool table     | 91.23 | 95.17 |
|        pillow       | 52.95 | 63.27 |
|     screen door     | 74.78 | 79.08 |
|       stairway      | 30.99 | 42.48 |
|        river        |  7.91 |  12.0 |
|        bridge       | 31.34 |  40.7 |
|       bookcase      |  36.7 | 63.08 |
|        blind        | 32.24 | 33.36 |
|     coffee table    | 57.14 |  81.8 |
|        toilet       | 84.27 | 89.33 |
|        flower       | 42.81 | 59.94 |
|         book        | 43.73 | 58.18 |
|         hill        | 12.94 | 19.72 |
|        bench        | 47.57 | 55.71 |
|      countertop     | 52.52 | 72.68 |
|        stove        | 75.13 |  84.4 |
|         palm        | 46.71 | 53.01 |
|    kitchen island   | 37.03 | 62.89 |
|       computer      |  56.0 | 63.28 |
|     swivel chair    | 43.18 | 59.88 |
|         boat        | 55.88 | 69.08 |
|         bar         | 36.77 |  49.6 |
|    arcade machine   | 48.85 | 53.03 |
|        hovel        | 26.51 | 29.84 |
|         bus         | 80.37 | 93.15 |
|        towel        | 66.06 | 76.71 |
|        light        | 48.64 | 60.56 |
|        truck        | 26.85 | 37.02 |
|        tower        |  4.94 |  7.2  |
|      chandelier     | 63.05 |  75.6 |
|        awning       |  26.1 | 30.38 |
|     streetlight     |  23.3 | 33.67 |
|        booth        | 35.63 | 42.03 |
| television receiver | 67.13 | 77.11 |
|       airplane      | 54.11 |  65.5 |
|      dirt track     |  8.02 | 13.48 |
|       apparel       |  32.4 | 40.84 |
|         pole        | 16.37 | 19.76 |
|         land        |  2.73 |  5.59 |
|      bannister      | 12.72 | 21.52 |
|      escalator      | 32.55 | 42.69 |
|       ottoman       | 36.25 | 47.99 |
|        bottle       | 24.74 | 32.39 |
|        buffet       | 46.47 |  55.5 |
|        poster       | 31.91 | 39.44 |
|        stage        | 17.68 | 30.89 |
|         van         | 38.29 | 44.57 |
|         ship        | 23.41 | 28.47 |
|       fountain      | 20.03 | 21.57 |
|    conveyer belt    | 76.04 | 86.46 |
|        canopy       | 29.76 | 50.64 |
|        washer       | 71.02 | 71.62 |
|      plaything      | 21.13 | 42.84 |
|    swimming pool    | 39.62 | 77.46 |
|        stool        | 42.92 | 50.75 |
|        barrel       | 24.81 | 81.67 |
|        basket       | 22.35 |  27.1 |
|      waterfall      | 61.36 | 93.37 |
|         tent        | 79.78 | 98.87 |
|         bag         |  9.56 | 10.64 |
|       minibike      | 63.54 | 80.32 |
|        cradle       | 80.01 | 97.75 |
|         oven        | 41.56 | 48.92 |
|         ball        | 42.61 | 50.24 |
|         food        | 38.14 | 45.01 |
|         step        | 10.12 | 11.82 |
|         tank        | 48.99 | 56.35 |
|      trade name     | 17.94 | 20.84 |
|      microwave      | 79.83 | 92.44 |
|         pot         | 40.12 | 45.72 |
|        animal       |  59.4 | 62.95 |
|       bicycle       | 52.42 | 65.21 |
|         lake        | 40.15 | 75.12 |
|      dishwasher     | 68.22 | 78.11 |
|        screen       | 66.02 | 89.04 |
|       blanket       | 10.27 | 13.15 |
|      sculpture      | 50.83 | 62.28 |
|         hood        | 52.84 | 59.83 |
|        sconce       | 39.53 | 49.59 |
|         vase        | 37.04 | 44.96 |
|    traffic light    | 30.22 | 47.46 |
|         tray        |  6.0  | 11.11 |
|        ashcan       | 39.09 | 52.35 |
|         fan         | 57.58 | 71.79 |
|         pier        | 54.35 |  81.5 |
|      crt screen     |  2.6  |  7.82 |
|        plate        | 45.82 |  58.6 |
|       monitor       |  2.83 |  4.88 |
|    bulletin board   | 49.98 | 58.13 |
|        shower       |  2.38 |  3.6  |
|       radiator      |  39.9 |  43.7 |
|        glass        |  7.28 |  7.66 |
|        clock        |  32.8 | 40.77 |
|         flag        | 42.58 | 44.81 |
+---------------------+-------+-------+
10/06 01:42:26 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.6900  mIoU: 46.1200  mAcc: 58.0600  data_time: 0.0017  time: 0.2406
Finished processing corruption type: defocus_blur
Processing corruption type: glass_blur
10/06 01:42:29 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1959684474
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1959684474
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 01:42:30 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='glass_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/glass_blur'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 01:42:34,151 - mmseg - INFO - using core type: DCNv3
2024-10-06 01:42:34,151 - mmseg - INFO - using activation layer: GELU
2024-10-06 01:42:34,151 - mmseg - INFO - using main norm layer: LN
2024-10-06 01:42:34,151 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 01:42:34,151 - mmseg - INFO - level2_post_norm: False
2024-10-06 01:42:34,151 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 01:42:34,151 - mmseg - INFO - res_post_norm: False
2024-10-06 01:42:34,151 - mmseg - INFO - use_dcn_v4_op: False
10/06 01:42:36 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 01:42:36 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 01:42:38 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 01:42:39 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 01:49:00 - mmengine - INFO - Iter(test) [  50/2000]    eta: 4:07:28  time: 7.4585  data_time: 0.0016  memory: 29516  
10/06 01:54:55 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 3:53:08  time: 7.4519  data_time: 0.0017  memory: 15185  
10/06 02:00:37 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 3:41:30  time: 6.9849  data_time: 0.0016  memory: 15170  
10/06 02:06:32 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 3:34:53  time: 6.9195  data_time: 0.0016  memory: 15186  
10/06 02:12:10 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 3:26:38  time: 6.6470  data_time: 0.0016  memory: 15182  
10/06 02:17:44 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 3:18:47  time: 6.7834  data_time: 0.0017  memory: 15176  
10/06 02:23:27 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 3:12:19  time: 6.4297  data_time: 0.0016  memory: 15183  
10/06 02:29:05 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 3:05:43  time: 6.8701  data_time: 0.0015  memory: 15181  
10/06 02:34:08 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 2:57:17  time: 6.1590  data_time: 0.0016  memory: 9791  
10/06 02:39:36 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 2:50:50  time: 6.3642  data_time: 0.0015  memory: 15149  
10/06 02:45:24 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 2:45:25  time: 7.0096  data_time: 0.0016  memory: 15183  
10/06 02:50:50 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 2:39:04  time: 6.8744  data_time: 0.0017  memory: 9975  
10/06 02:56:19 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 2:33:00  time: 6.7323  data_time: 0.0015  memory: 15188  
10/06 03:02:11 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 2:27:41  time: 6.7405  data_time: 0.0017  memory: 15187  
10/06 03:07:53 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 2:22:03  time: 6.9601  data_time: 0.0015  memory: 15192  
10/06 03:13:02 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 2:15:33  time: 6.5224  data_time: 0.0017  memory: 15170  
10/06 03:18:30 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 2:09:40  time: 6.5612  data_time: 0.0017  memory: 967  
10/06 03:23:35 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 2:03:21  time: 5.9094  data_time: 0.0015  memory: 9232  
10/06 03:29:15 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 1:57:49  time: 6.6602  data_time: 0.0016  memory: 15181  
10/06 03:34:32 - mmengine - INFO - Iter(test) [1000/2000]    eta: 1:51:52  time: 6.2363  data_time: 0.0016  memory: 15139  
10/06 03:40:13 - mmengine - INFO - Iter(test) [1050/2000]    eta: 1:46:22  time: 7.1484  data_time: 0.0016  memory: 15191  
10/06 03:45:45 - mmengine - INFO - Iter(test) [1100/2000]    eta: 1:40:42  time: 6.4318  data_time: 0.0017  memory: 15164  
10/06 03:51:07 - mmengine - INFO - Iter(test) [1150/2000]    eta: 1:34:57  time: 6.6611  data_time: 0.0015  memory: 15151  
10/06 03:56:37 - mmengine - INFO - Iter(test) [1200/2000]    eta: 1:29:18  time: 6.3573  data_time: 0.0016  memory: 2148  
10/06 04:01:53 - mmengine - INFO - Iter(test) [1250/2000]    eta: 1:23:31  time: 6.4082  data_time: 0.0015  memory: 15172  
10/06 04:06:57 - mmengine - INFO - Iter(test) [1300/2000]    eta: 1:17:42  time: 6.5157  data_time: 0.0015  memory: 969  
10/06 04:12:19 - mmengine - INFO - Iter(test) [1350/2000]    eta: 1:12:03  time: 6.0226  data_time: 0.0015  memory: 15146  
10/06 04:17:48 - mmengine - INFO - Iter(test) [1400/2000]    eta: 1:06:29  time: 7.0093  data_time: 0.0015  memory: 15176  
10/06 04:23:00 - mmengine - INFO - Iter(test) [1450/2000]    eta: 1:00:49  time: 6.8936  data_time: 0.0015  memory: 15158  
10/06 04:28:16 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:55:12  time: 6.0341  data_time: 0.0016  memory: 968  
10/06 04:33:54 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:49:43  time: 6.5864  data_time: 0.0015  memory: 10910  
10/06 04:39:06 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:44:06  time: 6.3303  data_time: 0.0016  memory: 966  
10/06 04:44:26 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:38:33  time: 5.9301  data_time: 0.0014  memory: 15182  
10/06 04:49:56 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:33:02  time: 6.4545  data_time: 0.0017  memory: 15165  
10/06 04:55:27 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:27:32  time: 6.3825  data_time: 0.0015  memory: 15148  
10/06 05:00:36 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:21:59  time: 6.5355  data_time: 0.0017  memory: 15148  
10/06 05:06:00 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:16:29  time: 6.4676  data_time: 0.0017  memory: 915  
10/06 05:11:03 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:10:58  time: 6.2438  data_time: 0.0015  memory: 15188  
10/06 05:16:31 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:05:29  time: 6.2346  data_time: 0.0015  memory: 15154  
10/06 05:21:42 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 5.8202  data_time: 0.0014  memory: 8857  
10/06 05:21:42 - mmengine - INFO - per class results:
10/06 05:21:42 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.97 | 89.26 |
|       building      | 80.92 | 91.54 |
|         sky         | 93.54 | 98.04 |
|        floor        | 79.38 |  90.4 |
|         tree        | 71.36 | 86.07 |
|       ceiling       | 82.38 | 93.09 |
|         road        | 84.28 | 89.15 |
|         bed         | 87.27 | 93.77 |
|      windowpane     | 57.16 | 74.47 |
|        grass        | 61.92 | 75.51 |
|       cabinet       | 56.77 | 68.27 |
|       sidewalk      | 63.09 | 75.37 |
|        person       | 78.69 | 89.19 |
|        earth        | 33.78 | 48.02 |
|         door        | 46.15 | 57.96 |
|        table        | 57.02 | 75.12 |
|       mountain      | 55.76 | 70.36 |
|        plant        | 45.73 |  60.0 |
|       curtain       | 64.38 | 82.52 |
|        chair        | 54.39 | 71.12 |
|         car         | 80.65 | 87.09 |
|        water        | 50.59 | 69.02 |
|       painting      | 71.51 | 83.29 |
|         sofa        | 64.42 | 82.88 |
|        shelf        |  36.7 |  54.4 |
|        house        | 45.45 | 55.53 |
|         sea         |  52.4 | 73.61 |
|        mirror       | 63.56 | 77.59 |
|         rug         | 60.25 | 77.42 |
|        field        | 18.61 | 42.97 |
|       armchair      | 36.37 | 45.76 |
|         seat        | 56.23 | 79.02 |
|        fence        | 42.22 | 52.61 |
|         desk        | 41.48 | 50.24 |
|         rock        | 32.45 | 51.76 |
|       wardrobe      | 37.84 | 49.37 |
|         lamp        | 59.48 | 71.35 |
|       bathtub       | 74.73 | 80.08 |
|       railing       | 25.42 | 31.81 |
|       cushion       | 53.58 | 74.55 |
|         base        | 28.92 | 40.17 |
|         box         | 24.97 | 33.51 |
|        column       | 45.92 | 58.95 |
|      signboard      | 32.14 | 38.27 |
|   chest of drawers  | 40.99 | 62.58 |
|       counter       | 27.06 | 30.88 |
|         sand        | 42.82 | 56.34 |
|         sink        | 67.55 | 72.96 |
|      skyscraper     | 64.97 | 81.16 |
|      fireplace      | 68.91 | 83.73 |
|     refrigerator    | 66.68 | 71.69 |
|      grandstand     | 34.79 | 81.58 |
|         path        | 22.22 | 30.17 |
|        stairs       | 23.29 | 27.86 |
|        runway       | 73.84 | 93.93 |
|         case        | 48.37 |  76.1 |
|      pool table     | 90.65 | 92.55 |
|        pillow       | 48.92 | 54.62 |
|     screen door     | 38.91 | 39.46 |
|       stairway      | 29.23 | 42.61 |
|        river        |  4.13 |  5.75 |
|        bridge       | 25.95 | 31.72 |
|       bookcase      | 21.63 | 25.53 |
|        blind        | 23.23 |  23.6 |
|     coffee table    | 61.34 | 78.54 |
|        toilet       | 84.05 | 88.53 |
|        flower       | 36.82 | 63.81 |
|         book        | 35.02 | 41.79 |
|         hill        | 14.15 | 22.31 |
|        bench        | 39.31 | 41.49 |
|      countertop     | 55.02 | 63.96 |
|        stove        | 71.27 | 80.91 |
|         palm        |  41.8 | 48.07 |
|    kitchen island   | 35.93 | 64.83 |
|       computer      | 49.83 | 55.01 |
|     swivel chair    | 43.07 | 59.27 |
|         boat        |  35.8 | 40.84 |
|         bar         | 30.07 | 42.62 |
|    arcade machine   | 52.54 | 77.32 |
|        hovel        | 44.91 | 60.31 |
|         bus         | 89.48 | 93.27 |
|        towel        | 57.79 | 67.92 |
|        light        | 44.89 | 49.95 |
|        truck        |  18.5 | 25.94 |
|        tower        | 29.11 | 48.08 |
|      chandelier     | 65.33 | 78.99 |
|        awning       | 28.27 | 33.78 |
|     streetlight     | 18.21 | 23.11 |
|        booth        | 24.38 | 27.47 |
| television receiver | 62.76 | 67.42 |
|       airplane      |  55.0 | 59.54 |
|      dirt track     |  7.3  | 17.77 |
|       apparel       | 33.47 | 53.06 |
|         pole        | 16.84 |  20.1 |
|         land        |  3.72 |  8.23 |
|      bannister      |  4.93 |  6.16 |
|      escalator      | 18.43 | 18.85 |
|       ottoman       | 44.73 | 59.82 |
|        bottle       | 27.99 |  36.1 |
|        buffet       | 37.13 | 40.59 |
|        poster       | 13.43 | 16.22 |
|        stage        | 16.58 | 29.86 |
|         van         | 45.04 | 65.21 |
|         ship        |  5.05 |  7.03 |
|       fountain      | 18.98 | 21.23 |
|    conveyer belt    | 66.68 | 69.83 |
|        canopy       | 11.82 | 15.64 |
|        washer       | 62.68 | 63.02 |
|      plaything      | 17.86 | 28.13 |
|    swimming pool    | 46.36 | 87.93 |
|        stool        | 39.85 | 54.89 |
|        barrel       | 37.77 | 64.76 |
|        basket       | 26.16 | 30.06 |
|      waterfall      | 42.94 |  66.6 |
|         tent        |  94.0 | 98.31 |
|         bag         |  7.96 |  8.15 |
|       minibike      | 68.75 | 79.77 |
|        cradle       | 81.51 | 96.02 |
|         oven        |  32.8 |  42.6 |
|         ball        | 42.06 |  47.8 |
|         food        | 45.43 | 54.99 |
|         step        | 11.67 |  13.3 |
|         tank        | 55.29 |  57.3 |
|      trade name     | 14.33 | 15.73 |
|      microwave      | 72.35 | 76.88 |
|         pot         | 36.59 | 39.39 |
|        animal       | 60.93 | 63.59 |
|       bicycle       | 53.23 |  63.8 |
|         lake        | 50.36 | 73.52 |
|      dishwasher     | 57.87 | 60.59 |
|        screen       | 48.68 | 61.15 |
|       blanket       | 10.81 |  12.4 |
|      sculpture      | 27.86 | 28.39 |
|         hood        | 40.99 | 41.55 |
|        sconce       |  35.0 | 42.15 |
|         vase        | 31.75 | 36.23 |
|    traffic light    | 28.31 | 36.16 |
|         tray        |  4.09 |  5.79 |
|        ashcan       | 43.69 | 54.46 |
|         fan         | 52.64 | 59.08 |
|         pier        | 39.85 | 52.84 |
|      crt screen     |  3.39 | 11.16 |
|        plate        |  30.5 | 33.29 |
|       monitor       |  8.96 | 11.13 |
|    bulletin board   |  41.2 | 56.02 |
|        shower       |  1.17 |  6.75 |
|       radiator      | 41.95 | 44.69 |
|        glass        |  5.79 |  5.89 |
|        clock        | 27.79 | 33.36 |
|         flag        | 32.94 | 33.78 |
+---------------------+-------+-------+
10/06 05:21:42 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.0500  mIoU: 43.6100  mAcc: 53.8000  data_time: 0.0018  time: 6.5714
Finished processing corruption type: glass_blur
Processing corruption type: motion_blur
10/06 05:21:51 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 625392888
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 625392888
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 05:21:52 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='motion_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/motion_blur'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 05:21:57,165 - mmseg - INFO - using core type: DCNv3
2024-10-06 05:21:57,165 - mmseg - INFO - using activation layer: GELU
2024-10-06 05:21:57,166 - mmseg - INFO - using main norm layer: LN
2024-10-06 05:21:57,166 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 05:21:57,166 - mmseg - INFO - level2_post_norm: False
2024-10-06 05:21:57,166 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 05:21:57,166 - mmseg - INFO - res_post_norm: False
2024-10-06 05:21:57,166 - mmseg - INFO - use_dcn_v4_op: False
10/06 05:22:01 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 05:22:01 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 05:22:03 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 05:22:05 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 05:23:34 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:58:10  time: 1.2455  data_time: 0.0017  memory: 29516  
10/06 05:24:38 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:48:25  time: 1.3784  data_time: 0.0017  memory: 15185  
10/06 05:25:28 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:41:47  time: 0.9970  data_time: 0.0016  memory: 15170  
10/06 05:26:27 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:39:17  time: 1.1189  data_time: 0.0016  memory: 15186  
10/06 05:27:25 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:37:17  time: 0.9686  data_time: 0.0015  memory: 15182  
10/06 05:28:19 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:35:16  time: 0.8695  data_time: 0.0016  memory: 15176  
10/06 05:29:14 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:33:41  time: 0.9550  data_time: 0.0015  memory: 15183  
10/06 05:30:06 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:32:04  time: 1.0200  data_time: 0.0015  memory: 15181  
10/06 05:30:47 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:29:57  time: 0.8697  data_time: 0.0015  memory: 9791  
10/06 05:31:31 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:28:17  time: 0.7685  data_time: 0.0015  memory: 15149  
10/06 05:32:16 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:26:51  time: 1.0158  data_time: 0.0016  memory: 15183  
10/06 05:32:58 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:25:23  time: 0.9611  data_time: 0.0016  memory: 9975  
10/06 05:33:45 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:24:14  time: 1.0109  data_time: 0.0014  memory: 15188  
10/06 05:34:37 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:23:17  time: 0.8451  data_time: 0.0016  memory: 15187  
10/06 05:35:30 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:22:22  time: 1.3525  data_time: 0.0015  memory: 15192  
10/06 05:36:10 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:21:07  time: 0.7765  data_time: 0.0026  memory: 15170  
10/06 05:36:50 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:19:57  time: 0.8338  data_time: 0.0017  memory: 967  
10/06 05:37:31 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:18:52  time: 0.8363  data_time: 0.0015  memory: 9232  
10/06 05:38:22 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:17:59  time: 1.0790  data_time: 0.0016  memory: 15181  
10/06 05:39:06 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:17:00  time: 0.7787  data_time: 0.0015  memory: 15139  
10/06 05:39:54 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:16:07  time: 1.2340  data_time: 0.0016  memory: 15191  
10/06 05:40:41 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:15:13  time: 0.8019  data_time: 0.0016  memory: 15164  
10/06 05:41:24 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:14:16  time: 0.9441  data_time: 0.0015  memory: 15151  
10/06 05:42:05 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:13:20  time: 0.7985  data_time: 0.0015  memory: 2148  
10/06 05:42:49 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:12:26  time: 0.9228  data_time: 0.0015  memory: 15172  
10/06 05:43:27 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:11:30  time: 0.8001  data_time: 0.0015  memory: 969  
10/06 05:44:09 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:10:37  time: 0.7549  data_time: 0.0015  memory: 15146  
10/06 05:44:58 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:09:48  time: 1.1059  data_time: 0.0015  memory: 15176  
10/06 05:45:40 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:08:56  time: 1.0267  data_time: 0.0015  memory: 15158  
10/06 05:46:20 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:08:04  time: 0.7403  data_time: 0.0015  memory: 968  
10/06 05:47:03 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:07:14  time: 0.8398  data_time: 0.0015  memory: 10910  
10/06 05:47:41 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:06:23  time: 0.7582  data_time: 0.0016  memory: 966  
10/06 05:48:26 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:05:35  time: 0.7720  data_time: 0.0014  memory: 15182  
10/06 05:49:12 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:47  time: 0.8318  data_time: 0.0016  memory: 15165  
10/06 05:49:57 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:58  time: 0.8577  data_time: 0.0040  memory: 15148  
10/06 05:50:37 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:10  time: 0.8002  data_time: 0.0017  memory: 15148  
10/06 05:51:16 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:21  time: 0.7790  data_time: 0.0017  memory: 915  
10/06 05:51:56 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:34  time: 0.8059  data_time: 0.0015  memory: 15188  
10/06 05:52:41 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:47  time: 0.8147  data_time: 0.0015  memory: 15154  
10/06 05:53:24 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7140  data_time: 0.0014  memory: 8857  
10/06 05:53:24 - mmengine - INFO - per class results:
10/06 05:53:24 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.82 | 86.21 |
|       building      | 78.84 | 93.45 |
|         sky         | 93.55 | 97.05 |
|        floor        | 80.01 | 89.22 |
|         tree        | 71.42 |  84.1 |
|       ceiling       | 82.74 | 93.28 |
|         road        | 79.96 | 85.86 |
|         bed         | 87.07 | 95.76 |
|      windowpane     | 60.72 | 78.13 |
|        grass        | 64.51 | 84.56 |
|       cabinet       | 58.28 | 71.23 |
|       sidewalk      | 62.55 | 79.31 |
|        person       | 77.96 | 90.91 |
|        earth        |  34.3 |  47.5 |
|         door        | 48.24 |  61.1 |
|        table        |  56.9 | 74.19 |
|       mountain      |  54.2 | 62.84 |
|        plant        | 47.67 | 63.75 |
|       curtain       | 69.22 | 81.39 |
|        chair        | 55.88 |  71.0 |
|         car         | 80.97 | 91.56 |
|        water        | 56.69 | 73.55 |
|       painting      | 71.41 | 83.46 |
|         sofa        | 63.82 | 81.89 |
|        shelf        | 43.45 | 66.17 |
|        house        | 28.06 | 32.49 |
|         sea         | 63.25 | 78.95 |
|        mirror       | 68.65 | 76.97 |
|         rug         | 59.95 | 76.09 |
|        field        | 20.11 | 30.98 |
|       armchair      | 40.07 | 54.27 |
|         seat        | 57.17 | 77.24 |
|        fence        | 38.64 | 56.34 |
|         desk        | 47.09 | 64.32 |
|         rock        | 38.85 | 70.31 |
|       wardrobe      | 41.82 | 62.58 |
|         lamp        | 58.53 | 75.37 |
|       bathtub       | 77.08 | 82.26 |
|       railing       | 34.09 | 51.22 |
|       cushion       | 56.89 | 71.08 |
|         base        | 40.83 | 61.14 |
|         box         |  24.7 |  32.6 |
|        column       | 45.38 | 57.76 |
|      signboard      | 35.68 | 47.96 |
|   chest of drawers  | 41.51 | 62.93 |
|       counter       | 30.27 | 35.38 |
|         sand        | 46.29 | 61.78 |
|         sink        | 69.59 | 78.67 |
|      skyscraper     | 27.07 | 30.77 |
|      fireplace      | 72.96 | 89.24 |
|     refrigerator    | 73.33 | 82.05 |
|      grandstand     | 46.14 | 72.49 |
|         path        | 25.74 | 39.27 |
|        stairs       | 24.47 | 30.64 |
|        runway       | 71.77 | 94.95 |
|         case        |  46.1 | 63.69 |
|      pool table     | 89.97 | 94.32 |
|        pillow       | 55.88 | 69.67 |
|     screen door     | 78.98 | 83.38 |
|       stairway      | 26.83 | 35.83 |
|        river        |  9.56 |  13.2 |
|        bridge       | 31.18 | 40.08 |
|       bookcase      | 40.23 | 57.99 |
|        blind        | 39.89 | 44.37 |
|     coffee table    | 57.73 | 82.15 |
|        toilet       | 84.38 | 89.79 |
|        flower       | 42.17 | 54.66 |
|         book        | 46.96 | 61.01 |
|         hill        | 13.89 | 20.61 |
|        bench        | 42.63 | 49.93 |
|      countertop     | 55.61 | 72.72 |
|        stove        | 77.02 | 84.36 |
|         palm        | 45.82 | 53.54 |
|    kitchen island   | 34.61 | 68.57 |
|       computer      |  60.8 |  68.9 |
|     swivel chair    | 44.97 | 61.23 |
|         boat        | 66.38 | 71.07 |
|         bar         |  25.4 | 33.11 |
|    arcade machine   | 35.81 | 37.87 |
|        hovel        | 32.44 | 38.73 |
|         bus         | 84.47 | 94.96 |
|        towel        | 65.19 | 79.03 |
|        light        | 50.81 | 62.47 |
|        truck        | 21.18 | 31.07 |
|        tower        |  6.04 |  9.31 |
|      chandelier     | 62.11 | 71.52 |
|        awning       | 29.99 | 37.26 |
|     streetlight     | 22.46 | 30.37 |
|        booth        | 34.36 | 38.61 |
| television receiver | 69.08 | 79.56 |
|       airplane      | 59.05 | 67.76 |
|      dirt track     | 10.28 | 44.33 |
|       apparel       |  29.8 |  37.1 |
|         pole        | 19.38 | 25.68 |
|         land        |  3.1  |  3.97 |
|      bannister      | 15.57 | 20.36 |
|      escalator      | 23.78 |  30.5 |
|       ottoman       |  39.0 | 54.51 |
|        bottle       | 22.77 | 27.24 |
|        buffet       | 43.66 | 50.46 |
|        poster       | 29.47 | 41.21 |
|        stage        | 19.08 | 29.91 |
|         van         |  43.7 | 55.54 |
|         ship        |  5.32 |  6.09 |
|       fountain      |  20.6 | 20.69 |
|    conveyer belt    | 72.49 | 86.74 |
|        canopy       | 28.65 | 45.56 |
|        washer       | 75.02 | 76.18 |
|      plaything      | 24.96 | 36.51 |
|    swimming pool    | 41.98 |  77.4 |
|        stool        | 40.48 | 50.78 |
|        barrel       | 25.46 | 76.38 |
|        basket       |  24.2 | 37.61 |
|      waterfall      | 35.15 | 53.04 |
|         tent        | 93.21 | 98.16 |
|         bag         | 15.86 | 20.12 |
|       minibike      | 63.88 | 87.37 |
|        cradle       | 82.51 | 95.77 |
|         oven        | 34.32 | 60.53 |
|         ball        | 41.99 | 50.98 |
|         food        | 38.18 |  45.2 |
|         step        | 11.19 | 13.63 |
|         tank        | 48.94 | 56.82 |
|      trade name     | 23.29 |  27.7 |
|      microwave      |  67.0 | 76.29 |
|         pot         | 39.67 | 46.99 |
|        animal       | 60.69 | 64.53 |
|       bicycle       | 52.57 | 73.08 |
|         lake        | 44.49 | 59.04 |
|      dishwasher     | 71.15 | 80.82 |
|        screen       | 66.11 | 88.02 |
|       blanket       | 15.29 | 17.89 |
|      sculpture      | 44.94 | 50.27 |
|         hood        | 58.86 | 67.18 |
|        sconce       | 41.31 |  52.6 |
|         vase        | 35.29 | 45.88 |
|    traffic light    | 32.03 |  48.0 |
|         tray        |  7.18 | 15.04 |
|        ashcan       | 36.15 | 57.94 |
|         fan         | 58.53 | 76.09 |
|         pier        | 51.28 |  66.7 |
|      crt screen     |  3.2  |  8.01 |
|        plate        | 51.39 | 69.09 |
|       monitor       |  3.47 |  5.74 |
|    bulletin board   | 47.14 | 62.25 |
|        shower       |  1.82 |  1.86 |
|       radiator      | 55.82 | 60.14 |
|        glass        |  9.16 |  9.53 |
|        clock        | 35.84 | 45.75 |
|         flag        | 41.57 | 44.94 |
+---------------------+-------+-------+
10/06 05:53:24 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.4600  mIoU: 46.2100  mAcc: 58.1100  data_time: 0.0017  time: 0.9395
Finished processing corruption type: motion_blur
Processing corruption type: zoom_blur
10/06 05:53:27 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1212251367
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1212251367
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 05:53:29 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='zoom_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/zoom_blur'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 05:53:32,162 - mmseg - INFO - using core type: DCNv3
2024-10-06 05:53:32,163 - mmseg - INFO - using activation layer: GELU
2024-10-06 05:53:32,163 - mmseg - INFO - using main norm layer: LN
2024-10-06 05:53:32,163 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 05:53:32,163 - mmseg - INFO - level2_post_norm: False
2024-10-06 05:53:32,163 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 05:53:32,163 - mmseg - INFO - res_post_norm: False
2024-10-06 05:53:32,163 - mmseg - INFO - use_dcn_v4_op: False
10/06 05:53:34 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 05:53:34 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 05:53:36 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 05:53:37 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 05:54:58 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:52:33  time: 1.1650  data_time: 0.0016  memory: 29516  
10/06 05:55:56 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:44:07  time: 1.2919  data_time: 0.0016  memory: 15185  
10/06 05:56:44 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:38:20  time: 0.9466  data_time: 0.0016  memory: 15170  
10/06 05:57:38 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:36:10  time: 1.0319  data_time: 0.0016  memory: 15186  
10/06 05:58:31 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:34:17  time: 0.8690  data_time: 0.0016  memory: 15182  
10/06 05:59:20 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:32:21  time: 0.7590  data_time: 0.0016  memory: 15176  
10/06 06:00:11 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:30:58  time: 0.8700  data_time: 0.0015  memory: 15183  
10/06 06:00:59 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:29:27  time: 0.9210  data_time: 0.0015  memory: 15181  
10/06 06:01:36 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:27:30  time: 0.7874  data_time: 0.0015  memory: 9791  
10/06 06:02:16 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:25:55  time: 0.7127  data_time: 0.0015  memory: 15149  
10/06 06:02:58 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:24:39  time: 0.9400  data_time: 0.0016  memory: 15183  
10/06 06:03:37 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:23:20  time: 0.9102  data_time: 0.0017  memory: 9975  
10/06 06:04:21 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:22:16  time: 0.9351  data_time: 0.0014  memory: 15188  
10/06 06:05:08 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:21:23  time: 0.7638  data_time: 0.0016  memory: 15187  
10/06 06:05:56 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:20:31  time: 1.2585  data_time: 0.0015  memory: 15192  
10/06 06:06:33 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:19:23  time: 0.7370  data_time: 0.0017  memory: 15170  
10/06 06:07:10 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:18:19  time: 0.7457  data_time: 0.0017  memory: 967  
10/06 06:07:48 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:17:19  time: 0.7631  data_time: 0.0015  memory: 9232  
10/06 06:08:34 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:16:31  time: 0.9841  data_time: 0.0016  memory: 15181  
10/06 06:09:14 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:15:37  time: 0.7080  data_time: 0.0015  memory: 15139  
10/06 06:09:59 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:14:48  time: 1.1233  data_time: 0.0015  memory: 15191  
10/06 06:10:42 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:13:58  time: 0.7271  data_time: 0.0016  memory: 15164  
10/06 06:11:21 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:13:06  time: 0.8670  data_time: 0.0036  memory: 15151  
10/06 06:11:58 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:12:14  time: 0.7185  data_time: 0.0015  memory: 2148  
10/06 06:12:37 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:11:23  time: 0.8369  data_time: 0.0015  memory: 15172  
10/06 06:13:12 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:10:32  time: 0.7368  data_time: 0.0016  memory: 969  
10/06 06:13:49 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:09:43  time: 0.6837  data_time: 0.0015  memory: 15146  
10/06 06:14:33 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:08:58  time: 0.9666  data_time: 0.0015  memory: 15176  
10/06 06:15:11 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:08:10  time: 0.9220  data_time: 0.0015  memory: 15158  
10/06 06:15:47 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:07:23  time: 0.6821  data_time: 0.0015  memory: 968  
10/06 06:16:27 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:06:37  time: 0.7519  data_time: 0.0015  memory: 10910  
10/06 06:17:03 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:51  time: 0.7258  data_time: 0.0016  memory: 966  
10/06 06:17:44 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:05:06  time: 0.6782  data_time: 0.0014  memory: 15182  
10/06 06:18:26 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:22  time: 0.7377  data_time: 0.0016  memory: 15165  
10/06 06:19:06 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:38  time: 0.7324  data_time: 0.0015  memory: 15148  
10/06 06:19:43 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:53  time: 0.7473  data_time: 0.0016  memory: 15148  
10/06 06:20:20 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:09  time: 0.7380  data_time: 0.0016  memory: 915  
10/06 06:20:56 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:26  time: 0.7156  data_time: 0.0015  memory: 15188  
10/06 06:21:37 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:43  time: 0.7124  data_time: 0.0015  memory: 15154  
10/06 06:22:16 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6657  data_time: 0.0014  memory: 8857  
10/06 06:22:16 - mmengine - INFO - per class results:
10/06 06:22:16 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 58.32 | 81.41 |
|       building      | 65.79 | 84.88 |
|         sky         | 84.52 | 90.03 |
|        floor        | 58.03 | 84.88 |
|         tree        | 45.55 | 51.35 |
|       ceiling       | 58.16 | 91.09 |
|         road        | 51.07 | 58.15 |
|         bed         | 71.34 | 89.78 |
|      windowpane     | 45.15 | 63.32 |
|        grass        | 52.78 | 75.12 |
|       cabinet       | 46.93 | 58.19 |
|       sidewalk      | 26.18 | 41.44 |
|        person       | 57.04 | 78.77 |
|        earth        | 15.32 | 20.79 |
|         door        | 19.38 | 22.26 |
|        table        | 42.07 | 58.25 |
|       mountain      | 26.56 | 30.02 |
|        plant        | 21.48 |  33.4 |
|       curtain       |  38.0 | 50.92 |
|        chair        |  34.9 | 44.69 |
|         car         | 65.05 | 82.95 |
|        water        | 35.69 | 48.89 |
|       painting      | 52.13 | 68.51 |
|         sofa        | 45.44 | 64.22 |
|        shelf        | 26.12 | 44.77 |
|        house        | 25.81 | 29.69 |
|         sea         |  45.8 | 49.57 |
|        mirror       |  42.7 | 46.44 |
|         rug         | 27.67 | 28.95 |
|        field        | 11.54 | 44.98 |
|       armchair      | 22.67 | 31.57 |
|         seat        | 29.66 | 47.19 |
|        fence        | 13.83 | 24.33 |
|         desk        | 32.95 | 45.39 |
|         rock        | 19.22 | 21.11 |
|       wardrobe      | 31.14 | 43.06 |
|         lamp        | 39.19 | 53.59 |
|       bathtub       | 69.07 | 78.36 |
|       railing       | 13.03 | 16.32 |
|       cushion       | 25.09 |  29.9 |
|         base        | 20.27 | 35.32 |
|         box         |  7.22 |  8.73 |
|        column       | 21.31 | 25.09 |
|      signboard      | 21.58 | 25.38 |
|   chest of drawers  | 33.87 |  47.2 |
|       counter       |  9.46 | 12.78 |
|         sand        | 16.68 | 35.38 |
|         sink        | 56.79 | 64.49 |
|      skyscraper     | 29.18 | 40.14 |
|      fireplace      | 61.49 | 72.33 |
|     refrigerator    | 60.17 | 72.07 |
|      grandstand     | 24.26 | 61.45 |
|         path        |  4.3  |  4.44 |
|        stairs       |  1.32 |  1.5  |
|        runway       | 60.19 |  82.7 |
|         case        |  30.3 | 39.53 |
|      pool table     | 80.67 | 88.64 |
|        pillow       | 36.38 | 52.59 |
|     screen door     | 45.01 | 48.88 |
|       stairway      | 10.31 |  11.6 |
|        river        |  5.98 |  9.8  |
|        bridge       |  23.9 | 31.34 |
|       bookcase      | 32.55 | 54.65 |
|        blind        |  17.5 | 21.07 |
|     coffee table    |  45.3 |  54.7 |
|        toilet       | 66.32 | 74.67 |
|        flower       | 18.07 | 23.53 |
|         book        | 31.99 | 39.03 |
|         hill        |  1.56 |  3.86 |
|        bench        | 30.21 | 41.04 |
|      countertop     | 46.22 | 60.29 |
|        stove        | 59.59 | 68.64 |
|         palm        | 16.29 | 37.22 |
|    kitchen island   | 35.11 | 53.32 |
|       computer      | 44.26 | 51.69 |
|     swivel chair    | 19.68 | 24.46 |
|         boat        | 11.95 | 12.39 |
|         bar         | 13.55 | 15.61 |
|    arcade machine   |  7.49 |  10.6 |
|        hovel        |  8.78 | 10.51 |
|         bus         | 66.71 | 81.41 |
|        towel        | 25.76 | 28.71 |
|        light        | 20.68 | 25.56 |
|        truck        |  4.24 |  5.32 |
|        tower        | 28.79 | 36.23 |
|      chandelier     | 30.68 | 33.19 |
|        awning       | 11.82 | 13.03 |
|     streetlight     |  3.39 |  3.53 |
|        booth        | 27.03 | 28.19 |
| television receiver |  51.3 | 58.89 |
|       airplane      |  41.3 | 56.64 |
|      dirt track     |  0.99 | 12.49 |
|       apparel       |  3.58 |  3.83 |
|         pole        |  3.16 |  3.33 |
|         land        |  0.1  |  0.12 |
|      bannister      |  2.77 |  3.29 |
|      escalator      | 15.85 |  20.4 |
|       ottoman       |  24.4 | 28.27 |
|        bottle       | 12.03 | 12.82 |
|        buffet       | 31.73 | 35.76 |
|        poster       | 17.25 | 25.53 |
|        stage        | 14.26 | 17.37 |
|         van         | 13.72 | 20.25 |
|         ship        |  6.18 |  6.39 |
|       fountain      |  6.3  |  6.31 |
|    conveyer belt    | 38.69 | 57.49 |
|        canopy       |  4.15 |  4.29 |
|        washer       | 73.35 | 78.39 |
|      plaything      |  8.61 | 10.67 |
|    swimming pool    | 41.99 | 64.71 |
|        stool        | 21.42 | 23.83 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 15.85 | 17.76 |
|      waterfall      | 16.52 | 22.02 |
|         tent        | 77.25 | 99.48 |
|         bag         |  5.91 |  7.21 |
|       minibike      | 46.18 | 53.32 |
|        cradle       | 53.99 | 58.31 |
|         oven        | 22.86 | 26.08 |
|         ball        |  23.3 | 45.64 |
|         food        | 33.39 | 37.44 |
|         step        | 10.27 | 11.63 |
|         tank        | 22.16 | 25.17 |
|      trade name     |  9.25 |  9.45 |
|      microwave      | 32.37 |  38.3 |
|         pot         | 13.85 | 14.75 |
|        animal       | 44.84 | 49.74 |
|       bicycle       | 18.97 | 24.39 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 34.77 | 44.34 |
|        screen       | 47.91 | 75.34 |
|       blanket       |  0.56 |  0.58 |
|      sculpture      | 11.97 | 12.74 |
|         hood        | 47.15 | 52.26 |
|        sconce       | 14.35 | 17.16 |
|         vase        | 11.68 | 14.15 |
|    traffic light    |  10.9 | 11.62 |
|         tray        |  2.31 |  2.87 |
|        ashcan       | 20.62 | 23.39 |
|         fan         | 30.69 | 42.41 |
|         pier        | 34.25 | 42.21 |
|      crt screen     |  3.79 |  7.29 |
|        plate        | 27.31 | 32.21 |
|       monitor       | 37.39 | 46.78 |
|    bulletin board   | 21.18 |  24.1 |
|        shower       |  0.03 |  0.03 |
|       radiator      | 26.47 | 32.79 |
|        glass        |  1.58 |  1.6  |
|        clock        |  6.56 |  7.04 |
|         flag        | 25.61 | 30.73 |
+---------------------+-------+-------+
10/06 06:22:16 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 67.3300  mIoU: 28.5000  mAcc: 36.7100  data_time: 0.0018  time: 0.8593
Finished processing corruption type: zoom_blur
Processing corruption type: snow
10/06 06:22:19 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 477230302
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 477230302
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 06:22:21 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='snow',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/snow'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 06:22:24,281 - mmseg - INFO - using core type: DCNv3
2024-10-06 06:22:24,281 - mmseg - INFO - using activation layer: GELU
2024-10-06 06:22:24,281 - mmseg - INFO - using main norm layer: LN
2024-10-06 06:22:24,281 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 06:22:24,281 - mmseg - INFO - level2_post_norm: False
2024-10-06 06:22:24,281 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 06:22:24,281 - mmseg - INFO - res_post_norm: False
2024-10-06 06:22:24,281 - mmseg - INFO - use_dcn_v4_op: False
10/06 06:22:26 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 06:22:26 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 06:22:28 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 06:22:29 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 06:23:29 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:38:46  time: 0.7161  data_time: 0.0016  memory: 29516  
10/06 06:24:06 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:30:46  time: 0.8552  data_time: 0.0016  memory: 15185  
10/06 06:24:33 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:25:20  time: 0.5137  data_time: 0.0016  memory: 15170  
10/06 06:25:06 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:23:28  time: 0.6130  data_time: 0.0016  memory: 15186  
10/06 06:25:38 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:22:00  time: 0.4527  data_time: 0.0015  memory: 15182  
10/06 06:26:06 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:30  time: 0.3269  data_time: 0.0017  memory: 15176  
10/06 06:26:37 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:28  time: 0.4719  data_time: 0.0015  memory: 15183  
10/06 06:27:04 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:18:18  time: 0.4929  data_time: 0.0015  memory: 15181  
10/06 06:27:22 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:16:48  time: 0.4047  data_time: 0.0015  memory: 9791  
10/06 06:27:41 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:15:34  time: 0.3062  data_time: 0.0025  memory: 15149  
10/06 06:28:01 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:14:34  time: 0.4998  data_time: 0.0016  memory: 15183  
10/06 06:28:19 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:36  time: 0.4785  data_time: 0.0017  memory: 9975  
10/06 06:28:42 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:53  time: 0.5133  data_time: 0.0015  memory: 15188  
10/06 06:29:08 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:19  time: 0.3308  data_time: 0.0017  memory: 15187  
10/06 06:29:34 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:47  time: 0.8469  data_time: 0.0015  memory: 15192  
10/06 06:29:51 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:02  time: 0.3154  data_time: 0.0016  memory: 15170  
10/06 06:30:07 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:18  time: 0.3179  data_time: 0.0017  memory: 967  
10/06 06:30:25 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:41  time: 0.3862  data_time: 0.0015  memory: 9232  
10/06 06:30:50 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:09:13  time: 0.5711  data_time: 0.0016  memory: 15181  
10/06 06:31:10 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:40  time: 0.3027  data_time: 0.0015  memory: 15139  
10/06 06:31:33 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:08:12  time: 0.6844  data_time: 0.0015  memory: 15191  
10/06 06:31:55 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:42  time: 0.3164  data_time: 0.0017  memory: 15164  
10/06 06:32:13 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:11  time: 0.4416  data_time: 0.0015  memory: 15151  
10/06 06:32:29 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:39  time: 0.3075  data_time: 0.0015  memory: 2148  
10/06 06:32:48 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:11  time: 0.4310  data_time: 0.0015  memory: 15172  
10/06 06:33:03 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:40  time: 0.3162  data_time: 0.0015  memory: 969  
10/06 06:33:20 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:13  time: 0.2902  data_time: 0.0015  memory: 15146  
10/06 06:33:43 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:48  time: 0.5342  data_time: 0.0016  memory: 15176  
10/06 06:34:01 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:22  time: 0.4901  data_time: 0.0015  memory: 15158  
10/06 06:34:16 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:55  time: 0.2898  data_time: 0.0015  memory: 968  
10/06 06:34:34 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:30  time: 0.3253  data_time: 0.0015  memory: 10910  
10/06 06:34:49 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:04  time: 0.3115  data_time: 0.0017  memory: 966  
10/06 06:35:10 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:41  time: 0.2865  data_time: 0.0014  memory: 15182  
10/06 06:35:31 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:17  time: 0.3165  data_time: 0.0017  memory: 15165  
10/06 06:35:50 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:54  time: 0.3164  data_time: 0.0015  memory: 15148  
10/06 06:36:06 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:30  time: 0.3200  data_time: 0.0017  memory: 15148  
10/06 06:36:22 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:07  time: 0.3198  data_time: 0.0017  memory: 915  
10/06 06:36:39 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:44  time: 0.3082  data_time: 0.0016  memory: 15188  
10/06 06:36:58 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:22  time: 0.3036  data_time: 0.0015  memory: 15154  
10/06 06:37:17 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2792  data_time: 0.0014  memory: 8857  
10/06 06:37:17 - mmengine - INFO - per class results:
10/06 06:37:17 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 69.65 |  86.8 |
|       building      | 76.96 | 91.51 |
|         sky         | 91.32 | 95.05 |
|        floor        | 72.05 |  89.8 |
|         tree        | 69.38 |  83.2 |
|       ceiling       | 73.01 | 87.33 |
|         road        | 51.63 | 53.58 |
|         bed         | 82.95 | 90.69 |
|      windowpane     | 58.02 | 76.74 |
|        grass        |  56.7 | 73.62 |
|       cabinet       | 50.19 | 60.06 |
|       sidewalk      | 38.45 | 82.19 |
|        person       | 76.29 | 89.77 |
|        earth        |  34.2 | 44.64 |
|         door        | 27.45 | 31.44 |
|        table        | 50.34 |  67.0 |
|       mountain      |  49.1 | 61.45 |
|        plant        |  46.4 | 54.28 |
|       curtain       | 57.79 | 70.07 |
|        chair        | 50.06 | 59.49 |
|         car         | 79.76 | 90.48 |
|        water        | 43.44 | 67.46 |
|       painting      | 63.89 | 85.75 |
|         sofa        | 60.59 | 76.23 |
|        shelf        | 31.46 | 51.54 |
|        house        | 28.04 | 31.84 |
|         sea         | 51.02 | 63.11 |
|        mirror       | 59.32 |  66.8 |
|         rug         | 48.12 | 59.36 |
|        field        | 20.88 | 46.95 |
|       armchair      | 36.77 | 55.85 |
|         seat        | 46.99 | 67.12 |
|        fence        | 38.57 | 54.31 |
|         desk        | 42.17 | 50.57 |
|         rock        | 43.74 | 67.43 |
|       wardrobe      | 39.08 | 54.09 |
|         lamp        | 57.84 | 70.02 |
|       bathtub       | 62.45 | 76.46 |
|       railing       | 27.13 |  39.5 |
|       cushion       | 49.21 | 56.98 |
|         base        | 24.34 | 38.05 |
|         box         | 18.38 | 39.75 |
|        column       | 34.97 |  46.2 |
|      signboard      | 35.32 | 47.95 |
|   chest of drawers  | 36.92 | 72.48 |
|       counter       | 27.71 | 40.63 |
|         sand        | 31.02 | 44.17 |
|         sink        | 64.85 | 72.64 |
|      skyscraper     | 23.48 | 27.93 |
|      fireplace      | 69.08 | 85.14 |
|     refrigerator    | 57.52 | 61.67 |
|      grandstand     | 27.72 | 68.99 |
|         path        | 14.81 |  20.5 |
|        stairs       | 12.61 | 17.74 |
|        runway       | 60.04 | 81.28 |
|         case        | 40.71 | 64.26 |
|      pool table     | 88.28 | 94.29 |
|        pillow       | 47.83 | 61.88 |
|     screen door     | 46.42 |  57.1 |
|       stairway      | 19.55 | 34.11 |
|        river        |  7.34 |  9.16 |
|        bridge       | 36.26 | 42.23 |
|       bookcase      | 17.76 | 19.98 |
|        blind        | 27.38 | 29.11 |
|     coffee table    | 58.64 | 77.74 |
|        toilet       | 70.72 | 75.01 |
|        flower       |  39.9 | 52.78 |
|         book        |  41.3 | 52.53 |
|         hill        |  5.51 |  5.65 |
|        bench        | 25.27 | 27.83 |
|      countertop     |  56.3 | 71.29 |
|        stove        | 69.48 | 77.24 |
|         palm        | 45.89 | 61.26 |
|    kitchen island   |  19.6 | 30.79 |
|       computer      | 50.07 | 53.61 |
|     swivel chair    | 30.06 | 33.21 |
|         boat        |  43.2 | 47.13 |
|         bar         | 15.28 | 16.97 |
|    arcade machine   | 20.74 | 21.29 |
|        hovel        | 49.95 | 59.54 |
|         bus         | 88.24 | 95.39 |
|        towel        | 43.47 | 47.56 |
|        light        |  40.9 | 45.31 |
|        truck        | 29.88 | 40.27 |
|        tower        | 20.64 | 32.82 |
|      chandelier     | 60.32 | 74.71 |
|        awning       | 17.05 | 18.13 |
|     streetlight     | 21.76 | 25.61 |
|        booth        | 31.04 | 31.66 |
| television receiver | 51.69 | 55.72 |
|       airplane      | 51.29 | 60.06 |
|      dirt track     |  1.63 |  2.64 |
|       apparel       | 30.76 | 36.59 |
|         pole        | 16.63 | 21.79 |
|         land        |  1.48 |  1.53 |
|      bannister      | 10.55 | 12.86 |
|      escalator      | 15.83 | 17.22 |
|       ottoman       | 37.05 | 45.36 |
|        bottle       | 27.14 | 41.87 |
|        buffet       | 39.33 | 45.97 |
|        poster       | 13.87 | 18.25 |
|        stage        | 14.22 | 20.48 |
|         van         | 39.99 |  70.7 |
|         ship        | 52.74 | 81.94 |
|       fountain      | 12.19 | 12.93 |
|    conveyer belt    | 55.39 |  56.1 |
|        canopy       |  8.4  | 10.95 |
|        washer       | 67.52 | 68.44 |
|      plaything      | 24.36 | 30.34 |
|    swimming pool    | 46.89 | 81.23 |
|        stool        | 33.83 |  38.0 |
|        barrel       | 24.88 | 35.19 |
|        basket       | 31.54 | 42.33 |
|      waterfall      | 17.36 | 19.31 |
|         tent        | 88.79 | 99.17 |
|         bag         | 14.72 | 21.32 |
|       minibike      | 61.41 | 68.37 |
|        cradle       | 83.24 | 95.13 |
|         oven        | 40.25 | 46.46 |
|         ball        | 39.94 | 47.79 |
|         food        | 30.77 | 34.15 |
|         step        |  7.29 | 12.56 |
|         tank        | 28.28 | 32.65 |
|      trade name     | 19.12 | 21.73 |
|      microwave      | 35.64 | 37.53 |
|         pot         | 37.07 |  41.3 |
|        animal       |  52.1 | 59.17 |
|       bicycle       | 52.36 | 66.11 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 51.75 | 55.65 |
|        screen       | 52.94 | 70.87 |
|       blanket       | 12.14 | 12.65 |
|      sculpture      | 52.53 | 64.58 |
|         hood        | 39.75 | 40.34 |
|        sconce       | 34.89 | 45.82 |
|         vase        | 39.34 | 52.66 |
|    traffic light    | 32.58 | 40.99 |
|         tray        |  4.69 | 11.16 |
|        ashcan       | 29.98 | 36.72 |
|         fan         | 51.97 | 62.84 |
|         pier        | 56.81 | 78.56 |
|      crt screen     |  3.53 | 16.45 |
|        plate        | 42.55 |  49.9 |
|       monitor       |  1.94 |  2.15 |
|    bulletin board   | 39.89 | 44.91 |
|        shower       |  1.02 |  5.17 |
|       radiator      |  28.7 | 29.42 |
|        glass        | 11.13 | 11.61 |
|        clock        | 21.66 |  34.5 |
|         flag        | 37.36 | 44.82 |
+---------------------+-------+-------+
10/06 06:37:17 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 76.4700  mIoU: 39.6200  mAcc: 49.7100  data_time: 0.0018  time: 0.4439
Finished processing corruption type: snow
Processing corruption type: frost
10/06 06:37:23 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1631204223
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1631204223
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 06:37:24 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='frost',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/frost'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 06:37:29,384 - mmseg - INFO - using core type: DCNv3
2024-10-06 06:37:29,384 - mmseg - INFO - using activation layer: GELU
2024-10-06 06:37:29,384 - mmseg - INFO - using main norm layer: LN
2024-10-06 06:37:29,384 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 06:37:29,384 - mmseg - INFO - level2_post_norm: False
2024-10-06 06:37:29,384 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 06:37:29,384 - mmseg - INFO - res_post_norm: False
2024-10-06 06:37:29,384 - mmseg - INFO - use_dcn_v4_op: False
10/06 06:37:32 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 06:37:32 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 06:37:33 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 06:37:34 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 06:38:23 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:39  time: 0.4749  data_time: 0.0016  memory: 29516  
10/06 06:38:49 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:43  time: 0.6208  data_time: 0.0017  memory: 15185  
10/06 06:39:04 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:27  time: 0.2814  data_time: 0.0016  memory: 15170  
10/06 06:39:26 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:43  time: 0.3876  data_time: 0.0016  memory: 15186  
10/06 06:39:47 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:29  time: 0.2294  data_time: 0.0015  memory: 15182  
10/06 06:40:05 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:14:12  time: 0.0976  data_time: 0.0016  memory: 15176  
10/06 06:40:25 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:22  time: 0.2638  data_time: 0.0015  memory: 15183  
10/06 06:40:41 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:24  time: 0.2647  data_time: 0.0015  memory: 15181  
10/06 06:40:49 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:11:08  time: 0.1990  data_time: 0.0015  memory: 9791  
10/06 06:40:56 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:10:05  time: 0.0943  data_time: 0.0015  memory: 15149  
10/06 06:41:05 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:14  time: 0.2672  data_time: 0.0016  memory: 15183  
10/06 06:41:13 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:28  time: 0.2486  data_time: 0.0017  memory: 9975  
10/06 06:41:24 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:57  time: 0.2919  data_time: 0.0014  memory: 15188  
10/06 06:41:39 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:33  time: 0.1029  data_time: 0.0017  memory: 15187  
10/06 06:41:54 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:12  time: 0.6339  data_time: 0.0015  memory: 15192  
10/06 06:42:00 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:38  time: 0.0924  data_time: 0.0016  memory: 15170  
10/06 06:42:05 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:05  time: 0.0930  data_time: 0.0017  memory: 967  
10/06 06:42:13 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:40  time: 0.1906  data_time: 0.0015  memory: 9232  
10/06 06:42:27 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:23  time: 0.3561  data_time: 0.0016  memory: 15181  
10/06 06:42:36 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:01  time: 0.0883  data_time: 0.0015  memory: 15139  
10/06 06:42:48 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:43  time: 0.4541  data_time: 0.0015  memory: 15191  
10/06 06:42:58 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:24  time: 0.0932  data_time: 0.0017  memory: 15164  
10/06 06:43:06 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:05  time: 0.2584  data_time: 0.0042  memory: 15151  
10/06 06:43:11 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:44  time: 0.0912  data_time: 0.0015  memory: 2148  
10/06 06:43:19 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:26  time: 0.2175  data_time: 0.0015  memory: 15172  
10/06 06:43:24 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:07  time: 0.0920  data_time: 0.0015  memory: 969  
10/06 06:43:30 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:50  time: 0.0899  data_time: 0.0032  memory: 15146  
10/06 06:43:42 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:37  time: 0.2988  data_time: 0.0038  memory: 15176  
10/06 06:43:49 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:22  time: 0.2615  data_time: 0.0015  memory: 15158  
10/06 06:43:54 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:06  time: 0.0889  data_time: 0.0014  memory: 968  
10/06 06:44:01 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:52  time: 0.0987  data_time: 0.0015  memory: 10910  
10/06 06:44:05 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:37  time: 0.0919  data_time: 0.0016  memory: 966  
10/06 06:44:18 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:25  time: 0.0882  data_time: 0.0014  memory: 15182  
10/06 06:44:27 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:12  time: 0.0907  data_time: 0.0016  memory: 15165  
10/06 06:44:35 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:00  time: 0.0945  data_time: 0.0014  memory: 15148  
10/06 06:44:41 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:47  time: 0.0945  data_time: 0.0017  memory: 15148  
10/06 06:44:45 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:34  time: 0.0904  data_time: 0.0016  memory: 915  
10/06 06:44:51 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:22  time: 0.0931  data_time: 0.0015  memory: 15188  
10/06 06:45:00 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:11  time: 0.0905  data_time: 0.0015  memory: 15154  
10/06 06:45:08 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0845  data_time: 0.0014  memory: 8857  
10/06 06:45:08 - mmengine - INFO - per class results:
10/06 06:45:08 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 70.71 | 87.43 |
|       building      | 80.26 | 90.11 |
|         sky         | 72.83 |  75.4 |
|        floor        | 75.51 | 89.67 |
|         tree        | 66.14 |  86.7 |
|       ceiling       | 74.68 | 84.15 |
|         road        | 77.77 | 84.37 |
|         bed         |  86.1 | 93.01 |
|      windowpane     | 58.24 | 76.94 |
|        grass        | 64.16 | 81.24 |
|       cabinet       | 55.67 |  65.0 |
|       sidewalk      | 58.97 | 72.35 |
|        person       | 78.11 | 90.32 |
|        earth        | 33.94 | 50.92 |
|         door        | 37.96 | 51.61 |
|        table        | 56.06 | 72.59 |
|       mountain      | 27.04 | 70.96 |
|        plant        | 44.77 | 53.89 |
|       curtain       | 59.32 | 71.12 |
|        chair        | 54.67 | 68.29 |
|         car         | 81.98 |  90.1 |
|        water        | 53.59 | 71.67 |
|       painting      | 67.95 | 85.87 |
|         sofa        | 61.99 | 78.49 |
|        shelf        | 36.72 | 51.82 |
|        house        |  48.4 | 67.74 |
|         sea         | 49.88 | 66.79 |
|        mirror       | 60.72 | 70.16 |
|         rug         | 54.06 |  65.0 |
|        field        | 23.66 | 39.92 |
|       armchair      | 39.12 | 56.95 |
|         seat        | 55.83 | 71.41 |
|        fence        | 29.52 | 36.96 |
|         desk        | 47.87 | 63.69 |
|         rock        | 36.42 | 53.31 |
|       wardrobe      | 36.67 | 49.94 |
|         lamp        | 60.06 | 72.93 |
|       bathtub       | 59.53 | 67.75 |
|       railing       | 30.55 | 41.49 |
|       cushion       | 50.66 | 61.58 |
|         base        | 18.16 | 22.67 |
|         box         | 24.28 | 32.87 |
|        column       | 43.02 | 56.28 |
|      signboard      |  34.7 | 45.55 |
|   chest of drawers  | 36.71 | 48.06 |
|       counter       | 39.52 | 49.36 |
|         sand        | 32.06 | 41.08 |
|         sink        | 67.08 |  73.7 |
|      skyscraper     | 60.71 | 75.77 |
|      fireplace      | 68.68 | 87.03 |
|     refrigerator    |  69.9 | 77.62 |
|      grandstand     | 41.14 | 74.64 |
|         path        | 25.15 | 40.59 |
|        stairs       | 33.22 | 44.03 |
|        runway       | 64.33 | 87.03 |
|         case        | 44.24 | 72.54 |
|      pool table     | 91.67 | 94.55 |
|        pillow       | 56.68 | 69.55 |
|     screen door     | 51.68 | 70.49 |
|       stairway      | 31.12 |  36.9 |
|        river        | 11.14 | 17.54 |
|        bridge       | 33.73 | 45.36 |
|       bookcase      | 41.77 | 53.61 |
|        blind        | 36.59 | 39.33 |
|     coffee table    | 60.93 | 77.19 |
|        toilet       | 73.86 | 77.93 |
|        flower       | 42.36 | 57.44 |
|         book        | 43.25 | 60.43 |
|         hill        |  6.04 |  8.87 |
|        bench        | 40.87 | 53.86 |
|      countertop     |  51.6 | 72.95 |
|        stove        | 74.98 | 79.61 |
|         palm        | 44.92 | 54.73 |
|    kitchen island   |  30.8 | 65.95 |
|       computer      | 54.42 | 60.27 |
|     swivel chair    | 44.51 |  52.2 |
|         boat        | 42.56 | 45.88 |
|         bar         | 25.66 | 28.42 |
|    arcade machine   | 21.13 | 21.82 |
|        hovel        | 58.38 | 68.77 |
|         bus         | 89.62 | 95.67 |
|        towel        | 51.43 | 61.14 |
|        light        |  43.6 | 49.18 |
|        truck        | 30.58 | 38.69 |
|        tower        | 15.95 | 25.34 |
|      chandelier     | 61.19 | 73.05 |
|        awning       | 29.09 | 34.31 |
|     streetlight     | 24.14 | 28.42 |
|        booth        | 33.91 | 39.95 |
| television receiver | 55.05 | 57.76 |
|       airplane      | 65.32 | 77.94 |
|      dirt track     |  3.27 | 20.64 |
|       apparel       |  29.2 | 37.49 |
|         pole        | 26.14 | 37.75 |
|         land        |  0.26 |  0.36 |
|      bannister      | 11.68 |  15.6 |
|      escalator      | 16.51 | 21.17 |
|       ottoman       | 48.46 | 65.21 |
|        bottle       | 35.18 | 48.51 |
|        buffet       | 41.82 | 47.11 |
|        poster       | 25.19 | 30.34 |
|        stage        | 15.38 | 20.09 |
|         van         | 43.39 | 65.89 |
|         ship        | 61.89 | 88.74 |
|       fountain      |  6.37 |  6.77 |
|    conveyer belt    | 63.34 | 70.28 |
|        canopy       |  7.39 | 10.09 |
|        washer       | 59.71 | 60.84 |
|      plaything      | 27.54 | 36.04 |
|    swimming pool    | 37.88 |  66.3 |
|        stool        | 32.82 | 41.52 |
|        barrel       |  5.96 | 25.29 |
|        basket       | 32.79 | 43.11 |
|      waterfall      | 33.52 | 40.19 |
|         tent        | 92.62 | 97.77 |
|         bag         |  8.57 |  9.89 |
|       minibike      |  71.5 | 84.76 |
|        cradle       | 83.75 | 95.25 |
|         oven        | 23.89 | 66.09 |
|         ball        |  43.0 | 48.91 |
|         food        | 46.25 | 57.35 |
|         step        | 13.89 | 19.62 |
|         tank        | 33.32 | 37.76 |
|      trade name     | 22.21 | 25.32 |
|      microwave      | 41.28 | 43.46 |
|         pot         | 42.43 | 46.61 |
|        animal       | 58.16 | 60.61 |
|       bicycle       | 54.05 |  71.3 |
|         lake        |  63.2 | 70.09 |
|      dishwasher     | 50.79 | 66.01 |
|        screen       | 66.85 | 77.03 |
|       blanket       | 14.93 | 16.89 |
|      sculpture      | 57.89 | 73.45 |
|         hood        | 49.73 | 53.88 |
|        sconce       | 32.59 | 37.78 |
|         vase        | 40.36 | 52.66 |
|    traffic light    | 32.55 |  37.9 |
|         tray        |  6.56 | 11.61 |
|        ashcan       | 34.58 | 39.04 |
|         fan         |  54.7 | 62.54 |
|         pier        | 40.78 | 55.82 |
|      crt screen     |  1.54 |  4.11 |
|        plate        | 51.54 | 62.66 |
|       monitor       |  1.73 |  1.87 |
|    bulletin board   | 36.72 |  50.0 |
|        shower       |  0.65 |  1.14 |
|       radiator      |  34.6 | 36.23 |
|        glass        | 12.39 | 13.01 |
|        clock        | 23.56 | 28.84 |
|         flag        |  44.9 | 47.53 |
+---------------------+-------+-------+
10/06 06:45:08 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 77.7700  mIoU: 43.6400  mAcc: 54.4500  data_time: 0.0019  time: 0.2269
Finished processing corruption type: frost
Processing corruption type: fog
10/06 06:46:05 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1623520855
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1623520855
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 06:46:06 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='fog',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/fog'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 06:46:44,502 - mmseg - INFO - using core type: DCNv3
2024-10-06 06:46:44,502 - mmseg - INFO - using activation layer: GELU
2024-10-06 06:46:44,502 - mmseg - INFO - using main norm layer: LN
2024-10-06 06:46:44,502 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 06:46:44,502 - mmseg - INFO - level2_post_norm: False
2024-10-06 06:46:44,502 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 06:46:44,502 - mmseg - INFO - res_post_norm: False
2024-10-06 06:46:44,502 - mmseg - INFO - use_dcn_v4_op: False
10/06 06:46:54 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 06:46:54 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 06:46:56 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 06:46:59 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 06:48:29 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:58:53  time: 0.5966  data_time: 0.0016  memory: 29516  
10/06 06:49:02 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:38:56  time: 0.7491  data_time: 0.0016  memory: 15185  
10/06 06:49:23 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:29:39  time: 0.4114  data_time: 0.0016  memory: 15170  
10/06 06:49:51 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:25:51  time: 0.5149  data_time: 0.0015  memory: 15186  
10/06 06:50:19 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:23:20  time: 0.3614  data_time: 0.0015  memory: 15182  
10/06 06:50:43 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:21:09  time: 0.2253  data_time: 0.0016  memory: 15176  
10/06 06:51:09 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:38  time: 0.3899  data_time: 0.0015  memory: 15183  
10/06 06:51:31 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:18:09  time: 0.3932  data_time: 0.0015  memory: 15181  
10/06 06:51:46 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:16:27  time: 0.3244  data_time: 0.0015  memory: 9791  
10/06 06:52:00 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:15:02  time: 0.2217  data_time: 0.0015  memory: 15149  
10/06 06:52:15 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:13:52  time: 0.3955  data_time: 0.0016  memory: 15183  
10/06 06:52:28 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:12:49  time: 0.3732  data_time: 0.0016  memory: 9975  
10/06 06:52:46 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:02  time: 0.4194  data_time: 0.0014  memory: 15188  
10/06 06:53:07 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:24  time: 0.2278  data_time: 0.0016  memory: 15187  
10/06 06:53:29 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:49  time: 0.7611  data_time: 0.0015  memory: 15192  
10/06 06:53:41 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:03  time: 0.2208  data_time: 0.0016  memory: 15170  
10/06 06:53:53 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:19  time: 0.2203  data_time: 0.0016  memory: 967  
10/06 06:54:07 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:43  time: 0.3175  data_time: 0.0014  memory: 9232  
10/06 06:54:28 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:16  time: 0.4856  data_time: 0.0016  memory: 15181  
10/06 06:54:43 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:44  time: 0.2190  data_time: 0.0016  memory: 15139  
10/06 06:55:06 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:20  time: 0.5834  data_time: 0.0015  memory: 15191  
10/06 06:55:23 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:52  time: 0.2454  data_time: 0.0038  memory: 15164  
10/06 06:55:37 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:23  time: 0.3488  data_time: 0.0015  memory: 15151  
10/06 06:55:49 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:53  time: 0.2203  data_time: 0.0015  memory: 2148  
10/06 06:56:04 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:27  time: 0.3711  data_time: 0.0033  memory: 15172  
10/06 06:56:15 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:59  time: 0.2243  data_time: 0.0015  memory: 969  
10/06 06:56:28 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:34  time: 0.2162  data_time: 0.0015  memory: 15146  
10/06 06:56:46 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:11  time: 0.4218  data_time: 0.0015  memory: 15176  
10/06 06:57:01 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:48  time: 0.3932  data_time: 0.0035  memory: 15158  
10/06 06:57:12 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:24  time: 0.2167  data_time: 0.0015  memory: 968  
10/06 06:57:25 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:01  time: 0.2254  data_time: 0.0015  memory: 10910  
10/06 06:57:36 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:39  time: 0.2517  data_time: 0.0038  memory: 966  
10/06 06:57:53 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:18  time: 0.2147  data_time: 0.0014  memory: 15182  
10/06 06:58:08 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:58  time: 0.2222  data_time: 0.0017  memory: 15165  
10/06 06:58:23 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:37  time: 0.2229  data_time: 0.0014  memory: 15148  
10/06 06:58:35 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:17  time: 0.2226  data_time: 0.0017  memory: 15148  
10/06 06:58:46 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:57  time: 0.2212  data_time: 0.0017  memory: 915  
10/06 06:58:59 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:37  time: 0.2224  data_time: 0.0015  memory: 15188  
10/06 06:59:14 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:18  time: 0.2468  data_time: 0.0035  memory: 15154  
10/06 06:59:29 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2135  data_time: 0.0014  memory: 8857  
10/06 06:59:29 - mmengine - INFO - per class results:
10/06 06:59:29 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 78.01 | 88.48 |
|       building      | 82.01 |  92.1 |
|         sky         | 94.16 | 97.59 |
|        floor        |  81.5 |  90.7 |
|         tree        | 72.89 | 86.87 |
|       ceiling       |  84.0 | 92.85 |
|         road        | 83.78 | 88.51 |
|         bed         | 88.72 | 95.23 |
|      windowpane     | 61.89 | 79.99 |
|        grass        | 63.71 | 76.82 |
|       cabinet       | 59.13 | 73.23 |
|       sidewalk      | 66.46 | 83.62 |
|        person       | 81.32 | 92.07 |
|        earth        | 36.05 | 51.47 |
|         door        |  52.7 |  66.7 |
|        table        | 61.39 | 76.36 |
|       mountain      | 56.63 | 73.19 |
|        plant        | 48.33 | 59.33 |
|       curtain       | 73.01 | 82.97 |
|        chair        |  58.4 |  73.1 |
|         car         | 84.49 | 91.71 |
|        water        | 53.52 | 69.29 |
|       painting      | 73.45 | 87.41 |
|         sofa        | 64.37 | 82.28 |
|        shelf        | 40.96 | 56.38 |
|        house        | 38.03 | 53.87 |
|         sea         | 55.01 | 72.39 |
|        mirror       | 67.19 | 75.31 |
|         rug         | 60.04 | 71.85 |
|        field        | 28.14 | 49.67 |
|       armchair      | 40.66 | 55.79 |
|         seat        | 61.34 | 77.46 |
|        fence        |  45.1 | 57.73 |
|         desk        | 51.05 | 64.41 |
|         rock        | 40.04 | 62.51 |
|       wardrobe      | 46.57 | 65.65 |
|         lamp        | 64.28 | 78.47 |
|       bathtub       | 78.03 | 85.03 |
|       railing       | 34.42 | 49.16 |
|       cushion       | 60.39 | 74.97 |
|         base        | 34.01 | 45.02 |
|         box         | 29.08 | 38.55 |
|        column       | 47.84 | 60.33 |
|      signboard      | 37.94 | 52.87 |
|   chest of drawers  | 39.91 | 59.12 |
|       counter       | 35.86 | 43.47 |
|         sand        | 55.08 | 73.32 |
|         sink        | 71.63 | 81.36 |
|      skyscraper     | 53.07 |  67.3 |
|      fireplace      | 76.26 | 87.85 |
|     refrigerator    | 72.95 | 82.82 |
|      grandstand     |  46.5 | 71.55 |
|         path        | 26.57 | 39.42 |
|        stairs       | 33.31 | 40.65 |
|        runway       |  67.9 | 96.54 |
|         case        | 49.63 | 73.47 |
|      pool table     | 92.06 | 95.31 |
|        pillow       | 57.93 | 71.11 |
|     screen door     | 77.75 | 85.04 |
|       stairway      | 31.82 | 36.92 |
|        river        | 10.16 | 21.56 |
|        bridge       | 57.04 | 73.33 |
|       bookcase      | 42.65 | 62.86 |
|        blind        | 45.17 | 50.29 |
|     coffee table    | 59.34 | 81.32 |
|        toilet       | 85.94 | 91.03 |
|        flower       | 46.33 | 59.46 |
|         book        | 46.19 | 69.57 |
|         hill        |  8.48 | 10.52 |
|        bench        | 50.41 | 57.35 |
|      countertop     | 55.58 | 75.05 |
|        stove        | 78.97 |  83.7 |
|         palm        | 49.09 | 62.89 |
|    kitchen island   |  34.8 |  72.2 |
|       computer      | 65.92 | 75.12 |
|     swivel chair    |  40.4 | 51.69 |
|         boat        | 45.42 | 50.27 |
|         bar         | 32.57 | 42.15 |
|    arcade machine   | 39.01 | 40.55 |
|        hovel        | 35.31 |  38.2 |
|         bus         | 87.36 | 96.35 |
|        towel        | 65.92 | 79.66 |
|        light        | 55.23 | 63.81 |
|        truck        |  25.9 | 33.44 |
|        tower        |  26.1 | 43.51 |
|      chandelier     | 70.57 |  82.1 |
|        awning       | 28.11 | 33.88 |
|     streetlight     | 27.74 | 37.54 |
|        booth        |  37.6 | 43.86 |
| television receiver | 66.05 | 74.82 |
|       airplane      | 71.36 | 81.88 |
|      dirt track     | 11.99 | 24.67 |
|       apparel       | 41.16 | 55.31 |
|         pole        | 23.78 | 33.16 |
|         land        |  2.74 |  4.13 |
|      bannister      | 14.26 | 18.29 |
|      escalator      | 29.26 |  36.5 |
|       ottoman       | 43.82 | 60.13 |
|        bottle       | 35.19 | 54.04 |
|        buffet       | 43.11 | 48.83 |
|        poster       | 31.81 | 41.95 |
|        stage        | 15.96 | 23.54 |
|         van         | 43.71 | 66.93 |
|         ship        | 42.51 | 65.89 |
|       fountain      |  18.6 | 18.88 |
|    conveyer belt    | 76.52 | 87.38 |
|        canopy       | 27.39 | 38.25 |
|        washer       | 72.37 | 75.11 |
|      plaything      | 29.97 | 42.95 |
|    swimming pool    | 42.29 | 76.62 |
|        stool        | 41.53 | 54.17 |
|        barrel       | 33.92 | 64.98 |
|        basket       | 33.17 | 47.22 |
|      waterfall      | 44.52 | 54.72 |
|         tent        | 92.89 | 98.77 |
|         bag         | 15.69 |  17.9 |
|       minibike      | 73.57 | 83.91 |
|        cradle       | 85.81 | 97.22 |
|         oven        | 43.07 | 60.54 |
|         ball        | 46.76 | 51.43 |
|         food        | 48.25 | 56.36 |
|         step        | 19.02 | 24.55 |
|         tank        | 51.46 | 57.14 |
|      trade name     |  26.7 | 33.34 |
|      microwave      | 77.04 | 86.25 |
|         pot         | 44.73 |  52.2 |
|        animal       | 59.08 | 61.21 |
|       bicycle       | 55.98 | 70.77 |
|         lake        | 62.78 | 78.67 |
|      dishwasher     |  70.9 | 83.34 |
|        screen       | 58.66 | 74.93 |
|       blanket       | 14.03 | 16.68 |
|      sculpture      | 63.75 | 71.31 |
|         hood        | 61.48 | 65.76 |
|        sconce       | 43.12 | 53.23 |
|         vase        | 46.07 | 58.83 |
|    traffic light    | 34.92 | 50.93 |
|         tray        |  8.55 |  16.5 |
|        ashcan       | 46.42 | 60.29 |
|         fan         | 62.83 | 71.89 |
|         pier        | 57.59 | 79.42 |
|      crt screen     |  4.28 | 13.14 |
|        plate        | 56.16 | 68.99 |
|       monitor       |  3.94 |  6.0  |
|    bulletin board   | 50.85 | 68.46 |
|        shower       |  1.64 |  1.95 |
|       radiator      | 62.37 | 72.09 |
|        glass        | 15.16 | 16.28 |
|        clock        | 38.82 | 50.32 |
|         flag        | 45.51 |  48.5 |
+---------------------+-------+-------+
10/06 06:59:29 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.9200  mIoU: 49.6600  mAcc: 61.4500  data_time: 0.0024  time: 0.3752
Finished processing corruption type: fog
Processing corruption type: brightness
10/06 06:59:37 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 414004598
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 414004598
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 06:59:38 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='brightness',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/brightness'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 06:59:43,218 - mmseg - INFO - using core type: DCNv3
2024-10-06 06:59:43,218 - mmseg - INFO - using activation layer: GELU
2024-10-06 06:59:43,218 - mmseg - INFO - using main norm layer: LN
2024-10-06 06:59:43,218 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 06:59:43,218 - mmseg - INFO - level2_post_norm: False
2024-10-06 06:59:43,218 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 06:59:43,218 - mmseg - INFO - res_post_norm: False
2024-10-06 06:59:43,218 - mmseg - INFO - use_dcn_v4_op: False
10/06 06:59:48 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 06:59:48 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 06:59:50 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 06:59:52 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 07:00:54 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:40:23  time: 0.7169  data_time: 0.0063  memory: 29516  
10/06 07:01:32 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:31:31  time: 1.0162  data_time: 0.0152  memory: 15185  
10/06 07:02:00 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:26:22  time: 0.5229  data_time: 0.0058  memory: 15170  
10/06 07:02:32 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:23:56  time: 0.6261  data_time: 0.0098  memory: 15186  
10/06 07:03:02 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:22:07  time: 0.4081  data_time: 0.0040  memory: 15182  
10/06 07:03:29 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:27  time: 0.3346  data_time: 0.0087  memory: 15176  
10/06 07:04:00 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:29  time: 0.4797  data_time: 0.0075  memory: 15183  
10/06 07:04:23 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:18:04  time: 0.4082  data_time: 0.0021  memory: 15181  
10/06 07:04:38 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:16:23  time: 0.3217  data_time: 0.0015  memory: 9791  
10/06 07:04:52 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:15:00  time: 0.2275  data_time: 0.0015  memory: 15149  
10/06 07:05:08 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:13:53  time: 0.4491  data_time: 0.0041  memory: 15183  
10/06 07:05:23 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:12:51  time: 0.3927  data_time: 0.0035  memory: 9975  
10/06 07:05:42 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:06  time: 0.4857  data_time: 0.0052  memory: 15188  
10/06 07:06:04 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:31  time: 0.2475  data_time: 0.0017  memory: 15187  
10/06 07:06:27 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:10:58  time: 0.7681  data_time: 0.0016  memory: 15192  
10/06 07:06:40 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:11  time: 0.2352  data_time: 0.0017  memory: 15170  
10/06 07:06:52 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:27  time: 0.2371  data_time: 0.0017  memory: 967  
10/06 07:07:07 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:51  time: 0.3138  data_time: 0.0015  memory: 9232  
10/06 07:07:31 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:26  time: 0.5570  data_time: 0.0096  memory: 15181  
10/06 07:07:48 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:55  time: 0.2529  data_time: 0.0038  memory: 15139  
10/06 07:08:08 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:28  time: 0.5981  data_time: 0.0015  memory: 15191  
10/06 07:08:26 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:00  time: 0.2266  data_time: 0.0016  memory: 15164  
10/06 07:08:40 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:30  time: 0.3596  data_time: 0.0015  memory: 15151  
10/06 07:08:52 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:59  time: 0.2259  data_time: 0.0016  memory: 2148  
10/06 07:09:07 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:32  time: 0.3491  data_time: 0.0015  memory: 15172  
10/06 07:09:18 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:04  time: 0.2347  data_time: 0.0015  memory: 969  
10/06 07:09:31 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:38  time: 0.2143  data_time: 0.0015  memory: 15146  
10/06 07:09:52 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:17  time: 0.5364  data_time: 0.0089  memory: 15176  
10/06 07:10:07 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:53  time: 0.4062  data_time: 0.0016  memory: 15158  
10/06 07:10:19 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:28  time: 0.2139  data_time: 0.0015  memory: 968  
10/06 07:10:35 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:06  time: 0.2373  data_time: 0.0015  memory: 10910  
10/06 07:10:46 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:43  time: 0.2264  data_time: 0.0016  memory: 966  
10/06 07:11:04 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:22  time: 0.2146  data_time: 0.0014  memory: 15182  
10/06 07:11:22 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:01  time: 0.3221  data_time: 0.0064  memory: 15165  
10/06 07:11:40 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:41  time: 0.2357  data_time: 0.0036  memory: 15148  
10/06 07:11:53 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:20  time: 0.2373  data_time: 0.0018  memory: 15148  
10/06 07:12:04 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:59  time: 0.2351  data_time: 0.0017  memory: 915  
10/06 07:12:18 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:39  time: 0.2289  data_time: 0.0016  memory: 15188  
10/06 07:12:34 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:19  time: 0.2223  data_time: 0.0015  memory: 15154  
10/06 07:12:50 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2077  data_time: 0.0014  memory: 8857  
10/06 07:12:50 - mmengine - INFO - per class results:
10/06 07:12:50 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 78.09 | 88.35 |
|       building      |  82.3 |  92.3 |
|         sky         | 93.96 | 97.81 |
|        floor        | 81.97 |  90.4 |
|         tree        | 72.77 | 86.28 |
|       ceiling       | 84.75 | 92.73 |
|         road        | 84.62 | 89.67 |
|         bed         | 89.31 | 95.71 |
|      windowpane     | 62.86 | 80.29 |
|        grass        | 64.82 |  79.4 |
|       cabinet       | 60.38 | 73.91 |
|       sidewalk      | 66.28 | 82.14 |
|        person       | 81.15 | 92.36 |
|        earth        | 37.24 | 52.68 |
|         door        | 52.08 |  68.0 |
|        table        | 61.23 | 77.34 |
|       mountain      | 58.22 | 73.52 |
|        plant        | 48.75 | 59.79 |
|       curtain       | 73.64 | 83.66 |
|        chair        | 58.74 | 73.23 |
|         car         | 84.19 |  91.6 |
|        water        | 53.93 | 69.88 |
|       painting      | 72.97 | 87.21 |
|         sofa        | 65.27 | 82.94 |
|        shelf        | 41.96 | 58.34 |
|        house        | 41.57 |  57.7 |
|         sea         | 57.37 | 75.79 |
|        mirror       | 66.41 | 75.11 |
|         rug         | 60.85 | 74.52 |
|        field        |  28.8 | 48.12 |
|       armchair      |  41.1 | 55.44 |
|         seat        | 61.39 | 80.31 |
|        fence        | 44.54 | 56.61 |
|         desk        |  51.1 | 66.35 |
|         rock        |  40.6 | 63.09 |
|       wardrobe      | 45.17 | 63.86 |
|         lamp        | 63.54 | 76.83 |
|       bathtub       | 79.55 | 85.02 |
|       railing       | 33.28 | 46.85 |
|       cushion       | 61.01 | 76.37 |
|         base        |  34.2 | 43.31 |
|         box         | 29.64 | 38.85 |
|        column       | 47.35 | 59.56 |
|      signboard      | 38.28 | 52.55 |
|   chest of drawers  | 40.09 | 59.36 |
|       counter       | 33.38 | 39.86 |
|         sand        | 56.51 | 78.93 |
|         sink        |  71.6 | 80.55 |
|      skyscraper     |  57.6 | 73.36 |
|      fireplace      | 76.66 | 87.03 |
|     refrigerator    | 72.75 | 82.07 |
|      grandstand     | 44.24 | 67.69 |
|         path        | 27.91 |  40.6 |
|        stairs       | 34.79 | 42.42 |
|        runway       | 71.25 | 95.96 |
|         case        | 48.44 | 71.98 |
|      pool table     | 92.73 | 95.73 |
|        pillow       | 57.95 | 69.44 |
|     screen door     | 77.19 | 84.15 |
|       stairway      | 32.32 | 37.62 |
|        river        |  11.3 | 23.47 |
|        bridge       | 50.27 | 64.96 |
|       bookcase      |  43.8 | 62.22 |
|        blind        | 42.53 | 46.38 |
|     coffee table    | 61.08 | 82.45 |
|        toilet       |  85.8 | 91.03 |
|        flower       | 45.45 | 61.59 |
|         book        | 47.52 | 71.55 |
|         hill        |  5.81 |  8.12 |
|        bench        | 50.15 | 57.51 |
|      countertop     | 56.89 | 74.67 |
|        stove        | 80.87 | 85.61 |
|         palm        | 51.22 | 66.54 |
|    kitchen island   | 33.47 |  66.7 |
|       computer      | 65.65 | 74.66 |
|     swivel chair    | 39.89 | 52.22 |
|         boat        | 43.34 | 49.15 |
|         bar         | 30.88 | 38.95 |
|    arcade machine   | 40.03 | 41.68 |
|        hovel        | 41.62 | 45.74 |
|         bus         | 88.68 | 96.56 |
|        towel        | 68.24 |  78.4 |
|        light        | 54.21 | 63.62 |
|        truck        | 32.99 | 42.13 |
|        tower        | 24.44 | 39.88 |
|      chandelier     | 69.43 | 81.08 |
|        awning       |  28.9 | 35.98 |
|     streetlight     |  27.1 | 36.14 |
|        booth        | 36.74 | 43.47 |
| television receiver | 67.33 | 75.35 |
|       airplane      | 71.95 | 82.77 |
|      dirt track     |  5.03 |  11.6 |
|       apparel       | 39.46 |  51.9 |
|         pole        | 25.11 | 36.35 |
|         land        |  3.11 |  4.38 |
|      bannister      | 16.01 | 20.13 |
|      escalator      | 37.45 | 51.69 |
|       ottoman       | 41.65 | 57.03 |
|        bottle       | 36.26 | 58.42 |
|        buffet       | 43.16 | 49.25 |
|        poster       |  33.8 | 42.38 |
|        stage        | 13.94 | 19.96 |
|         van         | 43.35 | 67.76 |
|         ship        | 57.57 | 88.54 |
|       fountain      | 20.44 | 20.87 |
|    conveyer belt    | 74.08 | 87.92 |
|        canopy       | 32.54 | 45.48 |
|        washer       | 73.02 |  75.7 |
|      plaything      | 30.66 | 44.36 |
|    swimming pool    | 41.79 | 76.46 |
|        stool        | 42.16 | 55.35 |
|        barrel       | 33.33 | 74.66 |
|        basket       | 32.61 | 48.15 |
|      waterfall      | 46.38 | 58.84 |
|         tent        | 95.29 | 98.47 |
|         bag         | 15.94 | 18.36 |
|       minibike      | 73.91 |  85.3 |
|        cradle       | 86.52 | 97.52 |
|         oven        | 44.29 | 73.59 |
|         ball        | 44.24 | 47.24 |
|         food        | 50.11 |  60.0 |
|         step        | 19.45 | 25.92 |
|         tank        | 51.54 | 58.92 |
|      trade name     |  27.4 | 34.33 |
|      microwave      | 72.32 | 79.89 |
|         pot         |  44.3 |  52.1 |
|        animal       | 57.68 |  59.9 |
|       bicycle       |  56.6 | 72.07 |
|         lake        | 70.91 | 78.01 |
|      dishwasher     | 74.14 | 83.18 |
|        screen       | 59.57 | 79.48 |
|       blanket       | 14.58 | 17.61 |
|      sculpture      | 64.65 | 74.11 |
|         hood        | 62.19 | 67.45 |
|        sconce       | 42.73 | 54.63 |
|         vase        | 45.45 | 57.62 |
|    traffic light    |  36.2 | 52.39 |
|         tray        |  9.44 | 17.86 |
|        ashcan       | 47.08 | 60.79 |
|         fan         | 63.75 | 74.25 |
|         pier        | 54.05 | 81.75 |
|      crt screen     |  4.6  | 13.33 |
|        plate        | 54.84 | 68.39 |
|       monitor       |  4.05 |  6.36 |
|    bulletin board   |  53.6 | 70.62 |
|        shower       |  2.61 |  2.69 |
|       radiator      | 59.34 | 68.17 |
|        glass        | 15.07 | 15.88 |
|        clock        | 39.47 |  51.7 |
|         flag        | 46.07 | 49.77 |
+---------------------+-------+-------+
10/06 07:12:50 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 83.1700  mIoU: 50.1100  mAcc: 62.1300  data_time: 0.0033  time: 0.3887
Finished processing corruption type: brightness
Processing corruption type: contrast
10/06 07:13:10 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1223117355
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1223117355
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 07:13:11 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='contrast',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/contrast'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 07:13:31,424 - mmseg - INFO - using core type: DCNv3
2024-10-06 07:13:31,424 - mmseg - INFO - using activation layer: GELU
2024-10-06 07:13:31,425 - mmseg - INFO - using main norm layer: LN
2024-10-06 07:13:31,425 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 07:13:31,425 - mmseg - INFO - level2_post_norm: False
2024-10-06 07:13:31,425 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 07:13:31,425 - mmseg - INFO - res_post_norm: False
2024-10-06 07:13:31,425 - mmseg - INFO - use_dcn_v4_op: False
10/06 07:13:36 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 07:13:36 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 07:13:37 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 07:13:39 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 07:14:31 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:33:52  time: 0.4730  data_time: 0.0016  memory: 29516  
10/06 07:14:57 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:24:46  time: 0.6200  data_time: 0.0016  memory: 15185  
10/06 07:15:12 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:19:06  time: 0.2785  data_time: 0.0016  memory: 15170  
10/06 07:15:34 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:17:09  time: 0.3819  data_time: 0.0015  memory: 15186  
10/06 07:15:55 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:48  time: 0.2290  data_time: 0.0015  memory: 15182  
10/06 07:16:12 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:14:26  time: 0.0961  data_time: 0.0016  memory: 15176  
10/06 07:16:32 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:33  time: 0.2619  data_time: 0.0015  memory: 15183  
10/06 07:16:47 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:33  time: 0.2627  data_time: 0.0014  memory: 15181  
10/06 07:16:55 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:11:16  time: 0.1927  data_time: 0.0015  memory: 9791  
10/06 07:17:03 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:10:11  time: 0.0883  data_time: 0.0015  memory: 15149  
10/06 07:17:11 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:19  time: 0.2636  data_time: 0.0016  memory: 15183  
10/06 07:17:19 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:32  time: 0.2431  data_time: 0.0016  memory: 9975  
10/06 07:17:30 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:59  time: 0.2881  data_time: 0.0014  memory: 15188  
10/06 07:17:44 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:35  time: 0.0973  data_time: 0.0016  memory: 15187  
10/06 07:17:59 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:13  time: 0.6341  data_time: 0.0015  memory: 15192  
10/06 07:18:06 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:39  time: 0.0905  data_time: 0.0016  memory: 15170  
10/06 07:18:10 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:06  time: 0.0931  data_time: 0.0016  memory: 967  
10/06 07:18:18 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:40  time: 0.1875  data_time: 0.0015  memory: 9232  
10/06 07:18:32 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:23  time: 0.3549  data_time: 0.0016  memory: 15181  
10/06 07:18:41 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:01  time: 0.0863  data_time: 0.0015  memory: 15139  
10/06 07:18:53 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:43  time: 0.4525  data_time: 0.0015  memory: 15191  
10/06 07:19:03 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:24  time: 0.0887  data_time: 0.0016  memory: 15164  
10/06 07:19:10 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:04  time: 0.2195  data_time: 0.0015  memory: 15151  
10/06 07:19:15 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:43  time: 0.0891  data_time: 0.0015  memory: 2148  
10/06 07:19:23 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:26  time: 0.2132  data_time: 0.0015  memory: 15172  
10/06 07:19:27 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:07  time: 0.0899  data_time: 0.0015  memory: 969  
10/06 07:19:33 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:50  time: 0.0846  data_time: 0.0015  memory: 15146  
10/06 07:19:45 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:36  time: 0.2940  data_time: 0.0015  memory: 15176  
10/06 07:19:52 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:21  time: 0.2598  data_time: 0.0015  memory: 15158  
10/06 07:19:57 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:05  time: 0.0845  data_time: 0.0014  memory: 968  
10/06 07:20:03 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:51  time: 0.0934  data_time: 0.0015  memory: 10910  
10/06 07:20:08 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:37  time: 0.0881  data_time: 0.0016  memory: 966  
10/06 07:20:18 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:24  time: 0.0834  data_time: 0.0014  memory: 15182  
10/06 07:20:27 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:11  time: 0.0900  data_time: 0.0016  memory: 15165  
10/06 07:20:35 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:59  time: 0.0931  data_time: 0.0014  memory: 15148  
10/06 07:20:40 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:46  time: 0.0911  data_time: 0.0016  memory: 15148  
10/06 07:20:45 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:34  time: 0.0896  data_time: 0.0016  memory: 915  
10/06 07:20:51 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:22  time: 0.0891  data_time: 0.0015  memory: 15188  
10/06 07:20:59 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:11  time: 0.0870  data_time: 0.0015  memory: 15154  
10/06 07:21:07 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0804  data_time: 0.0014  memory: 8857  
10/06 07:21:07 - mmengine - INFO - per class results:
10/06 07:21:07 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 77.45 |  88.4 |
|       building      | 81.45 | 91.17 |
|         sky         | 94.06 | 97.58 |
|        floor        | 81.65 | 90.56 |
|         tree        | 72.52 | 87.27 |
|       ceiling       | 83.71 | 92.74 |
|         road        | 83.78 | 88.66 |
|         bed         |  88.2 | 95.15 |
|      windowpane     | 61.62 | 79.87 |
|        grass        | 62.54 | 76.83 |
|       cabinet       | 58.62 | 73.22 |
|       sidewalk      | 65.76 | 82.98 |
|        person       | 81.19 | 91.91 |
|        earth        | 35.29 | 51.75 |
|         door        | 51.94 |  66.2 |
|        table        |  60.8 | 75.96 |
|       mountain      | 55.45 | 72.43 |
|        plant        | 48.88 | 57.67 |
|       curtain       | 72.22 | 81.68 |
|        chair        | 58.46 | 73.02 |
|         car         | 84.45 | 91.59 |
|        water        | 51.03 | 66.86 |
|       painting      | 71.79 | 87.49 |
|         sofa        | 64.45 | 80.51 |
|        shelf        | 40.35 | 54.37 |
|        house        | 37.34 | 54.97 |
|         sea         | 56.49 | 73.76 |
|        mirror       | 65.85 | 73.68 |
|         rug         | 60.45 |  71.8 |
|        field        | 27.97 | 51.58 |
|       armchair      | 41.77 | 58.81 |
|         seat        |  62.2 | 77.33 |
|        fence        | 45.01 | 56.61 |
|         desk        | 50.33 | 63.61 |
|         rock        | 38.58 |  57.3 |
|       wardrobe      | 44.75 | 64.06 |
|         lamp        | 63.85 | 77.55 |
|       bathtub       | 78.31 | 85.07 |
|       railing       | 33.45 | 48.67 |
|       cushion       | 60.04 | 73.93 |
|         base        | 35.61 | 48.13 |
|         box         | 27.68 | 35.82 |
|        column       |  48.0 |  59.7 |
|      signboard      | 38.53 | 52.83 |
|   chest of drawers  | 39.39 | 59.18 |
|       counter       | 35.22 |  44.8 |
|         sand        |  55.7 | 72.54 |
|         sink        |  71.0 | 80.47 |
|      skyscraper     | 54.24 | 70.08 |
|      fireplace      | 75.45 | 86.42 |
|     refrigerator    |  73.1 | 82.17 |
|      grandstand     | 43.47 | 68.99 |
|         path        | 24.13 | 36.86 |
|        stairs       | 33.57 | 39.67 |
|        runway       | 67.39 | 96.36 |
|         case        | 48.59 | 81.42 |
|      pool table     | 91.73 | 95.19 |
|        pillow       | 57.13 |  69.6 |
|     screen door     | 76.36 | 83.26 |
|       stairway      | 31.53 | 36.58 |
|        river        |  6.68 |  15.0 |
|        bridge       | 53.51 |  66.7 |
|       bookcase      | 41.61 | 60.39 |
|        blind        |  42.6 | 47.77 |
|     coffee table    | 59.16 |  81.6 |
|        toilet       | 85.29 | 90.91 |
|        flower       | 45.63 |  57.1 |
|         book        |  45.1 | 69.86 |
|         hill        |  8.49 |  9.86 |
|        bench        | 49.77 |  57.7 |
|      countertop     | 51.46 | 72.39 |
|        stove        | 78.53 | 81.89 |
|         palm        |  49.8 | 61.74 |
|    kitchen island   | 35.33 |  70.8 |
|       computer      | 66.33 | 74.91 |
|     swivel chair    | 40.86 | 52.69 |
|         boat        | 44.81 | 49.59 |
|         bar         | 25.61 | 31.59 |
|    arcade machine   | 23.55 | 24.14 |
|        hovel        | 35.11 | 37.61 |
|         bus         | 87.79 |  96.2 |
|        towel        | 65.48 | 79.65 |
|        light        | 53.89 | 61.02 |
|        truck        | 16.05 | 21.11 |
|        tower        | 22.67 | 37.64 |
|      chandelier     | 68.81 | 80.45 |
|        awning       | 27.88 | 34.12 |
|     streetlight     | 26.99 | 35.98 |
|        booth        | 37.22 | 42.81 |
| television receiver | 65.15 | 72.47 |
|       airplane      | 75.35 | 86.05 |
|      dirt track     |  6.64 |  17.5 |
|       apparel       | 39.35 | 50.88 |
|         pole        | 23.45 | 32.81 |
|         land        |  3.93 |  5.67 |
|      bannister      | 12.33 | 16.04 |
|      escalator      | 33.34 | 43.53 |
|       ottoman       | 45.83 | 63.11 |
|        bottle       |  34.5 | 57.07 |
|        buffet       | 47.36 | 55.11 |
|        poster       |  26.0 | 31.37 |
|        stage        | 16.18 | 23.83 |
|         van         | 43.06 | 67.09 |
|         ship        | 55.08 | 85.11 |
|       fountain      | 15.49 | 15.71 |
|    conveyer belt    | 74.25 | 85.28 |
|        canopy       | 29.61 | 39.76 |
|        washer       | 70.66 | 73.32 |
|      plaything      | 27.37 | 39.77 |
|    swimming pool    | 42.64 | 77.06 |
|        stool        | 42.57 | 53.53 |
|        barrel       | 39.66 | 65.06 |
|        basket       | 33.88 | 45.61 |
|      waterfall      |  46.7 | 56.76 |
|         tent        | 88.58 | 99.16 |
|         bag         | 16.41 | 18.22 |
|       minibike      | 74.29 | 84.75 |
|        cradle       |  86.0 | 97.33 |
|         oven        | 45.26 | 59.87 |
|         ball        | 47.05 | 51.98 |
|         food        | 42.85 | 50.78 |
|         step        | 17.18 | 24.79 |
|         tank        | 49.11 | 55.89 |
|      trade name     | 27.86 | 34.93 |
|      microwave      | 80.42 | 89.41 |
|         pot         | 42.53 | 49.02 |
|        animal       | 59.57 |  62.1 |
|       bicycle       | 55.57 | 70.64 |
|         lake        | 65.78 | 78.51 |
|      dishwasher     | 72.06 | 82.87 |
|        screen       | 65.66 | 74.48 |
|       blanket       | 14.14 | 17.07 |
|      sculpture      | 62.08 | 70.62 |
|         hood        | 62.06 | 65.12 |
|        sconce       | 41.05 | 51.23 |
|         vase        | 44.57 | 57.03 |
|    traffic light    | 33.68 | 50.45 |
|         tray        |  7.36 | 14.31 |
|        ashcan       | 46.54 |  56.9 |
|         fan         | 62.18 | 70.48 |
|         pier        | 56.97 | 79.42 |
|      crt screen     |  4.14 | 12.61 |
|        plate        | 55.16 | 66.45 |
|       monitor       |  3.96 |  5.67 |
|    bulletin board   | 45.77 | 66.77 |
|        shower       |  0.72 |  0.92 |
|       radiator      | 59.01 | 68.16 |
|        glass        | 14.71 | 15.76 |
|        clock        | 39.35 | 50.06 |
|         flag        | 45.75 | 48.63 |
+---------------------+-------+-------+
10/06 07:21:07 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.6000  mIoU: 49.0900  mAcc: 60.6700  data_time: 0.0017  time: 0.2241
Finished processing corruption type: contrast
Processing corruption type: elastic_transform
10/06 07:21:11 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 729157827
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 729157827
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 07:21:12 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/elastic_transform'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 07:21:15,540 - mmseg - INFO - using core type: DCNv3
2024-10-06 07:21:15,540 - mmseg - INFO - using activation layer: GELU
2024-10-06 07:21:15,541 - mmseg - INFO - using main norm layer: LN
2024-10-06 07:21:15,541 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 07:21:15,541 - mmseg - INFO - level2_post_norm: False
2024-10-06 07:21:15,541 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 07:21:15,541 - mmseg - INFO - res_post_norm: False
2024-10-06 07:21:15,541 - mmseg - INFO - use_dcn_v4_op: False
10/06 07:21:18 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 07:21:18 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 07:21:19 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 07:21:21 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 07:22:57 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:02:25  time: 1.4814  data_time: 0.0015  memory: 29516  
10/06 07:24:10 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:53:40  time: 1.6080  data_time: 0.0016  memory: 15185  
10/06 07:25:12 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:47:34  time: 1.2472  data_time: 0.0016  memory: 15170  
10/06 07:26:22 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:45:09  time: 1.3236  data_time: 0.0015  memory: 15186  
10/06 07:27:29 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:42:55  time: 1.1516  data_time: 0.0015  memory: 15182  
10/06 07:28:31 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:40:40  time: 1.0461  data_time: 0.0017  memory: 15176  
10/06 07:29:38 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:39:02  time: 1.1791  data_time: 0.0015  memory: 15183  
10/06 07:30:40 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:37:16  time: 1.2231  data_time: 0.0015  memory: 15181  
10/06 07:31:30 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:34:58  time: 1.0482  data_time: 0.0015  memory: 9791  
10/06 07:32:24 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:33:09  time: 0.9923  data_time: 0.0015  memory: 15149  
10/06 07:33:21 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:31:39  time: 1.2396  data_time: 0.0016  memory: 15183  
10/06 07:34:14 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:30:04  time: 1.1928  data_time: 0.0017  memory: 9975  
10/06 07:35:11 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:28:44  time: 1.2207  data_time: 0.0014  memory: 15188  
10/06 07:36:13 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:27:37  time: 1.0579  data_time: 0.0016  memory: 15187  
10/06 07:37:15 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:26:30  time: 1.5383  data_time: 0.0015  memory: 15192  
10/06 07:38:05 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:25:06  time: 1.0301  data_time: 0.0016  memory: 15170  
10/06 07:38:57 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:23:49  time: 1.0433  data_time: 0.0017  memory: 967  
10/06 07:39:48 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:22:33  time: 1.0054  data_time: 0.0014  memory: 9232  
10/06 07:40:49 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:21:31  time: 1.2555  data_time: 0.0016  memory: 15181  
10/06 07:41:42 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:20:21  time: 0.9809  data_time: 0.0015  memory: 15139  
10/06 07:42:42 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:19:19  time: 1.4201  data_time: 0.0015  memory: 15191  
10/06 07:43:39 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:18:14  time: 1.0070  data_time: 0.0016  memory: 15164  
10/06 07:44:32 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:17:08  time: 1.1521  data_time: 0.0015  memory: 15151  
10/06 07:45:23 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:16:01  time: 0.9922  data_time: 0.0016  memory: 2148  
10/06 07:46:15 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:14:56  time: 1.1100  data_time: 0.0015  memory: 15172  
10/06 07:47:03 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:13:50  time: 1.0305  data_time: 0.0015  memory: 969  
10/06 07:47:55 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:12:47  time: 0.9458  data_time: 0.0015  memory: 15146  
10/06 07:48:53 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:11:48  time: 1.2667  data_time: 0.0015  memory: 15176  
10/06 07:49:44 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:10:46  time: 1.2148  data_time: 0.0015  memory: 15158  
10/06 07:50:33 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:09:44  time: 0.9351  data_time: 0.0015  memory: 968  
10/06 07:51:27 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:08:44  time: 1.0331  data_time: 0.0015  memory: 10910  
10/06 07:52:16 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:43  time: 0.9972  data_time: 0.0016  memory: 966  
10/06 07:53:11 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:45  time: 0.9245  data_time: 0.0014  memory: 15182  
10/06 07:54:07 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:46  time: 1.0168  data_time: 0.0017  memory: 15165  
10/06 07:55:01 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:48  time: 1.0044  data_time: 0.0014  memory: 15148  
10/06 07:55:51 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:50  time: 1.0277  data_time: 0.0016  memory: 15148  
10/06 07:56:42 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:52  time: 1.0182  data_time: 0.0016  memory: 915  
10/06 07:57:31 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:54  time: 0.9776  data_time: 0.0015  memory: 15188  
10/06 07:58:26 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:57  time: 0.9813  data_time: 0.0015  memory: 15154  
10/06 07:59:18 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.9090  data_time: 0.0014  memory: 8857  
10/06 07:59:18 - mmengine - INFO - per class results:
10/06 07:59:18 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 63.71 | 78.06 |
|       building      | 73.85 | 88.02 |
|         sky         | 84.21 | 92.21 |
|        floor        | 69.28 |  82.0 |
|         tree        | 62.42 | 78.77 |
|       ceiling       | 69.88 | 83.56 |
|         road        | 77.62 | 85.44 |
|         bed         | 77.63 |  88.2 |
|      windowpane     | 49.67 |  68.8 |
|        grass        | 57.63 | 73.85 |
|       cabinet       |  50.2 | 64.72 |
|       sidewalk      | 54.51 | 71.87 |
|        person       | 60.85 | 78.34 |
|        earth        | 35.25 |  48.6 |
|         door        | 41.59 | 55.35 |
|        table        | 44.59 | 64.08 |
|       mountain      |  52.7 | 68.25 |
|        plant        | 40.44 | 54.02 |
|       curtain       | 54.15 | 69.91 |
|        chair        | 41.62 | 58.42 |
|         car         | 61.39 | 76.61 |
|        water        | 51.43 | 66.84 |
|       painting      | 46.56 |  65.6 |
|         sofa        | 53.04 | 73.16 |
|        shelf        | 34.04 |  52.5 |
|        house        | 33.71 | 42.36 |
|         sea         | 50.36 | 67.69 |
|        mirror       | 56.36 | 68.28 |
|         rug         | 49.09 |  65.8 |
|        field        | 21.94 | 39.13 |
|       armchair      | 33.85 | 47.95 |
|         seat        | 52.33 | 72.61 |
|        fence        | 34.76 | 48.08 |
|         desk        | 41.11 | 58.85 |
|         rock        | 34.33 | 58.57 |
|       wardrobe      | 39.95 | 59.59 |
|         lamp        |  29.2 | 47.77 |
|       bathtub       |  66.0 |  75.1 |
|       railing       | 27.39 | 42.18 |
|       cushion       | 39.01 | 55.35 |
|         base        | 34.72 | 51.43 |
|         box         | 21.25 |  30.1 |
|        column       | 32.16 |  49.2 |
|      signboard      | 24.27 | 36.34 |
|   chest of drawers  | 35.27 | 49.69 |
|       counter       | 28.68 | 34.37 |
|         sand        | 43.57 | 62.49 |
|         sink        | 48.14 | 62.78 |
|      skyscraper     | 47.49 | 61.74 |
|      fireplace      | 57.62 | 79.92 |
|     refrigerator    | 62.96 | 74.11 |
|      grandstand     | 40.77 |  69.7 |
|         path        | 22.87 | 35.91 |
|        stairs       | 25.59 | 32.87 |
|        runway       | 66.59 | 90.55 |
|         case        |  44.0 | 64.91 |
|      pool table     | 77.44 | 86.76 |
|        pillow       | 41.36 | 54.69 |
|     screen door     | 65.39 | 75.44 |
|       stairway      | 23.65 | 30.03 |
|        river        | 11.06 | 20.56 |
|        bridge       | 42.06 | 57.03 |
|       bookcase      |  29.4 | 47.44 |
|        blind        | 37.95 | 44.49 |
|     coffee table    | 46.91 | 68.29 |
|        toilet       | 57.96 | 71.18 |
|        flower       |  33.3 | 49.68 |
|         book        | 31.31 | 51.02 |
|         hill        |  5.37 |  7.57 |
|        bench        | 42.12 | 51.18 |
|      countertop     | 38.25 | 59.51 |
|        stove        | 64.32 | 74.67 |
|         palm        | 37.79 | 52.56 |
|    kitchen island   | 27.24 | 52.74 |
|       computer      | 48.08 | 58.18 |
|     swivel chair    | 32.33 | 50.07 |
|         boat        | 56.79 | 67.28 |
|         bar         |  37.3 | 47.04 |
|    arcade machine   | 33.92 |  40.2 |
|        hovel        |  53.0 |  68.3 |
|         bus         | 68.52 | 81.54 |
|        towel        | 45.02 | 60.22 |
|        light        | 15.37 | 24.67 |
|        truck        | 22.41 | 35.16 |
|        tower        | 18.52 | 31.13 |
|      chandelier     | 47.48 | 65.19 |
|        awning       | 19.16 | 25.92 |
|     streetlight     | 11.93 | 19.54 |
|        booth        | 31.29 | 33.83 |
| television receiver | 46.04 |  58.5 |
|       airplane      | 44.57 | 61.17 |
|      dirt track     |  1.16 |  2.28 |
|       apparel       | 26.82 | 44.45 |
|         pole        | 10.42 | 16.64 |
|         land        |  5.85 |  8.26 |
|      bannister      |  8.55 | 12.59 |
|      escalator      |  29.1 | 34.82 |
|       ottoman       | 35.17 |  49.7 |
|        bottle       | 25.75 | 41.35 |
|        buffet       | 36.89 | 43.65 |
|        poster       | 26.53 | 34.17 |
|        stage        | 18.17 | 28.07 |
|         van         | 36.89 |  51.6 |
|         ship        | 52.56 | 62.93 |
|       fountain      | 17.74 | 19.25 |
|    conveyer belt    | 69.58 | 79.16 |
|        canopy       | 28.46 | 46.62 |
|        washer       | 66.69 | 71.31 |
|      plaything      | 22.23 | 37.93 |
|    swimming pool    | 39.63 | 72.01 |
|        stool        | 22.67 | 32.94 |
|        barrel       | 21.81 | 76.14 |
|        basket       | 21.26 | 32.99 |
|      waterfall      | 40.31 | 55.77 |
|         tent        | 75.66 | 86.82 |
|         bag         | 10.91 | 13.94 |
|       minibike      | 51.69 | 72.82 |
|        cradle       | 69.87 | 87.51 |
|         oven        | 39.95 | 51.61 |
|         ball        | 37.62 | 43.64 |
|         food        | 35.26 | 45.11 |
|         step        | 14.62 | 19.58 |
|         tank        | 47.26 |  57.2 |
|      trade name     |  16.7 |  21.2 |
|      microwave      | 66.61 | 78.79 |
|         pot         | 27.78 | 36.47 |
|        animal       | 51.75 |  58.1 |
|       bicycle       | 40.39 | 59.53 |
|         lake        | 54.47 | 76.41 |
|      dishwasher     | 52.12 | 65.14 |
|        screen       | 48.86 | 70.26 |
|       blanket       | 13.79 | 16.97 |
|      sculpture      | 46.65 | 64.01 |
|         hood        | 44.69 | 61.18 |
|        sconce       | 18.35 | 27.11 |
|         vase        | 20.51 | 36.41 |
|    traffic light    | 20.98 | 35.57 |
|         tray        |  4.74 |  9.2  |
|        ashcan       | 27.63 | 46.54 |
|         fan         |  28.7 | 45.91 |
|         pier        | 44.48 | 77.04 |
|      crt screen     |  6.56 | 20.42 |
|        plate        | 33.75 | 48.13 |
|       monitor       |  2.69 |  4.37 |
|    bulletin board   | 37.48 | 55.56 |
|        shower       |  0.47 |  0.79 |
|       radiator      | 45.24 | 56.23 |
|        glass        |  8.89 | 10.11 |
|        clock        | 12.92 | 19.43 |
|         flag        | 26.34 | 32.68 |
+---------------------+-------+-------+
10/06 07:59:18 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 74.8600  mIoU: 38.9900  mAcc: 52.4800  data_time: 0.0017  time: 1.1386
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
10/06 07:59:21 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1909576284
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1909576284
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 07:59:22 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/pixelate'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 07:59:25,943 - mmseg - INFO - using core type: DCNv3
2024-10-06 07:59:25,943 - mmseg - INFO - using activation layer: GELU
2024-10-06 07:59:25,943 - mmseg - INFO - using main norm layer: LN
2024-10-06 07:59:25,943 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 07:59:25,943 - mmseg - INFO - level2_post_norm: False
2024-10-06 07:59:25,943 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 07:59:25,943 - mmseg - INFO - res_post_norm: False
2024-10-06 07:59:25,943 - mmseg - INFO - use_dcn_v4_op: False
10/06 07:59:28 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 07:59:28 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 07:59:29 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 07:59:31 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 08:00:18 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:30:52  time: 0.4638  data_time: 0.0016  memory: 29516  
10/06 08:00:44 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:08  time: 0.6079  data_time: 0.0016  memory: 15185  
10/06 08:00:58 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:17:55  time: 0.2677  data_time: 0.0016  memory: 15170  
10/06 08:01:19 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:13  time: 0.3725  data_time: 0.0015  memory: 15186  
10/06 08:01:40 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:02  time: 0.2192  data_time: 0.0015  memory: 15182  
10/06 08:01:57 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:45  time: 0.0843  data_time: 0.0016  memory: 15176  
10/06 08:02:16 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:12:57  time: 0.2506  data_time: 0.0016  memory: 15183  
10/06 08:02:31 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:00  time: 0.2519  data_time: 0.0015  memory: 15181  
10/06 08:02:38 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:45  time: 0.1830  data_time: 0.0014  memory: 9791  
10/06 08:02:45 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:43  time: 0.0805  data_time: 0.0015  memory: 15149  
10/06 08:02:53 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:53  time: 0.2514  data_time: 0.0016  memory: 15183  
10/06 08:03:00 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:07  time: 0.2318  data_time: 0.0016  memory: 9975  
10/06 08:03:11 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:36  time: 0.2777  data_time: 0.0015  memory: 15188  
10/06 08:03:25 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:13  time: 0.0851  data_time: 0.0016  memory: 15187  
10/06 08:03:39 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:53  time: 0.6198  data_time: 0.0015  memory: 15192  
10/06 08:03:45 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:20  time: 0.0786  data_time: 0.0016  memory: 15170  
10/06 08:03:49 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:48  time: 0.0811  data_time: 0.0017  memory: 967  
10/06 08:03:56 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:24  time: 0.1769  data_time: 0.0014  memory: 9232  
10/06 08:04:10 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:07  time: 0.3417  data_time: 0.0015  memory: 15181  
10/06 08:04:18 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:46  time: 0.0763  data_time: 0.0015  memory: 15139  
10/06 08:04:29 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:29  time: 0.4416  data_time: 0.0015  memory: 15191  
10/06 08:04:39 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:11  time: 0.0772  data_time: 0.0016  memory: 15164  
10/06 08:04:46 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:52  time: 0.2086  data_time: 0.0015  memory: 15151  
10/06 08:04:50 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:32  time: 0.0787  data_time: 0.0015  memory: 2148  
10/06 08:04:57 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:15  time: 0.2033  data_time: 0.0015  memory: 15172  
10/06 08:05:01 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:02:57  time: 0.0796  data_time: 0.0015  memory: 969  
10/06 08:05:06 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:41  time: 0.0762  data_time: 0.0015  memory: 15146  
10/06 08:05:18 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:28  time: 0.2825  data_time: 0.0015  memory: 15176  
10/06 08:05:25 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:14  time: 0.2478  data_time: 0.0015  memory: 15158  
10/06 08:05:28 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:59  time: 0.0748  data_time: 0.0015  memory: 968  
10/06 08:05:34 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:45  time: 0.0820  data_time: 0.0015  memory: 10910  
10/06 08:05:38 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:31  time: 0.0775  data_time: 0.0016  memory: 966  
10/06 08:05:48 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:19  time: 0.0735  data_time: 0.0014  memory: 15182  
10/06 08:05:56 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:07  time: 0.0791  data_time: 0.0016  memory: 15165  
10/06 08:06:03 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:56  time: 0.0824  data_time: 0.0015  memory: 15148  
10/06 08:06:09 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:44  time: 0.0801  data_time: 0.0017  memory: 15148  
10/06 08:06:13 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:32  time: 0.0799  data_time: 0.0016  memory: 915  
10/06 08:06:18 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:21  time: 0.0792  data_time: 0.0015  memory: 15188  
10/06 08:06:26 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:10  time: 0.0762  data_time: 0.0015  memory: 15154  
10/06 08:06:34 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0703  data_time: 0.0014  memory: 8857  
10/06 08:06:34 - mmengine - INFO - per class results:
10/06 08:06:34 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 76.52 | 87.49 |
|       building      | 80.01 | 93.73 |
|         sky         | 94.06 | 97.58 |
|        floor        | 81.33 | 90.35 |
|         tree        | 71.47 | 82.66 |
|       ceiling       | 83.13 | 92.91 |
|         road        | 83.09 | 87.43 |
|         bed         |  87.3 |  94.8 |
|      windowpane     | 60.78 | 79.32 |
|        grass        | 60.14 | 73.74 |
|       cabinet       | 58.57 | 73.13 |
|       sidewalk      | 64.45 | 83.65 |
|        person       | 77.93 | 88.33 |
|        earth        | 34.16 | 46.37 |
|         door        | 47.44 | 61.74 |
|        table        |  59.4 | 78.52 |
|       mountain      | 53.43 | 63.94 |
|        plant        | 48.76 | 62.37 |
|       curtain       | 72.12 | 83.25 |
|        chair        | 57.22 | 69.94 |
|         car         | 79.96 | 86.18 |
|        water        | 49.77 | 66.54 |
|       painting      | 71.11 | 86.33 |
|         sofa        | 61.79 | 83.54 |
|        shelf        | 41.75 | 62.48 |
|        house        | 41.71 | 48.74 |
|         sea         | 52.98 | 68.84 |
|        mirror       | 63.64 | 72.46 |
|         rug         | 60.84 | 74.68 |
|        field        | 23.89 | 52.82 |
|       armchair      | 36.16 | 47.07 |
|         seat        | 56.65 | 78.62 |
|        fence        | 38.67 | 50.06 |
|         desk        |  48.2 | 57.06 |
|         rock        | 34.45 | 72.08 |
|       wardrobe      | 43.58 | 60.58 |
|         lamp        | 61.59 | 74.26 |
|       bathtub       |  77.9 | 84.95 |
|       railing       |  29.9 | 45.69 |
|       cushion       | 55.91 | 70.55 |
|         base        | 28.21 | 37.31 |
|         box         | 26.68 | 35.16 |
|        column       |  43.8 | 53.39 |
|      signboard      | 36.63 | 48.13 |
|   chest of drawers  | 40.68 | 61.03 |
|       counter       | 28.92 | 42.12 |
|         sand        | 50.52 | 70.78 |
|         sink        | 70.32 | 78.64 |
|      skyscraper     | 41.49 | 46.35 |
|      fireplace      |  74.4 | 87.29 |
|     refrigerator    |  72.8 | 85.43 |
|      grandstand     | 36.29 | 73.78 |
|         path        | 20.05 | 29.28 |
|        stairs       | 30.53 | 44.13 |
|        runway       | 70.65 | 95.72 |
|         case        | 47.12 | 61.88 |
|      pool table     |  91.7 | 94.25 |
|        pillow       | 53.41 | 62.32 |
|     screen door     | 75.37 | 81.07 |
|       stairway      | 30.52 | 37.59 |
|        river        |  7.24 | 16.82 |
|        bridge       | 58.35 | 76.33 |
|       bookcase      | 40.68 | 58.74 |
|        blind        |  42.3 | 46.86 |
|     coffee table    | 61.93 | 81.47 |
|        toilet       | 85.83 | 90.16 |
|        flower       | 30.99 | 43.69 |
|         book        | 42.51 | 58.81 |
|         hill        |  8.06 | 11.32 |
|        bench        | 45.51 | 54.49 |
|      countertop     | 52.58 | 63.93 |
|        stove        | 75.49 | 83.13 |
|         palm        | 49.41 |  61.5 |
|    kitchen island   | 33.25 | 77.05 |
|       computer      | 58.99 |  66.5 |
|     swivel chair    | 41.29 | 55.63 |
|         boat        | 41.97 | 43.65 |
|         bar         | 34.85 | 51.58 |
|    arcade machine   |  40.3 | 44.72 |
|        hovel        | 13.24 | 14.13 |
|         bus         | 87.53 | 95.78 |
|        towel        | 60.24 |  67.7 |
|        light        |  52.0 | 61.12 |
|        truck        | 30.49 | 50.19 |
|        tower        | 24.75 | 33.79 |
|      chandelier     | 59.29 | 75.19 |
|        awning       | 26.63 | 30.41 |
|     streetlight     | 25.72 | 34.37 |
|        booth        | 36.51 | 38.57 |
| television receiver | 63.37 | 77.39 |
|       airplane      | 52.67 | 56.72 |
|      dirt track     | 17.57 | 30.02 |
|       apparel       | 28.81 | 37.69 |
|         pole        | 21.11 | 29.68 |
|         land        |  5.19 |  9.14 |
|      bannister      | 10.62 | 13.63 |
|      escalator      |  16.2 |  17.0 |
|       ottoman       | 40.38 | 53.54 |
|        bottle       | 28.59 | 43.88 |
|        buffet       | 45.55 | 54.86 |
|        poster       | 17.48 |  23.5 |
|        stage        | 16.03 | 23.55 |
|         van         | 37.24 |  70.3 |
|         ship        | 12.84 | 20.39 |
|       fountain      | 19.87 | 20.37 |
|    conveyer belt    | 75.07 | 83.67 |
|        canopy       | 16.27 | 18.84 |
|        washer       |  72.7 | 73.66 |
|      plaything      | 21.64 | 29.68 |
|    swimming pool    | 41.64 |  77.4 |
|        stool        | 41.35 | 51.53 |
|        barrel       |  22.0 | 78.42 |
|        basket       | 31.23 | 43.76 |
|      waterfall      | 36.56 | 49.93 |
|         tent        | 93.62 |  98.7 |
|         bag         |  9.5  |  9.79 |
|       minibike      | 46.64 | 48.79 |
|        cradle       | 85.27 |  95.5 |
|         oven        | 26.18 | 62.82 |
|         ball        | 49.12 | 57.56 |
|         food        | 33.92 | 39.29 |
|         step        | 18.86 | 24.58 |
|         tank        | 49.67 | 57.15 |
|      trade name     | 28.88 |  37.4 |
|      microwave      | 53.14 |  60.5 |
|         pot         | 47.05 | 55.72 |
|        animal       | 53.41 | 55.15 |
|       bicycle       | 50.65 | 61.19 |
|         lake        | 68.62 | 73.74 |
|      dishwasher     | 69.23 | 79.38 |
|        screen       | 47.65 | 70.44 |
|       blanket       |  9.28 | 10.36 |
|      sculpture      |  45.1 | 50.58 |
|         hood        | 56.48 | 64.21 |
|        sconce       | 42.83 | 53.11 |
|         vase        | 37.97 | 45.53 |
|    traffic light    | 28.28 | 36.25 |
|         tray        |  9.49 | 15.05 |
|        ashcan       | 46.12 | 56.35 |
|         fan         | 60.34 | 68.11 |
|         pier        | 63.97 | 81.53 |
|      crt screen     |  3.37 | 11.32 |
|        plate        | 42.54 | 50.38 |
|       monitor       |  3.8  |  6.87 |
|    bulletin board   | 43.52 | 66.32 |
|        shower       |  2.54 |  2.69 |
|       radiator      | 57.16 | 64.24 |
|        glass        | 10.52 | 10.92 |
|        clock        | 36.41 | 46.62 |
|         flag        | 42.18 | 43.81 |
+---------------------+-------+-------+
10/06 08:06:34 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.6100  mIoU: 45.9000  mAcc: 57.3900  data_time: 0.0017  time: 0.2114
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
10/06 08:06:37 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1400075846
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1400075846
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 08:06:38 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/jpeg_compression'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 08:06:41,874 - mmseg - INFO - using core type: DCNv3
2024-10-06 08:06:41,874 - mmseg - INFO - using activation layer: GELU
2024-10-06 08:06:41,874 - mmseg - INFO - using main norm layer: LN
2024-10-06 08:06:41,874 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 08:06:41,874 - mmseg - INFO - level2_post_norm: False
2024-10-06 08:06:41,874 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 08:06:41,874 - mmseg - INFO - res_post_norm: False
2024-10-06 08:06:41,874 - mmseg - INFO - use_dcn_v4_op: False
10/06 08:06:44 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 08:06:44 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 08:06:45 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 08:06:47 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 08:07:35 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:08  time: 0.4666  data_time: 0.0016  memory: 29516  
10/06 08:08:01 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:23  time: 0.6215  data_time: 0.0016  memory: 15185  
10/06 08:08:15 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:10  time: 0.2745  data_time: 0.0016  memory: 15170  
10/06 08:08:36 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:26  time: 0.3796  data_time: 0.0015  memory: 15186  
10/06 08:08:58 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:14  time: 0.2258  data_time: 0.0015  memory: 15182  
10/06 08:09:15 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:57  time: 0.0918  data_time: 0.0017  memory: 15176  
10/06 08:09:34 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:08  time: 0.2556  data_time: 0.0015  memory: 15183  
10/06 08:09:50 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:11  time: 0.2577  data_time: 0.0014  memory: 15181  
10/06 08:09:57 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:56  time: 0.1894  data_time: 0.0015  memory: 9791  
10/06 08:10:05 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:53  time: 0.0844  data_time: 0.0015  memory: 15149  
10/06 08:10:13 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:02  time: 0.2600  data_time: 0.0016  memory: 15183  
10/06 08:10:20 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:16  time: 0.2373  data_time: 0.0016  memory: 9975  
10/06 08:10:31 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:45  time: 0.2828  data_time: 0.0014  memory: 15188  
10/06 08:10:45 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:22  time: 0.0921  data_time: 0.0016  memory: 15187  
10/06 08:11:00 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:01  time: 0.6259  data_time: 0.0015  memory: 15192  
10/06 08:11:06 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:28  time: 0.0857  data_time: 0.0016  memory: 15170  
10/06 08:11:10 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:56  time: 0.0868  data_time: 0.0016  memory: 967  
10/06 08:11:18 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:31  time: 0.1836  data_time: 0.0015  memory: 9232  
10/06 08:11:32 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:14  time: 0.3495  data_time: 0.0016  memory: 15181  
10/06 08:11:40 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:53  time: 0.0814  data_time: 0.0015  memory: 15139  
10/06 08:11:52 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:35  time: 0.4483  data_time: 0.0015  memory: 15191  
10/06 08:12:02 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:17  time: 0.0833  data_time: 0.0015  memory: 15164  
10/06 08:12:09 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:57  time: 0.2136  data_time: 0.0015  memory: 15151  
10/06 08:12:13 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:37  time: 0.0838  data_time: 0.0015  memory: 2148  
10/06 08:12:21 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:20  time: 0.2103  data_time: 0.0015  memory: 15172  
10/06 08:12:25 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:02  time: 0.0845  data_time: 0.0015  memory: 969  
10/06 08:12:31 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:45  time: 0.0804  data_time: 0.0015  memory: 15146  
10/06 08:12:42 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:32  time: 0.2885  data_time: 0.0015  memory: 15176  
10/06 08:12:50 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:17  time: 0.2549  data_time: 0.0014  memory: 15158  
10/06 08:12:54 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:02  time: 0.0794  data_time: 0.0015  memory: 968  
10/06 08:13:00 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:48  time: 0.0894  data_time: 0.0015  memory: 10910  
10/06 08:13:04 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:34  time: 0.0832  data_time: 0.0016  memory: 966  
10/06 08:13:14 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:22  time: 0.0784  data_time: 0.0014  memory: 15182  
10/06 08:13:23 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:09  time: 0.0850  data_time: 0.0016  memory: 15165  
10/06 08:13:30 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:57  time: 0.0885  data_time: 0.0014  memory: 15148  
10/06 08:13:36 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:45  time: 0.0864  data_time: 0.0016  memory: 15148  
10/06 08:13:40 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:33  time: 0.0856  data_time: 0.0016  memory: 915  
10/06 08:13:46 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:22  time: 0.0854  data_time: 0.0015  memory: 15188  
10/06 08:13:54 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:10  time: 0.0822  data_time: 0.0015  memory: 15154  
10/06 08:14:02 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0757  data_time: 0.0014  memory: 8857  
10/06 08:14:02 - mmengine - INFO - per class results:
10/06 08:14:02 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 77.01 | 88.38 |
|       building      | 82.22 | 92.88 |
|         sky         | 93.95 | 97.58 |
|        floor        | 80.23 | 91.05 |
|         tree        | 72.62 | 86.43 |
|       ceiling       | 82.62 | 91.85 |
|         road        | 83.42 |  89.3 |
|         bed         | 88.95 |  95.4 |
|      windowpane     | 61.36 | 79.71 |
|        grass        | 60.07 | 69.98 |
|       cabinet       | 59.37 | 72.08 |
|       sidewalk      | 62.84 | 80.39 |
|        person       | 79.88 | 90.85 |
|        earth        | 37.07 |  55.5 |
|         door        | 48.77 | 62.88 |
|        table        |  60.3 | 77.46 |
|       mountain      | 56.92 | 74.26 |
|        plant        | 48.29 |  57.2 |
|       curtain       | 72.51 | 81.51 |
|        chair        | 56.11 | 67.31 |
|         car         | 83.47 | 91.23 |
|        water        |  50.9 | 63.67 |
|       painting      | 75.01 | 86.16 |
|         sofa        | 64.85 | 84.53 |
|        shelf        | 41.81 | 63.72 |
|        house        | 44.13 | 59.15 |
|         sea         | 62.55 | 83.59 |
|        mirror       | 66.79 | 73.07 |
|         rug         | 55.51 | 65.66 |
|        field        | 28.07 | 57.56 |
|       armchair      | 39.85 | 53.47 |
|         seat        | 59.27 |  78.7 |
|        fence        | 44.93 |  57.6 |
|         desk        | 51.31 | 67.07 |
|         rock        | 35.62 | 57.99 |
|       wardrobe      | 42.75 | 63.81 |
|         lamp        | 62.29 | 73.13 |
|       bathtub       | 77.07 | 85.25 |
|       railing       | 33.41 | 44.58 |
|       cushion       | 57.24 | 71.84 |
|         base        | 25.84 | 31.36 |
|         box         | 26.27 | 33.68 |
|        column       | 46.69 |  58.1 |
|      signboard      |  36.7 |  47.1 |
|   chest of drawers  | 42.46 | 59.63 |
|       counter       |  33.8 | 39.56 |
|         sand        | 44.44 | 60.97 |
|         sink        | 70.75 | 80.09 |
|      skyscraper     |  63.9 | 83.54 |
|      fireplace      | 73.08 | 84.31 |
|     refrigerator    | 76.97 | 89.55 |
|      grandstand     | 48.97 | 70.74 |
|         path        | 23.33 | 36.64 |
|        stairs       | 33.39 | 41.25 |
|        runway       | 71.23 | 96.08 |
|         case        | 53.27 | 66.73 |
|      pool table     | 91.11 | 95.12 |
|        pillow       | 54.35 |  63.3 |
|     screen door     |  74.1 |  79.2 |
|       stairway      | 32.65 | 38.52 |
|        river        |  5.12 | 12.39 |
|        bridge       | 50.49 | 65.48 |
|       bookcase      | 41.12 | 59.98 |
|        blind        | 38.11 | 39.07 |
|     coffee table    | 64.25 | 80.75 |
|        toilet       | 84.45 | 89.75 |
|        flower       | 43.95 | 56.65 |
|         book        | 47.66 | 66.22 |
|         hill        |  6.85 |  9.11 |
|        bench        | 46.45 | 54.81 |
|      countertop     | 52.71 | 67.72 |
|        stove        |  79.5 | 86.51 |
|         palm        | 48.91 | 61.37 |
|    kitchen island   | 27.88 | 56.45 |
|       computer      | 65.36 | 73.18 |
|     swivel chair    | 41.48 | 51.82 |
|         boat        | 42.57 | 49.53 |
|         bar         | 33.23 | 44.32 |
|    arcade machine   | 45.69 | 47.88 |
|        hovel        | 29.25 | 31.96 |
|         bus         |  89.2 | 96.41 |
|        towel        |  63.4 | 70.09 |
|        light        | 50.69 |  58.3 |
|        truck        |  35.8 | 47.89 |
|        tower        | 18.62 | 30.03 |
|      chandelier     | 68.27 | 80.98 |
|        awning       | 25.63 | 30.01 |
|     streetlight     | 24.07 | 30.77 |
|        booth        | 42.08 | 48.57 |
| television receiver | 67.34 | 75.49 |
|       airplane      | 60.43 | 69.05 |
|      dirt track     | 11.16 | 20.02 |
|       apparel       |  38.8 | 49.98 |
|         pole        |  22.6 | 32.99 |
|         land        |  5.31 |  7.32 |
|      bannister      |  15.5 |  19.0 |
|      escalator      | 37.94 | 55.31 |
|       ottoman       | 44.15 | 60.23 |
|        bottle       | 25.67 | 32.45 |
|        buffet       | 43.41 | 52.28 |
|        poster       | 33.21 | 41.04 |
|        stage        | 15.69 | 19.79 |
|         van         | 44.25 | 66.68 |
|         ship        | 64.11 | 97.56 |
|       fountain      | 12.66 | 12.82 |
|    conveyer belt    | 60.56 | 78.07 |
|        canopy       | 20.64 | 27.06 |
|        washer       | 74.36 | 76.97 |
|      plaything      | 28.74 | 38.99 |
|    swimming pool    | 41.13 | 70.94 |
|        stool        | 39.47 | 54.11 |
|        barrel       |  19.5 | 65.79 |
|        basket       | 29.21 | 38.73 |
|      waterfall      | 49.57 | 59.61 |
|         tent        | 88.14 | 98.71 |
|         bag         |  10.6 | 11.53 |
|       minibike      | 70.21 | 81.17 |
|        cradle       | 83.74 | 97.07 |
|         oven        | 31.81 | 63.43 |
|         ball        |  40.6 |  45.6 |
|         food        | 44.59 |  54.1 |
|         step        | 22.01 |  24.7 |
|         tank        | 50.45 | 58.33 |
|      trade name     |  26.0 | 30.36 |
|      microwave      | 60.23 | 68.94 |
|         pot         | 46.27 | 54.41 |
|        animal       | 59.82 | 61.97 |
|       bicycle       | 53.46 | 66.34 |
|         lake        | 66.96 | 73.23 |
|      dishwasher     | 69.26 | 81.18 |
|        screen       | 58.29 | 73.62 |
|       blanket       | 11.45 | 12.83 |
|      sculpture      | 69.81 |  76.7 |
|         hood        |  54.7 | 63.76 |
|        sconce       | 40.82 | 49.72 |
|         vase        | 41.92 | 49.67 |
|    traffic light    |  27.2 | 37.07 |
|         tray        | 10.37 |  17.4 |
|        ashcan       | 43.25 | 54.31 |
|         fan         | 59.98 | 71.21 |
|         pier        | 51.28 | 82.57 |
|      crt screen     |  4.18 | 12.44 |
|        plate        | 54.29 | 67.94 |
|       monitor       |  3.33 |  4.52 |
|    bulletin board   | 47.78 | 59.32 |
|        shower       |  3.34 |  3.94 |
|       radiator      | 55.78 | 60.97 |
|        glass        | 11.07 |  11.6 |
|        clock        | 37.25 | 43.05 |
|         flag        | 44.38 | 46.56 |
+---------------------+-------+-------+
10/06 08:14:02 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.4000  mIoU: 48.2500  mAcc: 59.5300  data_time: 0.0017  time: 0.2176
Finished processing corruption type: jpeg_compression
Processing corruption type: elastic_transform
10/06 08:14:05 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1741622377
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1741622377
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 08:14:07 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/elastic_transform'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 08:14:10,179 - mmseg - INFO - using core type: DCNv3
2024-10-06 08:14:10,179 - mmseg - INFO - using activation layer: GELU
2024-10-06 08:14:10,179 - mmseg - INFO - using main norm layer: LN
2024-10-06 08:14:10,179 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 08:14:10,179 - mmseg - INFO - level2_post_norm: False
2024-10-06 08:14:10,179 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 08:14:10,179 - mmseg - INFO - res_post_norm: False
2024-10-06 08:14:10,179 - mmseg - INFO - use_dcn_v4_op: False
10/06 08:14:12 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 08:14:12 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 08:14:14 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 08:14:15 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 08:15:52 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:02:40  time: 1.4994  data_time: 0.0016  memory: 29516  
10/06 08:17:05 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:53:53  time: 1.6081  data_time: 0.0016  memory: 15185  
10/06 08:18:07 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:47:43  time: 1.2422  data_time: 0.0018  memory: 15170  
10/06 08:19:17 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:45:15  time: 1.3268  data_time: 0.0016  memory: 15186  
10/06 08:20:24 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:43:01  time: 1.1561  data_time: 0.0015  memory: 15182  
10/06 08:21:27 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:40:45  time: 1.0527  data_time: 0.0016  memory: 15176  
10/06 08:22:33 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:39:05  time: 1.1488  data_time: 0.0015  memory: 15183  
10/06 08:23:35 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:37:18  time: 1.2178  data_time: 0.0015  memory: 15181  
10/06 08:24:25 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:34:59  time: 1.0420  data_time: 0.0015  memory: 9791  
10/06 08:25:18 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:33:09  time: 0.9908  data_time: 0.0015  memory: 15149  
10/06 08:26:16 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:31:39  time: 1.2316  data_time: 0.0016  memory: 15183  
10/06 08:27:08 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:30:03  time: 1.1961  data_time: 0.0016  memory: 9975  
10/06 08:28:05 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:28:43  time: 1.2071  data_time: 0.0014  memory: 15188  
10/06 08:29:08 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:27:37  time: 1.0651  data_time: 0.0017  memory: 15187  
10/06 08:30:10 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:26:30  time: 1.5365  data_time: 0.0015  memory: 15192  
10/06 08:31:00 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:25:06  time: 1.0279  data_time: 0.0016  memory: 15170  
10/06 08:31:52 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:23:49  time: 1.0438  data_time: 0.0017  memory: 967  
10/06 08:32:43 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:22:33  time: 1.0072  data_time: 0.0014  memory: 9232  
10/06 08:33:43 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:21:31  time: 1.2566  data_time: 0.0016  memory: 15181  
10/06 08:34:37 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:20:21  time: 0.9806  data_time: 0.0016  memory: 15139  
10/06 08:35:36 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:19:19  time: 1.4216  data_time: 0.0015  memory: 15191  
10/06 08:36:33 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:18:14  time: 1.0083  data_time: 0.0016  memory: 15164  
10/06 08:37:26 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:17:08  time: 1.1508  data_time: 0.0015  memory: 15151  
10/06 08:38:17 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:16:01  time: 0.9858  data_time: 0.0015  memory: 2148  
10/06 08:39:10 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:14:56  time: 1.1104  data_time: 0.0015  memory: 15172  
10/06 08:39:58 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:13:50  time: 1.0294  data_time: 0.0015  memory: 969  
10/06 08:40:49 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:12:47  time: 0.9462  data_time: 0.0015  memory: 15146  
10/06 08:41:47 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:11:47  time: 1.2626  data_time: 0.0015  memory: 15176  
10/06 08:42:38 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:10:46  time: 1.2174  data_time: 0.0015  memory: 15158  
10/06 08:43:27 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:09:44  time: 0.9323  data_time: 0.0015  memory: 968  
10/06 08:44:21 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:08:44  time: 1.0302  data_time: 0.0015  memory: 10910  
10/06 08:45:10 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:43  time: 0.9931  data_time: 0.0016  memory: 966  
10/06 08:46:05 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:45  time: 0.9235  data_time: 0.0014  memory: 15182  
10/06 08:47:00 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:46  time: 1.0115  data_time: 0.0016  memory: 15165  
10/06 08:47:55 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:48  time: 1.0128  data_time: 0.0014  memory: 15148  
10/06 08:48:45 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:49  time: 1.0386  data_time: 0.0017  memory: 15148  
10/06 08:49:36 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:51  time: 1.0286  data_time: 0.0016  memory: 915  
10/06 08:50:26 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:54  time: 0.9881  data_time: 0.0015  memory: 15188  
10/06 08:51:21 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:57  time: 0.9836  data_time: 0.0014  memory: 15154  
10/06 08:52:13 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.9141  data_time: 0.0014  memory: 8857  
10/06 08:52:13 - mmengine - INFO - per class results:
10/06 08:52:13 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 63.97 | 78.13 |
|       building      | 74.34 | 88.03 |
|         sky         | 84.27 | 91.95 |
|        floor        | 68.48 | 80.83 |
|         tree        | 62.49 | 78.67 |
|       ceiling       | 70.63 |  84.5 |
|         road        | 77.25 | 85.51 |
|         bed         | 76.26 | 88.22 |
|      windowpane     |  49.1 | 68.46 |
|        grass        | 57.34 | 74.18 |
|       cabinet       | 50.16 | 64.57 |
|       sidewalk      | 52.34 | 70.36 |
|        person       | 60.59 | 77.37 |
|        earth        | 34.76 | 47.96 |
|         door        | 40.87 | 54.66 |
|        table        | 43.21 | 62.09 |
|       mountain      | 53.57 | 68.18 |
|        plant        | 41.65 | 55.53 |
|       curtain       | 52.61 | 68.36 |
|        chair        | 41.48 | 58.94 |
|         car         | 61.24 | 76.79 |
|        water        | 51.42 |  68.3 |
|       painting      | 48.44 | 67.11 |
|         sofa        | 52.69 | 71.75 |
|        shelf        | 35.06 | 53.59 |
|        house        | 39.73 | 51.45 |
|         sea         | 48.27 | 66.29 |
|        mirror       | 57.02 | 69.67 |
|         rug         | 49.29 | 65.62 |
|        field        | 24.53 | 42.37 |
|       armchair      |  33.8 | 48.19 |
|         seat        | 53.46 | 74.56 |
|        fence        | 34.95 | 47.89 |
|         desk        |  38.0 | 55.48 |
|         rock        | 31.85 | 55.71 |
|       wardrobe      | 41.81 | 62.88 |
|         lamp        | 29.38 | 47.62 |
|       bathtub       | 67.14 |  75.3 |
|       railing       |  28.9 |  43.6 |
|       cushion       | 40.34 | 57.99 |
|         base        | 32.01 | 46.53 |
|         box         | 22.86 | 32.28 |
|        column       | 30.95 | 48.92 |
|      signboard      | 24.54 | 37.71 |
|   chest of drawers  | 32.79 | 48.78 |
|       counter       | 26.43 | 31.22 |
|         sand        |  45.9 | 64.26 |
|         sink        |  49.3 | 64.12 |
|      skyscraper     | 48.93 | 64.43 |
|      fireplace      | 65.63 | 84.09 |
|     refrigerator    | 64.41 | 76.86 |
|      grandstand     | 39.31 | 70.73 |
|         path        | 26.63 | 41.37 |
|        stairs       | 25.22 | 32.82 |
|        runway       | 68.96 | 93.54 |
|         case        | 48.98 |  71.6 |
|      pool table     | 73.63 | 83.41 |
|        pillow       | 40.81 | 56.39 |
|     screen door     | 60.28 | 72.03 |
|       stairway      |  23.7 | 30.58 |
|        river        |  9.66 | 17.76 |
|        bridge       | 50.48 |  69.9 |
|       bookcase      | 31.31 | 49.38 |
|        blind        | 32.44 | 37.49 |
|     coffee table    | 45.78 | 68.47 |
|        toilet       | 57.76 | 71.53 |
|        flower       | 31.68 | 48.04 |
|         book        | 33.71 | 54.94 |
|         hill        | 11.26 | 16.08 |
|        bench        | 38.17 |  47.4 |
|      countertop     | 40.52 | 62.73 |
|        stove        | 63.73 | 74.34 |
|         palm        | 32.59 | 45.32 |
|    kitchen island   | 32.02 | 61.65 |
|       computer      | 48.84 | 60.21 |
|     swivel chair    | 30.44 | 44.68 |
|         boat        | 45.59 | 56.31 |
|         bar         | 29.75 | 39.62 |
|    arcade machine   | 35.14 | 39.24 |
|        hovel        |  41.5 | 47.37 |
|         bus         | 71.83 | 89.64 |
|        towel        | 47.81 | 64.34 |
|        light        | 14.78 |  23.5 |
|        truck        | 22.78 | 33.21 |
|        tower        | 16.18 | 29.08 |
|      chandelier     | 44.86 | 62.16 |
|        awning       | 20.76 | 27.08 |
|     streetlight     | 10.31 | 17.15 |
|        booth        | 37.04 | 41.66 |
| television receiver | 46.01 | 59.32 |
|       airplane      | 48.51 | 63.16 |
|      dirt track     |  7.77 | 17.19 |
|       apparel       | 30.37 |  45.3 |
|         pole        |  8.59 | 13.74 |
|         land        |  3.64 |  5.22 |
|      bannister      |  8.97 | 12.48 |
|      escalator      | 34.96 | 42.22 |
|       ottoman       | 36.02 | 51.43 |
|        bottle       | 25.37 | 42.15 |
|        buffet       | 35.68 | 42.57 |
|        poster       | 24.58 | 34.59 |
|        stage        | 15.62 | 24.25 |
|         van         | 38.46 | 54.88 |
|         ship        |  55.0 | 73.83 |
|       fountain      | 19.66 |  20.5 |
|    conveyer belt    | 69.66 | 82.86 |
|        canopy       |  25.2 | 41.19 |
|        washer       | 66.13 | 69.75 |
|      plaything      | 17.05 | 30.16 |
|    swimming pool    | 37.36 | 71.16 |
|        stool        | 22.01 | 32.05 |
|        barrel       | 21.12 | 79.09 |
|        basket       | 25.24 | 35.32 |
|      waterfall      | 40.02 | 57.74 |
|         tent        | 65.77 | 78.65 |
|         bag         | 11.74 | 14.66 |
|       minibike      | 51.35 | 68.97 |
|        cradle       | 68.84 | 84.91 |
|         oven        | 40.16 | 52.04 |
|         ball        | 36.37 | 44.02 |
|         food        | 38.21 | 46.74 |
|         step        | 13.81 | 19.19 |
|         tank        |  45.5 | 56.52 |
|      trade name     | 15.41 | 19.83 |
|      microwave      | 62.64 | 75.82 |
|         pot         | 27.44 | 36.69 |
|        animal       | 49.77 | 55.59 |
|       bicycle       | 41.09 | 57.66 |
|         lake        | 51.21 | 76.31 |
|      dishwasher     | 52.16 | 67.07 |
|        screen       | 56.43 | 77.34 |
|       blanket       | 12.08 | 14.78 |
|      sculpture      | 39.93 | 56.24 |
|         hood        | 32.95 | 46.04 |
|        sconce       | 21.04 | 31.26 |
|         vase        | 20.55 | 34.31 |
|    traffic light    | 16.57 | 29.33 |
|         tray        |  6.32 | 13.16 |
|        ashcan       |  29.8 | 47.76 |
|         fan         | 26.84 | 42.46 |
|         pier        | 40.89 |  65.7 |
|      crt screen     |  3.03 |  8.39 |
|        plate        | 37.09 | 51.69 |
|       monitor       |  3.83 |  6.36 |
|    bulletin board   | 45.65 | 66.83 |
|        shower       |  0.93 |  1.12 |
|       radiator      | 35.83 | 44.89 |
|        glass        |  9.87 | 11.33 |
|        clock        | 16.95 | 27.08 |
|         flag        | 30.65 | 37.37 |
+---------------------+-------+-------+
10/06 08:52:13 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 74.8500  mIoU: 38.8300  mAcc: 52.4700  data_time: 0.0017  time: 1.1390
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
10/06 08:52:18 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 773635598
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 773635598
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 08:52:19 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/pixelate'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 08:52:23,634 - mmseg - INFO - using core type: DCNv3
2024-10-06 08:52:23,635 - mmseg - INFO - using activation layer: GELU
2024-10-06 08:52:23,635 - mmseg - INFO - using main norm layer: LN
2024-10-06 08:52:23,635 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 08:52:23,635 - mmseg - INFO - level2_post_norm: False
2024-10-06 08:52:23,635 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 08:52:23,635 - mmseg - INFO - res_post_norm: False
2024-10-06 08:52:23,635 - mmseg - INFO - use_dcn_v4_op: False
10/06 08:52:26 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 08:52:26 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 08:52:27 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 08:52:29 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 08:53:17 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:16  time: 0.4596  data_time: 0.0016  memory: 29516  
10/06 08:53:42 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:18  time: 0.6081  data_time: 0.0016  memory: 15185  
10/06 08:53:56 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:02  time: 0.2682  data_time: 0.0016  memory: 15170  
10/06 08:54:17 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:18  time: 0.3721  data_time: 0.0015  memory: 15186  
10/06 08:54:38 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:05  time: 0.2188  data_time: 0.0015  memory: 15182  
10/06 08:54:55 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:49  time: 0.0842  data_time: 0.0016  memory: 15176  
10/06 08:55:14 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:00  time: 0.2497  data_time: 0.0016  memory: 15183  
10/06 08:55:29 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:02  time: 0.2522  data_time: 0.0015  memory: 15181  
10/06 08:55:37 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:47  time: 0.1834  data_time: 0.0015  memory: 9791  
10/06 08:55:44 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:45  time: 0.0783  data_time: 0.0015  memory: 15149  
10/06 08:55:52 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:54  time: 0.2540  data_time: 0.0016  memory: 15183  
10/06 08:55:58 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:09  time: 0.2322  data_time: 0.0016  memory: 9975  
10/06 08:56:09 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:38  time: 0.2788  data_time: 0.0015  memory: 15188  
10/06 08:56:23 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:15  time: 0.0860  data_time: 0.0016  memory: 15187  
10/06 08:56:37 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:54  time: 0.6230  data_time: 0.0016  memory: 15192  
10/06 08:56:43 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:21  time: 0.0790  data_time: 0.0017  memory: 15170  
10/06 08:56:47 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:49  time: 0.0813  data_time: 0.0016  memory: 967  
10/06 08:56:55 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:25  time: 0.1760  data_time: 0.0015  memory: 9232  
10/06 08:57:08 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:09  time: 0.3513  data_time: 0.0016  memory: 15181  
10/06 08:57:17 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:48  time: 0.0763  data_time: 0.0015  memory: 15139  
10/06 08:57:28 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:30  time: 0.4415  data_time: 0.0015  memory: 15191  
10/06 08:57:38 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:12  time: 0.0780  data_time: 0.0015  memory: 15164  
10/06 08:57:45 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:53  time: 0.2127  data_time: 0.0015  memory: 15151  
10/06 08:57:49 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:33  time: 0.0782  data_time: 0.0015  memory: 2148  
10/06 08:57:56 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:16  time: 0.2091  data_time: 0.0015  memory: 15172  
10/06 08:58:00 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:02:58  time: 0.0860  data_time: 0.0018  memory: 969  
10/06 08:58:06 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:42  time: 0.0748  data_time: 0.0015  memory: 15146  
10/06 08:58:17 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:29  time: 0.2817  data_time: 0.0015  memory: 15176  
10/06 08:58:24 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:14  time: 0.2486  data_time: 0.0015  memory: 15158  
10/06 08:58:28 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:59  time: 0.0734  data_time: 0.0015  memory: 968  
10/06 08:58:34 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:45  time: 0.0826  data_time: 0.0015  memory: 10910  
10/06 08:58:38 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:32  time: 0.0795  data_time: 0.0016  memory: 966  
10/06 08:58:47 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:20  time: 0.0727  data_time: 0.0014  memory: 15182  
10/06 08:58:56 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:08  time: 0.0795  data_time: 0.0016  memory: 15165  
10/06 08:59:03 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:56  time: 0.0821  data_time: 0.0014  memory: 15148  
10/06 08:59:08 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:44  time: 0.0800  data_time: 0.0016  memory: 15148  
10/06 08:59:13 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:32  time: 0.0942  data_time: 0.0016  memory: 915  
10/06 08:59:18 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:21  time: 0.0792  data_time: 0.0015  memory: 15188  
10/06 08:59:26 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:10  time: 0.0754  data_time: 0.0015  memory: 15154  
10/06 08:59:34 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0711  data_time: 0.0014  memory: 8857  
10/06 08:59:34 - mmengine - INFO - per class results:
10/06 08:59:34 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 76.52 | 87.49 |
|       building      | 80.01 | 93.73 |
|         sky         | 94.06 | 97.58 |
|        floor        | 81.33 | 90.35 |
|         tree        | 71.47 | 82.66 |
|       ceiling       | 83.13 | 92.91 |
|         road        | 83.09 | 87.43 |
|         bed         |  87.3 |  94.8 |
|      windowpane     | 60.78 | 79.32 |
|        grass        | 60.14 | 73.74 |
|       cabinet       | 58.57 | 73.13 |
|       sidewalk      | 64.45 | 83.65 |
|        person       | 77.93 | 88.33 |
|        earth        | 34.16 | 46.37 |
|         door        | 47.44 | 61.74 |
|        table        |  59.4 | 78.52 |
|       mountain      | 53.43 | 63.94 |
|        plant        | 48.76 | 62.37 |
|       curtain       | 72.12 | 83.25 |
|        chair        | 57.22 | 69.94 |
|         car         | 79.96 | 86.18 |
|        water        | 49.77 | 66.54 |
|       painting      | 71.11 | 86.33 |
|         sofa        | 61.79 | 83.54 |
|        shelf        | 41.75 | 62.48 |
|        house        | 41.71 | 48.74 |
|         sea         | 52.98 | 68.84 |
|        mirror       | 63.64 | 72.46 |
|         rug         | 60.84 | 74.68 |
|        field        | 23.89 | 52.82 |
|       armchair      | 36.16 | 47.07 |
|         seat        | 56.65 | 78.62 |
|        fence        | 38.67 | 50.06 |
|         desk        |  48.2 | 57.06 |
|         rock        | 34.45 | 72.08 |
|       wardrobe      | 43.58 | 60.58 |
|         lamp        | 61.59 | 74.26 |
|       bathtub       |  77.9 | 84.95 |
|       railing       |  29.9 | 45.69 |
|       cushion       | 55.91 | 70.55 |
|         base        | 28.21 | 37.31 |
|         box         | 26.68 | 35.16 |
|        column       |  43.8 | 53.39 |
|      signboard      | 36.63 | 48.13 |
|   chest of drawers  | 40.68 | 61.03 |
|       counter       | 28.92 | 42.12 |
|         sand        | 50.52 | 70.78 |
|         sink        | 70.32 | 78.64 |
|      skyscraper     | 41.49 | 46.35 |
|      fireplace      |  74.4 | 87.29 |
|     refrigerator    |  72.8 | 85.43 |
|      grandstand     | 36.29 | 73.78 |
|         path        | 20.05 | 29.28 |
|        stairs       | 30.53 | 44.13 |
|        runway       | 70.65 | 95.72 |
|         case        | 47.12 | 61.88 |
|      pool table     |  91.7 | 94.25 |
|        pillow       | 53.41 | 62.32 |
|     screen door     | 75.37 | 81.07 |
|       stairway      | 30.52 | 37.59 |
|        river        |  7.24 | 16.82 |
|        bridge       | 58.35 | 76.33 |
|       bookcase      | 40.68 | 58.74 |
|        blind        |  42.3 | 46.86 |
|     coffee table    | 61.93 | 81.47 |
|        toilet       | 85.83 | 90.16 |
|        flower       | 30.99 | 43.69 |
|         book        | 42.51 | 58.81 |
|         hill        |  8.06 | 11.32 |
|        bench        | 45.51 | 54.49 |
|      countertop     | 52.58 | 63.93 |
|        stove        | 75.49 | 83.13 |
|         palm        | 49.41 |  61.5 |
|    kitchen island   | 33.25 | 77.05 |
|       computer      | 58.99 |  66.5 |
|     swivel chair    | 41.29 | 55.63 |
|         boat        | 41.97 | 43.65 |
|         bar         | 34.85 | 51.58 |
|    arcade machine   |  40.3 | 44.72 |
|        hovel        | 13.24 | 14.13 |
|         bus         | 87.53 | 95.78 |
|        towel        | 60.24 |  67.7 |
|        light        |  52.0 | 61.12 |
|        truck        | 30.49 | 50.19 |
|        tower        | 24.75 | 33.79 |
|      chandelier     | 59.29 | 75.19 |
|        awning       | 26.63 | 30.41 |
|     streetlight     | 25.72 | 34.37 |
|        booth        | 36.51 | 38.57 |
| television receiver | 63.37 | 77.39 |
|       airplane      | 52.67 | 56.72 |
|      dirt track     | 17.57 | 30.02 |
|       apparel       | 28.81 | 37.69 |
|         pole        | 21.11 | 29.68 |
|         land        |  5.19 |  9.14 |
|      bannister      | 10.62 | 13.63 |
|      escalator      |  16.2 |  17.0 |
|       ottoman       | 40.38 | 53.54 |
|        bottle       | 28.59 | 43.88 |
|        buffet       | 45.55 | 54.86 |
|        poster       | 17.48 |  23.5 |
|        stage        | 16.03 | 23.55 |
|         van         | 37.24 |  70.3 |
|         ship        | 12.84 | 20.39 |
|       fountain      | 19.87 | 20.37 |
|    conveyer belt    | 75.07 | 83.67 |
|        canopy       | 16.27 | 18.84 |
|        washer       |  72.7 | 73.66 |
|      plaything      | 21.64 | 29.68 |
|    swimming pool    | 41.64 |  77.4 |
|        stool        | 41.35 | 51.53 |
|        barrel       |  22.0 | 78.42 |
|        basket       | 31.23 | 43.76 |
|      waterfall      | 36.56 | 49.93 |
|         tent        | 93.62 |  98.7 |
|         bag         |  9.5  |  9.79 |
|       minibike      | 46.64 | 48.79 |
|        cradle       | 85.27 |  95.5 |
|         oven        | 26.18 | 62.82 |
|         ball        | 49.12 | 57.56 |
|         food        | 33.92 | 39.29 |
|         step        | 18.86 | 24.58 |
|         tank        | 49.67 | 57.15 |
|      trade name     | 28.88 |  37.4 |
|      microwave      | 53.14 |  60.5 |
|         pot         | 47.05 | 55.72 |
|        animal       | 53.41 | 55.15 |
|       bicycle       | 50.65 | 61.19 |
|         lake        | 68.62 | 73.74 |
|      dishwasher     | 69.23 | 79.38 |
|        screen       | 47.65 | 70.44 |
|       blanket       |  9.28 | 10.36 |
|      sculpture      |  45.1 | 50.58 |
|         hood        | 56.48 | 64.21 |
|        sconce       | 42.83 | 53.11 |
|         vase        | 37.97 | 45.53 |
|    traffic light    | 28.28 | 36.25 |
|         tray        |  9.49 | 15.05 |
|        ashcan       | 46.12 | 56.35 |
|         fan         | 60.34 | 68.11 |
|         pier        | 63.97 | 81.53 |
|      crt screen     |  3.37 | 11.32 |
|        plate        | 42.54 | 50.38 |
|       monitor       |  3.8  |  6.87 |
|    bulletin board   | 43.52 | 66.32 |
|        shower       |  2.54 |  2.69 |
|       radiator      | 57.16 | 64.24 |
|        glass        | 10.52 | 10.92 |
|        clock        | 36.41 | 46.62 |
|         flag        | 42.18 | 43.81 |
+---------------------+-------+-------+
10/06 08:59:34 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.6100  mIoU: 45.9000  mAcc: 57.3900  data_time: 0.0017  time: 0.2125
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
10/06 08:59:37 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1915051178
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1915051178
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 08:59:38 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=448,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=112,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.4,
        groups=[
            7,
            14,
            28,
            56,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            112,
            224,
            448,
            896,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_b_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_b_512_160k_ade20k/jpeg_compression'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 08:59:41,785 - mmseg - INFO - using core type: DCNv3
2024-10-06 08:59:41,785 - mmseg - INFO - using activation layer: GELU
2024-10-06 08:59:41,785 - mmseg - INFO - using main norm layer: LN
2024-10-06 08:59:41,785 - mmseg - INFO - using dpr: linear, 0.4
2024-10-06 08:59:41,785 - mmseg - INFO - level2_post_norm: False
2024-10-06 08:59:41,785 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 08:59:41,785 - mmseg - INFO - res_post_norm: False
2024-10-06 08:59:41,785 - mmseg - INFO - use_dcn_v4_op: False
10/06 08:59:44 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 08:59:44 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 08:59:45 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 08:59:47 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_b_512_160k_ade20k.pth
10/06 09:00:35 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:18  time: 0.4716  data_time: 0.0016  memory: 29516  
10/06 09:01:01 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:28  time: 0.6162  data_time: 0.0016  memory: 15185  
10/06 09:01:15 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:13  time: 0.2743  data_time: 0.0016  memory: 15170  
10/06 09:01:37 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:29  time: 0.3793  data_time: 0.0015  memory: 15186  
10/06 09:01:58 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:17  time: 0.2254  data_time: 0.0015  memory: 15182  
10/06 09:02:15 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:14:00  time: 0.0907  data_time: 0.0016  memory: 15176  
10/06 09:02:34 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:10  time: 0.2553  data_time: 0.0015  memory: 15183  
10/06 09:02:50 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:12  time: 0.2588  data_time: 0.0015  memory: 15181  
10/06 09:02:58 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:57  time: 0.1886  data_time: 0.0015  memory: 9791  
10/06 09:03:05 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:54  time: 0.0893  data_time: 0.0015  memory: 15149  
10/06 09:03:13 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:04  time: 0.2602  data_time: 0.0016  memory: 15183  
10/06 09:03:20 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:18  time: 0.2390  data_time: 0.0016  memory: 9975  
10/06 09:03:32 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:46  time: 0.2847  data_time: 0.0014  memory: 15188  
10/06 09:03:46 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:23  time: 0.0918  data_time: 0.0016  memory: 15187  
10/06 09:04:00 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:02  time: 0.6277  data_time: 0.0015  memory: 15192  
10/06 09:04:06 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:29  time: 0.0854  data_time: 0.0016  memory: 15170  
10/06 09:04:11 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:56  time: 0.0866  data_time: 0.0016  memory: 967  
10/06 09:04:18 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:31  time: 0.1837  data_time: 0.0015  memory: 9232  
10/06 09:04:32 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:15  time: 0.3509  data_time: 0.0016  memory: 15181  
10/06 09:04:41 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:54  time: 0.0818  data_time: 0.0015  memory: 15139  
10/06 09:04:52 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:36  time: 0.4482  data_time: 0.0015  memory: 15191  
10/06 09:05:02 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:18  time: 0.0836  data_time: 0.0016  memory: 15164  
10/06 09:05:10 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:58  time: 0.2143  data_time: 0.0015  memory: 15151  
10/06 09:05:14 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:38  time: 0.0848  data_time: 0.0015  memory: 2148  
10/06 09:05:22 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:20  time: 0.2097  data_time: 0.0015  memory: 15172  
10/06 09:05:26 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:02  time: 0.0858  data_time: 0.0015  memory: 969  
10/06 09:05:31 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:45  time: 0.0809  data_time: 0.0015  memory: 15146  
10/06 09:05:43 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:32  time: 0.2913  data_time: 0.0015  memory: 15176  
10/06 09:05:50 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:17  time: 0.2557  data_time: 0.0015  memory: 15158  
10/06 09:05:55 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:02  time: 0.0791  data_time: 0.0014  memory: 968  
10/06 09:06:01 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:48  time: 0.0889  data_time: 0.0015  memory: 10910  
10/06 09:06:05 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:34  time: 0.0823  data_time: 0.0016  memory: 966  
10/06 09:06:15 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:22  time: 0.0778  data_time: 0.0014  memory: 15182  
10/06 09:06:23 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:09  time: 0.0865  data_time: 0.0016  memory: 15165  
10/06 09:06:31 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:57  time: 0.0882  data_time: 0.0014  memory: 15148  
10/06 09:06:37 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:45  time: 0.0861  data_time: 0.0016  memory: 15148  
10/06 09:06:41 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:33  time: 0.0855  data_time: 0.0016  memory: 915  
10/06 09:06:47 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:22  time: 0.0846  data_time: 0.0015  memory: 15188  
10/06 09:06:55 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:10  time: 0.0816  data_time: 0.0015  memory: 15154  
10/06 09:07:03 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0758  data_time: 0.0014  memory: 8857  
10/06 09:07:03 - mmengine - INFO - per class results:
10/06 09:07:03 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 77.01 | 88.38 |
|       building      | 82.22 | 92.88 |
|         sky         | 93.95 | 97.58 |
|        floor        | 80.23 | 91.05 |
|         tree        | 72.62 | 86.43 |
|       ceiling       | 82.62 | 91.85 |
|         road        | 83.42 |  89.3 |
|         bed         | 88.95 |  95.4 |
|      windowpane     | 61.36 | 79.71 |
|        grass        | 60.07 | 69.98 |
|       cabinet       | 59.37 | 72.08 |
|       sidewalk      | 62.84 | 80.39 |
|        person       | 79.88 | 90.85 |
|        earth        | 37.07 |  55.5 |
|         door        | 48.77 | 62.88 |
|        table        |  60.3 | 77.46 |
|       mountain      | 56.92 | 74.26 |
|        plant        | 48.29 |  57.2 |
|       curtain       | 72.51 | 81.51 |
|        chair        | 56.11 | 67.31 |
|         car         | 83.47 | 91.23 |
|        water        |  50.9 | 63.67 |
|       painting      | 75.01 | 86.16 |
|         sofa        | 64.85 | 84.53 |
|        shelf        | 41.81 | 63.72 |
|        house        | 44.13 | 59.15 |
|         sea         | 62.55 | 83.59 |
|        mirror       | 66.79 | 73.07 |
|         rug         | 55.51 | 65.66 |
|        field        | 28.07 | 57.56 |
|       armchair      | 39.85 | 53.47 |
|         seat        | 59.27 |  78.7 |
|        fence        | 44.93 |  57.6 |
|         desk        | 51.31 | 67.07 |
|         rock        | 35.62 | 57.99 |
|       wardrobe      | 42.75 | 63.81 |
|         lamp        | 62.29 | 73.13 |
|       bathtub       | 77.07 | 85.25 |
|       railing       | 33.41 | 44.58 |
|       cushion       | 57.24 | 71.84 |
|         base        | 25.84 | 31.36 |
|         box         | 26.27 | 33.68 |
|        column       | 46.69 |  58.1 |
|      signboard      |  36.7 |  47.1 |
|   chest of drawers  | 42.46 | 59.63 |
|       counter       |  33.8 | 39.56 |
|         sand        | 44.44 | 60.97 |
|         sink        | 70.75 | 80.09 |
|      skyscraper     |  63.9 | 83.54 |
|      fireplace      | 73.08 | 84.31 |
|     refrigerator    | 76.97 | 89.55 |
|      grandstand     | 48.97 | 70.74 |
|         path        | 23.33 | 36.64 |
|        stairs       | 33.39 | 41.25 |
|        runway       | 71.23 | 96.08 |
|         case        | 53.27 | 66.73 |
|      pool table     | 91.11 | 95.12 |
|        pillow       | 54.35 |  63.3 |
|     screen door     |  74.1 |  79.2 |
|       stairway      | 32.65 | 38.52 |
|        river        |  5.12 | 12.39 |
|        bridge       | 50.49 | 65.48 |
|       bookcase      | 41.12 | 59.98 |
|        blind        | 38.11 | 39.07 |
|     coffee table    | 64.25 | 80.75 |
|        toilet       | 84.45 | 89.75 |
|        flower       | 43.95 | 56.65 |
|         book        | 47.66 | 66.22 |
|         hill        |  6.85 |  9.11 |
|        bench        | 46.45 | 54.81 |
|      countertop     | 52.71 | 67.72 |
|        stove        |  79.5 | 86.51 |
|         palm        | 48.91 | 61.37 |
|    kitchen island   | 27.88 | 56.45 |
|       computer      | 65.36 | 73.18 |
|     swivel chair    | 41.48 | 51.82 |
|         boat        | 42.57 | 49.53 |
|         bar         | 33.23 | 44.32 |
|    arcade machine   | 45.69 | 47.88 |
|        hovel        | 29.25 | 31.96 |
|         bus         |  89.2 | 96.41 |
|        towel        |  63.4 | 70.09 |
|        light        | 50.69 |  58.3 |
|        truck        |  35.8 | 47.89 |
|        tower        | 18.62 | 30.03 |
|      chandelier     | 68.27 | 80.98 |
|        awning       | 25.63 | 30.01 |
|     streetlight     | 24.07 | 30.77 |
|        booth        | 42.08 | 48.57 |
| television receiver | 67.34 | 75.49 |
|       airplane      | 60.43 | 69.05 |
|      dirt track     | 11.16 | 20.02 |
|       apparel       |  38.8 | 49.98 |
|         pole        |  22.6 | 32.99 |
|         land        |  5.31 |  7.32 |
|      bannister      |  15.5 |  19.0 |
|      escalator      | 37.94 | 55.31 |
|       ottoman       | 44.15 | 60.23 |
|        bottle       | 25.67 | 32.45 |
|        buffet       | 43.41 | 52.28 |
|        poster       | 33.21 | 41.04 |
|        stage        | 15.69 | 19.79 |
|         van         | 44.25 | 66.68 |
|         ship        | 64.11 | 97.56 |
|       fountain      | 12.66 | 12.82 |
|    conveyer belt    | 60.56 | 78.07 |
|        canopy       | 20.64 | 27.06 |
|        washer       | 74.36 | 76.97 |
|      plaything      | 28.74 | 38.99 |
|    swimming pool    | 41.13 | 70.94 |
|        stool        | 39.47 | 54.11 |
|        barrel       |  19.5 | 65.79 |
|        basket       | 29.21 | 38.73 |
|      waterfall      | 49.57 | 59.61 |
|         tent        | 88.14 | 98.71 |
|         bag         |  10.6 | 11.53 |
|       minibike      | 70.21 | 81.17 |
|        cradle       | 83.74 | 97.07 |
|         oven        | 31.81 | 63.43 |
|         ball        |  40.6 |  45.6 |
|         food        | 44.59 |  54.1 |
|         step        | 22.01 |  24.7 |
|         tank        | 50.45 | 58.33 |
|      trade name     |  26.0 | 30.36 |
|      microwave      | 60.23 | 68.94 |
|         pot         | 46.27 | 54.41 |
|        animal       | 59.82 | 61.97 |
|       bicycle       | 53.46 | 66.34 |
|         lake        | 66.96 | 73.23 |
|      dishwasher     | 69.26 | 81.18 |
|        screen       | 58.29 | 73.62 |
|       blanket       | 11.45 | 12.83 |
|      sculpture      | 69.81 |  76.7 |
|         hood        |  54.7 | 63.76 |
|        sconce       | 40.82 | 49.72 |
|         vase        | 41.92 | 49.67 |
|    traffic light    |  27.2 | 37.07 |
|         tray        | 10.37 |  17.4 |
|        ashcan       | 43.25 | 54.31 |
|         fan         | 59.98 | 71.21 |
|         pier        | 51.28 | 82.57 |
|      crt screen     |  4.18 | 12.44 |
|        plate        | 54.29 | 67.94 |
|       monitor       |  3.33 |  4.52 |
|    bulletin board   | 47.78 | 59.32 |
|        shower       |  3.34 |  3.94 |
|       radiator      | 55.78 | 60.97 |
|        glass        | 11.07 |  11.6 |
|        clock        | 37.25 | 43.05 |
|         flag        | 44.38 | 46.56 |
+---------------------+-------+-------+
10/06 09:07:03 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.4000  mIoU: 48.2500  mAcc: 59.5300  data_time: 0.0017  time: 0.2179
Finished processing corruption type: jpeg_compression
Runtime: 1728198424

============================= JOB FEEDBACK =============================

NodeName=uc2n485
Job ID: 24369576
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 06:46:16
CPU Efficiency: 5.24% of 5-09:16:00 core-walltime
Job Wall-clock time: 08:04:45
Memory Utilized: 3.72 GB
Memory Efficiency: 3.72% of 100.00 GB
