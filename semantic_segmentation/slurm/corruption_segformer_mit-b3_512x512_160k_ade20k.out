Started at Sun Sep 15 14:24:26 CEST 2024
/var/spool/slurmd/job24235242/slurm_script: line 15: activate: No such file or directory
Processing corruption type: gaussian_noise
09/15 14:24:48 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 991312799
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 991312799
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 14:24:48 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='gaussian_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/gaussian_noise'

09/15 14:25:11 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 14:25:11 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 14:25:12 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 14:25:14 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 14:26:17 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:41:01  time: 0.5960  data_time: 0.0015  memory: 19841  
09/15 14:26:45 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:28:56  time: 0.5082  data_time: 0.0016  memory: 19792  
09/15 14:26:57 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:21:09  time: 0.2783  data_time: 0.0015  memory: 13446  
09/15 14:27:13 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:17:51  time: 0.2360  data_time: 0.0015  memory: 16826  
09/15 14:27:25 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:18  time: 0.1169  data_time: 0.0014  memory: 16834  
09/15 14:27:35 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:18  time: 0.0888  data_time: 0.0015  memory: 13449  
09/15 14:27:47 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:12:01  time: 0.1607  data_time: 0.0032  memory: 13451  
09/15 14:27:57 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:10:52  time: 0.2202  data_time: 0.0014  memory: 13451  
09/15 14:28:02 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:09:39  time: 0.0959  data_time: 0.0014  memory: 8614  
09/15 14:28:08 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:08:41  time: 0.0805  data_time: 0.0014  memory: 13440  
09/15 14:28:15 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:07:56  time: 0.2033  data_time: 0.0015  memory: 8622  
09/15 14:28:21 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:07:16  time: 0.1903  data_time: 0.0015  memory: 8622  
09/15 14:28:29 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:06:45  time: 0.2403  data_time: 0.0014  memory: 13453  
09/15 14:28:39 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:06:20  time: 0.1134  data_time: 0.0015  memory: 13451  
09/15 14:28:47 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:05:55  time: 0.2223  data_time: 0.0014  memory: 13456  
09/15 14:28:53 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:05:28  time: 0.0811  data_time: 0.0015  memory: 8615  
09/15 14:28:57 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:02  time: 0.1166  data_time: 0.0016  memory: 633  
09/15 14:29:02 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:04:39  time: 0.0944  data_time: 0.0014  memory: 8609  
09/15 14:29:10 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:04:21  time: 0.1403  data_time: 0.0015  memory: 13441  
09/15 14:29:17 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:03  time: 0.0798  data_time: 0.0014  memory: 8622  
09/15 14:29:26 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:03:48  time: 0.2423  data_time: 0.0015  memory: 13453  
09/15 14:29:32 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:03:31  time: 0.0820  data_time: 0.0015  memory: 13446  
09/15 14:29:37 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:14  time: 0.1185  data_time: 0.0015  memory: 13442  
09/15 14:29:41 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:02:58  time: 0.0829  data_time: 0.0014  memory: 1829  
09/15 14:29:47 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:02:44  time: 0.0984  data_time: 0.0014  memory: 13447  
09/15 14:29:51 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:02:29  time: 0.0820  data_time: 0.0014  memory: 633  
09/15 14:29:56 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:15  time: 0.0796  data_time: 0.0014  memory: 8599  
09/15 14:30:03 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:04  time: 0.1997  data_time: 0.0014  memory: 13448  
09/15 14:30:08 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:01:51  time: 0.1312  data_time: 0.0014  memory: 8609  
09/15 14:30:12 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:39  time: 0.0786  data_time: 0.0014  memory: 633  
09/15 14:30:18 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:28  time: 0.0814  data_time: 0.0014  memory: 8620  
09/15 14:30:22 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:17  time: 0.0807  data_time: 0.0015  memory: 624  
09/15 14:30:29 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:06  time: 0.0772  data_time: 0.0013  memory: 16824  
09/15 14:30:35 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:00:56  time: 0.0816  data_time: 0.0016  memory: 8612  
09/15 14:30:41 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:46  time: 0.0796  data_time: 0.0014  memory: 8618  
09/15 14:30:45 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:36  time: 0.0849  data_time: 0.0016  memory: 8600  
09/15 14:30:50 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:27  time: 0.0836  data_time: 0.0016  memory: 582  
09/15 14:30:55 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:17  time: 0.0824  data_time: 0.0014  memory: 8626  
09/15 14:31:01 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:08  time: 0.0797  data_time: 0.0014  memory: 16829  
09/15 14:31:06 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0759  data_time: 0.0013  memory: 8626  
09/15 14:31:06 - mmengine - INFO - per class results:
09/15 14:31:07 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 70.84 |  86.9 |
|       building      |  78.6 | 90.38 |
|         sky         | 92.46 | 96.39 |
|        floor        | 75.28 | 88.89 |
|         tree        | 69.79 | 89.47 |
|       ceiling       | 78.44 | 89.63 |
|         road        |  75.7 | 91.67 |
|         bed         | 83.76 | 92.51 |
|      windowpane     | 56.15 | 70.85 |
|        grass        | 62.76 |  78.7 |
|       cabinet       | 54.04 |  65.2 |
|       sidewalk      | 44.11 | 51.39 |
|        person       | 73.66 | 89.42 |
|        earth        | 31.91 | 50.06 |
|         door        | 37.77 | 48.31 |
|        table        | 52.99 | 71.39 |
|       mountain      | 52.07 | 61.67 |
|        plant        |  43.7 | 56.91 |
|       curtain       | 61.35 | 78.41 |
|        chair        | 47.57 | 57.67 |
|         car         | 80.69 | 88.78 |
|        water        | 54.58 | 68.62 |
|       painting      | 66.95 |  79.8 |
|         sofa        | 60.48 | 80.43 |
|        shelf        | 37.44 | 51.47 |
|        house        | 44.56 | 54.26 |
|         sea         | 47.56 | 67.75 |
|        mirror       |  53.6 | 59.19 |
|         rug         | 43.62 | 48.02 |
|        field        | 27.33 | 40.29 |
|       armchair      | 37.85 | 58.42 |
|         seat        | 57.86 | 76.85 |
|        fence        | 35.79 | 53.23 |
|         desk        | 41.34 | 67.55 |
|         rock        | 45.88 | 71.15 |
|       wardrobe      | 40.48 | 55.51 |
|         lamp        | 56.59 | 66.77 |
|       bathtub       | 69.31 | 76.07 |
|       railing       | 32.03 | 41.73 |
|       cushion       | 44.33 | 54.38 |
|         base        | 16.73 | 20.86 |
|         box         | 16.86 | 22.77 |
|        column       | 38.83 | 55.74 |
|      signboard      | 32.88 | 42.73 |
|   chest of drawers  | 43.61 | 55.61 |
|       counter       | 22.48 |  35.2 |
|         sand        | 34.41 |  58.9 |
|         sink        | 64.79 | 75.62 |
|      skyscraper     |  42.7 |  53.2 |
|      fireplace      | 66.99 | 79.14 |
|     refrigerator    | 67.03 | 81.91 |
|      grandstand     |  36.8 | 68.85 |
|         path        | 12.86 |  19.5 |
|        stairs       |  20.6 | 28.77 |
|        runway       | 76.29 | 82.04 |
|         case        | 36.35 |  45.6 |
|      pool table     | 87.31 | 90.79 |
|        pillow       | 48.62 | 60.98 |
|     screen door     | 55.18 | 61.83 |
|       stairway      | 27.64 |  47.0 |
|        river        |  5.71 |  6.89 |
|        bridge       |  33.9 | 40.17 |
|       bookcase      | 36.72 |  53.3 |
|        blind        | 32.19 | 34.33 |
|     coffee table    | 55.48 | 65.12 |
|        toilet       | 76.42 | 85.81 |
|        flower       | 33.03 | 53.97 |
|         book        | 43.06 | 58.04 |
|         hill        |  7.13 | 13.07 |
|        bench        | 33.71 | 37.34 |
|      countertop     | 49.21 | 63.53 |
|        stove        | 64.82 | 72.05 |
|         palm        | 43.23 | 53.71 |
|    kitchen island   | 27.99 | 43.62 |
|       computer      | 58.39 | 67.55 |
|     swivel chair    | 42.74 | 61.01 |
|         boat        | 51.27 | 56.55 |
|         bar         | 32.23 | 37.77 |
|    arcade machine   |  10.7 |  10.9 |
|        hovel        | 37.37 | 42.82 |
|         bus         | 83.08 | 92.67 |
|        towel        | 44.18 | 54.45 |
|        light        | 41.62 | 45.11 |
|        truck        | 33.75 | 44.16 |
|        tower        | 13.87 | 17.67 |
|      chandelier     | 59.48 | 74.29 |
|        awning       | 19.32 |  21.3 |
|     streetlight     | 20.39 | 25.87 |
|        booth        | 51.98 | 55.95 |
| television receiver |  55.6 | 65.67 |
|       airplane      | 52.05 |  62.4 |
|      dirt track     | 12.43 | 31.84 |
|       apparel       | 30.54 | 40.64 |
|         pole        | 18.55 |  25.9 |
|         land        |  1.85 |  2.8  |
|      bannister      |  6.11 |  8.18 |
|      escalator      | 18.13 | 18.51 |
|       ottoman       |  38.1 | 44.86 |
|        bottle       | 32.35 | 55.01 |
|        buffet       | 41.86 |  50.1 |
|        poster       | 24.54 | 26.37 |
|        stage        | 13.74 | 18.61 |
|         van         | 40.98 | 57.61 |
|         ship        |  5.37 |  5.44 |
|       fountain      | 29.62 | 32.04 |
|    conveyer belt    | 83.13 | 85.45 |
|        canopy       | 13.72 | 14.96 |
|        washer       | 65.78 | 68.65 |
|      plaything      | 15.72 | 18.79 |
|    swimming pool    | 16.16 | 26.55 |
|        stool        | 29.19 | 36.02 |
|        barrel       | 25.63 | 41.48 |
|        basket       | 19.53 | 23.32 |
|      waterfall      | 63.37 | 71.51 |
|         tent        | 92.49 | 98.31 |
|         bag         |  4.51 |  5.21 |
|       minibike      |  66.6 | 77.23 |
|        cradle       | 72.23 | 91.15 |
|         oven        | 30.03 | 45.27 |
|         ball        | 11.22 | 12.65 |
|         food        | 43.07 | 52.88 |
|         step        |  2.13 |  2.39 |
|         tank        |  42.3 | 43.97 |
|      trade name     | 23.97 |  26.1 |
|      microwave      | 60.04 | 65.99 |
|         pot         | 27.98 | 29.88 |
|        animal       | 52.12 |  55.6 |
|       bicycle       | 48.82 | 67.96 |
|         lake        | 58.59 | 58.59 |
|      dishwasher     | 51.24 | 54.29 |
|        screen       | 57.59 | 72.89 |
|       blanket       |  7.62 |  8.51 |
|      sculpture      | 38.35 | 55.84 |
|         hood        | 44.38 | 47.11 |
|        sconce       | 34.05 | 40.49 |
|         vase        |  33.9 | 47.38 |
|    traffic light    | 22.87 | 29.68 |
|         tray        |  6.94 | 13.12 |
|        ashcan       |  30.6 | 35.04 |
|         fan         | 52.15 | 65.33 |
|         pier        | 30.36 | 40.21 |
|      crt screen     |  9.41 | 19.55 |
|        plate        | 42.37 | 51.82 |
|       monitor       | 58.27 | 65.81 |
|    bulletin board   |  27.2 |  32.4 |
|        shower       |  0.69 |  1.69 |
|       radiator      | 31.24 | 32.51 |
|        glass        | 11.63 | 12.34 |
|        clock        | 28.51 | 32.93 |
|         flag        |  42.7 | 45.99 |
+---------------------+-------+-------+
09/15 14:31:07 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.9100  mIoU: 41.7700  mAcc: 51.4200  data_time: 0.0017  time: 0.1761
Finished processing corruption type: gaussian_noise
Processing corruption type: shot_noise
09/15 14:31:17 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1451363465
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1451363465
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 14:31:17 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='shot_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/shot_noise'

09/15 14:31:20 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 14:31:20 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 14:31:20 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 14:31:21 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 14:32:14 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:34:43  time: 0.7054  data_time: 0.0016  memory: 19841  
09/15 14:32:44 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:26:29  time: 0.4927  data_time: 0.0016  memory: 19792  
09/15 14:32:58 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:19:55  time: 0.2757  data_time: 0.0015  memory: 13446  
09/15 14:33:14 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:58  time: 0.3059  data_time: 0.0016  memory: 16826  
09/15 14:33:28 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:14:51  time: 0.1934  data_time: 0.0015  memory: 16834  
09/15 14:33:40 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:11  time: 0.1655  data_time: 0.0016  memory: 13449  
09/15 14:33:55 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:12:06  time: 0.1877  data_time: 0.0015  memory: 13451  
09/15 14:34:09 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:11:14  time: 0.3691  data_time: 0.0015  memory: 13451  
09/15 14:34:20 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:17  time: 0.2403  data_time: 0.0014  memory: 8614  
09/15 14:34:33 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:35  time: 0.2405  data_time: 0.0015  memory: 13440  
09/15 14:34:44 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:57  time: 0.2890  data_time: 0.0017  memory: 8622  
09/15 14:34:55 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:19  time: 0.2570  data_time: 0.0016  memory: 8622  
09/15 14:35:07 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:50  time: 0.3054  data_time: 0.0014  memory: 13453  
09/15 14:35:20 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:24  time: 0.1675  data_time: 0.0017  memory: 13451  
09/15 14:35:33 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:01  time: 0.3260  data_time: 0.0015  memory: 13456  
09/15 14:35:42 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:31  time: 0.1559  data_time: 0.0016  memory: 8615  
09/15 14:35:50 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:04  time: 0.1600  data_time: 0.0019  memory: 633  
09/15 14:35:58 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:39  time: 0.1564  data_time: 0.0015  memory: 8609  
09/15 14:36:10 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:19  time: 0.1891  data_time: 0.0015  memory: 13441  
09/15 14:36:20 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:59  time: 0.1469  data_time: 0.0015  memory: 8622  
09/15 14:36:33 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:42  time: 0.3389  data_time: 0.0015  memory: 13453  
09/15 14:36:43 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:23  time: 0.1518  data_time: 0.0015  memory: 13446  
09/15 14:36:52 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:05  time: 0.1942  data_time: 0.0015  memory: 13442  
09/15 14:37:01 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:46  time: 0.1602  data_time: 0.0015  memory: 1829  
09/15 14:37:11 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:29  time: 0.1707  data_time: 0.0015  memory: 13447  
09/15 14:37:18 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:12  time: 0.1569  data_time: 0.0015  memory: 633  
09/15 14:37:27 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:56  time: 0.1471  data_time: 0.0015  memory: 8599  
09/15 14:37:38 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:41  time: 0.2883  data_time: 0.0015  memory: 13448  
09/15 14:37:47 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:26  time: 0.2094  data_time: 0.0015  memory: 8609  
09/15 14:37:54 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:11  time: 0.1420  data_time: 0.0015  memory: 633  
09/15 14:38:03 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:56  time: 0.1606  data_time: 0.0015  memory: 8620  
09/15 14:38:11 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:42  time: 0.1538  data_time: 0.0016  memory: 624  
09/15 14:38:21 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:29  time: 0.1441  data_time: 0.0014  memory: 16824  
09/15 14:38:31 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:15  time: 0.1956  data_time: 0.0016  memory: 8612  
09/15 14:38:41 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:02  time: 0.1577  data_time: 0.0014  memory: 8618  
09/15 14:38:49 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:49  time: 0.1604  data_time: 0.0016  memory: 8600  
09/15 14:38:56 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:36  time: 0.1567  data_time: 0.0017  memory: 582  
09/15 14:39:06 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:24  time: 0.1689  data_time: 0.0015  memory: 8626  
09/15 14:39:15 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:12  time: 0.1540  data_time: 0.0015  memory: 16829  
09/15 14:39:23 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1442  data_time: 0.0014  memory: 8626  
09/15 14:39:23 - mmengine - INFO - per class results:
09/15 14:39:23 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 70.71 | 86.64 |
|       building      |  79.1 |  90.5 |
|         sky         | 92.15 | 96.08 |
|        floor        | 75.61 |  89.0 |
|         tree        | 70.25 | 89.69 |
|       ceiling       | 77.63 | 89.41 |
|         road        | 75.47 | 92.17 |
|         bed         | 84.46 | 93.27 |
|      windowpane     | 55.67 | 70.42 |
|        grass        |  61.5 | 77.53 |
|       cabinet       | 54.27 | 65.57 |
|       sidewalk      | 43.32 | 50.36 |
|        person       | 74.23 | 90.34 |
|        earth        | 32.57 | 49.79 |
|         door        | 37.92 | 49.23 |
|        table        | 53.66 | 72.34 |
|       mountain      | 51.62 | 61.46 |
|        plant        | 45.04 | 57.63 |
|       curtain       | 60.84 |  79.4 |
|        chair        |  49.4 | 60.79 |
|         car         | 81.33 | 89.17 |
|        water        | 53.11 | 67.59 |
|       painting      | 65.69 |  79.0 |
|         sofa        | 60.29 | 80.76 |
|        shelf        | 38.04 | 53.39 |
|        house        | 47.76 | 58.55 |
|         sea         | 46.26 | 65.28 |
|        mirror       |  53.1 | 57.95 |
|         rug         |  37.5 | 41.19 |
|        field        | 28.76 | 46.64 |
|       armchair      | 38.81 | 59.33 |
|         seat        | 58.38 | 76.25 |
|        fence        | 36.16 | 54.25 |
|         desk        | 42.48 | 68.22 |
|         rock        | 43.14 |  68.3 |
|       wardrobe      | 42.35 |  57.0 |
|         lamp        | 55.59 | 65.96 |
|       bathtub       | 67.56 | 74.54 |
|       railing       | 31.94 | 40.82 |
|       cushion       |  46.2 | 56.48 |
|         base        | 18.65 | 22.88 |
|         box         | 18.85 | 25.37 |
|        column       | 38.25 | 54.51 |
|      signboard      | 32.42 | 41.41 |
|   chest of drawers  | 41.21 | 51.79 |
|       counter       | 21.88 | 34.27 |
|         sand        | 33.83 |  57.3 |
|         sink        | 62.42 | 75.86 |
|      skyscraper     | 44.36 | 56.07 |
|      fireplace      | 65.84 | 77.09 |
|     refrigerator    | 65.47 | 78.96 |
|      grandstand     | 35.98 | 65.85 |
|         path        | 13.93 | 20.29 |
|        stairs       | 22.01 | 29.71 |
|        runway       | 74.27 | 81.46 |
|         case        |  36.4 | 47.28 |
|      pool table     | 89.06 | 92.37 |
|        pillow       | 48.09 | 59.85 |
|     screen door     | 56.54 | 61.01 |
|       stairway      | 26.84 | 46.11 |
|        river        |  6.99 |  8.5  |
|        bridge       | 30.98 | 36.44 |
|       bookcase      | 37.16 | 53.09 |
|        blind        | 30.06 |  31.7 |
|     coffee table    | 56.07 | 66.51 |
|        toilet       | 69.95 | 82.84 |
|        flower       | 32.29 | 53.72 |
|         book        | 42.85 | 57.32 |
|         hill        |  4.36 |  7.38 |
|        bench        | 31.81 | 34.23 |
|      countertop     | 48.22 | 63.49 |
|        stove        | 66.39 | 73.24 |
|         palm        | 43.49 | 55.47 |
|    kitchen island   | 26.06 | 41.51 |
|       computer      | 55.31 | 63.55 |
|     swivel chair    | 44.23 | 64.19 |
|         boat        | 59.34 | 69.37 |
|         bar         |  31.2 |  36.9 |
|    arcade machine   |  18.1 | 18.76 |
|        hovel        |  34.3 | 39.04 |
|         bus         | 82.29 | 91.31 |
|        towel        | 43.25 | 51.12 |
|        light        | 37.21 |  40.0 |
|        truck        | 34.32 | 46.47 |
|        tower        | 14.15 | 17.85 |
|      chandelier     | 57.68 | 73.49 |
|        awning       | 20.84 | 22.97 |
|     streetlight     | 20.49 | 26.55 |
|        booth        | 52.21 | 56.12 |
| television receiver | 62.74 |  72.6 |
|       airplane      |  52.5 | 61.61 |
|      dirt track     | 13.18 | 25.76 |
|       apparel       | 30.08 | 41.23 |
|         pole        |  18.3 | 26.98 |
|         land        |  0.71 |  1.04 |
|      bannister      |  8.18 | 11.21 |
|      escalator      | 19.89 |  20.4 |
|       ottoman       | 32.77 | 39.88 |
|        bottle       | 32.24 | 55.77 |
|        buffet       | 45.95 | 53.86 |
|        poster       | 21.64 | 23.29 |
|        stage        | 17.84 | 24.05 |
|         van         | 40.57 | 58.13 |
|         ship        |  6.2  |  6.39 |
|       fountain      | 30.99 | 33.64 |
|    conveyer belt    | 80.32 | 82.86 |
|        canopy       |  12.0 | 13.17 |
|        washer       | 63.94 | 69.55 |
|      plaything      | 16.57 | 19.85 |
|    swimming pool    | 26.74 | 36.07 |
|        stool        | 35.33 | 43.33 |
|        barrel       | 47.76 | 67.74 |
|        basket       | 24.38 |  28.8 |
|      waterfall      | 58.62 | 61.94 |
|         tent        | 92.85 | 98.91 |
|         bag         |  4.44 |  5.27 |
|       minibike      | 66.56 | 79.94 |
|        cradle       | 69.83 | 89.55 |
|         oven        | 30.91 | 45.53 |
|         ball        | 13.61 | 15.72 |
|         food        | 40.31 | 49.35 |
|         step        |  2.24 |  2.39 |
|         tank        | 43.01 | 44.29 |
|      trade name     | 24.37 | 26.55 |
|      microwave      |  64.7 | 70.64 |
|         pot         | 33.67 | 36.53 |
|        animal       | 51.77 | 56.02 |
|       bicycle       | 47.55 | 67.93 |
|         lake        | 46.07 | 46.07 |
|      dishwasher     | 52.43 | 59.44 |
|        screen       | 55.65 | 69.95 |
|       blanket       |  7.04 |  7.75 |
|      sculpture      |  47.1 | 70.99 |
|         hood        | 40.71 | 42.77 |
|        sconce       | 31.84 |  37.1 |
|         vase        | 33.81 |  48.7 |
|    traffic light    | 23.56 |  31.8 |
|         tray        |  6.33 | 11.65 |
|        ashcan       | 30.07 | 36.02 |
|         fan         | 52.27 |  65.2 |
|         pier        | 29.78 | 40.83 |
|      crt screen     |  9.23 | 22.68 |
|        plate        | 40.65 | 49.28 |
|       monitor       | 49.51 | 56.48 |
|    bulletin board   | 17.53 | 20.43 |
|        shower       |  0.96 |  1.36 |
|       radiator      | 25.87 | 26.79 |
|        glass        | 11.69 | 12.39 |
|        clock        | 29.39 | 34.42 |
|         flag        | 40.25 | 43.21 |
+---------------------+-------+-------+
09/15 14:39:23 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.9100  mIoU: 41.7600  mAcc: 51.5900  data_time: 0.0017  time: 0.2413
Finished processing corruption type: shot_noise
Processing corruption type: impulse_noise
09/15 14:39:27 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 681329731
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 681329731
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 14:39:27 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='impulse_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/impulse_noise'

09/15 14:39:30 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 14:39:30 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 14:39:30 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 14:39:31 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 14:40:20 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:55  time: 0.6338  data_time: 0.0016  memory: 19841  
09/15 14:40:46 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:48  time: 0.3970  data_time: 0.0018  memory: 19792  
09/15 14:40:54 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:17:14  time: 0.1797  data_time: 0.0015  memory: 13446  
09/15 14:41:06 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:14:18  time: 0.2176  data_time: 0.0030  memory: 16826  
09/15 14:41:16 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:12:17  time: 0.1039  data_time: 0.0015  memory: 16834  
09/15 14:41:24 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:41  time: 0.0671  data_time: 0.0016  memory: 13449  
09/15 14:41:33 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:09:38  time: 0.0990  data_time: 0.0015  memory: 13451  
09/15 14:41:42 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:08:46  time: 0.2004  data_time: 0.0014  memory: 13451  
09/15 14:41:47 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:07:48  time: 0.0805  data_time: 0.0014  memory: 8614  
09/15 14:41:51 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:07:00  time: 0.0625  data_time: 0.0015  memory: 13440  
09/15 14:41:57 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:06:24  time: 0.1868  data_time: 0.0015  memory: 8622  
09/15 14:42:01 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:05:51  time: 0.1473  data_time: 0.0016  memory: 8622  
09/15 14:42:09 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:05:28  time: 0.2063  data_time: 0.0014  memory: 13453  
09/15 14:42:16 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:05:07  time: 0.0687  data_time: 0.0033  memory: 13451  
09/15 14:42:24 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:04:48  time: 0.1999  data_time: 0.0014  memory: 13456  
09/15 14:42:28 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:04:26  time: 0.0622  data_time: 0.0016  memory: 8615  
09/15 14:42:31 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:04:04  time: 0.0634  data_time: 0.0016  memory: 633  
09/15 14:42:35 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:03:45  time: 0.1341  data_time: 0.0014  memory: 8609  
09/15 14:42:42 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:03:31  time: 0.1013  data_time: 0.0015  memory: 13441  
09/15 14:42:47 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:03:16  time: 0.0607  data_time: 0.0014  memory: 8622  
09/15 14:42:54 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:03:04  time: 0.2231  data_time: 0.0015  memory: 13453  
09/15 14:43:00 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:02:50  time: 0.0636  data_time: 0.0015  memory: 13446  
09/15 14:43:04 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:02:37  time: 0.0832  data_time: 0.0015  memory: 13442  
09/15 14:43:07 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:02:24  time: 0.0629  data_time: 0.0015  memory: 1829  
09/15 14:43:12 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:02:12  time: 0.0809  data_time: 0.0014  memory: 13447  
09/15 14:43:15 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:02:00  time: 0.0638  data_time: 0.0015  memory: 633  
09/15 14:43:18 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:01:49  time: 0.0610  data_time: 0.0015  memory: 8599  
09/15 14:43:25 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:01:40  time: 0.1789  data_time: 0.0015  memory: 13448  
09/15 14:43:29 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:01:30  time: 0.1136  data_time: 0.0014  memory: 8609  
09/15 14:43:32 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:20  time: 0.0585  data_time: 0.0014  memory: 633  
09/15 14:43:37 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:11  time: 0.0658  data_time: 0.0015  memory: 8620  
09/15 14:43:40 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:02  time: 0.0637  data_time: 0.0016  memory: 624  
09/15 14:43:46 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:00:54  time: 0.0625  data_time: 0.0014  memory: 16824  
09/15 14:43:51 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:00:45  time: 0.0636  data_time: 0.0016  memory: 8612  
09/15 14:43:55 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:37  time: 0.0713  data_time: 0.0015  memory: 8618  
09/15 14:43:59 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:29  time: 0.0701  data_time: 0.0016  memory: 8600  
09/15 14:44:04 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:22  time: 0.0633  data_time: 0.0015  memory: 582  
09/15 14:44:10 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:14  time: 0.1037  data_time: 0.0015  memory: 8626  
09/15 14:44:16 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:07  time: 0.0641  data_time: 0.0014  memory: 16829  
09/15 14:44:24 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1520  data_time: 0.0013  memory: 8626  
09/15 14:44:24 - mmengine - INFO - per class results:
09/15 14:44:24 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 69.17 | 87.53 |
|       building      | 78.21 | 90.64 |
|         sky         | 91.81 | 95.18 |
|        floor        | 73.47 | 89.94 |
|         tree        | 67.93 | 88.32 |
|       ceiling       | 76.82 | 87.38 |
|         road        | 75.86 |  89.8 |
|         bed         | 82.31 |  90.7 |
|      windowpane     | 55.05 | 70.07 |
|        grass        | 61.71 | 76.93 |
|       cabinet       | 50.06 | 59.82 |
|       sidewalk      | 47.06 | 55.88 |
|        person       | 73.78 | 87.53 |
|        earth        | 30.92 | 54.48 |
|         door        | 36.63 |  45.8 |
|        table        | 51.07 | 69.17 |
|       mountain      | 51.78 | 62.49 |
|        plant        | 43.26 | 55.45 |
|       curtain       | 60.79 | 77.65 |
|        chair        | 46.71 | 56.69 |
|         car         | 80.76 |  88.9 |
|        water        | 53.16 | 69.75 |
|       painting      | 65.08 | 76.74 |
|         sofa        | 60.23 | 79.75 |
|        shelf        |  38.3 | 54.31 |
|        house        | 39.22 | 49.34 |
|         sea         | 45.09 |  61.3 |
|        mirror       | 50.33 | 54.73 |
|         rug         | 39.52 | 43.41 |
|        field        | 24.24 | 36.92 |
|       armchair      | 38.25 | 58.51 |
|         seat        | 57.12 | 74.38 |
|        fence        | 32.98 | 53.05 |
|         desk        | 36.36 | 54.71 |
|         rock        | 45.48 | 68.85 |
|       wardrobe      | 41.13 | 51.99 |
|         lamp        | 52.32 | 59.21 |
|       bathtub       | 62.84 | 68.71 |
|       railing       | 31.62 | 40.14 |
|       cushion       | 38.45 | 45.06 |
|         base        | 13.55 | 16.13 |
|         box         | 16.12 | 22.02 |
|        column       | 37.91 | 53.14 |
|      signboard      |  30.9 | 40.85 |
|   chest of drawers  | 33.02 |  48.2 |
|       counter       | 19.14 | 28.02 |
|         sand        | 32.27 | 53.07 |
|         sink        |  62.9 | 72.92 |
|      skyscraper     | 34.05 | 41.74 |
|      fireplace      | 62.93 | 72.74 |
|     refrigerator    | 65.03 | 76.17 |
|      grandstand     | 39.93 | 73.25 |
|         path        | 13.21 | 20.01 |
|        stairs       | 21.31 | 29.42 |
|        runway       | 58.11 | 60.14 |
|         case        | 39.23 | 52.42 |
|      pool table     | 84.64 | 87.25 |
|        pillow       | 46.17 | 60.23 |
|     screen door     | 52.77 | 57.89 |
|       stairway      | 23.61 | 37.68 |
|        river        |  4.65 |  5.62 |
|        bridge       |  39.8 | 44.66 |
|       bookcase      | 34.94 | 45.66 |
|        blind        | 25.11 | 25.88 |
|     coffee table    | 55.12 | 64.07 |
|        toilet       | 74.05 | 83.66 |
|        flower       | 30.17 | 43.62 |
|         book        | 39.18 | 52.41 |
|         hill        | 12.39 | 19.03 |
|        bench        | 33.73 | 36.03 |
|      countertop     |  45.0 | 56.69 |
|        stove        |  63.4 | 72.86 |
|         palm        | 40.92 | 52.52 |
|    kitchen island   | 24.08 | 35.68 |
|       computer      |  54.1 | 61.67 |
|     swivel chair    | 36.53 | 45.49 |
|         boat        | 34.38 | 36.27 |
|         bar         | 28.42 | 31.35 |
|    arcade machine   | 11.95 |  12.2 |
|        hovel        |  38.2 |  44.2 |
|         bus         | 82.52 | 91.73 |
|        towel        | 38.24 | 45.71 |
|        light        |  31.8 | 33.22 |
|        truck        | 34.06 | 44.94 |
|        tower        | 11.73 | 14.69 |
|      chandelier     |  57.1 | 67.08 |
|        awning       | 18.64 | 20.21 |
|     streetlight     | 18.32 | 21.21 |
|        booth        | 54.29 | 57.23 |
| television receiver | 55.39 |  65.2 |
|       airplane      | 52.39 |  59.1 |
|      dirt track     | 11.12 | 24.34 |
|       apparel       | 31.02 | 37.44 |
|         pole        | 18.67 | 26.22 |
|         land        |  0.99 |  1.4  |
|      bannister      |  6.28 |  7.78 |
|      escalator      | 13.93 | 14.23 |
|       ottoman       | 24.15 | 29.38 |
|        bottle       | 29.54 | 49.99 |
|        buffet       | 50.04 | 58.02 |
|        poster       |  16.4 | 17.69 |
|        stage        | 11.73 | 13.78 |
|         van         | 39.67 | 54.92 |
|         ship        |  4.73 |  4.78 |
|       fountain      |  20.0 | 22.31 |
|    conveyer belt    | 78.77 | 83.12 |
|        canopy       | 12.45 | 13.44 |
|        washer       | 67.85 | 69.93 |
|      plaything      | 13.73 | 15.89 |
|    swimming pool    | 16.24 | 25.96 |
|        stool        | 32.99 | 40.95 |
|        barrel       | 21.12 | 41.31 |
|        basket       | 26.36 | 30.17 |
|      waterfall      | 63.69 | 65.73 |
|         tent        | 88.39 | 98.59 |
|         bag         |  3.42 |  3.62 |
|       minibike      | 66.13 | 76.44 |
|        cradle       | 70.91 | 89.43 |
|         oven        | 20.08 | 39.81 |
|         ball        | 11.16 | 12.54 |
|         food        | 40.46 | 52.29 |
|         step        |  2.68 |  2.91 |
|         tank        | 38.86 | 41.49 |
|      trade name     |  22.5 | 24.27 |
|      microwave      | 34.74 | 38.16 |
|         pot         | 23.66 |  25.2 |
|        animal       | 51.94 | 55.74 |
|       bicycle       |  45.9 | 63.44 |
|         lake        | 58.89 | 58.89 |
|      dishwasher     | 35.54 | 38.35 |
|        screen       | 52.95 | 69.19 |
|       blanket       |  6.5  |  6.83 |
|      sculpture      |  37.8 | 57.26 |
|         hood        | 36.78 | 37.76 |
|        sconce       | 26.48 | 30.46 |
|         vase        | 34.39 | 43.85 |
|    traffic light    | 20.93 | 26.01 |
|         tray        |  4.6  |  10.9 |
|        ashcan       | 27.25 |  31.4 |
|         fan         | 50.16 | 57.95 |
|         pier        | 26.64 | 33.54 |
|      crt screen     | 10.09 | 26.06 |
|        plate        | 40.44 | 47.68 |
|       monitor       | 55.45 | 62.95 |
|    bulletin board   | 25.08 | 28.07 |
|        shower       |  0.33 |  1.12 |
|       radiator      | 33.29 | 34.83 |
|        glass        |  9.16 |  9.44 |
|        clock        | 23.58 | 26.41 |
|         flag        | 35.79 | 37.17 |
+---------------------+-------+-------+
09/15 14:44:24 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 77.9100  mIoU: 39.3900  mAcc: 48.1500  data_time: 0.0017  time: 0.1464
Finished processing corruption type: impulse_noise
Processing corruption type: defocus_blur
09/15 14:44:27 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 2131320523
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 2131320523
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 14:44:27 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='defocus_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/defocus_blur'

09/15 14:44:31 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 14:44:31 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 14:44:31 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 14:44:31 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 14:45:24 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:33:52  time: 0.5933  data_time: 0.0016  memory: 19841  
09/15 14:45:50 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:24:47  time: 0.3930  data_time: 0.0016  memory: 19792  
09/15 14:45:59 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:00  time: 0.1868  data_time: 0.0016  memory: 13446  
09/15 14:46:12 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:15:06  time: 0.2639  data_time: 0.0015  memory: 16826  
09/15 14:46:23 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:12:59  time: 0.1056  data_time: 0.0015  memory: 16834  
09/15 14:46:32 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:11:22  time: 0.0742  data_time: 0.0016  memory: 13449  
09/15 14:46:43 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:10:20  time: 0.1431  data_time: 0.0015  memory: 13451  
09/15 14:46:53 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:09:24  time: 0.1877  data_time: 0.0015  memory: 13451  
09/15 14:46:57 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:08:22  time: 0.0875  data_time: 0.0015  memory: 8614  
09/15 14:47:02 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:07:31  time: 0.0696  data_time: 0.0014  memory: 13440  
09/15 14:47:08 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:06:52  time: 0.1919  data_time: 0.0015  memory: 8622  
09/15 14:47:14 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:06:18  time: 0.1567  data_time: 0.0017  memory: 8622  
09/15 14:47:21 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:05:52  time: 0.2113  data_time: 0.0014  memory: 13453  
09/15 14:47:29 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:05:29  time: 0.0720  data_time: 0.0017  memory: 13451  
09/15 14:47:37 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:05:09  time: 0.2406  data_time: 0.0015  memory: 13456  
09/15 14:47:42 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:04:45  time: 0.0700  data_time: 0.0016  memory: 8615  
09/15 14:47:46 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:04:22  time: 0.0735  data_time: 0.0022  memory: 633  
09/15 14:47:50 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:04:02  time: 0.0864  data_time: 0.0014  memory: 8609  
09/15 14:47:57 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:03:46  time: 0.1040  data_time: 0.0015  memory: 13441  
09/15 14:48:03 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:03:31  time: 0.0946  data_time: 0.0015  memory: 8622  
09/15 14:48:11 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:03:18  time: 0.2318  data_time: 0.0015  memory: 13453  
09/15 14:48:16 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:03:04  time: 0.0705  data_time: 0.0015  memory: 13446  
09/15 14:48:22 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:02:50  time: 0.0898  data_time: 0.0015  memory: 13442  
09/15 14:48:25 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:02:35  time: 0.0673  data_time: 0.0015  memory: 1829  
09/15 14:48:31 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:02:23  time: 0.1093  data_time: 0.0015  memory: 13447  
09/15 14:48:34 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:02:10  time: 0.0727  data_time: 0.0015  memory: 633  
09/15 14:48:38 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:01:58  time: 0.0696  data_time: 0.0015  memory: 8599  
09/15 14:48:46 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:01:49  time: 0.1862  data_time: 0.0015  memory: 13448  
09/15 14:48:51 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:01:38  time: 0.1183  data_time: 0.0015  memory: 8609  
09/15 14:48:54 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:27  time: 0.0682  data_time: 0.0014  memory: 633  
09/15 14:48:59 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:17  time: 0.0730  data_time: 0.0015  memory: 8620  
09/15 14:49:03 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:07  time: 0.0703  data_time: 0.0016  memory: 624  
09/15 14:49:09 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:00:58  time: 0.0703  data_time: 0.0014  memory: 16824  
09/15 14:49:15 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:00:49  time: 0.0706  data_time: 0.0016  memory: 8612  
09/15 14:49:19 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:41  time: 0.0725  data_time: 0.0014  memory: 8618  
09/15 14:49:23 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:32  time: 0.0723  data_time: 0.0016  memory: 8600  
09/15 14:49:27 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:23  time: 0.0690  data_time: 0.0016  memory: 582  
09/15 14:49:32 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:15  time: 0.0713  data_time: 0.0015  memory: 8626  
09/15 14:49:37 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:07  time: 0.0854  data_time: 0.0014  memory: 16829  
09/15 14:49:41 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0674  data_time: 0.0013  memory: 8626  
09/15 14:49:41 - mmengine - INFO - per class results:
09/15 14:49:41 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.59 | 87.44 |
|       building      | 80.13 | 92.01 |
|         sky         | 93.72 | 97.08 |
|        floor        | 79.38 | 89.79 |
|         tree        | 72.17 | 85.54 |
|       ceiling       | 82.62 | 90.49 |
|         road        | 82.32 | 89.41 |
|         bed         | 87.02 | 94.99 |
|      windowpane     | 57.63 | 76.43 |
|        grass        | 66.67 |  84.1 |
|       cabinet       | 57.75 | 71.68 |
|       sidewalk      | 62.59 | 79.68 |
|        person       | 75.19 | 88.73 |
|        earth        | 35.41 |  49.6 |
|         door        | 45.37 | 56.67 |
|        table        | 53.73 | 71.77 |
|       mountain      | 55.16 | 70.81 |
|        plant        | 49.87 | 60.96 |
|       curtain       | 71.99 | 82.59 |
|        chair        | 51.68 | 66.49 |
|         car         | 81.95 | 91.32 |
|        water        | 59.47 | 75.03 |
|       painting      | 67.17 | 81.21 |
|         sofa        | 60.24 | 78.53 |
|        shelf        | 42.19 | 60.79 |
|        house        | 39.98 | 54.62 |
|         sea         | 60.27 | 75.79 |
|        mirror       | 60.13 | 70.55 |
|         rug         | 58.64 | 70.18 |
|        field        | 32.44 | 46.14 |
|       armchair      | 39.07 | 55.99 |
|         seat        |  59.9 | 79.36 |
|        fence        | 39.39 |  52.7 |
|         desk        | 46.14 | 66.12 |
|         rock        | 40.33 | 67.14 |
|       wardrobe      | 45.14 | 65.22 |
|         lamp        | 57.11 |  72.2 |
|       bathtub       |  73.3 | 79.84 |
|       railing       | 30.91 | 46.21 |
|       cushion       |  49.4 |  59.8 |
|         base        | 26.89 | 37.41 |
|         box         | 21.12 | 27.98 |
|        column       | 43.92 | 53.87 |
|      signboard      | 31.78 | 42.62 |
|   chest of drawers  | 41.13 | 55.77 |
|       counter       | 22.51 | 32.21 |
|         sand        | 38.38 |  53.7 |
|         sink        | 66.79 | 75.13 |
|      skyscraper     | 48.33 | 59.95 |
|      fireplace      | 71.23 | 82.61 |
|     refrigerator    | 67.29 |  77.0 |
|      grandstand     | 35.72 |  61.7 |
|         path        |  16.4 | 25.22 |
|        stairs       |  19.5 | 22.71 |
|        runway       | 68.66 | 89.04 |
|         case        | 50.59 | 61.28 |
|      pool table     | 89.55 | 94.68 |
|        pillow       | 51.99 | 62.23 |
|     screen door     | 74.16 | 79.17 |
|       stairway      | 22.59 | 34.62 |
|        river        |  8.1  | 13.27 |
|        bridge       | 30.57 | 37.37 |
|       bookcase      | 37.05 | 66.02 |
|        blind        | 33.82 | 35.78 |
|     coffee table    | 51.91 | 74.65 |
|        toilet       | 78.64 |  89.4 |
|        flower       | 38.75 | 50.46 |
|         book        | 40.22 | 55.42 |
|         hill        | 10.02 | 17.15 |
|        bench        | 37.48 | 47.13 |
|      countertop     | 56.39 | 71.72 |
|        stove        |  70.1 | 79.38 |
|         palm        |  42.6 | 49.46 |
|    kitchen island   | 38.33 | 66.99 |
|       computer      | 55.77 | 66.29 |
|     swivel chair    | 41.55 | 62.77 |
|         boat        | 59.36 | 83.05 |
|         bar         | 46.33 |  56.4 |
|    arcade machine   | 72.95 | 86.26 |
|        hovel        | 28.07 | 30.64 |
|         bus         | 81.73 | 94.55 |
|        towel        | 59.56 | 73.87 |
|        light        | 48.15 | 55.35 |
|        truck        | 36.33 |  50.1 |
|        tower        | 10.04 | 16.98 |
|      chandelier     | 60.12 | 73.78 |
|        awning       | 24.79 | 29.38 |
|     streetlight     | 18.68 | 25.64 |
|        booth        | 56.98 | 67.34 |
| television receiver | 61.03 | 75.99 |
|       airplane      | 50.87 | 65.19 |
|      dirt track     | 12.11 | 41.35 |
|       apparel       | 24.78 | 35.34 |
|         pole        | 13.87 | 16.67 |
|         land        |  3.63 |  6.82 |
|      bannister      |  5.97 |  8.58 |
|      escalator      | 24.48 | 29.16 |
|       ottoman       | 43.22 | 54.61 |
|        bottle       | 31.42 | 44.12 |
|        buffet       | 45.76 |  52.3 |
|        poster       | 27.87 | 34.31 |
|        stage        | 14.56 | 27.33 |
|         van         | 42.86 | 51.75 |
|         ship        | 39.71 | 41.68 |
|       fountain      | 22.77 | 24.82 |
|    conveyer belt    | 80.82 | 88.01 |
|        canopy       | 32.85 | 36.91 |
|        washer       |  62.4 | 66.74 |
|      plaything      | 13.59 | 25.29 |
|    swimming pool    | 52.83 | 80.66 |
|        stool        | 33.87 | 43.12 |
|        barrel       | 47.44 |  64.0 |
|        basket       | 17.71 | 19.49 |
|      waterfall      |  70.5 | 93.22 |
|         tent        | 92.23 |  97.9 |
|         bag         |  4.63 |  5.23 |
|       minibike      | 66.05 | 77.28 |
|        cradle       | 75.39 | 95.19 |
|         oven        | 29.13 | 43.65 |
|         ball        | 25.07 | 25.54 |
|         food        | 43.41 | 51.71 |
|         step        |  2.57 |  2.85 |
|         tank        | 41.05 | 44.24 |
|      trade name     | 18.32 | 19.58 |
|      microwave      | 73.29 | 80.71 |
|         pot         | 42.84 |  50.1 |
|        animal       | 49.83 | 52.96 |
|       bicycle       | 47.78 | 64.94 |
|         lake        | 51.58 | 64.28 |
|      dishwasher     | 52.05 | 63.06 |
|        screen       | 60.79 | 84.93 |
|       blanket       |  8.82 | 10.48 |
|      sculpture      | 44.61 | 58.88 |
|         hood        | 48.74 | 56.17 |
|        sconce       | 41.19 | 52.44 |
|         vase        | 30.45 |  38.7 |
|    traffic light    | 28.39 | 46.71 |
|         tray        |  5.57 |  8.79 |
|        ashcan       | 30.17 | 37.77 |
|         fan         | 56.49 | 70.96 |
|         pier        | 30.25 | 47.14 |
|      crt screen     | 19.52 |  26.0 |
|        plate        | 35.39 | 46.87 |
|       monitor       | 42.56 | 64.44 |
|    bulletin board   | 41.32 | 55.75 |
|        shower       |  0.85 |  0.9  |
|       radiator      | 42.29 | 45.73 |
|        glass        |  5.17 |  5.38 |
|        clock        | 33.45 | 39.99 |
|         flag        | 47.29 | 50.31 |
+---------------------+-------+-------+
09/15 14:49:41 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.3100  mIoU: 45.3800  mAcc: 56.7000  data_time: 0.0017  time: 0.1549
Finished processing corruption type: defocus_blur
Processing corruption type: glass_blur
09/15 14:49:45 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 669795400
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 669795400
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 14:49:45 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='glass_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/glass_blur'

09/15 14:49:48 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 14:49:48 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 14:49:48 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 14:49:49 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 14:56:14 - mmengine - INFO - Iter(test) [  50/2000]    eta: 4:10:35  time: 7.6426  data_time: 0.0016  memory: 19841  
09/15 15:02:14 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 3:55:47  time: 7.2875  data_time: 0.0016  memory: 19792  
09/15 15:07:54 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 3:43:03  time: 7.0185  data_time: 0.0016  memory: 13446  
09/15 15:13:43 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 3:35:04  time: 6.7842  data_time: 0.0015  memory: 16826  
09/15 15:19:13 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 3:25:45  time: 6.5725  data_time: 0.0015  memory: 16834  
09/15 15:24:39 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 3:17:23  time: 6.7849  data_time: 0.0016  memory: 13449  
09/15 15:30:15 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 3:10:38  time: 6.3422  data_time: 0.0023  memory: 13451  
09/15 15:35:51 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 3:04:06  time: 6.8979  data_time: 0.0015  memory: 13451  
09/15 15:40:52 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 2:55:52  time: 6.1275  data_time: 0.0015  memory: 8614  
09/15 15:46:21 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 2:49:36  time: 6.3905  data_time: 0.0016  memory: 13440  
09/15 15:52:11 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 2:44:24  time: 7.0236  data_time: 0.0016  memory: 8622  
09/15 15:57:38 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 2:38:14  time: 6.8833  data_time: 0.0017  memory: 8622  
09/15 16:03:13 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 2:32:26  time: 7.2229  data_time: 0.0015  memory: 13453  
09/15 16:09:02 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 2:27:07  time: 6.8309  data_time: 0.0017  memory: 13451  
09/15 16:14:43 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 2:21:30  time: 6.6265  data_time: 0.0015  memory: 13456  
09/15 16:19:56 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 2:15:11  time: 6.6195  data_time: 0.0017  memory: 8615  
09/15 16:25:26 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 2:09:22  time: 6.6453  data_time: 0.0017  memory: 633  
09/15 16:30:30 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 2:03:03  time: 5.8753  data_time: 0.0015  memory: 8609  
09/15 16:36:07 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 1:57:28  time: 6.4688  data_time: 0.0019  memory: 13441  
09/15 16:41:23 - mmengine - INFO - Iter(test) [1000/2000]    eta: 1:51:33  time: 6.2810  data_time: 0.0016  memory: 8622  
09/15 16:47:02 - mmengine - INFO - Iter(test) [1050/2000]    eta: 1:46:03  time: 7.0004  data_time: 0.0016  memory: 13453  
09/15 16:52:32 - mmengine - INFO - Iter(test) [1100/2000]    eta: 1:40:24  time: 6.4625  data_time: 0.0016  memory: 13446  
09/15 16:57:54 - mmengine - INFO - Iter(test) [1150/2000]    eta: 1:34:40  time: 6.6007  data_time: 0.0015  memory: 13442  
09/15 17:03:27 - mmengine - INFO - Iter(test) [1200/2000]    eta: 1:29:05  time: 6.3971  data_time: 0.0015  memory: 1829  
09/15 17:08:44 - mmengine - INFO - Iter(test) [1250/2000]    eta: 1:23:21  time: 6.3831  data_time: 0.0015  memory: 13447  
09/15 17:13:51 - mmengine - INFO - Iter(test) [1300/2000]    eta: 1:17:33  time: 6.5590  data_time: 0.0015  memory: 633  
09/15 17:19:13 - mmengine - INFO - Iter(test) [1350/2000]    eta: 1:11:56  time: 6.0544  data_time: 0.0015  memory: 8599  
09/15 17:24:41 - mmengine - INFO - Iter(test) [1400/2000]    eta: 1:06:22  time: 6.9529  data_time: 0.0015  memory: 13448  
09/15 17:29:52 - mmengine - INFO - Iter(test) [1450/2000]    eta: 1:00:42  time: 6.7903  data_time: 0.0015  memory: 8609  
09/15 17:35:09 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:55:06  time: 6.0444  data_time: 0.0015  memory: 633  
09/15 17:40:50 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:49:39  time: 6.6793  data_time: 0.0016  memory: 8620  
09/15 17:46:07 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:44:04  time: 6.4124  data_time: 0.0016  memory: 624  
09/15 17:51:28 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:38:31  time: 6.0257  data_time: 0.0015  memory: 16824  
09/15 17:57:01 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:33:02  time: 6.5450  data_time: 0.0016  memory: 8612  
09/15 18:02:33 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:27:32  time: 6.4517  data_time: 0.0014  memory: 8618  
09/15 18:07:47 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:21:59  time: 6.6697  data_time: 0.0017  memory: 8600  
09/15 18:13:15 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:16:29  time: 6.5590  data_time: 0.0017  memory: 582  
09/15 18:18:24 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:10:58  time: 6.3537  data_time: 0.0015  memory: 8626  
09/15 18:23:55 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:05:29  time: 6.3393  data_time: 0.0016  memory: 16829  
09/15 18:29:10 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 5.9585  data_time: 0.0014  memory: 8626  
09/15 18:29:10 - mmengine - INFO - per class results:
09/15 18:29:10 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.42 | 88.96 |
|       building      | 80.65 | 91.27 |
|         sky         |  93.7 | 97.77 |
|        floor        | 79.22 | 89.64 |
|         tree        | 72.24 | 86.99 |
|       ceiling       | 82.36 | 91.76 |
|         road        | 82.15 | 90.77 |
|         bed         | 87.03 | 94.16 |
|      windowpane     | 55.72 | 71.49 |
|        grass        | 66.29 |  82.9 |
|       cabinet       | 56.74 | 69.66 |
|       sidewalk      | 60.79 | 71.91 |
|        person       | 76.26 | 90.27 |
|        earth        | 37.05 | 52.48 |
|         door        | 47.11 | 56.79 |
|        table        | 55.07 | 72.27 |
|       mountain      | 54.97 | 68.67 |
|        plant        | 48.42 | 60.13 |
|       curtain       | 67.96 | 83.35 |
|        chair        | 51.49 | 66.69 |
|         car         | 81.68 | 89.75 |
|        water        | 53.95 |  72.3 |
|       painting      | 69.79 | 81.45 |
|         sofa        | 63.07 | 81.13 |
|        shelf        |  42.0 | 60.98 |
|        house        | 44.18 | 59.92 |
|         sea         | 55.67 | 77.87 |
|        mirror       |  58.8 | 75.16 |
|         rug         | 58.49 | 71.01 |
|        field        | 26.38 | 41.57 |
|       armchair      | 34.99 | 47.09 |
|         seat        | 63.66 | 80.93 |
|        fence        | 39.05 | 55.77 |
|         desk        | 43.94 | 62.16 |
|         rock        | 35.45 | 56.74 |
|       wardrobe      | 42.61 |  57.2 |
|         lamp        | 58.47 | 70.52 |
|       bathtub       | 72.51 | 77.34 |
|       railing       |  30.4 | 39.21 |
|       cushion       | 50.11 | 66.47 |
|         base        | 18.91 | 25.74 |
|         box         | 21.59 | 28.84 |
|        column       | 44.77 | 55.41 |
|      signboard      | 30.51 |  40.4 |
|   chest of drawers  | 36.92 | 56.94 |
|       counter       | 20.17 |  26.0 |
|         sand        | 40.64 | 57.32 |
|         sink        | 67.57 | 75.88 |
|      skyscraper     | 67.56 | 84.64 |
|      fireplace      | 68.68 |  84.2 |
|     refrigerator    | 67.54 | 72.77 |
|      grandstand     | 30.59 | 66.59 |
|         path        | 16.91 | 26.43 |
|        stairs       | 19.78 | 23.64 |
|        runway       | 84.13 | 85.82 |
|         case        | 48.21 | 56.13 |
|      pool table     | 89.23 | 92.86 |
|        pillow       | 48.13 | 57.82 |
|     screen door     | 66.05 | 68.92 |
|       stairway      | 26.32 | 39.95 |
|        river        |  6.4  |  8.26 |
|        bridge       | 32.22 | 36.33 |
|       bookcase      | 43.29 |  58.6 |
|        blind        | 32.17 |  33.2 |
|     coffee table    | 54.48 | 74.91 |
|        toilet       | 77.76 | 86.18 |
|        flower       | 35.87 | 53.96 |
|         book        | 42.22 | 56.84 |
|         hill        | 10.84 | 21.09 |
|        bench        | 34.43 | 40.07 |
|      countertop     |  53.5 | 64.04 |
|        stove        | 66.45 | 76.19 |
|         palm        | 40.17 | 44.63 |
|    kitchen island   | 29.42 | 49.56 |
|       computer      | 55.53 | 65.65 |
|     swivel chair    |  42.3 |  58.7 |
|         boat        | 57.76 | 72.63 |
|         bar         | 37.05 | 45.43 |
|    arcade machine   | 68.31 | 76.54 |
|        hovel        | 51.94 | 61.36 |
|         bus         | 82.37 | 90.55 |
|        towel        | 59.57 | 73.52 |
|        light        | 43.33 | 49.05 |
|        truck        | 33.17 | 52.57 |
|        tower        |  7.25 | 13.01 |
|      chandelier     | 63.34 | 78.79 |
|        awning       |  24.9 |  28.7 |
|     streetlight     | 18.35 | 24.83 |
|        booth        |  48.2 | 51.25 |
| television receiver |  57.7 | 66.29 |
|       airplane      | 51.09 | 62.49 |
|      dirt track     |  16.7 | 46.92 |
|       apparel       | 28.46 | 43.51 |
|         pole        | 13.79 | 16.96 |
|         land        |  3.75 |  7.82 |
|      bannister      |  2.54 |  3.12 |
|      escalator      | 22.77 | 24.11 |
|       ottoman       | 45.01 | 54.94 |
|        bottle       | 31.11 | 50.97 |
|        buffet       | 46.67 | 52.75 |
|        poster       | 23.12 | 25.87 |
|        stage        | 19.79 | 28.05 |
|         van         | 38.64 | 52.36 |
|         ship        | 25.63 | 27.45 |
|       fountain      | 20.94 | 23.09 |
|    conveyer belt    | 82.05 | 85.96 |
|        canopy       | 23.27 | 27.67 |
|        washer       | 56.19 |  59.9 |
|      plaything      |  21.6 | 29.52 |
|    swimming pool    | 46.83 | 84.41 |
|        stool        | 34.79 | 48.21 |
|        barrel       | 47.45 |  63.9 |
|        basket       | 20.09 |  22.3 |
|      waterfall      |  67.3 | 89.07 |
|         tent        | 94.43 | 97.54 |
|         bag         |  4.78 |  5.79 |
|       minibike      | 63.29 | 73.78 |
|        cradle       | 75.56 | 95.18 |
|         oven        |  26.8 |  47.1 |
|         ball        | 24.22 | 24.63 |
|         food        | 41.97 | 51.92 |
|         step        |  0.38 |  0.39 |
|         tank        | 45.34 | 48.93 |
|      trade name     | 14.09 | 14.65 |
|      microwave      | 47.06 | 50.56 |
|         pot         | 39.02 | 45.13 |
|        animal       | 53.45 | 58.31 |
|       bicycle       | 48.64 | 67.52 |
|         lake        |  62.8 | 63.22 |
|      dishwasher     |  50.8 | 57.51 |
|        screen       | 58.16 | 64.98 |
|       blanket       |  6.02 |  7.68 |
|      sculpture      | 51.37 | 62.58 |
|         hood        | 46.91 | 48.55 |
|        sconce       | 43.37 | 54.37 |
|         vase        | 31.97 | 39.78 |
|    traffic light    | 28.98 | 41.98 |
|         tray        |  5.79 | 11.03 |
|        ashcan       | 28.32 | 33.88 |
|         fan         | 55.42 | 64.28 |
|         pier        | 32.49 |  37.6 |
|      crt screen     | 16.82 | 32.35 |
|        plate        | 34.55 | 39.68 |
|       monitor       | 46.63 |  55.7 |
|    bulletin board   | 44.55 | 58.42 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 48.01 | 53.43 |
|        glass        |  5.56 |  5.6  |
|        clock        |  32.1 | 36.05 |
|         flag        | 22.86 | 24.03 |
+---------------------+-------+-------+
09/15 18:29:10 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.2000  mIoU: 44.6800  mAcc: 54.9800  data_time: 0.0018  time: 6.5803
Finished processing corruption type: glass_blur
Processing corruption type: motion_blur
09/15 18:29:13 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1816740504
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1816740504
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 18:29:13 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='motion_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/motion_blur'

09/15 18:29:16 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 18:29:16 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 18:29:17 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 18:29:18 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 18:31:08 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:11:37  time: 1.2666  data_time: 0.0015  memory: 19841  
09/15 18:32:11 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:54:41  time: 1.1380  data_time: 0.0015  memory: 19792  
09/15 18:32:54 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:44:22  time: 0.8743  data_time: 0.0015  memory: 13446  
09/15 18:33:42 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:39:33  time: 0.9286  data_time: 0.0015  memory: 16826  
09/15 18:34:27 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:35:59  time: 0.8172  data_time: 0.0015  memory: 16834  
09/15 18:35:10 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:33:13  time: 0.8151  data_time: 0.0016  memory: 13449  
09/15 18:35:54 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:31:08  time: 0.7722  data_time: 0.0014  memory: 13451  
09/15 18:36:39 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:29:21  time: 0.9128  data_time: 0.0014  memory: 13451  
09/15 18:37:15 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:27:21  time: 0.7338  data_time: 0.0014  memory: 8614  
09/15 18:37:54 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:25:47  time: 0.7338  data_time: 0.0014  memory: 13440  
09/15 18:38:36 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:24:30  time: 0.9196  data_time: 0.0015  memory: 8622  
09/15 18:39:13 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:23:09  time: 0.8261  data_time: 0.0016  memory: 8622  
09/15 18:39:56 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:22:03  time: 0.9022  data_time: 0.0013  memory: 13453  
09/15 18:40:40 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:21:06  time: 0.7934  data_time: 0.0016  memory: 13451  
09/15 18:41:24 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:20:10  time: 0.8970  data_time: 0.0043  memory: 13456  
09/15 18:42:02 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:19:05  time: 0.7896  data_time: 0.0016  memory: 8615  
09/15 18:42:40 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:18:04  time: 0.7387  data_time: 0.0016  memory: 633  
09/15 18:43:15 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:17:03  time: 0.7012  data_time: 0.0014  memory: 8609  
09/15 18:43:58 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:16:12  time: 0.8024  data_time: 0.0015  memory: 13441  
09/15 18:44:37 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:15:18  time: 0.7275  data_time: 0.0015  memory: 8622  
09/15 18:45:19 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:14:29  time: 0.9750  data_time: 0.0015  memory: 13453  
09/15 18:46:00 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:13:39  time: 0.7481  data_time: 0.0015  memory: 13446  
09/15 18:46:38 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:12:48  time: 0.7838  data_time: 0.0015  memory: 13442  
09/15 18:47:18 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:11:59  time: 0.7571  data_time: 0.0024  memory: 1829  
09/15 18:47:57 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:11:11  time: 0.7696  data_time: 0.0014  memory: 13447  
09/15 18:48:32 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:10:21  time: 0.7495  data_time: 0.0015  memory: 633  
09/15 18:49:11 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:09:34  time: 0.7067  data_time: 0.0015  memory: 8599  
09/15 18:49:53 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:08:49  time: 0.9572  data_time: 0.0015  memory: 13448  
09/15 18:50:30 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:08:02  time: 0.8540  data_time: 0.0015  memory: 8609  
09/15 18:51:08 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:07:16  time: 0.6940  data_time: 0.0015  memory: 633  
09/15 18:51:48 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:06:31  time: 0.7827  data_time: 0.0023  memory: 8620  
09/15 18:52:23 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:46  time: 0.7110  data_time: 0.0017  memory: 624  
09/15 18:53:03 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:05:02  time: 0.7089  data_time: 0.0014  memory: 16824  
09/15 18:53:44 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:18  time: 0.7910  data_time: 0.0017  memory: 8612  
09/15 18:54:24 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:35  time: 0.8166  data_time: 0.0016  memory: 8618  
09/15 18:55:00 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:51  time: 0.7508  data_time: 0.0016  memory: 8600  
09/15 18:55:37 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:07  time: 0.7218  data_time: 0.0016  memory: 582  
09/15 18:56:13 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:25  time: 0.7543  data_time: 0.0015  memory: 8626  
09/15 18:56:56 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:42  time: 0.7822  data_time: 0.0015  memory: 16829  
09/15 18:57:33 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6684  data_time: 0.0014  memory: 8626  
09/15 18:57:33 - mmengine - INFO - per class results:
09/15 18:57:33 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.89 | 86.68 |
|       building      |  80.7 |  92.8 |
|         sky         | 93.35 | 96.82 |
|        floor        | 79.53 |  89.9 |
|         tree        | 71.32 | 84.68 |
|       ceiling       | 82.21 | 92.23 |
|         road        | 80.63 | 88.41 |
|         bed         | 87.11 | 95.09 |
|      windowpane     | 57.98 | 74.47 |
|        grass        | 66.46 | 86.71 |
|       cabinet       | 56.01 | 69.52 |
|       sidewalk      | 62.16 | 81.54 |
|        person       | 74.59 | 89.18 |
|        earth        | 34.27 | 46.22 |
|         door        | 46.25 | 57.69 |
|        table        | 53.44 | 70.73 |
|       mountain      | 51.68 | 70.26 |
|        plant        | 49.17 | 58.99 |
|       curtain       | 69.49 |  83.7 |
|        chair        | 51.55 |  67.4 |
|         car         | 81.85 | 91.46 |
|        water        | 52.39 |  70.4 |
|       painting      | 68.03 | 82.33 |
|         sofa        | 61.43 | 82.66 |
|        shelf        | 41.47 | 60.22 |
|        house        | 43.35 | 54.17 |
|         sea         | 56.43 | 76.09 |
|        mirror       | 59.17 |  69.4 |
|         rug         | 59.15 | 71.92 |
|        field        | 31.89 | 41.97 |
|       armchair      | 37.27 | 48.64 |
|         seat        | 56.78 | 76.11 |
|        fence        | 39.79 | 57.71 |
|         desk        | 47.44 | 67.54 |
|         rock        | 34.41 | 52.06 |
|       wardrobe      | 42.74 |  61.1 |
|         lamp        | 54.94 | 70.92 |
|       bathtub       | 74.35 |  79.7 |
|       railing       |  32.8 | 48.35 |
|       cushion       | 50.28 | 64.08 |
|         base        | 29.75 | 40.95 |
|         box         | 24.21 | 33.58 |
|        column       | 44.16 | 55.97 |
|      signboard      | 33.26 | 46.92 |
|   chest of drawers  | 39.53 | 56.27 |
|       counter       | 18.96 |  26.6 |
|         sand        | 34.63 | 56.83 |
|         sink        | 68.85 | 77.13 |
|      skyscraper     | 43.34 | 51.81 |
|      fireplace      | 71.12 | 85.15 |
|     refrigerator    | 69.04 | 79.08 |
|      grandstand     | 36.94 | 66.16 |
|         path        | 13.08 | 18.95 |
|        stairs       |  22.1 |  25.4 |
|        runway       | 69.88 | 91.81 |
|         case        | 46.22 | 59.53 |
|      pool table     | 89.34 | 94.04 |
|        pillow       | 52.26 | 64.98 |
|     screen door     |  64.0 | 78.59 |
|       stairway      | 25.72 | 34.81 |
|        river        | 12.74 | 19.54 |
|        bridge       | 36.61 | 42.54 |
|       bookcase      | 43.23 | 61.84 |
|        blind        |  43.5 | 50.06 |
|     coffee table    | 50.55 | 78.28 |
|        toilet       | 80.96 | 90.27 |
|        flower       | 34.99 | 47.95 |
|         book        | 43.78 | 61.52 |
|         hill        |  9.11 | 15.96 |
|        bench        | 38.89 |  45.7 |
|      countertop     | 58.22 | 73.74 |
|        stove        | 71.56 | 82.68 |
|         palm        | 44.29 | 59.86 |
|    kitchen island   | 37.85 | 67.98 |
|       computer      | 55.93 | 66.02 |
|     swivel chair    | 43.36 | 59.65 |
|         boat        | 64.32 | 83.52 |
|         bar         | 45.93 | 52.87 |
|    arcade machine   | 55.97 | 60.76 |
|        hovel        | 47.91 | 54.73 |
|         bus         | 82.32 | 93.95 |
|        towel        | 60.19 | 73.96 |
|        light        | 50.02 | 59.39 |
|        truck        | 37.04 | 52.08 |
|        tower        | 10.28 | 14.75 |
|      chandelier     | 60.73 | 72.86 |
|        awning       | 25.64 | 30.61 |
|     streetlight     | 18.92 | 25.94 |
|        booth        | 50.45 | 54.18 |
| television receiver | 62.68 | 74.79 |
|       airplane      | 49.55 | 65.21 |
|      dirt track     | 18.26 | 54.04 |
|       apparel       | 25.59 | 35.81 |
|         pole        | 14.07 | 18.07 |
|         land        |  4.43 |  7.33 |
|      bannister      |  9.33 | 12.23 |
|      escalator      | 29.51 | 34.12 |
|       ottoman       | 38.36 | 44.99 |
|        bottle       | 32.48 | 53.55 |
|        buffet       | 40.38 |  47.5 |
|        poster       | 31.96 |  40.1 |
|        stage        | 19.46 | 25.96 |
|         van         | 39.51 | 48.96 |
|         ship        |  8.79 |  9.08 |
|       fountain      | 18.42 | 19.98 |
|    conveyer belt    | 82.52 | 88.53 |
|        canopy       | 25.33 | 27.93 |
|        washer       | 66.03 | 70.83 |
|      plaything      |  15.3 | 21.22 |
|    swimming pool    | 39.23 | 52.18 |
|        stool        | 32.91 | 43.17 |
|        barrel       | 48.91 | 63.83 |
|        basket       | 23.09 | 30.93 |
|      waterfall      | 42.38 | 51.01 |
|         tent        | 93.18 | 97.63 |
|         bag         |  7.69 | 10.31 |
|       minibike      | 64.15 | 78.13 |
|        cradle       | 74.81 | 92.32 |
|         oven        | 21.39 | 57.17 |
|         ball        |  21.0 | 21.51 |
|         food        | 38.43 |  43.4 |
|         step        |  5.87 |  6.81 |
|         tank        | 44.35 |  47.8 |
|      trade name     | 20.74 | 22.28 |
|      microwave      | 41.87 | 45.19 |
|         pot         | 39.76 | 46.89 |
|        animal       | 52.02 | 58.41 |
|       bicycle       |  49.8 | 74.04 |
|         lake        | 54.16 | 59.81 |
|      dishwasher     | 55.07 | 67.72 |
|        screen       | 62.43 | 85.03 |
|       blanket       |  11.2 | 14.71 |
|      sculpture      | 48.42 | 59.36 |
|         hood        | 50.05 | 55.68 |
|        sconce       | 41.41 | 56.63 |
|         vase        | 35.11 | 45.79 |
|    traffic light    | 27.32 | 43.44 |
|         tray        |  6.72 | 12.99 |
|        ashcan       | 30.26 | 42.62 |
|         fan         | 56.45 | 74.73 |
|         pier        | 46.53 | 66.24 |
|      crt screen     | 16.64 |  24.0 |
|        plate        | 40.81 | 57.61 |
|       monitor       | 47.13 |  62.1 |
|    bulletin board   | 39.94 | 59.82 |
|        shower       |  0.75 |  0.79 |
|       radiator      | 53.12 | 57.34 |
|        glass        |  9.95 | 10.39 |
|        clock        | 35.33 | 40.79 |
|         flag        | 36.77 | 39.49 |
+---------------------+-------+-------+
09/15 18:57:34 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.1300  mIoU: 45.0600  mAcc: 56.5900  data_time: 0.0017  time: 0.8476
Finished processing corruption type: motion_blur
Processing corruption type: zoom_blur
09/15 18:57:37 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 2031344966
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 2031344966
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 18:57:37 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='zoom_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/zoom_blur'

09/15 18:57:40 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 18:57:40 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 18:57:40 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 18:57:41 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 18:59:00 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:51:14  time: 1.2008  data_time: 0.0015  memory: 19841  
09/15 18:59:59 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:43:41  time: 1.1186  data_time: 0.0017  memory: 19792  
09/15 19:00:41 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:37:06  time: 0.8537  data_time: 0.0016  memory: 13446  
09/15 19:01:26 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:33:41  time: 0.8591  data_time: 0.0016  memory: 16826  
09/15 19:02:06 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:30:55  time: 0.7176  data_time: 0.0015  memory: 16834  
09/15 19:02:44 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:28:39  time: 0.7091  data_time: 0.0016  memory: 13449  
09/15 19:03:25 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:27:03  time: 0.6939  data_time: 0.0015  memory: 13451  
09/15 19:04:06 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:25:39  time: 0.8127  data_time: 0.0014  memory: 13451  
09/15 19:04:39 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:23:58  time: 0.6557  data_time: 0.0015  memory: 8614  
09/15 19:05:14 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:22:39  time: 0.6824  data_time: 0.0015  memory: 13440  
09/15 19:05:54 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:21:38  time: 0.8471  data_time: 0.0015  memory: 8622  
09/15 19:06:29 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:20:32  time: 0.7960  data_time: 0.0016  memory: 8622  
09/15 19:07:07 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:19:36  time: 0.8322  data_time: 0.0014  memory: 13453  
09/15 19:07:47 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:18:46  time: 0.7141  data_time: 0.0016  memory: 13451  
09/15 19:08:27 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:17:56  time: 0.7993  data_time: 0.0014  memory: 13456  
09/15 19:09:00 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:16:58  time: 0.6903  data_time: 0.0016  memory: 8615  
09/15 19:09:35 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:16:05  time: 0.7071  data_time: 0.0016  memory: 633  
09/15 19:10:07 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:15:12  time: 0.6349  data_time: 0.0015  memory: 8609  
09/15 19:10:45 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:14:27  time: 0.7066  data_time: 0.0015  memory: 13441  
09/15 19:11:21 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:13:39  time: 0.6474  data_time: 0.0015  memory: 8622  
09/15 19:12:00 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:12:57  time: 0.8712  data_time: 0.0015  memory: 13453  
09/15 19:12:36 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:12:12  time: 0.6747  data_time: 0.0015  memory: 13446  
09/15 19:13:11 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:11:27  time: 0.7071  data_time: 0.0015  memory: 13442  
09/15 19:13:46 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:10:43  time: 0.6718  data_time: 0.0015  memory: 1829  
09/15 19:14:21 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:10:00  time: 0.6842  data_time: 0.0015  memory: 13447  
09/15 19:14:54 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:09:16  time: 0.6894  data_time: 0.0016  memory: 633  
09/15 19:15:28 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:08:33  time: 0.6384  data_time: 0.0015  memory: 8599  
09/15 19:16:06 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:07:53  time: 0.8356  data_time: 0.0014  memory: 13448  
09/15 19:16:39 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:07:11  time: 0.7573  data_time: 0.0014  memory: 8609  
09/15 19:17:13 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:06:30  time: 0.6399  data_time: 0.0014  memory: 633  
09/15 19:17:49 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:05:50  time: 0.7035  data_time: 0.0015  memory: 8620  
09/15 19:18:23 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:10  time: 0.6782  data_time: 0.0016  memory: 624  
09/15 19:18:59 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:04:31  time: 0.6324  data_time: 0.0014  memory: 16824  
09/15 19:19:35 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:51  time: 0.6899  data_time: 0.0016  memory: 8612  
09/15 19:20:12 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:12  time: 0.6822  data_time: 0.0014  memory: 8618  
09/15 19:20:45 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:33  time: 0.6943  data_time: 0.0016  memory: 8600  
09/15 19:21:19 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:55  time: 0.6895  data_time: 0.0016  memory: 582  
09/15 19:21:53 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:16  time: 0.6697  data_time: 0.0015  memory: 8626  
09/15 19:22:29 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:38  time: 0.6641  data_time: 0.0015  memory: 16829  
09/15 19:23:03 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6228  data_time: 0.0014  memory: 8626  
09/15 19:23:03 - mmengine - INFO - per class results:
09/15 19:23:03 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 57.65 |  83.6 |
|       building      | 65.79 | 86.11 |
|         sky         | 85.27 | 88.37 |
|        floor        | 59.55 |  83.3 |
|         tree        | 43.25 | 49.11 |
|       ceiling       | 61.39 | 89.59 |
|         road        | 52.35 | 59.53 |
|         bed         | 69.94 | 88.08 |
|      windowpane     | 41.42 | 55.16 |
|        grass        |  45.2 | 74.01 |
|       cabinet       | 44.81 | 55.47 |
|       sidewalk      | 34.29 | 67.19 |
|        person       | 55.27 | 74.38 |
|        earth        | 12.57 | 16.77 |
|         door        | 22.48 | 25.68 |
|        table        | 38.29 | 50.42 |
|       mountain      | 34.84 | 39.77 |
|        plant        | 23.49 | 32.64 |
|       curtain       | 44.05 | 63.94 |
|        chair        | 30.65 | 39.52 |
|         car         | 62.62 | 73.19 |
|        water        | 45.81 | 66.59 |
|       painting      | 47.55 | 70.38 |
|         sofa        | 45.59 |  65.8 |
|        shelf        | 29.28 |  45.3 |
|        house        | 15.73 | 16.58 |
|         sea         | 41.21 | 48.51 |
|        mirror       | 48.45 | 54.62 |
|         rug         | 23.13 | 28.36 |
|        field        | 17.09 | 27.43 |
|       armchair      | 27.39 | 36.36 |
|         seat        | 26.42 | 47.85 |
|        fence        | 11.91 | 21.68 |
|         desk        | 29.92 | 40.78 |
|         rock        | 26.23 | 31.37 |
|       wardrobe      | 37.22 | 57.23 |
|         lamp        | 36.19 |  47.0 |
|       bathtub       |  61.9 | 74.88 |
|       railing       | 15.07 | 22.81 |
|       cushion       | 25.97 | 30.72 |
|         base        | 15.42 | 22.57 |
|         box         |  4.27 |  4.84 |
|        column       |  18.6 | 21.14 |
|      signboard      | 19.69 | 24.37 |
|   chest of drawers  | 24.08 | 29.62 |
|       counter       | 16.79 | 27.11 |
|         sand        | 19.73 |  44.6 |
|         sink        | 49.56 |  59.6 |
|      skyscraper     | 18.74 | 21.05 |
|      fireplace      | 44.98 | 48.95 |
|     refrigerator    | 58.21 | 68.18 |
|      grandstand     | 20.22 | 46.87 |
|         path        |  5.18 |  6.99 |
|        stairs       |  7.57 |  8.69 |
|        runway       | 55.88 | 69.95 |
|         case        | 31.08 |  37.5 |
|      pool table     | 80.35 | 85.72 |
|        pillow       | 36.76 | 51.77 |
|     screen door     | 57.59 | 65.55 |
|       stairway      | 17.91 | 21.17 |
|        river        |  2.92 |  4.96 |
|        bridge       | 18.29 |  21.4 |
|       bookcase      | 31.18 | 38.88 |
|        blind        | 13.93 |  17.1 |
|     coffee table    | 30.57 | 40.77 |
|        toilet       | 63.87 | 70.41 |
|        flower       |  16.3 | 24.52 |
|         book        | 26.21 | 33.05 |
|         hill        |  7.05 |  10.5 |
|        bench        | 24.37 | 33.18 |
|      countertop     | 42.54 | 58.01 |
|        stove        | 57.41 | 66.53 |
|         palm        | 10.85 | 35.09 |
|    kitchen island   | 34.23 | 69.07 |
|       computer      | 43.83 | 50.33 |
|     swivel chair    | 13.29 | 15.14 |
|         boat        | 32.67 | 33.45 |
|         bar         | 23.73 | 26.72 |
|    arcade machine   |  8.0  |  8.07 |
|        hovel        |  8.89 |  9.92 |
|         bus         | 64.36 | 74.42 |
|        towel        | 24.96 |  36.7 |
|        light        | 16.15 | 19.51 |
|        truck        |  2.64 |  3.1  |
|        tower        | 15.91 | 16.79 |
|      chandelier     | 28.85 | 32.02 |
|        awning       | 12.68 | 14.02 |
|     streetlight     |  2.53 |  2.78 |
|        booth        | 26.22 |  26.9 |
| television receiver | 43.25 | 52.26 |
|       airplane      | 42.94 | 57.58 |
|      dirt track     |  1.32 | 16.58 |
|       apparel       |  2.83 |  3.56 |
|         pole        |  2.98 |  3.14 |
|         land        |  5.2  |  5.78 |
|      bannister      |  1.1  |  1.69 |
|      escalator      |  13.0 | 17.37 |
|       ottoman       | 24.78 |  33.7 |
|        bottle       |  3.48 |  3.61 |
|        buffet       | 24.98 | 26.61 |
|        poster       |  4.94 |  8.0  |
|        stage        | 14.89 | 17.21 |
|         van         | 24.37 | 41.84 |
|         ship        |  6.02 |  6.59 |
|       fountain      | 15.47 | 19.19 |
|    conveyer belt    | 31.83 | 46.56 |
|        canopy       |  3.4  |  3.77 |
|        washer       |  65.9 | 75.29 |
|      plaything      |  6.05 |  7.02 |
|    swimming pool    | 26.81 | 37.49 |
|        stool        | 19.46 | 22.31 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  9.07 | 10.86 |
|      waterfall      | 29.86 |  66.6 |
|         tent        | 69.87 | 99.55 |
|         bag         |  3.92 |  6.09 |
|       minibike      |  32.3 | 35.16 |
|        cradle       | 53.66 |  73.0 |
|         oven        | 13.48 |  15.7 |
|         ball        |  2.42 |  2.76 |
|         food        |  2.4  |  2.46 |
|         step        |  2.86 |  3.84 |
|         tank        | 15.43 |  15.5 |
|      trade name     | 12.58 | 13.06 |
|      microwave      | 23.94 | 25.82 |
|         pot         |  7.51 |  7.86 |
|        animal       |  38.2 | 45.57 |
|       bicycle       |  6.38 |  6.68 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 32.95 | 42.13 |
|        screen       | 49.59 | 75.18 |
|       blanket       |  4.05 |  6.73 |
|      sculpture      | 10.69 | 19.38 |
|         hood        | 33.51 | 45.08 |
|        sconce       |  14.8 | 18.61 |
|         vase        | 12.63 | 18.14 |
|    traffic light    |  8.48 |  9.16 |
|         tray        |  1.72 |  1.96 |
|        ashcan       | 17.56 | 19.67 |
|         fan         | 27.87 | 37.55 |
|         pier        | 31.97 | 35.51 |
|      crt screen     | 11.14 |  13.5 |
|        plate        | 19.15 | 22.96 |
|       monitor       |  3.27 |  3.38 |
|    bulletin board   | 14.39 | 16.11 |
|        shower       |  0.62 |  1.07 |
|       radiator      | 33.31 | 42.47 |
|        glass        |  0.73 |  0.74 |
|        clock        |  5.45 |  5.6  |
|         flag        |  8.98 |  9.99 |
+---------------------+-------+-------+
09/15 19:23:03 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 67.3200  mIoU: 26.3700  mAcc: 34.4800  data_time: 0.0017  time: 0.7609
Finished processing corruption type: zoom_blur
Processing corruption type: snow
09/15 19:23:06 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 800378996
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 800378996
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 19:23:07 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='snow',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/snow'

09/15 19:23:11 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 19:23:11 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 19:23:12 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 19:23:12 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 19:24:17 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:41:57  time: 0.7948  data_time: 0.0016  memory: 19841  
09/15 19:24:53 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:31:51  time: 0.6016  data_time: 0.0016  memory: 19792  
09/15 19:25:12 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:24:34  time: 0.3972  data_time: 0.0016  memory: 13446  
09/15 19:25:34 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:21:17  time: 0.4442  data_time: 0.0015  memory: 16826  
09/15 19:25:54 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:18:51  time: 0.3083  data_time: 0.0015  memory: 16834  
09/15 19:26:12 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:16:58  time: 0.2823  data_time: 0.0016  memory: 13449  
09/15 19:26:33 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:15:45  time: 0.3502  data_time: 0.0015  memory: 13451  
09/15 19:26:56 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:14:55  time: 0.5557  data_time: 0.0015  memory: 13451  
09/15 19:27:12 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:13:45  time: 0.2740  data_time: 0.0014  memory: 8614  
09/15 19:27:27 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:12:45  time: 0.2878  data_time: 0.0014  memory: 13440  
09/15 19:27:45 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:11:58  time: 0.4241  data_time: 0.0015  memory: 8622  
09/15 19:28:01 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:13  time: 0.4014  data_time: 0.0016  memory: 8622  
09/15 19:28:19 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:10:37  time: 0.4200  data_time: 0.0014  memory: 13453  
09/15 19:28:38 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:04  time: 0.2908  data_time: 0.0016  memory: 13451  
09/15 19:28:57 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:09:34  time: 0.4348  data_time: 0.0014  memory: 13456  
09/15 19:29:12 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:08:59  time: 0.2969  data_time: 0.0016  memory: 8615  
09/15 19:29:26 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:25  time: 0.2803  data_time: 0.0019  memory: 633  
09/15 19:29:40 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:53  time: 0.2727  data_time: 0.0014  memory: 8609  
09/15 19:29:58 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:28  time: 0.3058  data_time: 0.0015  memory: 13441  
09/15 19:30:14 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:01  time: 0.2900  data_time: 0.0014  memory: 8622  
09/15 19:30:33 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:38  time: 0.4607  data_time: 0.0014  memory: 13453  
09/15 19:30:48 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:13  time: 0.2688  data_time: 0.0016  memory: 13446  
09/15 19:31:03 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:47  time: 0.2898  data_time: 0.0015  memory: 13442  
09/15 19:31:17 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:22  time: 0.2700  data_time: 0.0015  memory: 1829  
09/15 19:31:32 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:59  time: 0.2823  data_time: 0.0015  memory: 13447  
09/15 19:31:45 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:35  time: 0.2758  data_time: 0.0015  memory: 633  
09/15 19:31:59 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:13  time: 0.2581  data_time: 0.0015  memory: 8599  
09/15 19:32:16 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:52  time: 0.3971  data_time: 0.0016  memory: 13448  
09/15 19:32:30 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:31  time: 0.3238  data_time: 0.0014  memory: 8609  
09/15 19:32:43 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:10  time: 0.2539  data_time: 0.0014  memory: 633  
09/15 19:32:59 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:50  time: 0.3019  data_time: 0.0015  memory: 8620  
09/15 19:33:12 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:29  time: 0.2709  data_time: 0.0016  memory: 624  
09/15 19:33:28 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:10  time: 0.2543  data_time: 0.0014  memory: 16824  
09/15 19:33:44 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:51  time: 0.2874  data_time: 0.0016  memory: 8612  
09/15 19:34:00 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:32  time: 0.2736  data_time: 0.0014  memory: 8618  
09/15 19:34:13 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:13  time: 0.2789  data_time: 0.0016  memory: 8600  
09/15 19:34:27 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:54  time: 0.2720  data_time: 0.0016  memory: 582  
09/15 19:34:42 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:36  time: 0.2742  data_time: 0.0015  memory: 8626  
09/15 19:34:57 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:18  time: 0.2670  data_time: 0.0015  memory: 16829  
09/15 19:35:11 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2499  data_time: 0.0014  memory: 8626  
09/15 19:35:11 - mmengine - INFO - per class results:
09/15 19:35:11 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 68.97 | 88.55 |
|       building      | 78.06 | 92.42 |
|         sky         | 89.24 | 93.08 |
|        floor        | 72.16 | 90.31 |
|         tree        | 70.27 | 85.11 |
|       ceiling       | 72.62 | 82.05 |
|         road        | 68.74 | 75.99 |
|         bed         | 79.61 | 89.87 |
|      windowpane     |  55.4 | 70.92 |
|        grass        | 62.01 | 81.17 |
|       cabinet       | 52.68 | 64.22 |
|       sidewalk      | 48.35 | 71.24 |
|        person       |  73.0 | 86.07 |
|        earth        | 29.41 | 38.28 |
|         door        | 31.23 | 36.18 |
|        table        | 50.97 | 68.28 |
|       mountain      | 42.54 | 63.75 |
|        plant        | 44.81 | 54.57 |
|       curtain       | 61.06 | 72.17 |
|        chair        | 48.16 | 59.27 |
|         car         | 79.75 |  90.6 |
|        water        |  46.8 | 71.79 |
|       painting      | 65.05 | 81.47 |
|         sofa        | 59.05 | 76.54 |
|        shelf        | 34.64 |  58.1 |
|        house        | 26.81 | 32.78 |
|         sea         | 52.44 |  70.3 |
|        mirror       | 52.57 | 63.85 |
|         rug         | 38.31 | 39.61 |
|        field        | 20.77 | 32.57 |
|       armchair      | 35.75 | 49.46 |
|         seat        | 53.18 | 77.39 |
|        fence        | 36.64 | 55.12 |
|         desk        | 45.18 | 58.88 |
|         rock        | 34.79 | 49.68 |
|       wardrobe      |  36.4 | 51.62 |
|         lamp        | 52.96 | 63.59 |
|       bathtub       |  60.3 | 71.71 |
|       railing       | 24.74 | 30.19 |
|       cushion       | 42.65 | 50.58 |
|         base        | 19.64 |  30.2 |
|         box         | 17.71 | 27.87 |
|        column       | 37.15 | 42.23 |
|      signboard      |  33.3 | 43.72 |
|   chest of drawers  | 36.38 | 60.73 |
|       counter       | 22.92 | 35.13 |
|         sand        | 29.86 | 39.35 |
|         sink        | 59.83 |  67.4 |
|      skyscraper     | 28.33 | 36.63 |
|      fireplace      | 67.08 | 77.14 |
|     refrigerator    | 65.66 | 73.57 |
|      grandstand     | 31.42 | 73.61 |
|         path        | 11.17 | 16.18 |
|        stairs       | 16.71 | 21.18 |
|        runway       | 52.98 | 70.75 |
|         case        | 35.01 | 46.81 |
|      pool table     |  82.0 | 84.18 |
|        pillow       | 39.98 | 49.73 |
|     screen door     | 53.36 | 60.45 |
|       stairway      | 20.16 | 33.53 |
|        river        | 12.28 | 18.81 |
|        bridge       |  63.6 | 76.58 |
|       bookcase      | 38.91 | 48.82 |
|        blind        | 14.63 |  15.0 |
|     coffee table    | 56.48 | 67.01 |
|        toilet       | 72.72 | 77.27 |
|        flower       | 29.25 | 45.07 |
|         book        | 38.33 | 48.24 |
|         hill        |  5.08 |  8.19 |
|        bench        | 28.39 | 31.92 |
|      countertop     |  49.7 | 61.37 |
|        stove        | 63.33 |  72.6 |
|         palm        | 39.57 | 50.74 |
|    kitchen island   | 24.41 | 38.32 |
|       computer      | 51.17 | 57.88 |
|     swivel chair    | 43.25 | 49.48 |
|         boat        | 45.32 | 51.29 |
|         bar         | 31.93 | 35.98 |
|    arcade machine   | 15.45 | 15.83 |
|        hovel        | 30.37 | 39.49 |
|         bus         | 79.12 | 94.18 |
|        towel        | 41.34 | 46.32 |
|        light        | 35.24 | 37.85 |
|        truck        | 30.79 |  39.6 |
|        tower        | 24.06 | 29.23 |
|      chandelier     | 58.24 | 69.38 |
|        awning       | 16.57 | 18.31 |
|     streetlight     | 20.63 |  24.1 |
|        booth        |  39.0 | 40.35 |
| television receiver | 39.97 | 44.84 |
|       airplane      | 43.12 | 56.68 |
|      dirt track     | 19.32 | 30.68 |
|       apparel       | 23.64 | 35.07 |
|         pole        | 15.69 | 20.43 |
|         land        |  0.35 |  0.48 |
|      bannister      |  7.9  | 10.04 |
|      escalator      | 16.81 | 21.78 |
|       ottoman       | 31.85 | 38.76 |
|        bottle       | 21.63 | 50.82 |
|        buffet       | 42.71 | 52.37 |
|        poster       | 20.92 | 30.26 |
|        stage        |  7.11 | 10.41 |
|         van         | 40.05 | 56.33 |
|         ship        |  7.92 | 13.15 |
|       fountain      | 20.32 | 22.26 |
|    conveyer belt    | 50.33 |  50.8 |
|        canopy       | 14.77 | 16.57 |
|        washer       | 58.64 | 64.55 |
|      plaything      |  8.42 | 19.98 |
|    swimming pool    | 57.94 | 80.47 |
|        stool        | 30.64 | 37.88 |
|        barrel       |  8.42 | 20.31 |
|        basket       | 23.07 | 33.25 |
|      waterfall      | 51.47 | 57.18 |
|         tent        | 92.63 | 97.89 |
|         bag         |  4.86 |  6.75 |
|       minibike      | 65.68 | 72.69 |
|        cradle       | 64.98 | 83.22 |
|         oven        | 29.48 | 40.26 |
|         ball        | 14.34 |  15.3 |
|         food        | 39.71 | 49.46 |
|         step        |  3.48 |  4.08 |
|         tank        | 29.72 | 31.33 |
|      trade name     | 19.98 | 21.56 |
|      microwave      |  34.2 | 36.01 |
|         pot         | 31.49 | 34.76 |
|        animal       | 48.53 | 54.16 |
|       bicycle       | 46.13 | 73.48 |
|         lake        | 51.77 | 58.77 |
|      dishwasher     | 40.78 | 42.63 |
|        screen       | 70.05 | 83.48 |
|       blanket       |  2.41 |  2.49 |
|      sculpture      | 41.12 | 64.93 |
|         hood        | 35.24 | 36.47 |
|        sconce       | 34.64 | 45.86 |
|         vase        | 33.65 | 46.75 |
|    traffic light    | 27.72 | 38.96 |
|         tray        |  5.51 | 10.66 |
|        ashcan       | 30.55 | 36.93 |
|         fan         | 49.46 | 61.08 |
|         pier        | 35.83 | 64.22 |
|      crt screen     |  5.75 | 17.95 |
|        plate        | 37.04 | 42.87 |
|       monitor       | 27.84 | 31.23 |
|    bulletin board   | 25.04 | 29.42 |
|        shower       |  0.34 |  1.6  |
|       radiator      | 24.53 | 26.04 |
|        glass        |  9.88 | 10.45 |
|        clock        | 23.35 | 25.83 |
|         flag        | 34.26 | 37.33 |
+---------------------+-------+-------+
09/15 19:35:11 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 77.0200  mIoU: 38.6200  mAcc: 48.3400  data_time: 0.0017  time: 0.3595
Finished processing corruption type: snow
Processing corruption type: frost
09/15 19:35:15 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 67153664
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 67153664
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 19:35:16 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='frost',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/frost'

09/15 19:35:19 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 19:35:19 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 19:35:20 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 19:35:21 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 19:36:09 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:25  time: 0.5783  data_time: 0.0016  memory: 19841  
09/15 19:36:34 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:19  time: 0.3784  data_time: 0.0016  memory: 19792  
09/15 19:36:43 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:16:52  time: 0.1727  data_time: 0.0016  memory: 13446  
09/15 19:36:54 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:14:00  time: 0.2123  data_time: 0.0015  memory: 16826  
09/15 19:37:03 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:11:59  time: 0.0957  data_time: 0.0015  memory: 16834  
09/15 19:37:11 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:25  time: 0.0634  data_time: 0.0016  memory: 13449  
09/15 19:37:20 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:09:24  time: 0.0963  data_time: 0.0015  memory: 13451  
09/15 19:37:29 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:08:33  time: 0.1743  data_time: 0.0014  memory: 13451  
09/15 19:37:33 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:07:36  time: 0.0752  data_time: 0.0014  memory: 8614  
09/15 19:37:37 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:06:49  time: 0.0607  data_time: 0.0015  memory: 13440  
09/15 19:37:43 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:06:14  time: 0.1838  data_time: 0.0016  memory: 8622  
09/15 19:37:47 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:05:42  time: 0.1469  data_time: 0.0016  memory: 8622  
09/15 19:37:55 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:05:19  time: 0.1984  data_time: 0.0014  memory: 13453  
09/15 19:38:02 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:04:59  time: 0.0623  data_time: 0.0016  memory: 13451  
09/15 19:38:10 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:04:41  time: 0.1953  data_time: 0.0014  memory: 13456  
09/15 19:38:14 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:04:19  time: 0.0613  data_time: 0.0016  memory: 8615  
09/15 19:38:17 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:03:58  time: 0.0615  data_time: 0.0016  memory: 633  
09/15 19:38:20 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:03:39  time: 0.0766  data_time: 0.0015  memory: 8609  
09/15 19:38:27 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:03:25  time: 0.0945  data_time: 0.0016  memory: 13441  
09/15 19:38:32 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:03:11  time: 0.0589  data_time: 0.0015  memory: 8622  
09/15 19:38:39 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:02:59  time: 0.2185  data_time: 0.0015  memory: 13453  
09/15 19:38:44 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:02:46  time: 0.0609  data_time: 0.0016  memory: 13446  
09/15 19:38:48 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:02:33  time: 0.0774  data_time: 0.0015  memory: 13442  
09/15 19:38:51 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:02:20  time: 0.0600  data_time: 0.0015  memory: 1829  
09/15 19:38:56 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:02:09  time: 0.0791  data_time: 0.0015  memory: 13447  
09/15 19:38:59 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:01:57  time: 0.0601  data_time: 0.0015  memory: 633  
09/15 19:39:02 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:01:46  time: 0.0589  data_time: 0.0015  memory: 8599  
09/15 19:39:09 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:01:37  time: 0.1729  data_time: 0.0015  memory: 13448  
09/15 19:39:12 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:01:27  time: 0.1065  data_time: 0.0014  memory: 8609  
09/15 19:39:15 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:18  time: 0.0574  data_time: 0.0014  memory: 633  
09/15 19:39:19 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:09  time: 0.0611  data_time: 0.0015  memory: 8620  
09/15 19:39:22 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:00  time: 0.0600  data_time: 0.0016  memory: 624  
09/15 19:39:28 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:00:52  time: 0.0580  data_time: 0.0014  memory: 16824  
09/15 19:39:33 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:00:44  time: 0.0580  data_time: 0.0016  memory: 8612  
09/15 19:39:37 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:36  time: 0.0608  data_time: 0.0014  memory: 8618  
09/15 19:39:40 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:28  time: 0.0612  data_time: 0.0016  memory: 8600  
09/15 19:39:43 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:21  time: 0.0618  data_time: 0.0017  memory: 582  
09/15 19:39:48 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:14  time: 0.0609  data_time: 0.0015  memory: 8626  
09/15 19:39:52 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:06  time: 0.0609  data_time: 0.0015  memory: 16829  
09/15 19:39:56 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0589  data_time: 0.0019  memory: 8626  
09/15 19:39:56 - mmengine - INFO - per class results:
09/15 19:39:56 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 68.66 | 87.44 |
|       building      | 80.01 | 91.04 |
|         sky         | 72.36 | 74.74 |
|        floor        | 74.92 | 89.98 |
|         tree        | 65.84 | 86.35 |
|       ceiling       | 71.45 | 80.88 |
|         road        | 76.56 |  86.3 |
|         bed         | 82.09 | 91.87 |
|      windowpane     | 54.26 | 71.54 |
|        grass        | 61.69 | 80.44 |
|       cabinet       | 55.85 | 65.38 |
|       sidewalk      | 54.75 | 66.31 |
|        person       | 73.24 | 88.17 |
|        earth        | 30.88 | 48.62 |
|         door        |  35.9 | 44.94 |
|        table        | 52.71 | 72.98 |
|       mountain      | 26.34 | 70.83 |
|        plant        | 45.72 | 55.31 |
|       curtain       | 61.94 |  73.0 |
|        chair        |  51.1 | 64.04 |
|         car         | 80.97 | 89.13 |
|        water        | 49.68 | 69.71 |
|       painting      | 62.85 | 80.95 |
|         sofa        | 64.94 | 82.95 |
|        shelf        | 39.11 | 53.42 |
|        house        | 44.58 |  55.0 |
|         sea         | 44.55 | 60.05 |
|        mirror       | 52.86 | 61.23 |
|         rug         |  50.2 | 54.36 |
|        field        |  21.6 | 33.58 |
|       armchair      | 40.53 |  55.9 |
|         seat        | 47.55 | 61.24 |
|        fence        |  37.7 | 53.27 |
|         desk        | 43.76 | 56.61 |
|         rock        | 33.48 |  47.7 |
|       wardrobe      | 37.16 | 49.16 |
|         lamp        | 55.95 | 68.21 |
|       bathtub       | 59.04 | 69.36 |
|       railing       | 31.45 | 44.53 |
|       cushion       | 44.21 | 57.77 |
|         base        | 12.37 | 15.14 |
|         box         | 17.15 | 22.35 |
|        column       | 34.21 | 43.25 |
|      signboard      | 34.72 |  44.5 |
|   chest of drawers  | 46.49 | 56.93 |
|       counter       | 25.98 | 39.35 |
|         sand        | 41.11 | 55.88 |
|         sink        | 61.33 | 70.55 |
|      skyscraper     | 37.89 |  48.7 |
|      fireplace      | 67.57 | 79.41 |
|     refrigerator    | 69.29 | 76.84 |
|      grandstand     | 36.78 | 59.16 |
|         path        | 17.73 | 27.21 |
|        stairs       | 28.89 |  36.3 |
|        runway       | 45.76 | 52.68 |
|         case        | 40.33 | 57.74 |
|      pool table     | 87.89 | 90.94 |
|        pillow       | 44.79 | 56.27 |
|     screen door     |  45.3 | 71.86 |
|       stairway      | 26.24 | 35.04 |
|        river        |  8.96 | 12.42 |
|        bridge       |  63.8 | 77.49 |
|       bookcase      | 39.62 | 52.34 |
|        blind        | 28.53 |  30.3 |
|     coffee table    | 56.01 | 73.23 |
|        toilet       | 73.01 | 77.61 |
|        flower       | 33.44 | 50.42 |
|         book        | 42.56 |  61.2 |
|         hill        | 10.87 | 17.56 |
|        bench        |  35.5 |  42.0 |
|      countertop     | 48.82 | 66.37 |
|        stove        | 64.39 | 70.38 |
|         palm        | 42.03 | 54.95 |
|    kitchen island   | 27.03 | 50.78 |
|       computer      | 55.34 | 61.17 |
|     swivel chair    | 39.86 |  47.5 |
|         boat        | 53.61 | 67.82 |
|         bar         | 37.09 | 40.99 |
|    arcade machine   | 15.16 | 15.41 |
|        hovel        | 49.12 | 55.52 |
|         bus         | 85.28 | 92.59 |
|        towel        | 42.02 | 57.26 |
|        light        | 42.66 | 47.86 |
|        truck        | 31.56 | 41.08 |
|        tower        | 22.86 | 31.57 |
|      chandelier     | 57.29 | 70.41 |
|        awning       | 24.79 | 27.94 |
|     streetlight     | 19.87 | 23.93 |
|        booth        |  60.5 | 66.85 |
| television receiver | 55.08 | 60.79 |
|       airplane      | 53.44 | 64.87 |
|      dirt track     | 22.23 |  61.7 |
|       apparel       | 26.16 | 37.01 |
|         pole        | 19.46 | 26.91 |
|         land        |  0.0  |  0.0  |
|      bannister      |  5.28 |  6.75 |
|      escalator      |  8.29 |  8.79 |
|       ottoman       | 34.48 | 43.88 |
|        bottle       | 34.83 | 57.86 |
|        buffet       |  40.4 |  47.3 |
|        poster       |  24.0 | 27.37 |
|        stage        | 11.86 |  15.0 |
|         van         | 40.73 | 52.54 |
|         ship        | 22.78 | 25.22 |
|       fountain      | 19.04 | 19.89 |
|    conveyer belt    | 76.52 |  76.9 |
|        canopy       | 36.98 | 43.37 |
|        washer       | 59.65 | 66.33 |
|      plaything      | 14.33 | 20.61 |
|    swimming pool    | 52.64 | 84.97 |
|        stool        | 33.34 | 43.89 |
|        barrel       | 29.36 | 41.22 |
|        basket       | 23.58 | 33.28 |
|      waterfall      | 40.09 | 47.85 |
|         tent        | 93.69 | 97.97 |
|         bag         |  7.18 |  8.35 |
|       minibike      |  63.2 | 69.38 |
|        cradle       | 72.12 |  89.1 |
|         oven        | 30.18 | 54.22 |
|         ball        |  13.5 | 14.68 |
|         food        | 44.27 | 56.94 |
|         step        |  3.43 |  4.21 |
|         tank        | 29.93 | 30.96 |
|      trade name     | 23.91 | 26.76 |
|      microwave      | 59.83 | 62.75 |
|         pot         | 35.94 | 39.94 |
|        animal       | 54.98 | 59.88 |
|       bicycle       | 44.86 | 71.29 |
|         lake        | 50.23 | 63.39 |
|      dishwasher     | 43.63 | 50.41 |
|        screen       | 61.21 | 66.59 |
|       blanket       |  8.61 |  9.8  |
|      sculpture      | 50.82 | 73.73 |
|         hood        | 37.58 | 39.64 |
|        sconce       | 36.22 | 44.94 |
|         vase        | 33.53 | 47.53 |
|    traffic light    | 24.67 | 30.24 |
|         tray        |  6.23 | 11.93 |
|        ashcan       | 27.73 | 31.77 |
|         fan         | 52.29 | 64.29 |
|         pier        | 38.75 | 57.03 |
|      crt screen     |  5.6  | 11.14 |
|        plate        | 42.87 | 52.92 |
|       monitor       | 22.34 | 23.71 |
|    bulletin board   |  36.4 | 43.92 |
|        shower       |  2.37 |  3.08 |
|       radiator      |  35.3 | 36.34 |
|        glass        | 12.91 | 13.77 |
|        clock        | 19.39 | 22.11 |
|         flag        | 30.62 | 33.13 |
+---------------------+-------+-------+
09/15 19:39:56 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 76.5800  mIoU: 41.4200  mAcc: 51.6800  data_time: 0.0017  time: 0.1376
Finished processing corruption type: frost
Processing corruption type: fog
09/15 19:39:59 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 782096625
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 782096625
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 19:40:00 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='fog',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/fog'

09/15 19:40:02 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 19:40:02 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 19:40:03 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 19:40:03 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 19:41:02 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:38:23  time: 0.7532  data_time: 0.0015  memory: 19841  
09/15 19:41:35 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:28:55  time: 0.5244  data_time: 0.0016  memory: 19792  
09/15 19:41:50 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:21:52  time: 0.3023  data_time: 0.0015  memory: 13446  
09/15 19:42:09 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:18:47  time: 0.3547  data_time: 0.0015  memory: 16826  
09/15 19:42:25 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:16:34  time: 0.2250  data_time: 0.0014  memory: 16834  
09/15 19:42:41 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:14:52  time: 0.1869  data_time: 0.0015  memory: 13449  
09/15 19:42:58 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:42  time: 0.2333  data_time: 0.0014  memory: 13451  
09/15 19:43:13 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:37  time: 0.2958  data_time: 0.0014  memory: 13451  
09/15 19:43:23 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:11:29  time: 0.2024  data_time: 0.0014  memory: 8614  
09/15 19:43:34 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:10:31  time: 0.1834  data_time: 0.0014  memory: 13440  
09/15 19:43:46 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:46  time: 0.3180  data_time: 0.0015  memory: 8622  
09/15 19:43:58 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:09:06  time: 0.2762  data_time: 0.0016  memory: 8622  
09/15 19:44:11 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:08:34  time: 0.3484  data_time: 0.0013  memory: 13453  
09/15 19:44:25 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:08:06  time: 0.1903  data_time: 0.0016  memory: 13451  
09/15 19:44:39 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:40  time: 0.3478  data_time: 0.0014  memory: 13456  
09/15 19:44:50 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:07:10  time: 0.1861  data_time: 0.0016  memory: 8615  
09/15 19:45:00 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:41  time: 0.1886  data_time: 0.0016  memory: 633  
09/15 19:45:10 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:06:15  time: 0.2058  data_time: 0.0014  memory: 8609  
09/15 19:45:23 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:53  time: 0.2325  data_time: 0.0015  memory: 13441  
09/15 19:45:35 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:31  time: 0.1807  data_time: 0.0014  memory: 8622  
09/15 19:45:48 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:05:12  time: 0.3482  data_time: 0.0015  memory: 13453  
09/15 19:45:59 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:51  time: 0.1857  data_time: 0.0015  memory: 13446  
09/15 19:46:10 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:30  time: 0.2004  data_time: 0.0014  memory: 13442  
09/15 19:46:19 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:10  time: 0.1825  data_time: 0.0014  memory: 1829  
09/15 19:46:30 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:52  time: 0.2007  data_time: 0.0014  memory: 13447  
09/15 19:46:39 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:33  time: 0.2054  data_time: 0.0014  memory: 633  
09/15 19:46:49 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:15  time: 0.1869  data_time: 0.0015  memory: 8599  
09/15 19:47:04 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:00  time: 0.3713  data_time: 0.0014  memory: 13448  
09/15 19:47:16 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:44  time: 0.3709  data_time: 0.0014  memory: 8609  
09/15 19:47:29 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:28  time: 0.2526  data_time: 0.0014  memory: 633  
09/15 19:47:40 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:12  time: 0.2214  data_time: 0.0015  memory: 8620  
09/15 19:47:50 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:56  time: 0.2209  data_time: 0.0015  memory: 624  
09/15 19:48:02 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:41  time: 0.1818  data_time: 0.0014  memory: 16824  
09/15 19:48:15 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:26  time: 0.2087  data_time: 0.0016  memory: 8612  
09/15 19:48:25 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:11  time: 0.1953  data_time: 0.0014  memory: 8618  
09/15 19:48:35 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:56  time: 0.1871  data_time: 0.0016  memory: 8600  
09/15 19:48:45 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:42  time: 0.2127  data_time: 0.0016  memory: 582  
09/15 19:48:55 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:28  time: 0.1833  data_time: 0.0014  memory: 8626  
09/15 19:49:06 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:13  time: 0.1849  data_time: 0.0017  memory: 16829  
09/15 19:49:17 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1834  data_time: 0.0013  memory: 8626  
09/15 19:49:17 - mmengine - INFO - per class results:
09/15 19:49:17 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 76.21 | 88.56 |
|       building      | 81.74 | 92.92 |
|         sky         | 93.78 | 97.26 |
|        floor        | 80.24 | 90.36 |
|         tree        | 72.56 | 87.38 |
|       ceiling       | 82.83 | 91.17 |
|         road        | 83.15 | 90.73 |
|         bed         | 87.27 | 94.85 |
|      windowpane     | 59.35 |  75.3 |
|        grass        | 64.99 | 82.26 |
|       cabinet       | 59.75 | 74.19 |
|       sidewalk      | 64.81 | 78.94 |
|        person       | 77.28 | 90.59 |
|        earth        | 34.67 | 49.87 |
|         door        | 47.01 | 60.79 |
|        table        | 55.56 | 73.51 |
|       mountain      | 56.54 | 73.88 |
|        plant        | 48.51 | 59.14 |
|       curtain       | 71.22 |  82.2 |
|        chair        | 54.61 | 69.49 |
|         car         | 83.71 | 91.92 |
|        water        | 51.32 | 69.79 |
|       painting      | 69.63 | 84.24 |
|         sofa        | 64.37 | 82.03 |
|        shelf        | 40.36 | 57.02 |
|        house        | 36.35 | 42.38 |
|         sea         | 55.85 | 77.09 |
|        mirror       | 57.71 | 66.23 |
|         rug         | 58.02 | 66.44 |
|        field        | 30.38 | 40.83 |
|       armchair      | 40.84 | 55.61 |
|         seat        | 64.71 |  82.2 |
|        fence        | 42.82 | 57.13 |
|         desk        | 47.16 | 65.88 |
|         rock        | 39.17 | 58.49 |
|       wardrobe      | 48.38 | 66.12 |
|         lamp        | 60.51 | 73.85 |
|       bathtub       | 74.28 | 79.86 |
|       railing       | 32.07 | 46.65 |
|       cushion       | 52.31 | 67.05 |
|         base        | 27.87 | 36.67 |
|         box         | 24.11 | 32.32 |
|        column       | 42.33 | 53.26 |
|      signboard      | 34.99 |  48.2 |
|   chest of drawers  | 39.11 | 55.24 |
|       counter       | 24.75 | 36.08 |
|         sand        | 38.69 | 54.66 |
|         sink        | 70.72 | 78.98 |
|      skyscraper     | 43.37 | 52.67 |
|      fireplace      | 69.65 | 82.28 |
|     refrigerator    | 74.29 | 82.96 |
|      grandstand     | 43.55 | 69.24 |
|         path        | 14.35 | 21.63 |
|        stairs       | 29.26 | 35.49 |
|        runway       | 68.72 | 89.95 |
|         case        | 41.12 | 52.73 |
|      pool table     | 90.68 | 94.18 |
|        pillow       | 54.31 | 67.72 |
|     screen door     | 67.37 | 81.45 |
|       stairway      | 26.85 | 32.73 |
|        river        | 12.21 | 19.01 |
|        bridge       | 38.91 | 45.71 |
|       bookcase      |  42.2 | 61.39 |
|        blind        | 38.13 |  44.0 |
|     coffee table    | 55.37 | 74.98 |
|        toilet       | 77.37 | 90.26 |
|        flower       |  35.2 | 47.59 |
|         book        | 43.14 | 62.74 |
|         hill        |  6.96 |  9.64 |
|        bench        | 43.07 | 50.09 |
|      countertop     |  57.3 | 71.75 |
|        stove        |  73.9 | 79.29 |
|         palm        | 47.75 | 64.31 |
|    kitchen island   | 36.34 |  57.4 |
|       computer      | 58.54 | 68.22 |
|     swivel chair    | 45.96 |  61.1 |
|         boat        | 57.65 | 74.24 |
|         bar         | 42.15 | 47.45 |
|    arcade machine   | 59.37 | 65.23 |
|        hovel        | 41.65 | 54.94 |
|         bus         | 88.17 | 93.77 |
|        towel        | 55.73 | 75.16 |
|        light        | 48.99 | 56.02 |
|        truck        | 40.13 | 49.67 |
|        tower        |  23.3 |  35.0 |
|      chandelier     | 64.99 | 78.19 |
|        awning       | 23.91 | 27.24 |
|     streetlight     | 23.38 | 32.07 |
|        booth        | 49.11 | 54.85 |
| television receiver | 64.29 | 74.54 |
|       airplane      | 52.54 | 64.79 |
|      dirt track     | 17.19 | 33.46 |
|       apparel       | 29.98 | 46.46 |
|         pole        | 17.88 | 24.38 |
|         land        |  3.87 |  5.59 |
|      bannister      | 11.13 | 14.59 |
|      escalator      |  25.5 | 26.94 |
|       ottoman       | 45.09 | 52.83 |
|        bottle       |  36.3 | 56.88 |
|        buffet       | 44.73 | 50.41 |
|        poster       | 33.42 | 46.95 |
|        stage        | 20.63 | 27.75 |
|         van         | 45.41 |  62.4 |
|         ship        | 52.68 | 65.36 |
|       fountain      | 21.51 | 21.96 |
|    conveyer belt    |  83.3 | 87.87 |
|        canopy       | 26.74 |  29.9 |
|        washer       | 66.27 | 71.14 |
|      plaything      | 20.62 | 31.41 |
|    swimming pool    | 53.56 | 81.51 |
|        stool        | 34.19 | 45.77 |
|        barrel       | 43.69 |  65.3 |
|        basket       | 28.69 | 36.52 |
|      waterfall      | 49.25 | 54.33 |
|         tent        |  92.3 | 98.46 |
|         bag         |  9.68 | 11.89 |
|       minibike      | 67.18 | 75.17 |
|        cradle       | 79.73 | 95.27 |
|         oven        |  24.4 | 54.24 |
|         ball        | 20.09 | 20.47 |
|         food        |  42.3 | 50.73 |
|         step        |  8.23 |  9.77 |
|         tank        | 41.56 |  44.9 |
|      trade name     | 24.27 | 26.88 |
|      microwave      | 54.77 | 59.99 |
|         pot         | 42.33 | 49.73 |
|        animal       | 52.13 | 56.45 |
|       bicycle       | 49.07 | 73.62 |
|         lake        | 59.52 |  63.4 |
|      dishwasher     | 54.69 | 68.63 |
|        screen       | 69.01 | 82.21 |
|       blanket       | 13.64 | 15.75 |
|      sculpture      | 55.57 | 66.71 |
|         hood        | 54.24 | 58.77 |
|        sconce       | 47.16 | 58.89 |
|         vase        | 37.69 | 52.94 |
|    traffic light    | 28.18 | 44.71 |
|         tray        |  7.25 | 18.34 |
|        ashcan       |  32.0 | 40.46 |
|         fan         | 59.55 | 75.24 |
|         pier        | 53.73 | 75.81 |
|      crt screen     |  6.7  | 18.74 |
|        plate        | 45.31 | 58.16 |
|       monitor       |  8.4  | 10.26 |
|    bulletin board   | 43.59 | 58.47 |
|        shower       |  1.82 |  2.01 |
|       radiator      | 52.61 |  57.5 |
|        glass        | 15.22 | 16.84 |
|        clock        | 36.05 | 42.97 |
|         flag        | 28.53 | 30.79 |
+---------------------+-------+-------+
09/15 19:49:17 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.9800  mIoU: 46.7100  mAcc: 57.7900  data_time: 0.0017  time: 0.2767
Finished processing corruption type: fog
Processing corruption type: brightness
09/15 19:49:20 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1574528420
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1574528420
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 19:49:21 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='brightness',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/brightness'

09/15 19:49:23 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 19:49:23 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 19:49:24 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 19:49:24 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 19:50:21 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:37:08  time: 0.7272  data_time: 0.0016  memory: 19841  
09/15 19:50:54 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:28:19  time: 0.5337  data_time: 0.0017  memory: 19792  
09/15 19:51:09 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:21:32  time: 0.3161  data_time: 0.0016  memory: 13446  
09/15 19:51:27 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:18:27  time: 0.3476  data_time: 0.0016  memory: 16826  
09/15 19:51:43 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:16:13  time: 0.2315  data_time: 0.0016  memory: 16834  
09/15 19:51:59 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:14:35  time: 0.2041  data_time: 0.0017  memory: 13449  
09/15 19:52:15 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:25  time: 0.2236  data_time: 0.0016  memory: 13451  
09/15 19:52:31 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:28  time: 0.3163  data_time: 0.0016  memory: 13451  
09/15 19:52:42 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:11:19  time: 0.2034  data_time: 0.0016  memory: 8614  
09/15 19:52:53 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:10:24  time: 0.1941  data_time: 0.0016  memory: 13440  
09/15 19:53:06 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:43  time: 0.3302  data_time: 0.0019  memory: 8622  
09/15 19:53:17 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:09:03  time: 0.3143  data_time: 0.0017  memory: 8622  
09/15 19:53:31 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:08:33  time: 0.3432  data_time: 0.0014  memory: 13453  
09/15 19:53:46 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:08:05  time: 0.2069  data_time: 0.0017  memory: 13451  
09/15 19:54:01 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:41  time: 0.3358  data_time: 0.0015  memory: 13456  
09/15 19:54:12 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:07:11  time: 0.2010  data_time: 0.0017  memory: 8615  
09/15 19:54:22 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:42  time: 0.2050  data_time: 0.0017  memory: 633  
09/15 19:54:32 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:06:15  time: 0.1970  data_time: 0.0015  memory: 8609  
09/15 19:54:45 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:54  time: 0.2280  data_time: 0.0016  memory: 13441  
09/15 19:54:57 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:32  time: 0.1925  data_time: 0.0016  memory: 8622  
09/15 19:55:11 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:05:13  time: 0.3647  data_time: 0.0015  memory: 13453  
09/15 19:55:23 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:53  time: 0.1991  data_time: 0.0016  memory: 13446  
09/15 19:55:34 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:32  time: 0.2141  data_time: 0.0016  memory: 13442  
09/15 19:55:43 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:12  time: 0.1953  data_time: 0.0016  memory: 1829  
09/15 19:55:55 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:54  time: 0.2078  data_time: 0.0015  memory: 13447  
09/15 19:56:04 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:35  time: 0.1951  data_time: 0.0016  memory: 633  
09/15 19:56:15 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:17  time: 0.1853  data_time: 0.0016  memory: 8599  
09/15 19:56:28 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:01  time: 0.3191  data_time: 0.0016  memory: 13448  
09/15 19:56:38 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:44  time: 0.2500  data_time: 0.0015  memory: 8609  
09/15 19:56:48 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:27  time: 0.1876  data_time: 0.0015  memory: 633  
09/15 19:56:59 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:12  time: 0.2025  data_time: 0.0016  memory: 8620  
09/15 19:57:09 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:56  time: 0.1984  data_time: 0.0017  memory: 624  
09/15 19:57:21 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:41  time: 0.1837  data_time: 0.0015  memory: 16824  
09/15 19:57:33 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:26  time: 0.1972  data_time: 0.0016  memory: 8612  
09/15 19:57:44 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:11  time: 0.1952  data_time: 0.0014  memory: 8618  
09/15 19:57:57 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:56  time: 0.2245  data_time: 0.0017  memory: 8600  
09/15 19:58:10 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:42  time: 0.2691  data_time: 0.0017  memory: 582  
09/15 19:58:22 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:28  time: 0.1948  data_time: 0.0015  memory: 8626  
09/15 19:58:34 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:14  time: 0.1875  data_time: 0.0015  memory: 16829  
09/15 19:58:46 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1809  data_time: 0.0014  memory: 8626  
09/15 19:58:46 - mmengine - INFO - per class results:
09/15 19:58:46 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 76.71 | 88.68 |
|       building      | 81.91 | 92.93 |
|         sky         | 93.81 | 97.59 |
|        floor        |  81.0 |  90.8 |
|         tree        | 73.59 | 86.96 |
|       ceiling       | 83.59 | 91.67 |
|         road        | 83.19 | 90.99 |
|         bed         | 88.13 | 94.91 |
|      windowpane     |  59.5 | 77.05 |
|        grass        | 65.65 | 82.74 |
|       cabinet       | 59.56 | 73.07 |
|       sidewalk      |  63.5 | 78.51 |
|        person       | 77.55 | 90.51 |
|        earth        | 33.82 |  48.5 |
|         door        | 48.88 | 62.74 |
|        table        | 55.85 | 72.81 |
|       mountain      | 57.42 | 73.17 |
|        plant        |  50.0 | 60.25 |
|       curtain       | 70.89 | 81.81 |
|        chair        | 54.34 | 68.82 |
|         car         | 84.24 |  92.3 |
|        water        | 51.43 | 68.24 |
|       painting      | 70.98 | 84.41 |
|         sofa        | 65.77 | 83.65 |
|        shelf        | 42.67 | 59.66 |
|        house        | 39.25 | 46.47 |
|         sea         | 56.12 | 78.87 |
|        mirror       | 60.42 | 68.07 |
|         rug         | 60.18 |  69.0 |
|        field        | 29.84 | 41.15 |
|       armchair      | 42.58 | 58.71 |
|         seat        | 60.65 | 80.76 |
|        fence        | 43.74 | 59.01 |
|         desk        | 45.93 |  67.6 |
|         rock        | 40.95 | 62.12 |
|       wardrobe      | 48.03 | 67.07 |
|         lamp        | 60.06 | 73.39 |
|       bathtub       | 76.08 | 81.03 |
|       railing       | 33.42 | 45.86 |
|       cushion       |  51.4 | 65.94 |
|         base        | 30.45 | 39.71 |
|         box         |  24.0 | 32.79 |
|        column       | 42.64 | 54.04 |
|      signboard      |  36.2 | 50.05 |
|   chest of drawers  | 39.31 | 55.69 |
|       counter       | 26.41 | 37.21 |
|         sand        |  36.1 |  55.9 |
|         sink        | 70.09 | 78.24 |
|      skyscraper     | 37.05 | 46.23 |
|      fireplace      |  71.1 | 83.25 |
|     refrigerator    | 73.76 | 82.63 |
|      grandstand     | 41.18 | 63.41 |
|         path        | 13.57 | 20.07 |
|        stairs       | 28.97 | 34.65 |
|        runway       |  69.6 | 88.85 |
|         case        |  40.9 | 52.23 |
|      pool table     |  91.4 | 95.23 |
|        pillow       | 54.29 | 66.47 |
|     screen door     | 65.88 | 78.31 |
|       stairway      | 25.69 | 34.67 |
|        river        |  14.3 |  24.3 |
|        bridge       | 36.79 | 43.86 |
|       bookcase      | 41.84 |  60.0 |
|        blind        | 37.86 | 43.29 |
|     coffee table    | 53.91 | 77.19 |
|        toilet       | 78.87 | 90.27 |
|        flower       | 36.91 | 53.61 |
|         book        | 46.87 | 65.94 |
|         hill        | 10.25 | 16.08 |
|        bench        | 37.86 | 45.88 |
|      countertop     |  57.9 | 71.75 |
|        stove        | 72.87 | 79.65 |
|         palm        | 48.27 | 65.71 |
|    kitchen island   | 35.55 | 59.05 |
|       computer      | 60.32 | 69.49 |
|     swivel chair    | 46.91 | 62.17 |
|         boat        | 58.29 | 79.73 |
|         bar         | 43.91 | 48.75 |
|    arcade machine   | 49.56 | 52.98 |
|        hovel        | 45.64 |  57.8 |
|         bus         | 87.24 | 94.72 |
|        towel        | 61.78 | 76.34 |
|        light        | 51.93 | 60.23 |
|        truck        | 38.66 | 49.35 |
|        tower        | 16.62 | 23.58 |
|      chandelier     | 63.31 | 77.58 |
|        awning       | 26.34 | 31.11 |
|     streetlight     | 22.97 | 31.08 |
|        booth        | 44.47 |  49.2 |
| television receiver | 65.27 | 75.46 |
|       airplane      | 54.04 | 65.83 |
|      dirt track     | 16.38 |  50.3 |
|       apparel       | 27.89 | 40.73 |
|         pole        | 19.64 | 27.83 |
|         land        |  4.03 |  5.57 |
|      bannister      |  10.2 | 13.39 |
|      escalator      | 25.39 | 27.23 |
|       ottoman       | 45.48 | 55.41 |
|        bottle       | 34.15 | 55.99 |
|        buffet       | 46.75 | 55.02 |
|        poster       | 33.46 | 38.66 |
|        stage        | 17.33 | 22.11 |
|         van         | 42.76 | 57.79 |
|         ship        | 68.89 | 76.16 |
|       fountain      | 24.42 | 24.95 |
|    conveyer belt    | 84.52 | 88.03 |
|        canopy       | 37.51 | 45.17 |
|        washer       | 66.77 |  70.6 |
|      plaything      | 21.85 |  33.3 |
|    swimming pool    | 50.66 |  82.9 |
|        stool        | 39.86 | 49.57 |
|        barrel       | 50.18 | 66.07 |
|        basket       | 27.85 | 36.18 |
|      waterfall      | 54.24 | 60.79 |
|         tent        | 94.68 |  97.6 |
|         bag         |  9.14 | 11.32 |
|       minibike      | 67.54 | 75.85 |
|        cradle       | 80.63 | 95.62 |
|         oven        | 24.66 |  55.3 |
|         ball        |  16.4 |  16.8 |
|         food        | 48.44 | 59.81 |
|         step        |  8.88 | 10.16 |
|         tank        | 43.81 | 46.91 |
|      trade name     | 25.62 | 28.91 |
|      microwave      | 53.24 | 58.94 |
|         pot         | 41.14 |  48.0 |
|        animal       | 55.96 | 58.53 |
|       bicycle       | 48.22 | 72.94 |
|         lake        | 58.27 | 63.38 |
|      dishwasher     | 58.29 | 71.05 |
|        screen       | 68.69 |  84.8 |
|       blanket       |  15.6 | 19.51 |
|      sculpture      | 59.96 | 77.34 |
|         hood        | 54.42 | 60.91 |
|        sconce       | 45.02 | 55.28 |
|         vase        | 37.56 | 53.15 |
|    traffic light    | 30.97 | 47.19 |
|         tray        |  7.47 | 17.07 |
|        ashcan       | 32.86 | 41.54 |
|         fan         | 61.34 | 74.72 |
|         pier        | 47.83 | 65.66 |
|      crt screen     |  8.95 | 22.34 |
|        plate        | 44.03 | 56.13 |
|       monitor       | 17.63 | 25.29 |
|    bulletin board   | 48.35 | 63.72 |
|        shower       |  1.5  |  1.84 |
|       radiator      | 54.07 | 59.67 |
|        glass        | 14.34 | 15.37 |
|        clock        | 35.09 | 41.25 |
|         flag        | 32.05 | 34.79 |
+---------------------+-------+-------+
09/15 19:58:46 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.2400  mIoU: 47.2800  mAcc: 58.5500  data_time: 0.0018  time: 0.2806
Finished processing corruption type: brightness
Processing corruption type: contrast
09/15 19:58:49 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 788966395
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 788966395
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 19:58:49 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='contrast',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/contrast'

09/15 19:58:52 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 19:58:52 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 19:58:53 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 19:58:53 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 19:59:41 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:15  time: 0.5883  data_time: 0.0016  memory: 19841  
09/15 20:00:07 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:25  time: 0.3818  data_time: 0.0016  memory: 19792  
09/15 20:00:15 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:16:52  time: 0.1759  data_time: 0.0016  memory: 13446  
09/15 20:00:27 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:14:09  time: 0.2244  data_time: 0.0015  memory: 16826  
09/15 20:00:37 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:12:10  time: 0.1367  data_time: 0.0015  memory: 16834  
09/15 20:00:45 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:35  time: 0.0611  data_time: 0.0016  memory: 13449  
09/15 20:00:55 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:09:36  time: 0.0940  data_time: 0.0015  memory: 13451  
09/15 20:01:04 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:08:43  time: 0.1685  data_time: 0.0014  memory: 13451  
09/15 20:01:08 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:07:45  time: 0.0747  data_time: 0.0015  memory: 8614  
09/15 20:01:13 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:06:58  time: 0.0576  data_time: 0.0015  memory: 13440  
09/15 20:01:18 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:06:22  time: 0.2115  data_time: 0.0016  memory: 8622  
09/15 20:01:23 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:05:49  time: 0.1474  data_time: 0.0016  memory: 8622  
09/15 20:01:30 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:05:26  time: 0.2189  data_time: 0.0014  memory: 13453  
09/15 20:01:37 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:05:04  time: 0.0611  data_time: 0.0016  memory: 13451  
09/15 20:01:45 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:04:46  time: 0.1949  data_time: 0.0015  memory: 13456  
09/15 20:01:49 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:04:23  time: 0.0602  data_time: 0.0017  memory: 8615  
09/15 20:01:52 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:04:01  time: 0.0595  data_time: 0.0017  memory: 633  
09/15 20:01:55 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:03:42  time: 0.0724  data_time: 0.0015  memory: 8609  
09/15 20:02:02 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:03:28  time: 0.0941  data_time: 0.0016  memory: 13441  
09/15 20:02:07 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:03:13  time: 0.0572  data_time: 0.0015  memory: 8622  
09/15 20:02:14 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:03:01  time: 0.2202  data_time: 0.0015  memory: 13453  
09/15 20:02:19 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:02:48  time: 0.0570  data_time: 0.0015  memory: 13446  
09/15 20:02:22 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:02:34  time: 0.0757  data_time: 0.0015  memory: 13442  
09/15 20:02:25 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:02:21  time: 0.0577  data_time: 0.0015  memory: 1829  
09/15 20:02:30 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:02:10  time: 0.0743  data_time: 0.0014  memory: 13447  
09/15 20:02:33 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:01:58  time: 0.0775  data_time: 0.0015  memory: 633  
09/15 20:02:36 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:01:47  time: 0.0586  data_time: 0.0015  memory: 8599  
09/15 20:02:43 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:01:38  time: 0.1719  data_time: 0.0015  memory: 13448  
09/15 20:02:47 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:01:28  time: 0.1060  data_time: 0.0014  memory: 8609  
09/15 20:02:50 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:18  time: 0.0567  data_time: 0.0014  memory: 633  
09/15 20:02:54 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:09  time: 0.0594  data_time: 0.0015  memory: 8620  
09/15 20:02:57 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:00  time: 0.0580  data_time: 0.0016  memory: 624  
09/15 20:03:03 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:00:52  time: 0.0557  data_time: 0.0014  memory: 16824  
09/15 20:03:07 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:00:44  time: 0.0603  data_time: 0.0016  memory: 8612  
09/15 20:03:12 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:36  time: 0.0584  data_time: 0.0014  memory: 8618  
09/15 20:03:15 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:29  time: 0.0597  data_time: 0.0016  memory: 8600  
09/15 20:03:18 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:21  time: 0.0743  data_time: 0.0016  memory: 582  
09/15 20:03:22 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:14  time: 0.0591  data_time: 0.0015  memory: 8626  
09/15 20:03:27 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:07  time: 0.0571  data_time: 0.0014  memory: 16829  
09/15 20:03:31 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0545  data_time: 0.0014  memory: 8626  
09/15 20:03:31 - mmengine - INFO - per class results:
09/15 20:03:31 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 76.35 | 88.58 |
|       building      | 81.84 | 92.61 |
|         sky         | 93.84 | 97.31 |
|        floor        | 80.29 | 90.51 |
|         tree        | 72.63 | 87.51 |
|       ceiling       | 83.39 | 91.63 |
|         road        | 82.34 |  90.0 |
|         bed         | 87.26 | 95.15 |
|      windowpane     | 59.86 | 75.84 |
|        grass        | 65.29 | 82.66 |
|       cabinet       |  59.2 | 73.44 |
|       sidewalk      | 64.09 | 79.19 |
|        person       | 77.17 | 90.18 |
|        earth        | 35.22 | 50.68 |
|         door        | 47.79 | 61.88 |
|        table        | 56.14 | 73.32 |
|       mountain      | 56.52 |  73.7 |
|        plant        | 49.33 | 59.37 |
|       curtain       |  70.6 | 82.03 |
|        chair        | 54.72 | 69.88 |
|         car         | 83.93 | 91.78 |
|        water        | 50.91 |  68.8 |
|       painting      | 70.01 | 84.76 |
|         sofa        | 65.53 | 82.89 |
|        shelf        | 40.27 | 57.08 |
|        house        | 38.78 | 48.36 |
|         sea         | 56.15 | 76.29 |
|        mirror       |  60.3 | 68.14 |
|         rug         | 59.22 | 66.24 |
|        field        | 30.63 | 44.11 |
|       armchair      | 42.56 |  57.8 |
|         seat        | 62.01 | 80.65 |
|        fence        | 42.77 | 57.01 |
|         desk        | 46.87 | 66.34 |
|         rock        | 41.96 | 61.95 |
|       wardrobe      | 44.97 | 63.14 |
|         lamp        | 60.91 | 73.55 |
|       bathtub       | 75.33 | 80.79 |
|       railing       | 32.72 | 45.92 |
|       cushion       | 51.83 | 67.05 |
|         base        | 29.66 | 38.03 |
|         box         | 24.22 | 32.12 |
|        column       | 42.43 | 52.53 |
|      signboard      | 35.82 | 48.61 |
|   chest of drawers  | 40.64 | 57.56 |
|       counter       | 25.61 | 37.75 |
|         sand        | 43.43 | 58.06 |
|         sink        | 70.82 | 78.72 |
|      skyscraper     | 40.08 | 48.68 |
|      fireplace      | 70.14 | 82.61 |
|     refrigerator    | 74.36 | 82.47 |
|      grandstand     | 38.59 | 62.43 |
|         path        | 14.95 | 22.57 |
|        stairs       | 28.33 | 33.74 |
|        runway       | 69.22 |  90.6 |
|         case        | 39.23 |  53.5 |
|      pool table     | 91.05 |  94.4 |
|        pillow       | 52.42 | 65.13 |
|     screen door     | 68.16 | 81.21 |
|       stairway      | 25.35 | 32.88 |
|        river        |  11.5 | 20.03 |
|        bridge       | 36.25 | 43.31 |
|       bookcase      | 41.51 | 58.95 |
|        blind        | 39.54 | 46.61 |
|     coffee table    |  53.0 | 75.53 |
|        toilet       | 76.35 | 90.42 |
|        flower       | 34.64 | 46.46 |
|         book        | 43.27 | 64.59 |
|         hill        |  6.92 | 10.33 |
|        bench        | 40.58 |  47.6 |
|      countertop     | 58.87 | 74.17 |
|        stove        | 71.86 | 76.86 |
|         palm        | 46.58 | 61.32 |
|    kitchen island   |  37.1 | 57.72 |
|       computer      | 59.17 | 68.37 |
|     swivel chair    | 46.19 | 60.57 |
|         boat        | 60.45 | 78.73 |
|         bar         | 36.52 | 40.71 |
|    arcade machine   | 40.05 |  42.4 |
|        hovel        | 45.89 | 55.94 |
|         bus         | 87.97 | 94.06 |
|        towel        |  58.0 | 76.78 |
|        light        | 48.81 | 55.32 |
|        truck        | 38.09 | 48.07 |
|        tower        | 18.33 | 27.72 |
|      chandelier     | 65.97 | 78.81 |
|        awning       | 23.36 | 27.07 |
|     streetlight     | 22.55 | 30.97 |
|        booth        | 52.41 | 58.62 |
| television receiver | 67.82 | 73.84 |
|       airplane      |  54.8 | 66.23 |
|      dirt track     | 23.36 | 50.08 |
|       apparel       | 28.63 | 43.75 |
|         pole        | 17.78 | 24.65 |
|         land        |  6.05 |  8.82 |
|      bannister      | 10.13 | 13.25 |
|      escalator      | 25.45 | 26.76 |
|       ottoman       | 45.19 | 53.95 |
|        bottle       | 35.74 | 55.54 |
|        buffet       | 47.14 | 56.24 |
|        poster       | 33.15 |  39.7 |
|        stage        | 20.64 |  27.2 |
|         van         | 44.68 | 61.13 |
|         ship        | 65.37 | 72.79 |
|       fountain      | 20.79 | 21.04 |
|    conveyer belt    | 83.73 | 87.41 |
|        canopy       | 34.05 | 37.99 |
|        washer       | 66.76 |  71.0 |
|      plaything      | 19.56 |  29.4 |
|    swimming pool    | 43.57 | 67.33 |
|        stool        | 35.91 | 47.05 |
|        barrel       | 46.19 | 67.35 |
|        basket       | 26.49 | 33.57 |
|      waterfall      | 48.64 | 53.83 |
|         tent        | 94.88 |  98.1 |
|         bag         |  8.59 |  10.3 |
|       minibike      | 66.94 | 75.64 |
|        cradle       |  81.2 | 95.04 |
|         oven        | 24.41 | 52.78 |
|         ball        |  23.4 | 23.92 |
|         food        | 46.47 | 54.72 |
|         step        |  8.38 | 10.12 |
|         tank        | 39.91 |  43.5 |
|      trade name     | 24.55 | 27.57 |
|      microwave      | 56.87 | 61.95 |
|         pot         | 41.01 | 47.56 |
|        animal       | 53.76 | 57.43 |
|       bicycle       | 49.89 | 72.52 |
|         lake        | 56.99 | 63.38 |
|      dishwasher     | 57.65 | 69.22 |
|        screen       | 62.65 |  74.0 |
|       blanket       | 13.74 | 16.32 |
|      sculpture      | 58.12 | 73.76 |
|         hood        | 52.28 |  56.7 |
|        sconce       | 44.45 |  55.3 |
|         vase        | 37.42 |  53.6 |
|    traffic light    | 27.93 | 44.02 |
|         tray        |  7.42 | 16.73 |
|        ashcan       | 33.16 | 41.43 |
|         fan         | 60.64 | 75.84 |
|         pier        | 50.53 | 70.51 |
|      crt screen     |  4.2  |  12.7 |
|        plate        | 48.67 | 61.52 |
|       monitor       |  5.92 |  7.49 |
|    bulletin board   | 44.85 | 58.38 |
|        shower       |  1.75 |  1.84 |
|       radiator      | 54.22 | 60.71 |
|        glass        | 15.13 | 16.44 |
|        clock        | 35.46 | 42.44 |
|         flag        | 27.87 | 29.95 |
+---------------------+-------+-------+
09/15 20:03:31 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.0200  mIoU: 46.7400  mAcc: 57.6200  data_time: 0.0017  time: 0.1390
Finished processing corruption type: contrast
Processing corruption type: elastic_transform
09/15 20:03:34 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1744269695
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1744269695
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 20:03:35 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/elastic_transform'

09/15 20:03:38 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 20:03:38 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 20:03:38 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 20:03:39 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 20:05:13 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:01:02  time: 1.5135  data_time: 0.0021  memory: 19841  
09/15 20:06:24 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:52:20  time: 1.3375  data_time: 0.0017  memory: 19792  
09/15 20:07:19 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:45:08  time: 1.1191  data_time: 0.0016  memory: 13446  
09/15 20:08:17 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:41:41  time: 1.1255  data_time: 0.0015  memory: 16826  
09/15 20:09:12 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:38:50  time: 1.0593  data_time: 0.0015  memory: 16834  
09/15 20:10:07 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:36:37  time: 1.0105  data_time: 0.0016  memory: 13449  
09/15 20:11:03 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:34:52  time: 0.9858  data_time: 0.0015  memory: 13451  
09/15 20:11:57 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:33:12  time: 1.1106  data_time: 0.0015  memory: 13451  
09/15 20:12:42 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:31:11  time: 0.8994  data_time: 0.0015  memory: 8614  
09/15 20:13:31 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:29:37  time: 0.9691  data_time: 0.0015  memory: 13440  
09/15 20:14:25 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:28:24  time: 1.1455  data_time: 0.0015  memory: 8622  
09/15 20:15:15 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:27:04  time: 1.0772  data_time: 0.0016  memory: 8622  
09/15 20:16:08 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:25:55  time: 1.1689  data_time: 0.0014  memory: 13453  
09/15 20:17:03 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:24:52  time: 1.0081  data_time: 0.0016  memory: 13451  
09/15 20:17:56 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:23:48  time: 1.0761  data_time: 0.0014  memory: 13456  
09/15 20:18:43 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:22:35  time: 0.9718  data_time: 0.0016  memory: 8615  
09/15 20:19:31 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:21:28  time: 0.9854  data_time: 0.0017  memory: 633  
09/15 20:20:17 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:20:19  time: 0.8750  data_time: 0.0016  memory: 8609  
09/15 20:21:09 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:19:20  time: 0.9743  data_time: 0.0015  memory: 13441  
09/15 20:21:57 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:18:18  time: 0.9289  data_time: 0.0015  memory: 8622  
09/15 20:22:51 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:17:22  time: 1.1577  data_time: 0.0015  memory: 13453  
09/15 20:23:41 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:16:23  time: 0.9547  data_time: 0.0016  memory: 13446  
09/15 20:24:29 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:15:24  time: 0.9833  data_time: 0.0015  memory: 13442  
09/15 20:25:18 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:14:26  time: 0.9397  data_time: 0.0015  memory: 1829  
09/15 20:26:06 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:13:28  time: 0.9484  data_time: 0.0015  memory: 13447  
09/15 20:26:51 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:12:29  time: 0.9711  data_time: 0.0015  memory: 633  
09/15 20:27:39 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:11:33  time: 0.8931  data_time: 0.0015  memory: 8599  
09/15 20:28:30 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:10:39  time: 1.1175  data_time: 0.0014  memory: 13448  
09/15 20:29:16 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:09:43  time: 1.0381  data_time: 0.0015  memory: 8609  
09/15 20:30:03 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:08:47  time: 0.8847  data_time: 0.0015  memory: 633  
09/15 20:30:53 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:07:54  time: 0.9721  data_time: 0.0015  memory: 8620  
09/15 20:31:39 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:00  time: 0.9399  data_time: 0.0016  memory: 624  
09/15 20:32:28 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:06  time: 0.8734  data_time: 0.0025  memory: 16824  
09/15 20:33:18 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:13  time: 0.9562  data_time: 0.0016  memory: 8612  
09/15 20:34:08 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:21  time: 0.9413  data_time: 0.0014  memory: 8618  
09/15 20:34:54 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:28  time: 0.9783  data_time: 0.0016  memory: 8600  
09/15 20:35:42 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:35  time: 0.9603  data_time: 0.0016  memory: 582  
09/15 20:36:28 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:43  time: 0.9243  data_time: 0.0014  memory: 8626  
09/15 20:37:17 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:51  time: 0.9249  data_time: 0.0014  memory: 16829  
09/15 20:38:04 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.8592  data_time: 0.0014  memory: 8626  
09/15 20:38:04 - mmengine - INFO - per class results:
09/15 20:38:04 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 63.28 | 78.85 |
|       building      | 74.56 | 88.15 |
|         sky         | 84.33 | 92.08 |
|        floor        | 68.35 | 81.94 |
|         tree        | 63.46 |  79.9 |
|       ceiling       | 69.92 | 83.89 |
|         road        | 75.39 | 85.39 |
|         bed         | 76.32 | 87.76 |
|      windowpane     | 47.66 | 64.83 |
|        grass        | 59.45 | 77.96 |
|       cabinet       | 49.71 | 64.49 |
|       sidewalk      | 50.92 | 68.55 |
|        person       | 59.31 | 77.44 |
|        earth        | 32.48 | 47.06 |
|         door        | 37.68 |  48.7 |
|        table        | 41.67 | 61.65 |
|       mountain      | 48.92 | 62.68 |
|        plant        | 40.83 | 54.29 |
|       curtain       | 52.32 | 69.68 |
|        chair        | 39.63 | 55.91 |
|         car         | 62.51 | 77.67 |
|        water        | 51.15 | 67.29 |
|       painting      | 45.86 | 64.84 |
|         sofa        | 51.58 | 72.65 |
|        shelf        | 34.96 | 53.12 |
|        house        | 41.75 | 51.17 |
|         sea         | 51.76 | 73.83 |
|        mirror       | 53.08 | 64.55 |
|         rug         | 49.17 | 64.17 |
|        field        | 28.82 | 40.48 |
|       armchair      | 28.54 | 41.35 |
|         seat        | 53.85 | 76.39 |
|        fence        | 33.55 | 48.18 |
|         desk        | 40.28 | 61.79 |
|         rock        | 33.84 | 57.11 |
|       wardrobe      | 43.67 | 63.75 |
|         lamp        | 30.06 | 46.23 |
|       bathtub       | 59.79 | 69.87 |
|       railing       | 26.28 | 39.75 |
|       cushion       | 34.79 | 49.07 |
|         base        | 27.46 | 36.72 |
|         box         | 19.65 | 27.08 |
|        column       | 28.45 | 42.58 |
|      signboard      | 23.36 | 36.85 |
|   chest of drawers  | 33.34 | 47.99 |
|       counter       | 20.27 | 27.66 |
|         sand        | 32.83 | 49.11 |
|         sink        |  49.0 | 62.89 |
|      skyscraper     | 41.62 | 53.23 |
|      fireplace      | 61.68 | 79.46 |
|     refrigerator    | 62.04 | 73.73 |
|      grandstand     | 37.68 | 62.97 |
|         path        |  9.83 | 15.33 |
|        stairs       | 19.47 | 23.71 |
|        runway       | 68.76 | 83.07 |
|         case        | 46.33 | 57.31 |
|      pool table     | 76.57 |  86.5 |
|        pillow       | 40.27 | 53.56 |
|     screen door     | 58.44 | 76.38 |
|       stairway      | 21.55 | 33.13 |
|        river        | 12.07 | 19.78 |
|        bridge       | 35.84 | 44.26 |
|       bookcase      | 35.05 | 51.23 |
|        blind        | 35.07 | 42.31 |
|     coffee table    |  37.8 | 62.92 |
|        toilet       | 52.89 | 70.73 |
|        flower       |  27.9 |  43.6 |
|         book        | 30.68 | 46.41 |
|         hill        |  9.65 | 15.69 |
|        bench        | 33.33 | 40.42 |
|      countertop     | 39.59 |  56.5 |
|        stove        | 65.22 | 75.96 |
|         palm        | 35.81 |  52.4 |
|    kitchen island   | 27.79 | 47.74 |
|       computer      | 48.35 | 61.39 |
|     swivel chair    | 35.49 | 54.69 |
|         boat        | 52.12 | 77.25 |
|         bar         | 39.77 |  47.4 |
|    arcade machine   | 35.69 | 40.51 |
|        hovel        | 42.33 |  51.5 |
|         bus         | 71.14 | 87.73 |
|        towel        |  33.3 | 49.29 |
|        light        | 15.69 | 24.44 |
|        truck        | 31.19 | 47.05 |
|        tower        | 20.89 | 27.73 |
|      chandelier     | 38.77 |  55.6 |
|        awning       | 21.28 |  25.9 |
|     streetlight     |  8.24 | 13.18 |
|        booth        | 42.48 | 50.08 |
| television receiver |  41.0 | 55.32 |
|       airplane      | 36.61 | 50.32 |
|      dirt track     | 15.86 | 42.21 |
|       apparel       | 22.04 | 36.69 |
|         pole        |  8.97 | 13.31 |
|         land        |  3.74 |  5.26 |
|      bannister      |  6.88 |  9.84 |
|      escalator      | 25.38 | 27.78 |
|       ottoman       | 35.18 |  44.6 |
|        bottle       | 27.56 | 47.65 |
|        buffet       | 45.49 | 52.36 |
|        poster       | 20.14 | 26.21 |
|        stage        | 16.58 | 23.52 |
|         van         | 31.01 |  43.6 |
|         ship        | 28.95 | 34.02 |
|       fountain      | 17.33 | 20.21 |
|    conveyer belt    | 72.38 | 84.14 |
|        canopy       | 32.81 | 43.34 |
|        washer       | 61.82 | 68.63 |
|      plaything      | 10.44 | 17.63 |
|    swimming pool    | 57.47 | 82.37 |
|        stool        | 20.89 | 32.01 |
|        barrel       | 37.09 | 53.89 |
|        basket       | 19.76 | 24.46 |
|      waterfall      | 59.72 | 72.21 |
|         tent        | 77.26 | 87.76 |
|         bag         |  9.05 | 11.75 |
|       minibike      | 49.04 | 65.47 |
|        cradle       |  66.1 | 86.51 |
|         oven        | 22.48 | 54.55 |
|         ball        | 13.55 | 14.55 |
|         food        | 39.09 |  50.8 |
|         step        |  6.42 |  7.58 |
|         tank        | 37.01 | 40.19 |
|      trade name     | 13.71 | 15.81 |
|      microwave      | 44.95 | 52.05 |
|         pot         | 23.91 | 33.24 |
|        animal       | 44.73 |  52.7 |
|       bicycle       | 35.63 | 56.47 |
|         lake        | 50.26 | 61.89 |
|      dishwasher     | 43.84 | 55.76 |
|        screen       | 49.41 | 71.83 |
|       blanket       | 11.31 | 14.87 |
|      sculpture      | 42.61 | 62.94 |
|         hood        | 37.08 | 48.34 |
|        sconce       | 16.87 | 25.93 |
|         vase        | 17.54 | 30.86 |
|    traffic light    | 16.06 | 28.41 |
|         tray        |  5.55 | 12.61 |
|        ashcan       | 19.76 | 30.57 |
|         fan         | 27.95 | 42.73 |
|         pier        | 45.47 | 66.39 |
|      crt screen     | 11.03 | 19.22 |
|        plate        | 24.64 | 35.03 |
|       monitor       | 26.78 |  36.6 |
|    bulletin board   | 39.54 | 55.43 |
|        shower       |  0.65 |  0.77 |
|       radiator      | 38.45 | 47.69 |
|        glass        |  8.32 |  9.75 |
|        clock        | 22.67 | 30.81 |
|         flag        | 17.48 | 20.63 |
+---------------------+-------+-------+
09/15 20:38:04 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 74.3800  mIoU: 37.3100  mAcc: 49.8500  data_time: 0.0017  time: 1.0324
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
09/15 20:38:07 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 443918559
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 443918559
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 20:38:07 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/pixelate'

09/15 20:38:10 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 20:38:10 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 20:38:11 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 20:38:11 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 20:38:59 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:30:59  time: 0.5665  data_time: 0.0021  memory: 19841  
09/15 20:39:23 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:22:55  time: 0.3660  data_time: 0.0016  memory: 19792  
09/15 20:39:31 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:16:25  time: 0.1592  data_time: 0.0015  memory: 13446  
09/15 20:39:41 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:13:33  time: 0.1957  data_time: 0.0015  memory: 16826  
09/15 20:39:50 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:11:33  time: 0.0841  data_time: 0.0014  memory: 16834  
09/15 20:39:57 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:01  time: 0.0507  data_time: 0.0016  memory: 13449  
09/15 20:40:06 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:09:01  time: 0.0837  data_time: 0.0014  memory: 13451  
09/15 20:40:14 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:08:10  time: 0.1593  data_time: 0.0014  memory: 13451  
09/15 20:40:17 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:07:14  time: 0.0631  data_time: 0.0014  memory: 8614  
09/15 20:40:21 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:06:28  time: 0.0472  data_time: 0.0014  memory: 13440  
09/15 20:40:25 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:05:54  time: 0.1682  data_time: 0.0015  memory: 8622  
09/15 20:40:29 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:05:22  time: 0.1305  data_time: 0.0015  memory: 8622  
09/15 20:40:36 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:05:00  time: 0.1879  data_time: 0.0014  memory: 13453  
09/15 20:40:42 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:04:40  time: 0.0488  data_time: 0.0016  memory: 13451  
09/15 20:40:49 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:04:23  time: 0.1833  data_time: 0.0014  memory: 13456  
09/15 20:40:53 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:04:02  time: 0.0483  data_time: 0.0016  memory: 8615  
09/15 20:40:55 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:03:42  time: 0.0484  data_time: 0.0016  memory: 633  
09/15 20:40:58 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:03:24  time: 0.0626  data_time: 0.0013  memory: 8609  
09/15 20:41:04 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:03:10  time: 0.0825  data_time: 0.0015  memory: 13441  
09/15 20:41:08 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:02:57  time: 0.0478  data_time: 0.0015  memory: 8622  
09/15 20:41:15 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:02:46  time: 0.2046  data_time: 0.0015  memory: 13453  
09/15 20:41:19 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:02:33  time: 0.0480  data_time: 0.0015  memory: 13446  
09/15 20:41:22 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:02:21  time: 0.0660  data_time: 0.0015  memory: 13442  
09/15 20:41:25 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:02:09  time: 0.0476  data_time: 0.0014  memory: 1829  
09/15 20:41:29 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:01:58  time: 0.0646  data_time: 0.0014  memory: 13447  
09/15 20:41:31 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:01:47  time: 0.0487  data_time: 0.0014  memory: 633  
09/15 20:41:34 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:01:37  time: 0.0474  data_time: 0.0014  memory: 8599  
09/15 20:41:40 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:01:29  time: 0.1592  data_time: 0.0014  memory: 13448  
09/15 20:41:43 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:01:20  time: 0.0945  data_time: 0.0014  memory: 8609  
09/15 20:41:45 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:11  time: 0.0470  data_time: 0.0014  memory: 633  
09/15 20:41:49 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:03  time: 0.0490  data_time: 0.0014  memory: 8620  
09/15 20:41:51 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:00:54  time: 0.0485  data_time: 0.0015  memory: 624  
09/15 20:41:56 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:00:47  time: 0.0459  data_time: 0.0013  memory: 16824  
09/15 20:42:00 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:00:40  time: 0.0482  data_time: 0.0016  memory: 8612  
09/15 20:42:04 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:33  time: 0.0477  data_time: 0.0014  memory: 8618  
09/15 20:42:07 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:26  time: 0.0486  data_time: 0.0016  memory: 8600  
09/15 20:42:09 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:19  time: 0.0490  data_time: 0.0016  memory: 582  
09/15 20:42:13 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:12  time: 0.0474  data_time: 0.0014  memory: 8626  
09/15 20:42:16 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:06  time: 0.0476  data_time: 0.0014  memory: 16829  
09/15 20:42:20 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0449  data_time: 0.0013  memory: 8626  
09/15 20:42:20 - mmengine - INFO - per class results:
09/15 20:42:20 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.87 | 88.97 |
|       building      | 80.37 | 93.84 |
|         sky         | 93.97 | 97.23 |
|        floor        | 79.68 | 90.41 |
|         tree        | 71.89 | 86.32 |
|       ceiling       |  82.6 | 91.44 |
|         road        | 82.21 | 90.68 |
|         bed         | 87.23 | 93.86 |
|      windowpane     | 58.79 | 75.61 |
|        grass        | 64.05 | 77.71 |
|       cabinet       | 57.61 | 71.88 |
|       sidewalk      | 61.43 | 76.67 |
|        person       | 77.03 |  87.0 |
|        earth        | 32.85 | 49.52 |
|         door        | 46.13 | 62.06 |
|        table        | 53.26 | 70.56 |
|       mountain      | 57.77 | 69.72 |
|        plant        | 47.62 | 57.33 |
|       curtain       | 70.76 |  82.2 |
|        chair        | 52.77 | 64.99 |
|         car         |  81.0 | 88.43 |
|        water        | 49.17 | 66.59 |
|       painting      | 73.27 | 83.97 |
|         sofa        | 62.04 | 83.77 |
|        shelf        | 42.46 | 60.73 |
|        house        | 31.08 | 38.19 |
|         sea         | 52.99 | 74.93 |
|        mirror       | 57.01 | 65.43 |
|         rug         | 58.17 | 67.69 |
|        field        | 30.27 | 46.79 |
|       armchair      |  35.5 | 45.91 |
|         seat        |  57.9 | 82.15 |
|        fence        | 42.48 | 57.13 |
|         desk        | 47.79 | 64.04 |
|         rock        | 40.94 | 53.52 |
|       wardrobe      | 43.59 | 60.57 |
|         lamp        | 59.03 | 70.17 |
|       bathtub       | 72.48 | 77.19 |
|       railing       | 31.22 | 43.61 |
|       cushion       |  48.9 | 61.08 |
|         base        | 26.38 | 33.95 |
|         box         | 22.56 | 33.87 |
|        column       | 42.03 | 52.71 |
|      signboard      | 35.09 |  45.0 |
|   chest of drawers  | 38.02 | 58.51 |
|       counter       | 23.11 | 35.78 |
|         sand        | 36.54 | 50.97 |
|         sink        | 67.46 | 76.43 |
|      skyscraper     |  41.1 | 45.26 |
|      fireplace      | 68.74 | 78.84 |
|     refrigerator    | 74.77 | 82.65 |
|      grandstand     | 37.88 | 63.22 |
|         path        | 15.95 | 23.78 |
|        stairs       | 30.93 | 39.33 |
|        runway       | 71.11 | 88.84 |
|         case        | 46.34 | 61.29 |
|      pool table     | 91.47 | 95.07 |
|        pillow       | 48.18 | 60.66 |
|     screen door     | 66.83 | 77.65 |
|       stairway      | 26.93 | 39.15 |
|        river        | 17.83 | 33.12 |
|        bridge       | 66.18 | 79.36 |
|       bookcase      | 39.85 | 56.33 |
|        blind        | 37.76 | 42.86 |
|     coffee table    | 55.39 | 77.08 |
|        toilet       | 79.04 | 88.39 |
|        flower       | 31.35 | 43.51 |
|         book        | 41.95 | 64.05 |
|         hill        |  7.01 | 12.49 |
|        bench        | 34.27 | 41.21 |
|      countertop     | 54.15 | 64.56 |
|        stove        | 70.51 | 78.61 |
|         palm        | 45.04 | 55.34 |
|    kitchen island   | 30.18 | 54.63 |
|       computer      |  58.4 | 66.57 |
|     swivel chair    | 45.45 | 60.51 |
|         boat        | 46.18 | 61.19 |
|         bar         | 40.78 | 45.31 |
|    arcade machine   | 28.48 | 29.86 |
|        hovel        | 43.31 | 48.39 |
|         bus         | 86.56 | 93.62 |
|        towel        | 55.58 | 67.61 |
|        light        | 51.47 | 59.21 |
|        truck        | 36.63 | 54.63 |
|        tower        | 11.37 | 14.17 |
|      chandelier     | 60.89 | 80.06 |
|        awning       | 23.12 | 25.34 |
|     streetlight     |  21.9 | 29.25 |
|        booth        | 40.28 | 43.76 |
| television receiver | 65.57 | 76.52 |
|       airplane      | 53.87 | 61.23 |
|      dirt track     | 21.56 | 37.43 |
|       apparel       | 27.88 | 39.79 |
|         pole        | 18.86 | 27.17 |
|         land        |  5.86 |  9.06 |
|      bannister      |  4.04 |  4.81 |
|      escalator      |  21.8 | 22.45 |
|       ottoman       | 46.18 | 54.76 |
|        bottle       | 32.56 | 49.25 |
|        buffet       | 44.23 | 52.84 |
|        poster       | 29.82 | 34.41 |
|        stage        |  17.9 | 24.94 |
|         van         | 38.29 | 60.42 |
|         ship        | 20.46 | 26.63 |
|       fountain      | 23.73 | 24.44 |
|    conveyer belt    | 82.41 | 87.72 |
|        canopy       | 19.41 | 20.37 |
|        washer       |  63.8 | 65.58 |
|      plaything      | 15.98 | 22.22 |
|    swimming pool    | 54.93 | 84.71 |
|        stool        | 34.71 |  43.8 |
|        barrel       | 29.54 | 68.95 |
|        basket       | 27.45 | 33.37 |
|      waterfall      | 52.49 | 59.03 |
|         tent        | 95.69 | 97.37 |
|         bag         |  6.52 |  7.0  |
|       minibike      |  45.5 | 48.67 |
|        cradle       | 79.07 | 94.76 |
|         oven        | 21.54 | 47.67 |
|         ball        | 27.06 | 27.72 |
|         food        | 38.69 | 46.31 |
|         step        |  7.34 |  8.43 |
|         tank        | 37.43 | 41.65 |
|      trade name     | 28.26 | 31.91 |
|      microwave      | 53.44 | 60.48 |
|         pot         | 40.14 | 46.21 |
|        animal       | 50.75 | 54.52 |
|       bicycle       | 50.66 | 67.97 |
|         lake        | 56.11 | 63.47 |
|      dishwasher     | 57.36 | 71.84 |
|        screen       | 62.71 | 84.23 |
|       blanket       | 12.27 | 14.86 |
|      sculpture      | 42.85 | 52.92 |
|         hood        | 55.23 | 58.86 |
|        sconce       |  47.1 | 58.88 |
|         vase        | 33.43 | 45.87 |
|    traffic light    | 28.06 | 39.24 |
|         tray        |  6.14 |  11.5 |
|        ashcan       | 30.62 | 37.85 |
|         fan         | 60.03 | 71.41 |
|         pier        | 47.51 | 72.47 |
|      crt screen     |  8.98 | 23.95 |
|        plate        |  37.7 | 44.84 |
|       monitor       |  8.88 |  10.6 |
|    bulletin board   | 42.33 | 52.11 |
|        shower       |  0.75 |  0.77 |
|       radiator      | 51.62 | 58.11 |
|        glass        | 11.53 | 12.48 |
|        clock        | 34.89 | 40.71 |
|         flag        | 26.86 | 28.06 |
+---------------------+-------+-------+
09/15 20:42:20 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.3400  mIoU: 44.8100  mAcc: 55.4100  data_time: 0.0016  time: 0.1243
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
09/15 20:42:23 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 369035811
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 369035811
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 20:42:23 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/jpeg_compression'

09/15 20:42:26 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 20:42:26 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 20:42:27 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 20:42:27 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 20:43:15 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:30:59  time: 0.5684  data_time: 0.0015  memory: 19841  
09/15 20:43:40 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:22:58  time: 0.3685  data_time: 0.0016  memory: 19792  
09/15 20:43:48 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:16:30  time: 0.1637  data_time: 0.0015  memory: 13446  
09/15 20:43:58 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:13:39  time: 0.2031  data_time: 0.0015  memory: 16826  
09/15 20:44:07 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:11:40  time: 0.0902  data_time: 0.0014  memory: 16834  
09/15 20:44:15 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:07  time: 0.0557  data_time: 0.0015  memory: 13449  
09/15 20:44:24 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:09:08  time: 0.0888  data_time: 0.0014  memory: 13451  
09/15 20:44:32 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:08:17  time: 0.1634  data_time: 0.0013  memory: 13451  
09/15 20:44:35 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:07:20  time: 0.0665  data_time: 0.0013  memory: 8614  
09/15 20:44:39 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:06:34  time: 0.0518  data_time: 0.0014  memory: 13440  
09/15 20:44:44 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:06:00  time: 0.1738  data_time: 0.0015  memory: 8622  
09/15 20:44:48 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:05:28  time: 0.1370  data_time: 0.0015  memory: 8622  
09/15 20:44:55 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:05:06  time: 0.1906  data_time: 0.0013  memory: 13453  
09/15 20:45:02 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:04:46  time: 0.0527  data_time: 0.0015  memory: 13451  
09/15 20:45:09 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:04:28  time: 0.1893  data_time: 0.0014  memory: 13456  
09/15 20:45:13 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:04:07  time: 0.0542  data_time: 0.0015  memory: 8615  
09/15 20:45:15 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:03:46  time: 0.0530  data_time: 0.0016  memory: 633  
09/15 20:45:18 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:03:28  time: 0.0666  data_time: 0.0013  memory: 8609  
09/15 20:45:25 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:03:15  time: 0.0878  data_time: 0.0015  memory: 13441  
09/15 20:45:29 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:03:01  time: 0.0502  data_time: 0.0014  memory: 8622  
09/15 20:45:36 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:02:50  time: 0.2094  data_time: 0.0014  memory: 13453  
09/15 20:45:41 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:02:37  time: 0.0525  data_time: 0.0015  memory: 13446  
09/15 20:45:44 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:02:25  time: 0.0694  data_time: 0.0014  memory: 13442  
09/15 20:45:47 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:02:12  time: 0.0519  data_time: 0.0014  memory: 1829  
09/15 20:45:51 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:02:02  time: 0.0689  data_time: 0.0014  memory: 13447  
09/15 20:45:53 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:01:50  time: 0.0536  data_time: 0.0014  memory: 633  
09/15 20:45:56 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:01:40  time: 0.0515  data_time: 0.0013  memory: 8599  
09/15 20:46:03 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:01:32  time: 0.1641  data_time: 0.0014  memory: 13448  
09/15 20:46:06 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:01:22  time: 0.1002  data_time: 0.0014  memory: 8609  
09/15 20:46:08 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:13  time: 0.0513  data_time: 0.0013  memory: 633  
09/15 20:46:12 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:05  time: 0.0530  data_time: 0.0013  memory: 8620  
09/15 20:46:15 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:00:56  time: 0.0533  data_time: 0.0015  memory: 624  
09/15 20:46:20 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:00:49  time: 0.0496  data_time: 0.0013  memory: 16824  
09/15 20:46:24 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:00:41  time: 0.0531  data_time: 0.0015  memory: 8612  
09/15 20:46:28 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:34  time: 0.0531  data_time: 0.0013  memory: 8618  
09/15 20:46:31 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:27  time: 0.0546  data_time: 0.0015  memory: 8600  
09/15 20:46:34 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:19  time: 0.0551  data_time: 0.0016  memory: 582  
09/15 20:46:38 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:13  time: 0.0518  data_time: 0.0014  memory: 8626  
09/15 20:46:41 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:06  time: 0.0509  data_time: 0.0013  memory: 16829  
09/15 20:46:45 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0489  data_time: 0.0012  memory: 8626  
09/15 20:46:45 - mmengine - INFO - per class results:
09/15 20:46:45 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.09 | 89.01 |
|       building      | 81.47 | 93.08 |
|         sky         | 93.72 | 97.51 |
|        floor        | 78.92 | 91.21 |
|         tree        | 73.09 | 85.78 |
|       ceiling       | 81.57 | 89.66 |
|         road        | 81.89 | 91.57 |
|         bed         | 84.95 | 93.56 |
|      windowpane     |  57.7 | 75.87 |
|        grass        | 65.49 | 82.15 |
|       cabinet       | 57.74 | 71.07 |
|       sidewalk      | 60.81 | 74.02 |
|        person       |  76.7 | 89.34 |
|        earth        | 35.23 | 52.02 |
|         door        | 42.41 | 54.73 |
|        table        | 56.17 | 74.33 |
|       mountain      | 58.86 |  72.8 |
|        plant        | 47.93 | 56.86 |
|       curtain       | 71.15 |  80.2 |
|        chair        | 52.06 | 63.82 |
|         car         |  83.2 | 91.17 |
|        water        | 49.12 | 64.33 |
|       painting      | 69.28 | 79.91 |
|         sofa        | 63.84 | 82.74 |
|        shelf        | 41.28 | 58.64 |
|        house        | 48.06 | 56.93 |
|         sea         | 53.34 | 77.16 |
|        mirror       | 58.96 | 67.32 |
|         rug         | 53.64 | 59.66 |
|        field        | 29.13 | 39.86 |
|       armchair      | 38.79 | 51.57 |
|         seat        | 58.98 |  81.3 |
|        fence        | 42.85 | 55.94 |
|         desk        | 47.71 | 69.14 |
|         rock        | 47.39 | 71.37 |
|       wardrobe      | 43.96 |  63.5 |
|         lamp        | 58.67 | 69.29 |
|       bathtub       | 75.85 | 81.79 |
|       railing       | 34.06 | 43.18 |
|       cushion       | 49.39 | 62.12 |
|         base        | 28.49 | 38.41 |
|         box         | 21.39 | 29.28 |
|        column       | 42.09 | 53.04 |
|      signboard      | 34.61 |  45.2 |
|   chest of drawers  | 40.45 |  54.0 |
|       counter       | 22.75 | 30.94 |
|         sand        | 37.84 | 55.08 |
|         sink        | 67.67 | 76.74 |
|      skyscraper     | 47.14 | 59.65 |
|      fireplace      | 70.41 | 81.03 |
|     refrigerator    | 74.08 | 83.13 |
|      grandstand     | 35.71 | 56.59 |
|         path        | 18.75 | 27.42 |
|        stairs       | 23.99 |  28.4 |
|        runway       | 68.19 | 88.82 |
|         case        | 43.97 | 53.99 |
|      pool table     | 89.94 | 93.54 |
|        pillow       | 50.96 | 62.44 |
|     screen door     | 64.06 |  71.4 |
|       stairway      | 28.44 | 39.68 |
|        river        | 13.66 | 25.97 |
|        bridge       | 43.36 | 52.22 |
|       bookcase      |  38.5 | 58.39 |
|        blind        | 29.42 | 30.94 |
|     coffee table    |  57.7 | 75.48 |
|        toilet       | 79.54 | 89.23 |
|        flower       | 35.86 | 49.58 |
|         book        | 45.13 |  62.0 |
|         hill        | 10.94 | 18.97 |
|        bench        | 39.49 | 44.42 |
|      countertop     | 56.25 | 67.37 |
|        stove        | 70.55 | 78.66 |
|         palm        |  47.6 | 60.71 |
|    kitchen island   | 30.33 | 49.28 |
|       computer      | 59.37 | 67.68 |
|     swivel chair    | 47.27 | 62.36 |
|         boat        |  57.6 |  77.6 |
|         bar         | 40.84 | 47.65 |
|    arcade machine   | 61.62 | 65.52 |
|        hovel        |  39.6 | 43.55 |
|         bus         | 84.95 | 95.09 |
|        towel        | 58.21 | 69.07 |
|        light        | 50.29 | 57.88 |
|        truck        | 39.33 | 49.45 |
|        tower        | 17.11 |  26.4 |
|      chandelier     |  61.1 | 76.42 |
|        awning       |  25.0 | 28.56 |
|     streetlight     | 21.16 | 26.75 |
|        booth        | 51.49 | 57.89 |
| television receiver | 61.24 | 72.75 |
|       airplane      | 53.14 | 63.38 |
|      dirt track     | 20.89 |  54.4 |
|       apparel       | 24.45 | 33.02 |
|         pole        | 18.15 | 25.37 |
|         land        |  5.56 |  8.44 |
|      bannister      |  8.23 | 10.54 |
|      escalator      | 26.47 | 29.92 |
|       ottoman       | 34.59 |  39.8 |
|        bottle       |  33.4 |  54.6 |
|        buffet       |  44.5 | 52.25 |
|        poster       | 28.97 | 35.72 |
|        stage        | 19.17 | 24.53 |
|         van         | 41.99 | 59.46 |
|         ship        | 73.92 | 82.15 |
|       fountain      | 19.53 | 20.67 |
|    conveyer belt    | 83.51 | 88.91 |
|        canopy       | 22.93 |  27.7 |
|        washer       | 66.21 |  68.7 |
|      plaything      | 19.12 | 27.11 |
|    swimming pool    | 47.96 |  70.3 |
|        stool        | 37.16 | 47.34 |
|        barrel       | 35.36 | 41.36 |
|        basket       | 25.61 | 31.07 |
|      waterfall      |  66.9 | 72.67 |
|         tent        | 92.84 | 98.12 |
|         bag         |  6.31 |  7.64 |
|       minibike      | 66.57 | 74.15 |
|        cradle       | 75.48 | 94.39 |
|         oven        | 25.85 | 44.63 |
|         ball        |  9.25 |  9.32 |
|         food        | 40.91 | 50.49 |
|         step        |  5.24 |  5.78 |
|         tank        | 41.43 | 44.25 |
|      trade name     | 23.55 | 26.05 |
|      microwave      | 63.62 | 71.35 |
|         pot         | 38.04 | 44.21 |
|        animal       | 49.16 | 53.39 |
|       bicycle       | 49.48 | 67.45 |
|         lake        |  43.3 | 56.13 |
|      dishwasher     | 55.55 | 63.98 |
|        screen       | 60.51 | 74.55 |
|       blanket       |  7.74 |  8.5  |
|      sculpture      | 60.07 | 73.73 |
|         hood        | 54.02 | 57.11 |
|        sconce       |  43.6 | 52.68 |
|         vase        | 35.64 | 45.16 |
|    traffic light    | 27.94 | 40.44 |
|         tray        |  5.38 | 13.68 |
|        ashcan       | 32.29 | 40.25 |
|         fan         | 59.15 | 72.82 |
|         pier        | 29.44 |  46.1 |
|      crt screen     | 16.13 | 30.43 |
|        plate        | 42.37 | 54.09 |
|       monitor       | 43.75 | 53.47 |
|    bulletin board   |  46.7 | 56.35 |
|        shower       |  2.01 |  4.93 |
|       radiator      | 52.09 | 56.33 |
|        glass        | 11.25 | 11.92 |
|        clock        | 33.96 | 37.18 |
|         flag        | 37.39 | 39.98 |
+---------------------+-------+-------+
09/15 20:46:45 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.5200  mIoU: 46.0800  mAcc: 56.4800  data_time: 0.0016  time: 0.1288
Finished processing corruption type: jpeg_compression
Processing corruption type: elastic_transform
09/15 20:46:48 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 905379272
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 905379272
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 20:46:49 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/elastic_transform'

09/15 20:46:52 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 20:46:52 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 20:46:52 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 20:46:53 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 20:48:26 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:00:31  time: 1.4946  data_time: 0.0015  memory: 19841  
09/15 20:49:37 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:52:03  time: 1.3273  data_time: 0.0016  memory: 19792  
09/15 20:50:31 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:44:52  time: 1.1113  data_time: 0.0016  memory: 13446  
09/15 20:51:29 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:41:24  time: 1.1192  data_time: 0.0015  memory: 16826  
09/15 20:52:26 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:38:54  time: 1.0202  data_time: 0.0015  memory: 16834  
09/15 20:53:19 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:36:29  time: 0.9969  data_time: 0.0016  memory: 13449  
09/15 20:54:14 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:34:41  time: 0.9575  data_time: 0.0015  memory: 13451  
09/15 20:55:08 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:33:00  time: 1.1015  data_time: 0.0014  memory: 13451  
09/15 20:55:53 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:31:02  time: 0.9078  data_time: 0.0015  memory: 8614  
09/15 20:56:42 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:29:29  time: 0.9316  data_time: 0.0014  memory: 13440  
09/15 20:57:36 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:28:17  time: 1.1639  data_time: 0.0030  memory: 8622  
09/15 20:58:28 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:27:02  time: 1.0935  data_time: 0.0016  memory: 8622  
09/15 20:59:21 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:25:53  time: 1.1213  data_time: 0.0014  memory: 13453  
09/15 21:00:17 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:24:53  time: 1.0291  data_time: 0.0016  memory: 13451  
09/15 21:01:10 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:23:49  time: 1.1025  data_time: 0.0016  memory: 13456  
09/15 21:01:58 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:22:38  time: 0.9804  data_time: 0.0016  memory: 8615  
09/15 21:02:48 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:21:32  time: 0.9956  data_time: 0.0016  memory: 633  
09/15 21:03:33 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:20:23  time: 0.8816  data_time: 0.0014  memory: 8609  
09/15 21:04:27 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:19:25  time: 1.0687  data_time: 0.0015  memory: 13441  
09/15 21:05:17 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:18:24  time: 0.9493  data_time: 0.0015  memory: 8622  
09/15 21:06:10 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:17:27  time: 1.1622  data_time: 0.0014  memory: 13453  
09/15 21:07:01 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:16:28  time: 0.9527  data_time: 0.0015  memory: 13446  
09/15 21:07:49 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:15:28  time: 0.9965  data_time: 0.0014  memory: 13442  
09/15 21:08:38 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:14:30  time: 0.9381  data_time: 0.0014  memory: 1829  
09/15 21:09:26 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:13:31  time: 0.9706  data_time: 0.0015  memory: 13447  
09/15 21:10:11 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:12:33  time: 0.9719  data_time: 0.0015  memory: 633  
09/15 21:10:59 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:11:36  time: 0.8953  data_time: 0.0014  memory: 8599  
09/15 21:11:51 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:10:42  time: 1.1519  data_time: 0.0014  memory: 13448  
09/15 21:12:37 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:09:45  time: 1.0418  data_time: 0.0014  memory: 8609  
09/15 21:13:24 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:08:50  time: 0.8846  data_time: 0.0014  memory: 633  
09/15 21:14:14 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:07:56  time: 0.9773  data_time: 0.0015  memory: 8620  
09/15 21:15:01 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:01  time: 0.9395  data_time: 0.0016  memory: 624  
09/15 21:15:50 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:08  time: 0.8752  data_time: 0.0013  memory: 16824  
09/15 21:16:40 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:15  time: 0.9593  data_time: 0.0015  memory: 8612  
09/15 21:17:29 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:22  time: 0.9449  data_time: 0.0014  memory: 8618  
09/15 21:18:16 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:29  time: 0.9765  data_time: 0.0016  memory: 8600  
09/15 21:19:04 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:36  time: 0.9694  data_time: 0.0016  memory: 582  
09/15 21:19:50 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:44  time: 0.9242  data_time: 0.0015  memory: 8626  
09/15 21:20:40 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:51  time: 0.9262  data_time: 0.0014  memory: 16829  
09/15 21:21:26 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.8609  data_time: 0.0013  memory: 8626  
09/15 21:21:26 - mmengine - INFO - per class results:
09/15 21:21:26 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 63.79 | 79.28 |
|       building      |  74.2 | 87.88 |
|         sky         | 84.41 | 91.89 |
|        floor        | 68.64 | 82.64 |
|         tree        | 63.04 | 79.31 |
|       ceiling       | 69.88 | 83.01 |
|         road        |  76.2 | 86.73 |
|         bed         | 76.39 | 88.18 |
|      windowpane     | 48.31 |  65.9 |
|        grass        | 56.68 | 75.18 |
|       cabinet       | 49.47 | 64.81 |
|       sidewalk      | 51.28 | 68.97 |
|        person       | 59.65 | 77.57 |
|        earth        | 31.98 | 46.89 |
|         door        | 36.82 | 48.49 |
|        table        | 41.92 | 62.41 |
|       mountain      |  48.5 | 63.83 |
|        plant        | 41.21 |  53.8 |
|       curtain       | 53.31 |  71.7 |
|        chair        | 39.68 | 56.45 |
|         car         | 63.32 |  78.7 |
|        water        | 52.06 | 68.73 |
|       painting      | 47.43 | 65.88 |
|         sofa        | 53.01 | 73.28 |
|        shelf        | 36.18 | 55.43 |
|        house        | 28.88 | 37.92 |
|         sea         | 50.89 | 71.47 |
|        mirror       | 50.25 |  62.0 |
|         rug         | 43.69 | 54.84 |
|        field        | 25.42 | 35.61 |
|       armchair      | 31.19 | 44.25 |
|         seat        | 54.86 | 75.05 |
|        fence        | 34.13 | 48.58 |
|         desk        | 40.32 | 62.47 |
|         rock        | 31.27 | 52.08 |
|       wardrobe      |  42.5 | 61.85 |
|         lamp        | 29.84 | 47.69 |
|       bathtub       | 60.82 | 69.16 |
|       railing       | 27.13 |  41.6 |
|       cushion       | 38.01 | 52.39 |
|         base        | 27.54 | 37.31 |
|         box         | 18.79 | 27.08 |
|        column       | 28.71 | 42.99 |
|      signboard      | 22.47 | 35.04 |
|   chest of drawers  | 33.38 | 46.48 |
|       counter       | 21.58 | 29.71 |
|         sand        | 34.52 | 53.43 |
|         sink        |  47.7 | 61.16 |
|      skyscraper     | 40.01 | 51.34 |
|      fireplace      |  63.9 |  79.6 |
|     refrigerator    | 63.84 | 75.87 |
|      grandstand     | 38.36 | 64.81 |
|         path        |  9.99 | 15.62 |
|        stairs       | 21.58 | 26.45 |
|        runway       |  69.2 | 85.72 |
|         case        | 39.52 | 51.27 |
|      pool table     | 73.78 | 84.11 |
|        pillow       | 39.15 |  52.7 |
|     screen door     | 56.72 | 71.95 |
|       stairway      | 23.88 | 34.83 |
|        river        | 11.91 | 18.92 |
|        bridge       | 44.71 | 54.97 |
|       bookcase      | 30.59 | 48.37 |
|        blind        | 35.86 | 41.16 |
|     coffee table    | 41.39 | 66.34 |
|        toilet       | 52.98 | 69.31 |
|        flower       |  27.6 | 43.01 |
|         book        | 31.31 | 48.57 |
|         hill        |  6.97 | 11.29 |
|        bench        | 32.41 |  38.8 |
|      countertop     | 34.79 | 48.81 |
|        stove        |  62.8 |  72.3 |
|         palm        | 34.93 | 51.92 |
|    kitchen island   | 23.26 | 43.61 |
|       computer      | 47.21 | 58.78 |
|     swivel chair    | 31.84 | 50.28 |
|         boat        | 53.78 | 75.93 |
|         bar         | 32.62 | 39.47 |
|    arcade machine   | 46.36 | 52.76 |
|        hovel        | 45.55 | 54.12 |
|         bus         | 76.26 | 91.02 |
|        towel        | 39.24 | 58.53 |
|        light        | 16.54 | 25.46 |
|        truck        | 27.01 | 41.49 |
|        tower        |  8.0  |  12.7 |
|      chandelier     | 42.99 | 59.44 |
|        awning       | 17.95 | 23.25 |
|     streetlight     |  7.96 | 12.81 |
|        booth        | 41.26 | 47.74 |
| television receiver | 46.39 | 62.36 |
|       airplane      | 33.96 | 49.24 |
|      dirt track     | 15.56 | 50.83 |
|       apparel       | 18.65 | 33.87 |
|         pole        |  6.04 |  9.52 |
|         land        |  4.32 |  5.84 |
|      bannister      |  7.06 |  9.61 |
|      escalator      | 24.44 | 26.78 |
|       ottoman       | 39.93 | 49.06 |
|        bottle       | 26.46 | 46.89 |
|        buffet       | 37.95 | 46.86 |
|        poster       | 29.98 | 40.37 |
|        stage        | 20.01 |  27.1 |
|         van         | 39.15 | 51.27 |
|         ship        |  6.85 |  7.88 |
|       fountain      | 17.24 | 19.26 |
|    conveyer belt    | 76.43 | 83.87 |
|        canopy       | 14.79 | 18.17 |
|        washer       | 59.12 | 65.07 |
|      plaything      | 13.73 | 22.56 |
|    swimming pool    | 60.43 | 85.98 |
|        stool        | 25.34 | 37.58 |
|        barrel       | 40.63 | 59.45 |
|        basket       | 21.85 | 27.57 |
|      waterfall      | 57.09 | 75.09 |
|         tent        |  81.6 | 91.98 |
|         bag         |  7.6  |  9.78 |
|       minibike      | 55.86 | 70.94 |
|        cradle       | 70.01 | 86.97 |
|         oven        | 22.78 | 43.69 |
|         ball        |  11.5 | 12.09 |
|         food        | 37.78 | 48.85 |
|         step        |  6.21 |  7.28 |
|         tank        | 40.68 | 45.74 |
|      trade name     | 17.22 | 20.01 |
|      microwave      | 57.06 | 65.47 |
|         pot         | 26.24 |  34.8 |
|        animal       | 47.52 | 53.98 |
|       bicycle       | 38.15 | 59.75 |
|         lake        | 55.82 | 63.45 |
|      dishwasher     | 43.78 |  56.9 |
|        screen       | 58.57 | 78.09 |
|       blanket       | 13.42 | 17.88 |
|      sculpture      | 42.97 | 62.19 |
|         hood        | 41.61 | 52.91 |
|        sconce       | 21.16 | 31.65 |
|         vase        | 17.82 | 31.99 |
|    traffic light    | 13.49 |  23.7 |
|         tray        |  5.26 |  12.3 |
|        ashcan       |  18.9 | 28.81 |
|         fan         | 26.39 | 43.77 |
|         pier        | 31.39 | 50.12 |
|      crt screen     |  7.61 |  18.7 |
|        plate        | 26.53 | 37.99 |
|       monitor       | 11.26 | 13.38 |
|    bulletin board   | 41.09 | 55.94 |
|        shower       |  0.26 |  0.29 |
|       radiator      | 40.38 | 49.54 |
|        glass        |  6.88 |  7.76 |
|        clock        | 22.93 | 29.71 |
|         flag        | 19.82 | 23.15 |
+---------------------+-------+-------+
09/15 21:21:26 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 74.3100  mIoU: 37.2600  mAcc: 49.5700  data_time: 0.0016  time: 1.0368
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
09/15 21:21:50 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 752339727
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 752339727
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 21:21:50 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/pixelate'

09/15 21:21:56 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 21:21:56 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 21:21:57 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 21:21:58 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 21:22:55 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:37:02  time: 0.5672  data_time: 0.0015  memory: 19841  
09/15 21:23:20 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:25:51  time: 0.3652  data_time: 0.0016  memory: 19792  
09/15 21:23:27 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:19  time: 0.1599  data_time: 0.0015  memory: 13446  
09/15 21:23:38 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:15:00  time: 0.1976  data_time: 0.0015  memory: 16826  
09/15 21:23:47 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:12:41  time: 0.0842  data_time: 0.0014  memory: 16834  
09/15 21:23:54 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:56  time: 0.0505  data_time: 0.0016  memory: 13449  
09/15 21:24:03 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:09:48  time: 0.0828  data_time: 0.0014  memory: 13451  
09/15 21:24:11 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:08:50  time: 0.1587  data_time: 0.0013  memory: 13451  
09/15 21:24:14 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:07:48  time: 0.0629  data_time: 0.0014  memory: 8614  
09/15 21:24:18 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:06:58  time: 0.0481  data_time: 0.0014  memory: 13440  
09/15 21:24:22 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:06:20  time: 0.1696  data_time: 0.0015  memory: 8622  
09/15 21:24:27 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:05:46  time: 0.1343  data_time: 0.0035  memory: 8622  
09/15 21:24:33 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:05:22  time: 0.1880  data_time: 0.0013  memory: 13453  
09/15 21:24:40 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:05:00  time: 0.0494  data_time: 0.0015  memory: 13451  
09/15 21:24:47 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:04:40  time: 0.1988  data_time: 0.0014  memory: 13456  
09/15 21:24:50 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:04:18  time: 0.0491  data_time: 0.0016  memory: 8615  
09/15 21:24:53 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:03:56  time: 0.0496  data_time: 0.0016  memory: 633  
09/15 21:24:56 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:03:36  time: 0.0630  data_time: 0.0014  memory: 8609  
09/15 21:25:01 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:03:22  time: 0.0818  data_time: 0.0015  memory: 13441  
09/15 21:25:06 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:03:07  time: 0.0473  data_time: 0.0019  memory: 8622  
09/15 21:25:12 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:02:55  time: 0.2080  data_time: 0.0015  memory: 13453  
09/15 21:25:17 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:02:42  time: 0.0484  data_time: 0.0015  memory: 13446  
09/15 21:25:20 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:02:29  time: 0.0662  data_time: 0.0015  memory: 13442  
09/15 21:25:22 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:02:16  time: 0.0479  data_time: 0.0014  memory: 1829  
09/15 21:25:27 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:02:05  time: 0.0645  data_time: 0.0014  memory: 13447  
09/15 21:25:29 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:01:53  time: 0.0476  data_time: 0.0014  memory: 633  
09/15 21:25:32 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:01:42  time: 0.0472  data_time: 0.0014  memory: 8599  
09/15 21:25:38 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:01:33  time: 0.1605  data_time: 0.0014  memory: 13448  
09/15 21:25:41 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:01:24  time: 0.0956  data_time: 0.0017  memory: 8609  
09/15 21:25:43 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:14  time: 0.0466  data_time: 0.0014  memory: 633  
09/15 21:25:46 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:06  time: 0.0484  data_time: 0.0014  memory: 8620  
09/15 21:25:49 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:00:57  time: 0.0484  data_time: 0.0016  memory: 624  
09/15 21:25:54 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:00:50  time: 0.0468  data_time: 0.0014  memory: 16824  
09/15 21:25:58 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:00:42  time: 0.0492  data_time: 0.0016  memory: 8612  
09/15 21:26:02 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:34  time: 0.0477  data_time: 0.0014  memory: 8618  
09/15 21:26:04 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:27  time: 0.0483  data_time: 0.0015  memory: 8600  
09/15 21:26:07 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:20  time: 0.0497  data_time: 0.0016  memory: 582  
09/15 21:26:10 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:13  time: 0.0464  data_time: 0.0014  memory: 8626  
09/15 21:26:14 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:06  time: 0.0470  data_time: 0.0014  memory: 16829  
09/15 21:26:17 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0451  data_time: 0.0013  memory: 8626  
09/15 21:26:17 - mmengine - INFO - per class results:
09/15 21:26:17 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.87 | 88.97 |
|       building      | 80.37 | 93.84 |
|         sky         | 93.97 | 97.23 |
|        floor        | 79.68 | 90.41 |
|         tree        | 71.89 | 86.32 |
|       ceiling       |  82.6 | 91.44 |
|         road        | 82.21 | 90.68 |
|         bed         | 87.23 | 93.86 |
|      windowpane     | 58.79 | 75.61 |
|        grass        | 64.05 | 77.71 |
|       cabinet       | 57.61 | 71.88 |
|       sidewalk      | 61.43 | 76.67 |
|        person       | 77.03 |  87.0 |
|        earth        | 32.85 | 49.52 |
|         door        | 46.13 | 62.06 |
|        table        | 53.26 | 70.56 |
|       mountain      | 57.77 | 69.72 |
|        plant        | 47.62 | 57.33 |
|       curtain       | 70.76 |  82.2 |
|        chair        | 52.77 | 64.99 |
|         car         |  81.0 | 88.43 |
|        water        | 49.17 | 66.59 |
|       painting      | 73.27 | 83.97 |
|         sofa        | 62.04 | 83.77 |
|        shelf        | 42.46 | 60.73 |
|        house        | 31.08 | 38.19 |
|         sea         | 52.99 | 74.93 |
|        mirror       | 57.01 | 65.43 |
|         rug         | 58.17 | 67.69 |
|        field        | 30.27 | 46.79 |
|       armchair      |  35.5 | 45.91 |
|         seat        |  57.9 | 82.15 |
|        fence        | 42.48 | 57.13 |
|         desk        | 47.79 | 64.04 |
|         rock        | 40.94 | 53.52 |
|       wardrobe      | 43.59 | 60.57 |
|         lamp        | 59.03 | 70.17 |
|       bathtub       | 72.48 | 77.19 |
|       railing       | 31.22 | 43.61 |
|       cushion       |  48.9 | 61.08 |
|         base        | 26.38 | 33.95 |
|         box         | 22.56 | 33.87 |
|        column       | 42.03 | 52.71 |
|      signboard      | 35.09 |  45.0 |
|   chest of drawers  | 38.02 | 58.51 |
|       counter       | 23.11 | 35.78 |
|         sand        | 36.54 | 50.97 |
|         sink        | 67.46 | 76.43 |
|      skyscraper     |  41.1 | 45.26 |
|      fireplace      | 68.74 | 78.84 |
|     refrigerator    | 74.77 | 82.65 |
|      grandstand     | 37.88 | 63.22 |
|         path        | 15.95 | 23.78 |
|        stairs       | 30.93 | 39.33 |
|        runway       | 71.11 | 88.84 |
|         case        | 46.34 | 61.29 |
|      pool table     | 91.47 | 95.07 |
|        pillow       | 48.18 | 60.66 |
|     screen door     | 66.83 | 77.65 |
|       stairway      | 26.93 | 39.15 |
|        river        | 17.83 | 33.12 |
|        bridge       | 66.18 | 79.36 |
|       bookcase      | 39.85 | 56.33 |
|        blind        | 37.76 | 42.86 |
|     coffee table    | 55.39 | 77.08 |
|        toilet       | 79.04 | 88.39 |
|        flower       | 31.35 | 43.51 |
|         book        | 41.95 | 64.05 |
|         hill        |  7.01 | 12.49 |
|        bench        | 34.27 | 41.21 |
|      countertop     | 54.15 | 64.56 |
|        stove        | 70.51 | 78.61 |
|         palm        | 45.04 | 55.34 |
|    kitchen island   | 30.18 | 54.63 |
|       computer      |  58.4 | 66.57 |
|     swivel chair    | 45.45 | 60.51 |
|         boat        | 46.18 | 61.19 |
|         bar         | 40.78 | 45.31 |
|    arcade machine   | 28.48 | 29.86 |
|        hovel        | 43.31 | 48.39 |
|         bus         | 86.56 | 93.62 |
|        towel        | 55.58 | 67.61 |
|        light        | 51.47 | 59.21 |
|        truck        | 36.63 | 54.63 |
|        tower        | 11.37 | 14.17 |
|      chandelier     | 60.89 | 80.06 |
|        awning       | 23.12 | 25.34 |
|     streetlight     |  21.9 | 29.25 |
|        booth        | 40.28 | 43.76 |
| television receiver | 65.57 | 76.52 |
|       airplane      | 53.87 | 61.23 |
|      dirt track     | 21.56 | 37.43 |
|       apparel       | 27.88 | 39.79 |
|         pole        | 18.86 | 27.17 |
|         land        |  5.86 |  9.06 |
|      bannister      |  4.04 |  4.81 |
|      escalator      |  21.8 | 22.45 |
|       ottoman       | 46.18 | 54.76 |
|        bottle       | 32.56 | 49.25 |
|        buffet       | 44.23 | 52.84 |
|        poster       | 29.82 | 34.41 |
|        stage        |  17.9 | 24.94 |
|         van         | 38.29 | 60.42 |
|         ship        | 20.46 | 26.63 |
|       fountain      | 23.73 | 24.44 |
|    conveyer belt    | 82.41 | 87.72 |
|        canopy       | 19.41 | 20.37 |
|        washer       |  63.8 | 65.58 |
|      plaything      | 15.98 | 22.22 |
|    swimming pool    | 54.93 | 84.71 |
|        stool        | 34.71 |  43.8 |
|        barrel       | 29.54 | 68.95 |
|        basket       | 27.45 | 33.37 |
|      waterfall      | 52.49 | 59.03 |
|         tent        | 95.69 | 97.37 |
|         bag         |  6.52 |  7.0  |
|       minibike      |  45.5 | 48.67 |
|        cradle       | 79.07 | 94.76 |
|         oven        | 21.54 | 47.67 |
|         ball        | 27.06 | 27.72 |
|         food        | 38.69 | 46.31 |
|         step        |  7.34 |  8.43 |
|         tank        | 37.43 | 41.65 |
|      trade name     | 28.26 | 31.91 |
|      microwave      | 53.44 | 60.48 |
|         pot         | 40.14 | 46.21 |
|        animal       | 50.75 | 54.52 |
|       bicycle       | 50.66 | 67.97 |
|         lake        | 56.11 | 63.47 |
|      dishwasher     | 57.36 | 71.84 |
|        screen       | 62.71 | 84.23 |
|       blanket       | 12.27 | 14.86 |
|      sculpture      | 42.85 | 52.92 |
|         hood        | 55.23 | 58.86 |
|        sconce       |  47.1 | 58.88 |
|         vase        | 33.43 | 45.87 |
|    traffic light    | 28.06 | 39.24 |
|         tray        |  6.14 |  11.5 |
|        ashcan       | 30.62 | 37.85 |
|         fan         | 60.03 | 71.41 |
|         pier        | 47.51 | 72.47 |
|      crt screen     |  8.98 | 23.95 |
|        plate        |  37.7 | 44.84 |
|       monitor       |  8.88 |  10.6 |
|    bulletin board   | 42.33 | 52.11 |
|        shower       |  0.75 |  0.77 |
|       radiator      | 51.62 | 58.11 |
|        glass        | 11.53 | 12.48 |
|        clock        | 34.89 | 40.71 |
|         flag        | 26.86 | 28.06 |
+---------------------+-------+-------+
09/15 21:26:17 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.3400  mIoU: 44.8100  mAcc: 55.4100  data_time: 0.0016  time: 0.1296
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
09/15 21:26:21 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1605864192
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1605864192
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 21:26:21 - mmengine - INFO - Config:
checkpoint = 'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth'
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    backbone=dict(
        attn_drop_rate=0.0,
        drop_path_rate=0.1,
        drop_rate=0.0,
        embed_dims=64,
        in_channels=3,
        init_cfg=dict(
            checkpoint=
            'https://download.openmmlab.com/mmsegmentation/v0.5/pretrain/segformer/mit_b3_20220624-13b1141c.pth',
            type='Pretrained'),
        mlp_ratio=4,
        num_heads=[
            1,
            2,
            5,
            8,
        ],
        num_layers=[
            3,
            4,
            18,
            3,
        ],
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        patch_sizes=[
            7,
            3,
            3,
            3,
        ],
        qkv_bias=True,
        sr_ratios=[
            8,
            4,
            2,
            1,
        ],
        type='MixVisionTransformer'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=256,
        dropout_ratio=0.1,
        in_channels=[
            64,
            128,
            320,
            512,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        type='SegformerHead'),
    pretrained=None,
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=6e-05, type='AdamW', weight_decay=0.01),
    paramwise_cfg=dict(
        custom_keys=dict(
            head=dict(lr_mult=10.0),
            norm=dict(decay_mult=0.0),
            pos_block=dict(decay_mult=0.0))),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=1500, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=1500,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=2,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=2,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_512x512/jpeg_compression'

09/15 21:26:24 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 21:26:24 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 21:26:24 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 21:26:25 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/segformer/segformer_mit-b3_512x512_160k_ade20k_20210726_081410-962b98d2.pth
09/15 21:27:13 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:03  time: 0.5702  data_time: 0.0016  memory: 19841  
09/15 21:27:38 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:07  time: 0.3713  data_time: 0.0016  memory: 19792  
09/15 21:27:46 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:16:36  time: 0.1646  data_time: 0.0015  memory: 13446  
09/15 21:27:56 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:13:44  time: 0.2030  data_time: 0.0015  memory: 16826  
09/15 21:28:05 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:11:44  time: 0.0894  data_time: 0.0014  memory: 16834  
09/15 21:28:13 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:10:11  time: 0.0560  data_time: 0.0015  memory: 13449  
09/15 21:28:22 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:09:11  time: 0.0885  data_time: 0.0014  memory: 13451  
09/15 21:28:30 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:08:20  time: 0.1649  data_time: 0.0013  memory: 13451  
09/15 21:28:34 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:07:23  time: 0.0687  data_time: 0.0013  memory: 8614  
09/15 21:28:37 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:06:37  time: 0.0537  data_time: 0.0014  memory: 13440  
09/15 21:28:42 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:06:02  time: 0.1747  data_time: 0.0015  memory: 8622  
09/15 21:28:47 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:05:30  time: 0.1373  data_time: 0.0015  memory: 8622  
09/15 21:28:53 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:05:08  time: 0.1916  data_time: 0.0012  memory: 13453  
09/15 21:29:00 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:04:48  time: 0.0554  data_time: 0.0016  memory: 13451  
09/15 21:29:07 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:04:30  time: 0.1881  data_time: 0.0016  memory: 13456  
09/15 21:29:11 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:04:09  time: 0.0533  data_time: 0.0015  memory: 8615  
09/15 21:29:14 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:03:48  time: 0.0554  data_time: 0.0016  memory: 633  
09/15 21:29:17 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:03:30  time: 0.0670  data_time: 0.0013  memory: 8609  
09/15 21:29:23 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:03:16  time: 0.0874  data_time: 0.0015  memory: 13441  
09/15 21:29:27 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:03:02  time: 0.0533  data_time: 0.0014  memory: 8622  
09/15 21:29:34 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:02:51  time: 0.2107  data_time: 0.0014  memory: 13453  
09/15 21:29:39 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:02:38  time: 0.0527  data_time: 0.0015  memory: 13446  
09/15 21:29:42 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:02:26  time: 0.0706  data_time: 0.0015  memory: 13442  
09/15 21:29:45 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:02:13  time: 0.0530  data_time: 0.0014  memory: 1829  
09/15 21:29:50 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:02:02  time: 0.0693  data_time: 0.0014  memory: 13447  
09/15 21:29:52 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:01:51  time: 0.0535  data_time: 0.0014  memory: 633  
09/15 21:29:55 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:01:41  time: 0.0512  data_time: 0.0014  memory: 8599  
09/15 21:30:01 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:01:32  time: 0.1647  data_time: 0.0014  memory: 13448  
09/15 21:30:04 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:01:23  time: 0.0998  data_time: 0.0014  memory: 8609  
09/15 21:30:07 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:14  time: 0.0519  data_time: 0.0014  memory: 633  
09/15 21:30:11 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:05  time: 0.0546  data_time: 0.0014  memory: 8620  
09/15 21:30:13 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:00:57  time: 0.0521  data_time: 0.0015  memory: 624  
09/15 21:30:19 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:00:49  time: 0.0513  data_time: 0.0013  memory: 16824  
09/15 21:30:23 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:00:42  time: 0.0545  data_time: 0.0016  memory: 8612  
09/15 21:30:27 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:34  time: 0.0538  data_time: 0.0014  memory: 8618  
09/15 21:30:30 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:27  time: 0.0548  data_time: 0.0016  memory: 8600  
09/15 21:30:33 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:20  time: 0.0544  data_time: 0.0016  memory: 582  
09/15 21:30:37 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:13  time: 0.0527  data_time: 0.0014  memory: 8626  
09/15 21:30:40 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:06  time: 0.0522  data_time: 0.0014  memory: 16829  
09/15 21:30:44 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0487  data_time: 0.0012  memory: 8626  
09/15 21:30:44 - mmengine - INFO - per class results:
09/15 21:30:44 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.09 | 89.01 |
|       building      | 81.47 | 93.08 |
|         sky         | 93.72 | 97.51 |
|        floor        | 78.92 | 91.21 |
|         tree        | 73.09 | 85.78 |
|       ceiling       | 81.57 | 89.66 |
|         road        | 81.89 | 91.57 |
|         bed         | 84.95 | 93.56 |
|      windowpane     |  57.7 | 75.87 |
|        grass        | 65.49 | 82.15 |
|       cabinet       | 57.74 | 71.07 |
|       sidewalk      | 60.81 | 74.02 |
|        person       |  76.7 | 89.34 |
|        earth        | 35.23 | 52.02 |
|         door        | 42.41 | 54.73 |
|        table        | 56.17 | 74.33 |
|       mountain      | 58.86 |  72.8 |
|        plant        | 47.93 | 56.86 |
|       curtain       | 71.15 |  80.2 |
|        chair        | 52.06 | 63.82 |
|         car         |  83.2 | 91.17 |
|        water        | 49.12 | 64.33 |
|       painting      | 69.28 | 79.91 |
|         sofa        | 63.84 | 82.74 |
|        shelf        | 41.28 | 58.64 |
|        house        | 48.06 | 56.93 |
|         sea         | 53.34 | 77.16 |
|        mirror       | 58.96 | 67.32 |
|         rug         | 53.64 | 59.66 |
|        field        | 29.13 | 39.86 |
|       armchair      | 38.79 | 51.57 |
|         seat        | 58.98 |  81.3 |
|        fence        | 42.85 | 55.94 |
|         desk        | 47.71 | 69.14 |
|         rock        | 47.39 | 71.37 |
|       wardrobe      | 43.96 |  63.5 |
|         lamp        | 58.67 | 69.29 |
|       bathtub       | 75.85 | 81.79 |
|       railing       | 34.06 | 43.18 |
|       cushion       | 49.39 | 62.12 |
|         base        | 28.49 | 38.41 |
|         box         | 21.39 | 29.28 |
|        column       | 42.09 | 53.04 |
|      signboard      | 34.61 |  45.2 |
|   chest of drawers  | 40.45 |  54.0 |
|       counter       | 22.75 | 30.94 |
|         sand        | 37.84 | 55.08 |
|         sink        | 67.67 | 76.74 |
|      skyscraper     | 47.14 | 59.65 |
|      fireplace      | 70.41 | 81.03 |
|     refrigerator    | 74.08 | 83.13 |
|      grandstand     | 35.71 | 56.59 |
|         path        | 18.75 | 27.42 |
|        stairs       | 23.99 |  28.4 |
|        runway       | 68.19 | 88.82 |
|         case        | 43.97 | 53.99 |
|      pool table     | 89.94 | 93.54 |
|        pillow       | 50.96 | 62.44 |
|     screen door     | 64.06 |  71.4 |
|       stairway      | 28.44 | 39.68 |
|        river        | 13.66 | 25.97 |
|        bridge       | 43.36 | 52.22 |
|       bookcase      |  38.5 | 58.39 |
|        blind        | 29.42 | 30.94 |
|     coffee table    |  57.7 | 75.48 |
|        toilet       | 79.54 | 89.23 |
|        flower       | 35.86 | 49.58 |
|         book        | 45.13 |  62.0 |
|         hill        | 10.94 | 18.97 |
|        bench        | 39.49 | 44.42 |
|      countertop     | 56.25 | 67.37 |
|        stove        | 70.55 | 78.66 |
|         palm        |  47.6 | 60.71 |
|    kitchen island   | 30.33 | 49.28 |
|       computer      | 59.37 | 67.68 |
|     swivel chair    | 47.27 | 62.36 |
|         boat        |  57.6 |  77.6 |
|         bar         | 40.84 | 47.65 |
|    arcade machine   | 61.62 | 65.52 |
|        hovel        |  39.6 | 43.55 |
|         bus         | 84.95 | 95.09 |
|        towel        | 58.21 | 69.07 |
|        light        | 50.29 | 57.88 |
|        truck        | 39.33 | 49.45 |
|        tower        | 17.11 |  26.4 |
|      chandelier     |  61.1 | 76.42 |
|        awning       |  25.0 | 28.56 |
|     streetlight     | 21.16 | 26.75 |
|        booth        | 51.49 | 57.89 |
| television receiver | 61.24 | 72.75 |
|       airplane      | 53.14 | 63.38 |
|      dirt track     | 20.89 |  54.4 |
|       apparel       | 24.45 | 33.02 |
|         pole        | 18.15 | 25.37 |
|         land        |  5.56 |  8.44 |
|      bannister      |  8.23 | 10.54 |
|      escalator      | 26.47 | 29.92 |
|       ottoman       | 34.59 |  39.8 |
|        bottle       |  33.4 |  54.6 |
|        buffet       |  44.5 | 52.25 |
|        poster       | 28.97 | 35.72 |
|        stage        | 19.17 | 24.53 |
|         van         | 41.99 | 59.46 |
|         ship        | 73.92 | 82.15 |
|       fountain      | 19.53 | 20.67 |
|    conveyer belt    | 83.51 | 88.91 |
|        canopy       | 22.93 |  27.7 |
|        washer       | 66.21 |  68.7 |
|      plaything      | 19.12 | 27.11 |
|    swimming pool    | 47.96 |  70.3 |
|        stool        | 37.16 | 47.34 |
|        barrel       | 35.36 | 41.36 |
|        basket       | 25.61 | 31.07 |
|      waterfall      |  66.9 | 72.67 |
|         tent        | 92.84 | 98.12 |
|         bag         |  6.31 |  7.64 |
|       minibike      | 66.57 | 74.15 |
|        cradle       | 75.48 | 94.39 |
|         oven        | 25.85 | 44.63 |
|         ball        |  9.25 |  9.32 |
|         food        | 40.91 | 50.49 |
|         step        |  5.24 |  5.78 |
|         tank        | 41.43 | 44.25 |
|      trade name     | 23.55 | 26.05 |
|      microwave      | 63.62 | 71.35 |
|         pot         | 38.04 | 44.21 |
|        animal       | 49.16 | 53.39 |
|       bicycle       | 49.48 | 67.45 |
|         lake        |  43.3 | 56.13 |
|      dishwasher     | 55.55 | 63.98 |
|        screen       | 60.51 | 74.55 |
|       blanket       |  7.74 |  8.5  |
|      sculpture      | 60.07 | 73.73 |
|         hood        | 54.02 | 57.11 |
|        sconce       |  43.6 | 52.68 |
|         vase        | 35.64 | 45.16 |
|    traffic light    | 27.94 | 40.44 |
|         tray        |  5.38 | 13.68 |
|        ashcan       | 32.29 | 40.25 |
|         fan         | 59.15 | 72.82 |
|         pier        | 29.44 |  46.1 |
|      crt screen     | 16.13 | 30.43 |
|        plate        | 42.37 | 54.09 |
|       monitor       | 43.75 | 53.47 |
|    bulletin board   |  46.7 | 56.35 |
|        shower       |  2.01 |  4.93 |
|       radiator      | 52.09 | 56.33 |
|        glass        | 11.25 | 11.92 |
|        clock        | 33.96 | 37.18 |
|         flag        | 37.39 | 39.98 |
+---------------------+-------+-------+
09/15 21:30:44 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.5200  mIoU: 46.0800  mAcc: 56.4800  data_time: 0.0016  time: 0.1297
Finished processing corruption type: jpeg_compression
Runtime: 1726428645

============================= JOB FEEDBACK =============================

NodeName=uc2n484
Job ID: 24235242
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 06:42:32
CPU Efficiency: 5.89% of 4-17:50:08 core-walltime
Job Wall-clock time: 07:06:53
Memory Utilized: 3.70 GB
Memory Efficiency: 3.70% of 100.00 GB
