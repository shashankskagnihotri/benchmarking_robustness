Started at Sun Sep 15 19:29:26 CEST 2024
Processing corruption type: gaussian_noise
09/15 19:29:39 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 11456234
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 11456234
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 19:29:39 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='gaussian_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/gaussian_noise'

09/15 19:29:44 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 19:29:44 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 19:29:45 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/15 19:29:45 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/15 19:31:18 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:59:55  time: 0.8719  data_time: 0.0019  memory: 17171  
09/15 19:32:07 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:44:56  time: 1.1569  data_time: 0.0020  memory: 16951  
09/15 19:32:33 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:34:23  time: 0.5248  data_time: 0.0019  memory: 16944  
09/15 19:33:12 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:30:57  time: 0.6731  data_time: 0.0019  memory: 16953  
09/15 19:33:45 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:27:56  time: 0.4361  data_time: 0.0019  memory: 16951  
09/15 19:34:11 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:25:07  time: 0.1096  data_time: 0.0020  memory: 16947  
09/15 19:34:46 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:23:39  time: 0.4412  data_time: 0.0019  memory: 16951  
09/15 19:35:12 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:47  time: 0.5347  data_time: 0.0018  memory: 16950  
09/15 19:35:21 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:19:15  time: 0.2110  data_time: 0.0017  memory: 16873  
09/15 19:35:33 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:17:22  time: 0.0996  data_time: 0.0018  memory: 16932  
09/15 19:35:47 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:52  time: 0.5285  data_time: 0.0019  memory: 16951  
09/15 19:35:55 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:22  time: 0.2670  data_time: 0.0021  memory: 16879  
09/15 19:36:14 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:26  time: 0.5275  data_time: 0.0018  memory: 16953  
09/15 19:36:36 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:42  time: 0.1114  data_time: 0.0020  memory: 16954  
09/15 19:36:59 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:02  time: 1.0622  data_time: 0.0018  memory: 16956  
09/15 19:37:08 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:03  time: 0.0976  data_time: 0.0021  memory: 16944  
09/15 19:37:12 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:04  time: 0.0992  data_time: 0.0020  memory: 647  
09/15 19:37:20 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:16  time: 0.1930  data_time: 0.0018  memory: 16869  
09/15 19:37:41 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:45  time: 0.3051  data_time: 0.0020  memory: 16951  
09/15 19:37:52 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:07  time: 0.0934  data_time: 0.0019  memory: 16927  
09/15 19:38:09 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:35  time: 0.6336  data_time: 0.0020  memory: 16954  
09/15 19:38:22 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:02  time: 0.0953  data_time: 0.0020  memory: 16941  
09/15 19:38:31 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:28  time: 0.2049  data_time: 0.0020  memory: 16934  
09/15 19:38:36 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:53  time: 0.0959  data_time: 0.0019  memory: 1844  
09/15 19:38:46 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:24  time: 0.2059  data_time: 0.0018  memory: 16944  
09/15 19:38:51 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:53  time: 0.0957  data_time: 0.0019  memory: 1483  
09/15 19:38:59 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:26  time: 0.0930  data_time: 0.0019  memory: 16929  
09/15 19:39:23 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:07  time: 0.5920  data_time: 0.0019  memory: 16948  
09/15 19:39:36 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:43  time: 0.5565  data_time: 0.0019  memory: 16936  
09/15 19:39:42 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:19  time: 0.0940  data_time: 0.0018  memory: 647  
09/15 19:39:50 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:55  time: 0.1120  data_time: 0.0025  memory: 16878  
09/15 19:39:55 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:32  time: 0.0921  data_time: 0.0020  memory: 1527  
09/15 19:40:08 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:11  time: 0.1289  data_time: 0.0017  memory: 16951  
09/15 19:40:21 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:52  time: 0.1125  data_time: 0.0020  memory: 16942  
09/15 19:40:32 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:32  time: 0.0982  data_time: 0.0018  memory: 16932  
09/15 19:40:41 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:12  time: 0.0972  data_time: 0.0020  memory: 16931  
09/15 19:40:46 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:53  time: 0.1082  data_time: 0.0020  memory: 597  
09/15 19:40:55 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:35  time: 0.0999  data_time: 0.0017  memory: 16954  
09/15 19:41:06 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.0947  data_time: 0.0017  memory: 16935  
09/15 19:41:17 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1611  data_time: 0.0033  memory: 16883  
09/15 19:41:17 - mmengine - INFO - per class results:
09/15 19:41:17 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 58.13 | 89.06 |
|       building      | 71.87 | 86.13 |
|         sky         | 86.27 | 90.28 |
|        floor        | 61.25 | 86.33 |
|         tree        | 56.23 | 87.94 |
|       ceiling       | 65.28 | 74.27 |
|         road        | 66.52 |  81.8 |
|         bed         | 74.36 |  81.9 |
|      windowpane     | 40.31 | 48.98 |
|        grass        | 53.18 | 78.59 |
|       cabinet       | 40.91 |  51.1 |
|       sidewalk      |  28.6 | 30.73 |
|        person       | 64.98 | 78.78 |
|        earth        | 26.25 | 45.76 |
|         door        | 19.09 | 28.92 |
|        table        | 41.91 | 55.42 |
|       mountain      | 46.43 | 60.67 |
|        plant        | 36.98 | 56.58 |
|       curtain       | 43.89 | 49.14 |
|        chair        | 40.82 | 53.64 |
|         car         | 72.64 | 83.35 |
|        water        | 36.88 | 48.87 |
|       painting      | 56.82 | 63.29 |
|         sofa        | 53.58 | 66.28 |
|        shelf        | 25.49 | 32.84 |
|        house        | 15.17 | 15.68 |
|         sea         | 26.87 | 40.88 |
|        mirror       | 29.46 | 32.88 |
|         rug         | 21.07 | 21.46 |
|        field        | 13.81 | 16.54 |
|       armchair      |  31.5 | 47.94 |
|         seat        | 39.58 | 49.68 |
|        fence        | 20.43 | 27.18 |
|         desk        | 31.39 | 43.82 |
|         rock        | 26.02 | 48.01 |
|       wardrobe      | 23.47 | 25.88 |
|         lamp        | 49.67 | 56.78 |
|       bathtub       | 20.76 | 21.06 |
|       railing       | 19.34 | 22.64 |
|       cushion       |  32.3 |  38.6 |
|         base        |  1.69 |  1.95 |
|         box         | 14.76 |  20.1 |
|        column       | 25.58 | 32.99 |
|      signboard      |  25.6 | 34.37 |
|   chest of drawers  |  31.3 | 42.39 |
|       counter       | 15.92 | 18.32 |
|         sand        |  9.89 | 10.63 |
|         sink        | 42.95 | 63.33 |
|      skyscraper     | 33.87 | 42.82 |
|      fireplace      | 39.44 | 40.87 |
|     refrigerator    | 29.71 | 30.89 |
|      grandstand     | 31.38 | 55.25 |
|         path        | 12.78 | 19.05 |
|        stairs       | 20.36 |  28.7 |
|        runway       | 21.43 | 22.53 |
|         case        | 27.68 | 31.39 |
|      pool table     | 75.54 | 82.65 |
|        pillow       | 30.84 |  34.8 |
|     screen door     |  8.04 |  8.7  |
|       stairway      | 14.74 | 33.47 |
|        river        |  1.78 |  2.02 |
|        bridge       | 24.86 | 26.35 |
|       bookcase      | 16.24 | 18.43 |
|        blind        |  16.1 | 16.52 |
|     coffee table    | 46.56 | 51.87 |
|        toilet       | 48.21 |  49.1 |
|        flower       | 28.38 | 39.38 |
|         book        | 37.02 | 49.33 |
|         hill        |  2.1  |  2.75 |
|        bench        | 17.82 | 20.65 |
|      countertop     |  37.1 | 45.86 |
|        stove        | 50.62 | 61.12 |
|         palm        | 30.53 | 32.89 |
|    kitchen island   | 13.97 | 19.95 |
|       computer      | 30.73 | 32.18 |
|     swivel chair    | 26.04 |  28.3 |
|         boat        | 11.61 | 11.83 |
|         bar         | 19.46 |  24.3 |
|    arcade machine   | 10.87 | 11.64 |
|        hovel        | 26.75 | 29.34 |
|         bus         | 55.13 | 56.11 |
|        towel        |  12.6 | 13.08 |
|        light        | 18.86 |  19.6 |
|        truck        |  2.2  |  2.34 |
|        tower        |  9.03 | 12.23 |
|      chandelier     | 54.91 | 65.74 |
|        awning       |  5.39 |  5.61 |
|     streetlight     | 12.86 | 14.32 |
|        booth        |  9.63 | 12.82 |
| television receiver | 27.73 | 28.89 |
|       airplane      |  25.9 | 26.83 |
|      dirt track     |  3.44 |  6.31 |
|       apparel       | 15.49 |  20.7 |
|         pole        | 12.32 | 20.37 |
|         land        |  0.04 |  0.04 |
|      bannister      |  2.68 |  3.21 |
|      escalator      |  0.03 |  0.03 |
|       ottoman       | 26.83 | 29.47 |
|        bottle       | 12.48 | 17.83 |
|        buffet       |  3.12 |  3.12 |
|        poster       |  7.21 |  8.39 |
|        stage        |  3.4  |  3.58 |
|         van         |  16.7 | 18.49 |
|         ship        |  0.02 |  0.02 |
|       fountain      | 13.02 | 14.47 |
|    conveyer belt    |  46.3 | 50.55 |
|        canopy       |  0.0  |  0.0  |
|        washer       |  8.01 |  8.01 |
|      plaything      | 14.38 | 16.02 |
|    swimming pool    |  8.49 | 10.05 |
|        stool        | 21.94 | 35.96 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  10.0 | 10.76 |
|      waterfall      | 33.92 |  35.8 |
|         tent        |  2.83 |  2.83 |
|         bag         |  2.47 |  2.54 |
|       minibike      | 21.33 | 22.72 |
|        cradle       | 36.96 | 41.35 |
|         oven        | 14.04 | 15.45 |
|         ball        | 37.89 | 47.02 |
|         food        |  43.3 | 55.83 |
|         step        |  0.0  |  0.0  |
|         tank        | 22.74 | 25.38 |
|      trade name     | 12.83 | 13.42 |
|      microwave      | 18.13 | 18.37 |
|         pot         | 19.23 | 20.11 |
|        animal       | 27.05 | 27.87 |
|       bicycle       | 36.68 | 62.94 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 28.48 |  28.8 |
|        screen       | 14.57 |  14.6 |
|       blanket       |  3.8  |  3.85 |
|      sculpture      |  5.03 |  5.55 |
|         hood        | 15.81 | 15.86 |
|        sconce       | 13.42 | 14.13 |
|         vase        | 28.01 | 36.84 |
|    traffic light    |  9.35 |  9.73 |
|         tray        |  3.32 |  4.64 |
|        ashcan       | 20.82 | 21.53 |
|         fan         |  39.7 | 44.21 |
|         pier        |  5.15 |  5.17 |
|      crt screen     |  0.05 |  0.06 |
|        plate        | 25.41 | 28.92 |
|       monitor       |  3.84 |  4.09 |
|    bulletin board   |  8.32 |  9.07 |
|        shower       |  0.31 |  0.89 |
|       radiator      |  9.78 |  9.8  |
|        glass        |  8.33 |  8.68 |
|        clock        | 21.04 | 23.53 |
|         flag        | 10.44 | 10.75 |
+---------------------+-------+-------+
09/15 19:41:17 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 70.0200  mIoU: 24.9600  mAcc: 30.5100  data_time: 0.0022  time: 0.3457
Finished processing corruption type: gaussian_noise
Processing corruption type: shot_noise
09/15 19:41:24 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 657746141
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 657746141
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 19:41:24 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='shot_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/shot_noise'

09/15 19:41:30 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 19:41:30 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 19:41:30 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/15 19:41:31 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/15 19:43:14 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:07:06  time: 0.9724  data_time: 0.0027  memory: 17171  
09/15 19:44:06 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:49:15  time: 1.1814  data_time: 0.0022  memory: 16951  
09/15 19:44:36 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:38:08  time: 0.6289  data_time: 0.0019  memory: 16944  
09/15 19:45:19 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:34:11  time: 0.7657  data_time: 0.0018  memory: 16953  
09/15 19:45:57 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:31:03  time: 0.5840  data_time: 0.0018  memory: 16951  
09/15 19:46:28 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:28:03  time: 0.2102  data_time: 0.0020  memory: 16947  
09/15 19:47:07 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:26:26  time: 0.5381  data_time: 0.0019  memory: 16951  
09/15 19:47:37 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:24:23  time: 0.6015  data_time: 0.0018  memory: 16950  
09/15 19:47:50 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:21:46  time: 0.2824  data_time: 0.0019  memory: 16873  
09/15 19:48:06 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:19:45  time: 0.1807  data_time: 0.0020  memory: 16932  
09/15 19:48:25 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:18:11  time: 0.6187  data_time: 0.0021  memory: 16951  
09/15 19:48:37 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:16:35  time: 0.3610  data_time: 0.0020  memory: 16879  
09/15 19:49:00 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:15:33  time: 0.5976  data_time: 0.0018  memory: 16953  
09/15 19:49:26 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:14:42  time: 0.1941  data_time: 0.0021  memory: 16954  
09/15 19:49:52 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:13:55  time: 1.1036  data_time: 0.0026  memory: 16956  
09/15 19:50:05 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:12:51  time: 0.1777  data_time: 0.0021  memory: 16944  
09/15 19:50:14 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:11:48  time: 0.1819  data_time: 0.0020  memory: 647  
09/15 19:50:26 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:10:54  time: 0.2640  data_time: 0.0018  memory: 16869  
09/15 19:50:51 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:18  time: 0.4154  data_time: 0.0018  memory: 16951  
09/15 19:51:06 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:09:35  time: 0.1673  data_time: 0.0019  memory: 16927  
09/15 19:51:31 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:02  time: 0.8255  data_time: 0.0019  memory: 16954  
09/15 19:51:52 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:28  time: 0.1745  data_time: 0.0020  memory: 16941  
09/15 19:52:06 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:49  time: 0.3742  data_time: 0.0019  memory: 16934  
09/15 19:52:18 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:11  time: 0.1979  data_time: 0.0018  memory: 1844  
09/15 19:52:34 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:37  time: 0.2994  data_time: 0.0019  memory: 16944  
09/15 19:52:44 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:02  time: 0.2559  data_time: 0.0018  memory: 1483  
09/15 19:52:59 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:31  time: 0.2508  data_time: 0.0018  memory: 16929  
09/15 19:53:28 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:07  time: 0.7203  data_time: 0.0019  memory: 16948  
09/15 19:53:45 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:38  time: 0.6069  data_time: 0.0018  memory: 16936  
09/15 19:53:58 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:08  time: 0.2773  data_time: 0.0018  memory: 647  
09/15 19:54:11 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:40  time: 0.1955  data_time: 0.0019  memory: 16878  
09/15 19:54:20 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:12  time: 0.2135  data_time: 0.0019  memory: 1527  
09/15 19:54:37 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:46  time: 0.1760  data_time: 0.0026  memory: 16951  
09/15 19:54:54 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:21  time: 0.2031  data_time: 0.0021  memory: 16942  
09/15 19:55:10 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:57  time: 0.1901  data_time: 0.0018  memory: 16932  
09/15 19:55:24 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:32  time: 0.1891  data_time: 0.0020  memory: 16931  
09/15 19:55:35 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:08  time: 0.2467  data_time: 0.0021  memory: 597  
09/15 19:55:49 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:45  time: 0.1966  data_time: 0.0019  memory: 16954  
09/15 19:56:05 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:22  time: 0.1993  data_time: 0.0018  memory: 16935  
09/15 19:56:19 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1646  data_time: 0.0017  memory: 16883  
09/15 19:56:19 - mmengine - INFO - per class results:
09/15 19:56:19 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 57.41 | 88.73 |
|       building      | 71.61 | 85.77 |
|         sky         | 78.24 | 81.64 |
|        floor        | 61.89 | 87.83 |
|         tree        | 52.46 | 88.78 |
|       ceiling       | 60.89 | 69.68 |
|         road        | 67.46 | 82.53 |
|         bed         | 74.09 | 82.24 |
|      windowpane     | 37.56 | 45.53 |
|        grass        | 55.84 | 84.69 |
|       cabinet       | 41.68 | 51.42 |
|       sidewalk      | 27.73 | 29.94 |
|        person       | 66.19 | 81.87 |
|        earth        | 27.05 | 43.45 |
|         door        |  18.4 | 29.42 |
|        table        | 43.74 | 58.49 |
|       mountain      | 43.41 | 56.05 |
|        plant        | 38.77 | 53.96 |
|       curtain       | 41.28 | 45.69 |
|        chair        | 43.33 | 59.33 |
|         car         | 74.71 | 86.55 |
|        water        | 38.09 | 49.74 |
|       painting      | 53.64 | 59.97 |
|         sofa        | 52.93 | 66.67 |
|        shelf        |  26.2 | 34.18 |
|        house        | 12.76 | 13.57 |
|         sea         | 27.92 | 41.46 |
|        mirror       | 28.47 | 32.69 |
|         rug         | 22.32 | 22.89 |
|        field        | 14.17 | 16.58 |
|       armchair      | 31.39 | 49.92 |
|         seat        | 42.35 | 53.72 |
|        fence        | 18.93 | 25.26 |
|         desk        | 26.72 | 35.92 |
|         rock        | 26.29 |  52.1 |
|       wardrobe      | 20.54 |  22.9 |
|         lamp        | 44.92 | 51.57 |
|       bathtub       |  9.7  |  9.75 |
|       railing       | 21.09 | 25.54 |
|       cushion       | 33.57 | 39.44 |
|         base        |  4.66 |  5.38 |
|         box         | 14.37 | 18.65 |
|        column       | 28.51 | 37.59 |
|      signboard      | 25.46 | 34.54 |
|   chest of drawers  | 32.52 | 41.68 |
|       counter       | 13.99 | 14.99 |
|         sand        |  7.45 |  7.87 |
|         sink        | 39.62 |  59.5 |
|      skyscraper     | 35.76 | 45.24 |
|      fireplace      | 38.58 | 41.61 |
|     refrigerator    | 32.28 | 33.03 |
|      grandstand     | 28.36 |  52.4 |
|         path        | 11.23 | 16.32 |
|        stairs       |  23.0 | 32.04 |
|        runway       | 11.41 | 11.41 |
|         case        | 23.91 |  25.9 |
|      pool table     | 87.29 | 90.86 |
|        pillow       | 23.83 | 26.51 |
|     screen door     |  1.52 |  1.61 |
|       stairway      | 15.08 | 37.18 |
|        river        |  2.3  |  2.69 |
|        bridge       | 19.18 | 21.73 |
|       bookcase      | 16.71 | 18.75 |
|        blind        |  18.9 | 19.27 |
|     coffee table    | 46.68 | 52.47 |
|        toilet       | 35.91 | 37.56 |
|        flower       |  27.2 |  38.5 |
|         book        | 38.69 | 51.05 |
|         hill        |  1.63 |  1.92 |
|        bench        | 20.85 | 24.78 |
|      countertop     | 34.76 | 42.96 |
|        stove        |  54.3 | 64.58 |
|         palm        | 32.43 | 35.44 |
|    kitchen island   |  7.72 | 10.36 |
|       computer      | 25.69 |  26.9 |
|     swivel chair    | 32.45 | 36.98 |
|         boat        | 12.12 | 12.41 |
|         bar         | 18.47 | 24.01 |
|    arcade machine   | 12.52 | 14.15 |
|        hovel        |  23.9 | 26.05 |
|         bus         | 68.21 | 70.93 |
|        towel        |  7.93 |  8.28 |
|        light        | 15.53 | 15.99 |
|        truck        |  3.32 |  3.5  |
|        tower        |  3.41 |  4.51 |
|      chandelier     | 49.44 | 59.15 |
|        awning       |  7.01 |  7.23 |
|     streetlight     | 13.66 | 15.51 |
|        booth        | 12.37 | 17.69 |
| television receiver | 43.45 | 46.65 |
|       airplane      | 19.01 | 19.49 |
|      dirt track     |  1.78 |  3.31 |
|       apparel       | 14.26 | 19.94 |
|         pole        |  14.6 | 24.93 |
|         land        |  0.0  |  0.0  |
|      bannister      |  3.22 |  4.42 |
|      escalator      |  1.07 |  1.08 |
|       ottoman       | 28.68 | 31.03 |
|        bottle       |  13.8 | 18.38 |
|        buffet       | 14.64 | 16.02 |
|        poster       |  5.8  |  6.35 |
|        stage        |  2.74 |  2.99 |
|         van         |  9.4  | 10.19 |
|         ship        |  0.0  |  0.0  |
|       fountain      |  8.36 |  9.01 |
|    conveyer belt    | 39.91 | 50.06 |
|        canopy       |  0.0  |  0.0  |
|        washer       |  9.52 |  9.52 |
|      plaything      | 12.21 | 13.99 |
|    swimming pool    |  7.23 |  8.34 |
|        stool        | 22.06 | 39.82 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  11.4 | 12.67 |
|      waterfall      | 32.73 | 35.43 |
|         tent        |  4.06 |  4.08 |
|         bag         |  0.35 |  0.37 |
|       minibike      | 22.65 | 24.08 |
|        cradle       | 47.02 | 50.92 |
|         oven        | 25.31 |  30.4 |
|         ball        | 36.54 | 46.45 |
|         food        | 42.08 | 54.39 |
|         step        |  0.0  |  0.0  |
|         tank        | 22.54 | 24.53 |
|      trade name     | 12.29 | 12.82 |
|      microwave      | 18.65 | 18.87 |
|         pot         | 25.65 | 27.13 |
|        animal       | 26.72 | 27.67 |
|       bicycle       | 37.63 | 64.56 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 40.75 | 42.07 |
|        screen       | 21.17 | 21.33 |
|       blanket       |  3.93 |  3.99 |
|      sculpture      |  6.24 |  6.81 |
|         hood        | 11.28 | 11.34 |
|        sconce       |  9.62 | 10.07 |
|         vase        | 28.18 | 39.33 |
|    traffic light    | 10.13 | 10.65 |
|         tray        |  3.3  |  5.02 |
|        ashcan       | 25.21 | 26.84 |
|         fan         | 35.05 | 38.26 |
|         pier        |  6.9  |  6.91 |
|      crt screen     |  0.28 |  0.4  |
|        plate        | 20.31 | 23.48 |
|       monitor       | 26.87 | 29.67 |
|    bulletin board   | 12.12 | 12.71 |
|        shower       |  0.84 |  4.2  |
|       radiator      |  4.15 |  4.16 |
|        glass        |  9.06 |  9.44 |
|        clock        | 19.87 | 22.98 |
|         flag        | 10.44 | 10.63 |
+---------------------+-------+-------+
09/15 19:56:19 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 69.1400  mIoU: 24.9400  mAcc: 30.7200  data_time: 0.0022  time: 0.4441
Finished processing corruption type: shot_noise
Processing corruption type: impulse_noise
09/15 19:56:28 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 235405231
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 235405231
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 19:56:28 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='impulse_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/impulse_noise'

09/15 19:56:36 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 19:56:36 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 19:56:37 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/15 19:56:37 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/15 19:58:10 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:00:26  time: 0.8681  data_time: 0.0020  memory: 17171  
09/15 19:59:00 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:45:05  time: 1.1901  data_time: 0.0050  memory: 16951  
09/15 19:59:26 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:34:41  time: 0.5042  data_time: 0.0020  memory: 16944  
09/15 20:00:02 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:30:44  time: 0.6310  data_time: 0.0020  memory: 16953  
09/15 20:00:36 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:27:51  time: 0.4749  data_time: 0.0020  memory: 16951  
09/15 20:01:03 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:25:04  time: 0.0908  data_time: 0.0019  memory: 16947  
09/15 20:01:37 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:23:32  time: 0.4245  data_time: 0.0019  memory: 16951  
09/15 20:02:01 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:35  time: 0.4997  data_time: 0.0018  memory: 16950  
09/15 20:02:09 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:19:03  time: 0.1916  data_time: 0.0018  memory: 16873  
09/15 20:02:21 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:17:09  time: 0.1000  data_time: 0.0020  memory: 16932  
09/15 20:02:34 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:39  time: 0.5293  data_time: 0.0020  memory: 16951  
09/15 20:02:41 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:09  time: 0.2511  data_time: 0.0020  memory: 16879  
09/15 20:03:00 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:13  time: 0.5394  data_time: 0.0018  memory: 16953  
09/15 20:03:21 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:30  time: 0.0907  data_time: 0.0020  memory: 16954  
09/15 20:03:43 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:49  time: 1.0755  data_time: 0.0018  memory: 16956  
09/15 20:03:52 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:51  time: 0.0762  data_time: 0.0020  memory: 16944  
09/15 20:03:56 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:52  time: 0.0788  data_time: 0.0021  memory: 647  
09/15 20:04:03 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:04  time: 0.1778  data_time: 0.0018  memory: 16869  
09/15 20:04:23 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:34  time: 0.3140  data_time: 0.0020  memory: 16951  
09/15 20:04:34 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:57  time: 0.0727  data_time: 0.0018  memory: 16927  
09/15 20:04:51 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:26  time: 0.6140  data_time: 0.0019  memory: 16954  
09/15 20:05:04 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:54  time: 0.0843  data_time: 0.0028  memory: 16941  
09/15 20:05:12 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:20  time: 0.1877  data_time: 0.0019  memory: 16934  
09/15 20:05:16 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:45  time: 0.0768  data_time: 0.0019  memory: 1844  
09/15 20:05:27 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:17  time: 0.1892  data_time: 0.0018  memory: 16944  
09/15 20:05:30 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:47  time: 0.0776  data_time: 0.0019  memory: 1483  
09/15 20:05:38 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:20  time: 0.0742  data_time: 0.0019  memory: 16929  
09/15 20:05:59 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:00  time: 0.5646  data_time: 0.0018  memory: 16948  
09/15 20:06:09 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:36  time: 0.4365  data_time: 0.0025  memory: 16936  
09/15 20:06:12 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:11  time: 0.0732  data_time: 0.0018  memory: 647  
09/15 20:06:19 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:48  time: 0.0807  data_time: 0.0018  memory: 16878  
09/15 20:06:23 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:26  time: 0.0754  data_time: 0.0020  memory: 1527  
09/15 20:06:35 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:06  time: 0.0717  data_time: 0.0017  memory: 16951  
09/15 20:06:46 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:47  time: 0.0816  data_time: 0.0020  memory: 16942  
09/15 20:06:57 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:28  time: 0.0835  data_time: 0.0017  memory: 16932  
09/15 20:07:04 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:09  time: 0.0773  data_time: 0.0020  memory: 16931  
09/15 20:07:08 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:51  time: 0.0745  data_time: 0.0020  memory: 597  
09/15 20:07:16 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:33  time: 0.0861  data_time: 0.0018  memory: 16954  
09/15 20:07:25 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.0719  data_time: 0.0017  memory: 16935  
09/15 20:07:33 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0693  data_time: 0.0017  memory: 16883  
09/15 20:07:34 - mmengine - INFO - per class results:
09/15 20:07:34 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 52.03 | 90.39 |
|       building      | 67.16 | 80.02 |
|         sky         | 71.04 | 73.85 |
|        floor        | 53.02 | 86.07 |
|         tree        | 47.19 | 84.37 |
|       ceiling       | 55.88 | 64.25 |
|         road        | 56.72 | 65.48 |
|         bed         | 62.27 | 67.19 |
|      windowpane     | 36.96 | 48.81 |
|        grass        | 49.33 | 82.99 |
|       cabinet       | 24.41 | 27.33 |
|       sidewalk      | 21.41 | 22.86 |
|        person       | 54.27 | 65.15 |
|        earth        | 24.27 | 35.04 |
|         door        |  13.7 |  18.5 |
|        table        | 35.48 | 44.47 |
|       mountain      | 37.87 | 59.56 |
|        plant        | 29.81 | 59.17 |
|       curtain       |  36.0 | 39.59 |
|        chair        | 32.71 | 36.96 |
|         car         | 69.56 | 78.44 |
|        water        | 32.39 | 60.03 |
|       painting      | 49.74 | 57.27 |
|         sofa        |  49.7 | 61.43 |
|        shelf        | 26.58 | 34.91 |
|        house        |  3.1  |  3.16 |
|         sea         | 17.73 | 22.02 |
|        mirror       | 19.03 | 21.63 |
|         rug         |  8.32 |  8.41 |
|        field        |  4.06 |  4.54 |
|       armchair      | 21.99 | 28.79 |
|         seat        | 23.93 | 27.95 |
|        fence        | 19.18 | 22.44 |
|         desk        |  17.6 | 18.77 |
|         rock        | 21.06 |  52.8 |
|       wardrobe      |  8.7  |  9.31 |
|         lamp        |  43.6 | 48.82 |
|       bathtub       |  6.83 |  6.88 |
|       railing       | 17.78 | 21.11 |
|       cushion       | 28.11 | 32.37 |
|         base        |  0.27 |  0.29 |
|         box         | 13.79 | 21.62 |
|        column       | 20.34 | 25.59 |
|      signboard      |  22.9 | 31.49 |
|   chest of drawers  | 29.17 | 40.63 |
|       counter       |  2.79 |  2.84 |
|         sand        |  6.22 |  6.34 |
|         sink        | 30.33 | 57.28 |
|      skyscraper     | 22.11 | 25.54 |
|      fireplace      | 22.76 | 23.12 |
|     refrigerator    | 12.56 | 12.63 |
|      grandstand     | 22.66 | 69.97 |
|         path        | 12.93 | 25.43 |
|        stairs       | 17.41 | 31.63 |
|        runway       |  0.54 |  0.54 |
|         case        | 14.01 | 14.76 |
|      pool table     | 62.84 | 63.74 |
|        pillow       | 26.01 | 29.27 |
|     screen door     |  6.23 |  6.26 |
|       stairway      | 14.09 | 25.71 |
|        river        |  1.14 |  1.44 |
|        bridge       | 20.06 | 20.71 |
|       bookcase      | 10.94 |  11.4 |
|        blind        |  8.75 |  8.8  |
|     coffee table    | 29.22 |  31.0 |
|        toilet       | 34.65 | 35.67 |
|        flower       |  22.3 |  33.6 |
|         book        | 32.75 | 41.28 |
|         hill        |  1.02 |  1.38 |
|        bench        | 15.41 | 17.44 |
|      countertop     | 23.12 | 25.89 |
|        stove        | 40.21 | 57.91 |
|         palm        | 29.98 | 31.48 |
|    kitchen island   |  11.0 | 14.69 |
|       computer      | 26.42 | 27.28 |
|     swivel chair    | 18.68 | 21.03 |
|         boat        | 10.13 | 10.32 |
|         bar         |  1.7  |  1.87 |
|    arcade machine   |  9.45 | 18.81 |
|        hovel        | 18.85 | 20.09 |
|         bus         | 26.38 | 26.73 |
|        towel        |  3.96 |  4.0  |
|        light        | 10.36 | 10.48 |
|        truck        |  2.82 |  3.09 |
|        tower        |  17.2 | 31.58 |
|      chandelier     |  48.0 | 57.31 |
|        awning       |  2.81 |  2.84 |
|     streetlight     | 11.85 | 13.65 |
|        booth        |  4.33 |  6.96 |
| television receiver | 16.97 | 17.98 |
|       airplane      |  17.4 | 18.07 |
|      dirt track     |  0.23 |  0.4  |
|       apparel       | 13.55 | 16.23 |
|         pole        | 11.86 | 20.72 |
|         land        |  0.07 |  0.07 |
|      bannister      |  2.47 |  3.45 |
|      escalator      |  0.37 |  0.37 |
|       ottoman       | 20.36 | 21.33 |
|        bottle       | 14.16 | 17.17 |
|        buffet       |  1.02 |  1.02 |
|        poster       |  6.49 |  8.38 |
|        stage        |  2.59 |  2.6  |
|         van         |  7.57 |  8.07 |
|         ship        |  0.0  |  0.0  |
|       fountain      |  3.86 |  4.3  |
|    conveyer belt    | 39.33 | 39.44 |
|        canopy       |  0.06 |  0.06 |
|        washer       |  1.98 |  1.98 |
|      plaything      | 16.19 | 18.15 |
|    swimming pool    |  6.18 |  6.59 |
|        stool        | 13.99 | 22.07 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  9.03 |  9.31 |
|      waterfall      |  20.6 | 21.02 |
|         tent        |  1.35 |  1.36 |
|         bag         |  0.27 |  0.27 |
|       minibike      | 19.89 |  21.1 |
|        cradle       |  8.9  |  9.22 |
|         oven        |  9.28 | 10.81 |
|         ball        | 33.59 | 55.33 |
|         food        | 39.73 | 53.59 |
|         step        |  0.0  |  0.0  |
|         tank        | 24.24 | 33.73 |
|      trade name     | 10.07 | 10.39 |
|      microwave      |  9.74 |  9.77 |
|         pot         | 13.63 | 14.19 |
|        animal       |  16.5 | 17.37 |
|       bicycle       |  33.5 | 61.82 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 12.65 | 12.67 |
|        screen       |  0.24 |  0.24 |
|       blanket       |  0.04 |  0.04 |
|      sculpture      |  2.65 |  3.04 |
|         hood        |  7.92 |  7.93 |
|        sconce       |  8.15 |  8.39 |
|         vase        | 26.74 | 35.01 |
|    traffic light    |  7.47 |  7.73 |
|         tray        |  2.44 |  3.28 |
|        ashcan       | 17.66 | 19.11 |
|         fan         | 28.75 | 30.28 |
|         pier        |  0.11 |  0.11 |
|      crt screen     |  8.54 | 14.29 |
|        plate        | 20.38 | 22.95 |
|       monitor       |  3.21 |  3.47 |
|    bulletin board   |  0.0  |  0.0  |
|        shower       |  0.65 |  2.42 |
|       radiator      |  0.12 |  0.12 |
|        glass        |  6.77 |  7.04 |
|        clock        | 17.39 | 20.58 |
|         flag        |  7.6  |  7.72 |
+---------------------+-------+-------+
09/15 20:07:34 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 63.4100  mIoU: 18.8700  mAcc: 24.2700  data_time: 0.0022  time: 0.3278
Finished processing corruption type: impulse_noise
Processing corruption type: defocus_blur
09/15 20:09:16 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1032728408
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1032728408
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 20:09:16 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='defocus_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/defocus_blur'

09/15 20:09:56 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 20:09:56 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 20:09:57 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/15 20:09:58 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/15 20:11:58 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:18:10  time: 0.8718  data_time: 0.0021  memory: 17171  
09/15 20:12:46 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:53:18  time: 1.1016  data_time: 0.0030  memory: 16951  
09/15 20:13:11 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:39:40  time: 0.5147  data_time: 0.0019  memory: 16944  
09/15 20:13:48 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:34:27  time: 0.6531  data_time: 0.0019  memory: 16953  
09/15 20:14:21 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:30:39  time: 0.4771  data_time: 0.0019  memory: 16951  
09/15 20:14:47 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:27:15  time: 0.1034  data_time: 0.0020  memory: 16947  
09/15 20:15:20 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:25:18  time: 0.4322  data_time: 0.0019  memory: 16951  
09/15 20:15:45 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:23:07  time: 0.5076  data_time: 0.0018  memory: 16950  
09/15 20:15:53 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:20:24  time: 0.2055  data_time: 0.0044  memory: 16873  
09/15 20:16:05 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:18:20  time: 0.0892  data_time: 0.0018  memory: 16932  
09/15 20:16:18 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:16:42  time: 0.5394  data_time: 0.0022  memory: 16951  
09/15 20:16:26 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:15:05  time: 0.2577  data_time: 0.0021  memory: 16879  
09/15 20:16:45 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:14:04  time: 0.5000  data_time: 0.0017  memory: 16953  
09/15 20:17:07 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:13:16  time: 0.0981  data_time: 0.0020  memory: 16954  
09/15 20:17:29 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:31  time: 1.0557  data_time: 0.0019  memory: 16956  
09/15 20:17:38 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:29  time: 0.0866  data_time: 0.0021  memory: 16944  
09/15 20:17:42 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:27  time: 0.0866  data_time: 0.0022  memory: 647  
09/15 20:17:50 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:36  time: 0.1850  data_time: 0.0018  memory: 16869  
09/15 20:18:10 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:09:03  time: 0.2963  data_time: 0.0021  memory: 16951  
09/15 20:18:21 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:22  time: 0.0814  data_time: 0.0019  memory: 16927  
09/15 20:18:37 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:49  time: 0.6406  data_time: 0.0019  memory: 16954  
09/15 20:18:50 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:14  time: 0.0861  data_time: 0.0019  memory: 16941  
09/15 20:18:59 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:39  time: 0.1940  data_time: 0.0019  memory: 16934  
09/15 20:19:03 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:03  time: 0.1310  data_time: 0.0019  memory: 1844  
09/15 20:19:14 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:33  time: 0.1986  data_time: 0.0019  memory: 16944  
09/15 20:19:18 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:01  time: 0.0861  data_time: 0.0019  memory: 1483  
09/15 20:19:26 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:33  time: 0.0846  data_time: 0.0018  memory: 16929  
09/15 20:19:46 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:12  time: 0.5250  data_time: 0.0019  memory: 16948  
09/15 20:19:55 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:46  time: 0.4379  data_time: 0.0019  memory: 16936  
09/15 20:19:59 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:20  time: 0.0801  data_time: 0.0018  memory: 647  
09/15 20:20:06 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:56  time: 0.1062  data_time: 0.0018  memory: 16878  
09/15 20:20:11 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:33  time: 0.0819  data_time: 0.0020  memory: 1527  
09/15 20:20:23 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:12  time: 0.0816  data_time: 0.0019  memory: 16951  
09/15 20:20:34 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:52  time: 0.0847  data_time: 0.0021  memory: 16942  
09/15 20:20:44 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:32  time: 0.0896  data_time: 0.0018  memory: 16932  
09/15 20:20:52 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:12  time: 0.0862  data_time: 0.0020  memory: 16931  
09/15 20:20:56 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:53  time: 0.0892  data_time: 0.0039  memory: 597  
09/15 20:21:05 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:35  time: 0.0920  data_time: 0.0019  memory: 16954  
09/15 20:21:14 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.0817  data_time: 0.0018  memory: 16935  
09/15 20:21:22 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0791  data_time: 0.0016  memory: 16883  
09/15 20:21:22 - mmengine - INFO - per class results:
09/15 20:21:22 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 70.24 | 87.05 |
|       building      |  77.2 | 93.27 |
|         sky         | 92.87 | 96.43 |
|        floor        | 75.92 |  89.2 |
|         tree        | 69.81 | 84.15 |
|       ceiling       | 79.05 | 86.63 |
|         road        | 78.49 | 90.54 |
|         bed         |  84.2 | 94.09 |
|      windowpane     | 54.72 | 73.95 |
|        grass        | 64.41 | 79.17 |
|       cabinet       | 53.95 | 67.12 |
|       sidewalk      | 57.64 |  69.9 |
|        person       | 71.65 | 87.77 |
|        earth        | 28.21 | 38.68 |
|         door        | 31.57 | 39.88 |
|        table        | 51.45 | 69.85 |
|       mountain      | 48.69 | 64.63 |
|        plant        | 45.37 | 58.36 |
|       curtain       | 66.81 | 77.57 |
|        chair        |  50.2 | 64.95 |
|         car         | 78.03 | 87.63 |
|        water        | 42.25 | 51.47 |
|       painting      | 64.53 | 81.44 |
|         sofa        | 55.89 | 74.99 |
|        shelf        | 38.74 | 61.17 |
|        house        | 37.38 | 44.01 |
|         sea         | 45.41 |  73.0 |
|        mirror       | 50.34 | 57.29 |
|         rug         | 47.04 | 51.94 |
|        field        | 29.02 | 48.91 |
|       armchair      | 39.62 | 54.62 |
|         seat        |  51.8 | 68.36 |
|        fence        |  32.5 | 42.89 |
|         desk        | 39.27 | 55.95 |
|         rock        | 37.45 | 62.76 |
|       wardrobe      | 38.98 | 56.08 |
|         lamp        | 54.15 | 67.06 |
|       bathtub       | 63.44 | 70.69 |
|       railing       | 26.78 | 36.06 |
|       cushion       | 46.96 | 58.67 |
|         base        | 16.97 | 20.73 |
|         box         | 16.19 | 20.56 |
|        column       | 35.34 | 43.46 |
|      signboard      |  24.3 |  31.6 |
|   chest of drawers  |  38.0 | 46.86 |
|       counter       | 21.79 | 26.47 |
|         sand        | 30.99 | 42.51 |
|         sink        | 58.93 | 73.39 |
|      skyscraper     |  50.7 | 63.87 |
|      fireplace      | 57.68 | 70.91 |
|     refrigerator    |  56.6 | 63.83 |
|      grandstand     |  41.4 | 62.92 |
|         path        | 18.35 |  25.7 |
|        stairs       | 24.48 | 26.91 |
|        runway       | 73.27 | 87.76 |
|         case        |  46.1 | 69.64 |
|      pool table     | 89.75 | 94.54 |
|        pillow       | 45.28 | 53.15 |
|     screen door     | 50.44 |  59.9 |
|       stairway      |  30.0 | 39.79 |
|        river        |  11.5 | 25.53 |
|        bridge       | 49.67 |  57.4 |
|       bookcase      | 36.43 | 52.47 |
|        blind        | 19.03 | 19.38 |
|     coffee table    | 58.14 |  75.9 |
|        toilet       | 77.66 | 85.57 |
|        flower       | 26.92 | 43.95 |
|         book        |  37.6 | 54.16 |
|         hill        |  3.3  |  5.93 |
|        bench        | 40.35 | 46.22 |
|      countertop     | 44.09 | 59.84 |
|        stove        | 66.53 | 75.94 |
|         palm        | 39.88 | 45.16 |
|    kitchen island   | 37.25 | 64.01 |
|       computer      | 47.59 | 57.12 |
|     swivel chair    | 43.87 | 62.58 |
|         boat        | 36.37 | 48.11 |
|         bar         | 18.46 | 22.78 |
|    arcade machine   | 45.66 |  50.6 |
|        hovel        | 16.77 | 17.89 |
|         bus         | 71.48 | 87.62 |
|        towel        | 40.11 |  46.2 |
|        light        | 43.96 | 56.96 |
|        truck        | 12.68 | 15.89 |
|        tower        | 18.38 | 23.05 |
|      chandelier     | 61.23 | 75.06 |
|        awning       | 18.03 | 21.97 |
|     streetlight     | 17.35 | 22.69 |
|        booth        | 38.23 | 38.58 |
| television receiver | 49.34 | 68.22 |
|       airplane      | 50.17 | 63.73 |
|      dirt track     |  7.07 | 14.54 |
|       apparel       | 32.22 | 42.87 |
|         pole        | 11.72 | 15.41 |
|         land        |  0.5  |  1.06 |
|      bannister      |  1.72 |  2.33 |
|      escalator      | 14.69 | 15.16 |
|       ottoman       | 31.88 | 46.21 |
|        bottle       |  8.93 | 16.06 |
|        buffet       | 31.93 | 37.42 |
|        poster       | 21.64 | 23.61 |
|        stage        |  4.37 |  6.37 |
|         van         | 31.89 | 35.98 |
|         ship        | 78.46 | 79.52 |
|       fountain      | 13.45 | 16.73 |
|    conveyer belt    | 58.17 | 62.01 |
|        canopy       | 12.29 | 13.23 |
|        washer       | 61.17 | 63.44 |
|      plaything      | 16.05 | 31.59 |
|    swimming pool    | 32.61 | 46.98 |
|        stool        | 26.79 | 32.64 |
|        barrel       | 48.97 | 56.13 |
|        basket       | 14.66 |  16.1 |
|      waterfall      | 59.54 | 93.73 |
|         tent        | 81.29 | 99.55 |
|         bag         |  3.41 |  3.8  |
|       minibike      |  52.0 | 72.67 |
|        cradle       | 64.11 | 96.85 |
|         oven        | 19.22 | 32.44 |
|         ball        | 41.47 | 63.92 |
|         food        | 43.89 | 52.41 |
|         step        |  1.41 |  1.53 |
|         tank        | 36.09 | 38.67 |
|      trade name     | 11.53 | 12.11 |
|      microwave      | 37.33 | 39.75 |
|         pot         | 34.47 | 39.65 |
|        animal       | 39.13 | 41.92 |
|       bicycle       | 39.94 |  50.6 |
|         lake        | 34.12 | 63.47 |
|      dishwasher     | 55.09 | 56.74 |
|        screen       | 59.34 |  75.2 |
|       blanket       |  4.48 |  4.74 |
|      sculpture      | 28.81 | 34.88 |
|         hood        | 45.46 | 50.39 |
|        sconce       | 29.86 | 38.55 |
|         vase        | 25.14 | 35.68 |
|    traffic light    | 21.81 | 30.08 |
|         tray        |  5.13 |  7.0  |
|        ashcan       | 37.89 | 46.26 |
|         fan         | 44.62 | 49.21 |
|         pier        | 18.82 | 22.86 |
|      crt screen     |  2.49 |  4.48 |
|        plate        | 38.54 | 51.94 |
|       monitor       | 49.52 | 74.39 |
|    bulletin board   | 29.74 | 31.85 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  33.6 | 35.94 |
|        glass        |  4.05 |  4.25 |
|        clock        | 26.33 | 29.06 |
|         flag        | 24.97 | 26.92 |
+---------------------+-------+-------+
09/15 20:21:22 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.5400  mIoU: 39.4800  mAcc: 49.4800  data_time: 0.0023  time: 0.3421
Finished processing corruption type: defocus_blur
Processing corruption type: glass_blur
09/15 20:21:29 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1394556116
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1394556116
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/15 20:21:29 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='glass_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/glass_blur'

09/15 20:21:34 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/15 20:21:34 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/15 20:21:35 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/15 20:21:35 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/15 20:29:09 - mmengine - INFO - Iter(test) [  50/2000]    eta: 4:54:37  time: 8.4994  data_time: 0.0021  memory: 17171  
09/15 20:35:51 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 4:30:59  time: 8.4761  data_time: 0.0021  memory: 16951  
09/15 20:41:59 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 4:11:27  time: 7.5045  data_time: 0.0021  memory: 16944  
09/15 20:48:22 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 4:00:57  time: 7.4470  data_time: 0.0020  memory: 16953  
09/15 20:54:39 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 3:51:26  time: 7.3521  data_time: 0.0020  memory: 16951  
09/15 21:00:45 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 3:41:57  time: 7.2784  data_time: 0.0022  memory: 16947  
09/15 21:07:08 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 3:34:41  time: 7.1011  data_time: 0.0020  memory: 16951  
09/15 21:13:21 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 3:27:02  time: 7.6793  data_time: 0.0020  memory: 16950  
09/15 21:18:48 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 3:17:02  time: 6.6431  data_time: 0.0023  memory: 16873  
09/15 21:24:46 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 3:09:31  time: 6.8297  data_time: 0.0020  memory: 16932  
09/15 21:31:07 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 3:03:17  time: 7.9147  data_time: 0.0027  memory: 16951  
09/15 21:37:00 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 2:55:58  time: 7.5218  data_time: 0.0022  memory: 16879  
09/15 21:43:05 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 2:49:16  time: 7.5412  data_time: 0.0019  memory: 16953  
09/15 21:49:31 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 2:43:18  time: 7.2869  data_time: 0.0040  memory: 16954  
09/15 21:55:53 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 2:37:08  time: 7.9435  data_time: 0.0041  memory: 16956  
09/15 22:01:33 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 2:29:55  time: 7.1573  data_time: 0.0043  memory: 16944  
09/15 22:07:34 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 2:23:22  time: 7.2568  data_time: 0.0031  memory: 647  
09/15 22:13:08 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 2:16:20  time: 6.5207  data_time: 0.0034  memory: 16869  
09/15 22:19:29 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 2:10:17  time: 7.2704  data_time: 0.0077  memory: 16951  
09/15 22:25:19 - mmengine - INFO - Iter(test) [1000/2000]    eta: 2:03:43  time: 6.8616  data_time: 0.0033  memory: 16927  
09/15 22:31:37 - mmengine - INFO - Iter(test) [1050/2000]    eta: 1:57:38  time: 7.9595  data_time: 0.0041  memory: 16954  
09/15 22:37:27 - mmengine - INFO - Iter(test) [1100/2000]    eta: 1:51:09  time: 6.6231  data_time: 0.0026  memory: 16941  
09/15 22:43:01 - mmengine - INFO - Iter(test) [1150/2000]    eta: 1:44:32  time: 6.8977  data_time: 0.0019  memory: 16934  
09/15 22:49:00 - mmengine - INFO - Iter(test) [1200/2000]    eta: 1:38:16  time: 7.0160  data_time: 0.0022  memory: 1844  
09/15 22:54:50 - mmengine - INFO - Iter(test) [1250/2000]    eta: 1:31:56  time: 7.0532  data_time: 0.0045  memory: 16944  
09/15 23:00:25 - mmengine - INFO - Iter(test) [1300/2000]    eta: 1:25:31  time: 7.1742  data_time: 0.0021  memory: 1483  
09/15 23:06:22 - mmengine - INFO - Iter(test) [1350/2000]    eta: 1:19:20  time: 6.5949  data_time: 0.0033  memory: 16929  
09/15 23:12:32 - mmengine - INFO - Iter(test) [1400/2000]    eta: 1:13:15  time: 7.9079  data_time: 0.0027  memory: 16948  
09/15 23:18:17 - mmengine - INFO - Iter(test) [1450/2000]    eta: 1:07:01  time: 7.8080  data_time: 0.0036  memory: 16936  
09/15 23:24:04 - mmengine - INFO - Iter(test) [1500/2000]    eta: 1:00:49  time: 6.6107  data_time: 0.0020  memory: 647  
09/15 23:30:17 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:54:46  time: 7.2672  data_time: 0.0039  memory: 16878  
09/15 23:36:03 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:48:36  time: 7.0390  data_time: 0.0036  memory: 1527  
09/15 23:42:00 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:42:30  time: 6.5693  data_time: 0.0032  memory: 16951  
09/15 23:48:08 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:36:26  time: 7.1352  data_time: 0.0039  memory: 16942  
09/15 23:54:16 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:30:22  time: 7.1079  data_time: 0.0036  memory: 16932  
09/16 00:00:00 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:24:16  time: 7.2411  data_time: 0.0075  memory: 16931  
09/16 00:06:00 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:18:11  time: 7.1908  data_time: 0.0038  memory: 597  
09/16 00:11:40 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:12:06  time: 6.9262  data_time: 0.0048  memory: 16954  
09/16 00:17:44 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:06:03  time: 6.8979  data_time: 0.0042  memory: 16935  
09/16 00:23:31 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 6.4933  data_time: 0.0046  memory: 16883  
09/16 00:23:31 - mmengine - INFO - per class results:
09/16 00:23:31 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 69.73 | 88.11 |
|       building      | 77.49 | 92.77 |
|         sky         | 92.79 | 97.02 |
|        floor        | 75.01 | 87.47 |
|         tree        | 69.54 | 85.37 |
|       ceiling       | 78.57 | 88.01 |
|         road        | 78.63 | 91.12 |
|         bed         | 83.76 | 93.42 |
|      windowpane     | 52.72 |  71.0 |
|        grass        |  65.4 | 81.23 |
|       cabinet       | 49.73 | 64.23 |
|       sidewalk      | 52.91 | 61.95 |
|        person       | 72.38 | 88.56 |
|        earth        | 29.45 | 46.94 |
|         door        | 26.87 | 31.21 |
|        table        | 53.14 | 67.87 |
|       mountain      | 48.52 | 65.06 |
|        plant        | 45.93 | 60.23 |
|       curtain       | 59.19 | 81.42 |
|        chair        | 50.38 | 62.45 |
|         car         | 78.81 | 84.91 |
|        water        | 45.32 | 60.89 |
|       painting      | 64.78 | 78.58 |
|         sofa        | 57.53 | 80.45 |
|        shelf        | 37.75 | 58.92 |
|        house        |  34.1 | 37.62 |
|         sea         | 49.42 | 78.89 |
|        mirror       | 48.49 | 61.16 |
|         rug         |  48.4 | 58.62 |
|        field        | 20.33 | 29.95 |
|       armchair      | 36.06 | 47.36 |
|         seat        | 52.03 | 67.41 |
|        fence        | 34.08 | 44.05 |
|         desk        | 39.13 | 51.23 |
|         rock        | 34.13 | 50.54 |
|       wardrobe      | 37.32 | 49.17 |
|         lamp        | 55.26 |  65.7 |
|       bathtub       | 66.02 | 73.49 |
|       railing       | 28.26 | 37.53 |
|       cushion       |  45.7 | 58.03 |
|         base        | 10.71 | 11.74 |
|         box         | 17.46 | 23.53 |
|        column       | 34.02 | 43.26 |
|      signboard      | 25.45 | 31.48 |
|   chest of drawers  | 32.17 | 48.85 |
|       counter       | 19.68 | 23.97 |
|         sand        | 29.18 | 39.21 |
|         sink        | 64.55 | 73.77 |
|      skyscraper     |  50.7 | 65.39 |
|      fireplace      | 58.87 | 72.49 |
|     refrigerator    | 46.75 | 52.23 |
|      grandstand     | 35.36 | 64.99 |
|         path        | 21.28 | 27.51 |
|        stairs       | 27.97 | 32.71 |
|        runway       | 60.75 | 62.88 |
|         case        | 49.89 | 65.11 |
|      pool table     | 91.15 | 94.29 |
|        pillow       | 40.45 | 45.64 |
|     screen door     | 29.37 | 30.46 |
|       stairway      | 24.67 | 30.53 |
|        river        | 18.35 | 23.39 |
|        bridge       | 38.31 |  41.8 |
|       bookcase      | 32.19 | 40.57 |
|        blind        | 22.33 |  23.0 |
|     coffee table    | 58.89 | 74.88 |
|        toilet       | 79.64 | 85.62 |
|        flower       | 29.72 | 49.29 |
|         book        | 38.79 | 53.55 |
|         hill        |  3.83 |  6.59 |
|        bench        | 35.19 | 40.54 |
|      countertop     | 46.71 | 60.65 |
|        stove        | 63.19 | 74.52 |
|         palm        | 34.28 |  38.2 |
|    kitchen island   |  37.9 | 55.95 |
|       computer      | 46.44 | 51.39 |
|     swivel chair    | 43.36 | 56.88 |
|         boat        | 26.79 | 31.46 |
|         bar         | 10.03 | 11.65 |
|    arcade machine   | 36.39 | 46.16 |
|        hovel        | 32.59 | 35.71 |
|         bus         | 80.63 | 87.91 |
|        towel        | 43.74 | 57.18 |
|        light        | 40.77 | 48.28 |
|        truck        | 13.53 | 18.42 |
|        tower        | 30.88 |  38.6 |
|      chandelier     | 60.23 | 78.43 |
|        awning       |  18.9 | 22.27 |
|     streetlight     | 16.21 | 20.05 |
|        booth        | 21.96 | 22.38 |
| television receiver | 51.89 | 59.54 |
|       airplane      | 51.41 | 57.98 |
|      dirt track     |  8.81 |  19.2 |
|       apparel       | 27.21 | 39.25 |
|         pole        | 15.44 | 23.05 |
|         land        |  1.16 |  1.36 |
|      bannister      |  1.49 |  1.76 |
|      escalator      |  9.01 |  9.59 |
|       ottoman       | 32.71 |  45.4 |
|        bottle       |  9.98 | 17.57 |
|        buffet       |  32.2 | 34.57 |
|        poster       | 30.04 | 33.23 |
|        stage        |  3.06 |  3.84 |
|         van         |  35.9 |  41.5 |
|         ship        | 43.97 | 44.17 |
|       fountain      |  7.24 | 10.98 |
|    conveyer belt    | 56.33 | 57.14 |
|        canopy       |  6.46 |  6.97 |
|        washer       |  59.7 | 60.28 |
|      plaything      | 16.32 |  26.6 |
|    swimming pool    | 31.61 | 45.96 |
|        stool        | 33.61 | 40.65 |
|        barrel       | 48.57 | 59.86 |
|        basket       | 14.87 | 16.54 |
|      waterfall      | 61.42 | 89.41 |
|         tent        | 89.53 | 98.86 |
|         bag         |  2.44 |  2.59 |
|       minibike      | 51.99 | 60.54 |
|        cradle       |  69.8 |  96.6 |
|         oven        |  27.4 | 29.19 |
|         ball        | 43.76 | 62.48 |
|         food        | 46.06 | 59.31 |
|         step        |  0.27 |  0.28 |
|         tank        | 32.53 | 36.19 |
|      trade name     | 11.37 | 12.37 |
|      microwave      | 31.93 | 33.41 |
|         pot         | 30.87 |  34.5 |
|        animal       | 42.56 | 44.13 |
|       bicycle       | 39.82 | 55.04 |
|         lake        | 36.28 | 63.29 |
|      dishwasher     | 27.93 | 28.18 |
|        screen       |  34.1 | 40.54 |
|       blanket       |  4.28 |  4.55 |
|      sculpture      |  17.5 | 23.59 |
|         hood        | 44.66 | 48.07 |
|        sconce       | 31.85 | 40.76 |
|         vase        | 23.62 | 32.26 |
|    traffic light    | 22.17 | 27.69 |
|         tray        |  3.22 |  4.69 |
|        ashcan       | 35.16 | 42.62 |
|         fan         | 42.44 | 47.38 |
|         pier        | 13.83 | 15.19 |
|      crt screen     |  0.42 |  0.58 |
|        plate        | 38.06 | 43.18 |
|       monitor       | 57.92 | 71.71 |
|    bulletin board   | 29.85 | 35.18 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 41.59 | 47.24 |
|        glass        |  4.68 |  4.83 |
|        clock        | 22.93 | 27.01 |
|         flag        | 23.89 | 24.93 |
+---------------------+-------+-------+
09/16 00:23:31 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.1700  mIoU: 38.3000  mAcc: 47.0700  data_time: 0.0039  time: 7.2576
Finished processing corruption type: glass_blur
Processing corruption type: motion_blur
09/16 00:25:36 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 323909615
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 323909615
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 00:25:37 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='motion_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/motion_blur'

09/16 00:26:33 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 00:26:33 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 00:26:35 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 00:26:36 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 00:29:45 - mmengine - INFO - Iter(test) [  50/2000]    eta: 2:02:44  time: 1.6660  data_time: 0.0020  memory: 17171  
09/16 00:31:10 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:26:45  time: 1.8619  data_time: 0.0020  memory: 16951  
09/16 00:32:10 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:08:48  time: 1.2570  data_time: 0.0020  memory: 16944  
09/16 00:33:25 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 1:01:23  time: 1.3704  data_time: 0.0020  memory: 16953  
09/16 00:34:35 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:55:52  time: 1.1986  data_time: 0.0019  memory: 16951  
09/16 00:35:36 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:51:02  time: 0.8695  data_time: 0.0022  memory: 16947  
09/16 00:36:47 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:48:01  time: 1.1306  data_time: 0.0027  memory: 16951  
09/16 00:37:49 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:44:51  time: 1.2877  data_time: 0.0017  memory: 16950  
09/16 00:38:32 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:41:08  time: 0.9153  data_time: 0.0018  memory: 16873  
09/16 00:39:23 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:38:22  time: 0.8205  data_time: 0.0019  memory: 16932  
09/16 00:40:17 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:36:06  time: 1.3716  data_time: 0.0020  memory: 16951  
09/16 00:41:02 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:33:41  time: 1.0116  data_time: 0.0020  memory: 16879  
09/16 00:42:00 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:31:58  time: 1.3062  data_time: 0.0017  memory: 16953  
09/16 00:43:02 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:30:31  time: 0.9125  data_time: 0.0021  memory: 16954  
09/16 00:44:04 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:29:07  time: 1.7998  data_time: 0.0019  memory: 16956  
09/16 00:44:49 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:27:19  time: 0.8301  data_time: 0.0023  memory: 16944  
09/16 00:45:31 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:25:35  time: 0.8266  data_time: 0.0020  memory: 647  
09/16 00:46:14 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:24:00  time: 0.8750  data_time: 0.0018  memory: 16869  
09/16 00:47:14 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:22:48  time: 1.1009  data_time: 0.0035  memory: 16951  
09/16 00:48:03 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:21:26  time: 0.8294  data_time: 0.0022  memory: 16927  
09/16 00:48:59 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:20:14  time: 1.4972  data_time: 0.0024  memory: 16954  
09/16 00:49:50 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:19:00  time: 0.8357  data_time: 0.0019  memory: 16941  
09/16 00:50:37 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:17:45  time: 0.9736  data_time: 0.0023  memory: 16934  
09/16 00:51:21 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:16:30  time: 0.8477  data_time: 0.0019  memory: 1844  
09/16 00:52:09 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:15:20  time: 0.9584  data_time: 0.0018  memory: 16944  
09/16 00:52:50 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:14:07  time: 0.8495  data_time: 0.0020  memory: 1483  
09/16 00:53:37 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:13:00  time: 0.8023  data_time: 0.0018  memory: 16929  
09/16 00:54:37 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:12:00  time: 1.3757  data_time: 0.0018  memory: 16948  
09/16 00:55:23 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:10:55  time: 1.2955  data_time: 0.0018  memory: 16936  
09/16 00:56:06 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:09:49  time: 0.7785  data_time: 0.0018  memory: 647  
09/16 00:56:52 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:08:47  time: 0.8907  data_time: 0.0020  memory: 16878  
09/16 00:57:32 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:44  time: 0.8133  data_time: 0.0020  memory: 1527  
09/16 00:58:19 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:43  time: 0.7201  data_time: 0.0015  memory: 16951  
09/16 00:59:10 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:44  time: 0.8822  data_time: 0.0020  memory: 16942  
09/16 00:59:59 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:46  time: 0.9099  data_time: 0.0018  memory: 16932  
09/16 01:00:43 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:47  time: 0.8526  data_time: 0.0020  memory: 16931  
09/16 01:01:25 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:49  time: 0.8179  data_time: 0.0020  memory: 597  
09/16 01:02:10 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:52  time: 0.8601  data_time: 0.0020  memory: 16954  
09/16 01:03:00 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:55  time: 0.8673  data_time: 0.0019  memory: 16935  
09/16 01:03:45 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7735  data_time: 0.0025  memory: 16883  
09/16 01:03:45 - mmengine - INFO - per class results:
09/16 01:03:45 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 70.04 | 84.74 |
|       building      | 73.79 | 93.51 |
|         sky         | 92.13 | 95.51 |
|        floor        | 75.03 | 89.31 |
|         tree        |  65.9 | 76.46 |
|       ceiling       | 78.89 | 89.71 |
|         road        | 76.12 | 84.11 |
|         bed         | 82.73 | 94.35 |
|      windowpane     | 54.46 | 73.19 |
|        grass        | 61.58 | 81.02 |
|       cabinet       | 54.35 |  67.2 |
|       sidewalk      | 54.97 | 76.14 |
|        person       | 70.39 | 87.04 |
|        earth        | 22.57 | 30.32 |
|         door        | 31.76 | 39.41 |
|        table        | 49.76 | 69.25 |
|       mountain      | 41.77 |  66.7 |
|        plant        |  43.8 | 62.18 |
|       curtain       | 64.23 | 77.98 |
|        chair        | 48.75 | 64.11 |
|         car         | 78.15 | 88.98 |
|        water        | 38.93 | 53.36 |
|       painting      | 64.25 | 80.32 |
|         sofa        | 54.93 | 76.12 |
|        shelf        |  35.5 | 56.82 |
|        house        |  26.7 | 33.31 |
|         sea         | 50.14 | 79.51 |
|        mirror       | 51.59 | 57.71 |
|         rug         | 44.66 | 51.38 |
|        field        | 21.15 | 30.79 |
|       armchair      | 31.78 | 42.33 |
|         seat        | 45.38 |  64.1 |
|        fence        | 30.88 | 41.13 |
|         desk        | 40.69 | 58.51 |
|         rock        | 31.12 | 37.45 |
|       wardrobe      | 37.61 | 54.92 |
|         lamp        | 52.75 |  68.1 |
|       bathtub       | 67.45 | 74.93 |
|       railing       | 24.77 | 35.99 |
|       cushion       |  44.2 | 59.12 |
|         base        | 15.84 | 18.34 |
|         box         | 14.93 | 19.11 |
|        column       | 35.46 | 43.98 |
|      signboard      | 27.16 | 35.19 |
|   chest of drawers  | 35.99 | 45.01 |
|       counter       | 26.04 | 33.74 |
|         sand        |  31.7 | 46.88 |
|         sink        | 62.72 |  75.2 |
|      skyscraper     | 38.72 | 47.94 |
|      fireplace      | 59.05 | 78.95 |
|     refrigerator    | 61.45 | 74.68 |
|      grandstand     | 40.03 | 53.35 |
|         path        | 13.71 | 18.78 |
|        stairs       | 29.22 | 31.22 |
|        runway       | 63.21 | 82.31 |
|         case        | 41.53 | 72.42 |
|      pool table     | 89.28 | 93.15 |
|        pillow       | 47.49 | 61.17 |
|     screen door     | 57.12 | 73.31 |
|       stairway      | 31.26 | 36.97 |
|        river        |  9.43 | 26.63 |
|        bridge       | 28.67 | 32.47 |
|       bookcase      | 32.37 | 43.63 |
|        blind        | 35.09 | 38.28 |
|     coffee table    | 57.79 | 73.98 |
|        toilet       | 78.65 | 87.55 |
|        flower       | 25.54 | 31.05 |
|         book        | 38.57 |  55.9 |
|         hill        |  1.86 |  2.95 |
|        bench        | 38.39 | 44.55 |
|      countertop     | 49.39 | 68.98 |
|        stove        | 67.56 | 78.47 |
|         palm        | 34.53 | 54.53 |
|    kitchen island   | 37.89 | 68.61 |
|       computer      | 52.62 | 63.21 |
|     swivel chair    | 46.14 | 64.36 |
|         boat        | 37.69 | 44.83 |
|         bar         | 11.16 | 11.78 |
|    arcade machine   | 18.61 | 19.22 |
|        hovel        |  1.7  |  1.8  |
|         bus         | 75.11 | 88.63 |
|        towel        |  40.2 | 56.22 |
|        light        | 46.06 | 57.82 |
|        truck        |  7.36 |  8.82 |
|        tower        | 19.01 | 23.36 |
|      chandelier     | 53.18 | 59.39 |
|        awning       |  16.4 | 24.03 |
|     streetlight     | 14.72 | 17.54 |
|        booth        | 38.88 | 39.68 |
| television receiver | 57.64 | 68.87 |
|       airplane      | 42.09 | 65.87 |
|      dirt track     |  6.3  | 21.09 |
|       apparel       | 18.69 | 25.69 |
|         pole        | 16.95 | 24.39 |
|         land        |  1.91 |  2.64 |
|      bannister      |  3.08 |  3.82 |
|      escalator      | 17.03 | 18.24 |
|       ottoman       | 31.48 | 43.54 |
|        bottle       |  9.52 | 15.89 |
|        buffet       | 27.37 | 30.76 |
|        poster       | 23.99 | 25.85 |
|        stage        |  8.98 | 10.13 |
|         van         | 28.09 | 31.43 |
|         ship        | 71.51 | 72.36 |
|       fountain      | 10.24 | 10.28 |
|    conveyer belt    | 48.98 | 58.94 |
|        canopy       |  7.07 |  7.57 |
|        washer       | 63.56 | 66.33 |
|      plaything      | 13.65 | 18.91 |
|    swimming pool    | 22.23 | 27.96 |
|        stool        | 29.75 | 34.73 |
|        barrel       | 43.83 | 62.69 |
|        basket       | 17.99 | 28.31 |
|      waterfall      | 35.22 | 49.62 |
|         tent        | 82.81 | 98.96 |
|         bag         |  7.06 |  7.77 |
|       minibike      | 47.41 | 68.82 |
|        cradle       | 71.43 | 94.53 |
|         oven        | 15.35 | 37.81 |
|         ball        | 41.63 | 64.28 |
|         food        | 45.17 | 57.65 |
|         step        |  0.8  |  0.84 |
|         tank        | 34.75 | 39.07 |
|      trade name     | 17.07 | 18.35 |
|      microwave      | 35.55 | 37.86 |
|         pot         | 29.78 |  33.4 |
|        animal       | 39.68 | 45.43 |
|       bicycle       | 38.17 | 51.89 |
|         lake        |  0.02 |  0.02 |
|      dishwasher     | 58.53 | 61.99 |
|        screen       | 56.38 |  69.1 |
|       blanket       |  4.58 |  4.75 |
|      sculpture      | 21.08 | 24.61 |
|         hood        | 51.97 | 58.12 |
|        sconce       | 29.72 | 38.01 |
|         vase        | 23.28 | 29.75 |
|    traffic light    | 22.61 | 31.42 |
|         tray        |  4.15 |  6.23 |
|        ashcan       | 30.41 | 40.92 |
|         fan         | 52.45 | 63.07 |
|         pier        | 17.15 | 20.62 |
|      crt screen     |  0.69 |  1.03 |
|        plate        | 42.07 | 61.74 |
|       monitor       | 55.49 | 72.75 |
|    bulletin board   | 32.91 |  35.6 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 39.08 | 41.71 |
|        glass        |  5.26 |  5.45 |
|        clock        | 22.32 | 26.25 |
|         flag        | 22.26 | 23.15 |
+---------------------+-------+-------+
09/16 01:03:45 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 77.3100  mIoU: 37.8600  mAcc: 47.8400  data_time: 0.0028  time: 1.1145
Finished processing corruption type: motion_blur
Processing corruption type: zoom_blur
09/16 01:05:17 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1083077259
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1083077259
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 01:05:17 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='zoom_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/zoom_blur'

09/16 01:05:59 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 01:05:59 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 01:06:01 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 01:06:01 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 01:08:58 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:55:07  time: 1.6508  data_time: 0.0022  memory: 17171  
09/16 01:10:22 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:22:24  time: 1.8260  data_time: 0.0020  memory: 16951  
09/16 01:11:21 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:05:47  time: 1.2576  data_time: 0.0020  memory: 16944  
09/16 01:12:35 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:59:00  time: 1.3339  data_time: 0.0020  memory: 16953  
09/16 01:13:42 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:53:44  time: 1.1526  data_time: 0.0022  memory: 16951  
09/16 01:14:41 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:49:06  time: 0.8146  data_time: 0.0021  memory: 16947  
09/16 01:15:51 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:46:18  time: 1.0944  data_time: 0.0020  memory: 16951  
09/16 01:16:50 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:43:15  time: 1.2389  data_time: 0.0018  memory: 16950  
09/16 01:17:30 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:39:32  time: 0.8414  data_time: 0.0020  memory: 16873  
09/16 01:18:16 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:36:45  time: 0.7543  data_time: 0.0019  memory: 16932  
09/16 01:19:07 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:34:30  time: 1.2814  data_time: 0.0020  memory: 16951  
09/16 01:19:49 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:32:11  time: 0.9844  data_time: 0.0022  memory: 16879  
09/16 01:20:43 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:30:30  time: 1.2382  data_time: 0.0018  memory: 16953  
09/16 01:21:40 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:29:03  time: 0.8157  data_time: 0.0021  memory: 16954  
09/16 01:22:38 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:27:40  time: 1.7130  data_time: 0.0032  memory: 16956  
09/16 01:23:19 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:25:56  time: 0.7863  data_time: 0.0021  memory: 16944  
09/16 01:23:59 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:24:17  time: 0.7990  data_time: 0.0021  memory: 647  
09/16 01:24:39 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:22:45  time: 0.8029  data_time: 0.0019  memory: 16869  
09/16 01:25:34 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:21:36  time: 0.9785  data_time: 0.0026  memory: 16951  
09/16 01:26:19 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:20:17  time: 0.7460  data_time: 0.0019  memory: 16927  
09/16 01:27:11 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:19:08  time: 1.3711  data_time: 0.0028  memory: 16954  
09/16 01:27:58 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:17:56  time: 0.7638  data_time: 0.0019  memory: 16941  
09/16 01:28:41 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:16:44  time: 0.8932  data_time: 0.0019  memory: 16934  
09/16 01:29:20 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:15:32  time: 0.7544  data_time: 0.0020  memory: 1844  
09/16 01:30:04 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:14:25  time: 0.8658  data_time: 0.0019  memory: 16944  
09/16 01:30:41 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:13:16  time: 0.7878  data_time: 0.0020  memory: 1483  
09/16 01:31:23 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:12:12  time: 0.7299  data_time: 0.0018  memory: 16929  
09/16 01:32:19 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:11:16  time: 1.2622  data_time: 0.0025  memory: 16948  
09/16 01:33:01 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:10:14  time: 1.1915  data_time: 0.0020  memory: 16936  
09/16 01:33:39 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:09:12  time: 0.7225  data_time: 0.0018  memory: 647  
09/16 01:34:22 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:08:13  time: 0.8036  data_time: 0.0024  memory: 16878  
09/16 01:35:00 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:14  time: 0.7687  data_time: 0.0021  memory: 1527  
09/16 01:35:46 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:18  time: 0.7238  data_time: 0.0018  memory: 16951  
09/16 01:36:32 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:23  time: 0.7904  data_time: 0.0022  memory: 16942  
09/16 01:37:18 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:28  time: 0.7900  data_time: 0.0032  memory: 16932  
09/16 01:37:59 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:33  time: 0.8261  data_time: 0.0027  memory: 16931  
09/16 01:38:40 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:38  time: 0.8088  data_time: 0.0031  memory: 597  
09/16 01:39:22 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:45  time: 0.7686  data_time: 0.0025  memory: 16954  
09/16 01:40:06 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:52  time: 0.7609  data_time: 0.0019  memory: 16935  
09/16 01:40:48 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7058  data_time: 0.0016  memory: 16883  
09/16 01:40:48 - mmengine - INFO - per class results:
09/16 01:40:48 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 49.26 | 84.58 |
|       building      | 57.25 | 75.86 |
|         sky         | 82.84 | 87.03 |
|        floor        |  49.6 | 76.42 |
|         tree        |  17.6 | 18.58 |
|       ceiling       |  57.3 | 79.63 |
|         road        |  47.4 | 54.56 |
|         bed         | 60.37 | 86.27 |
|      windowpane     | 34.87 | 48.39 |
|        grass        | 34.52 | 52.84 |
|       cabinet       | 37.44 |  45.1 |
|       sidewalk      | 23.27 | 37.36 |
|        person       | 38.59 | 66.04 |
|        earth        |  4.81 |  5.99 |
|         door        | 12.06 | 13.86 |
|        table        | 32.62 | 46.84 |
|       mountain      | 31.16 | 44.82 |
|        plant        | 17.36 | 36.21 |
|       curtain       |  31.5 | 53.98 |
|        chair        | 24.39 | 30.13 |
|         car         | 51.86 | 62.13 |
|        water        | 20.99 | 33.11 |
|       painting      | 37.93 | 58.35 |
|         sofa        |  38.2 | 57.71 |
|        shelf        | 18.97 | 25.12 |
|        house        | 11.27 | 13.63 |
|         sea         | 37.51 | 60.77 |
|        mirror       | 30.79 |  33.8 |
|         rug         |  9.64 |  9.76 |
|        field        | 12.81 |  24.1 |
|       armchair      | 15.91 | 22.52 |
|         seat        | 18.63 | 25.53 |
|        fence        |  8.13 | 12.13 |
|         desk        | 21.07 |  26.5 |
|         rock        | 10.32 | 12.83 |
|       wardrobe      | 14.62 | 19.31 |
|         lamp        | 32.41 | 43.87 |
|       bathtub       | 46.55 | 61.21 |
|       railing       |  8.95 | 12.21 |
|       cushion       | 20.85 | 26.35 |
|         base        |  3.2  |  3.63 |
|         box         |  1.67 |  1.92 |
|        column       |  9.79 | 10.29 |
|      signboard      | 11.31 |  12.9 |
|   chest of drawers  | 21.38 | 27.65 |
|       counter       |  8.23 | 12.02 |
|         sand        |  9.98 | 22.71 |
|         sink        | 41.05 | 60.88 |
|      skyscraper     | 24.34 | 35.65 |
|      fireplace      | 43.21 | 53.86 |
|     refrigerator    | 40.18 |  49.2 |
|      grandstand     |  27.7 | 29.97 |
|         path        |  0.89 |  0.99 |
|        stairs       |  0.86 |  1.02 |
|        runway       | 56.29 | 78.76 |
|         case        | 22.49 | 46.93 |
|      pool table     | 73.62 | 84.37 |
|        pillow       | 31.78 | 45.66 |
|     screen door     | 24.14 | 37.34 |
|       stairway      |  8.95 |  9.87 |
|        river        |  3.93 | 15.66 |
|        bridge       | 20.52 | 22.37 |
|       bookcase      | 10.67 | 12.61 |
|        blind        | 15.22 | 21.79 |
|     coffee table    | 33.53 | 36.98 |
|        toilet       | 63.06 | 73.93 |
|        flower       | 14.94 |  19.3 |
|         book        | 11.61 | 13.58 |
|         hill        |  3.57 |  4.51 |
|        bench        | 29.72 | 37.27 |
|      countertop     | 28.87 | 33.68 |
|        stove        | 45.13 | 52.51 |
|         palm        |  5.58 | 39.42 |
|    kitchen island   | 30.27 | 56.62 |
|       computer      | 40.09 | 45.65 |
|     swivel chair    | 12.69 |  14.8 |
|         boat        | 20.22 | 21.68 |
|         bar         |  4.23 |  4.46 |
|    arcade machine   |  0.0  |  0.0  |
|        hovel        |  0.26 |  0.26 |
|         bus         | 52.71 | 59.38 |
|        towel        | 14.61 | 20.77 |
|        light        | 17.02 | 22.15 |
|        truck        |  0.43 |  0.45 |
|        tower        |  4.57 |  5.15 |
|      chandelier     | 21.55 | 22.94 |
|        awning       | 14.61 | 17.33 |
|     streetlight     |  1.83 |  1.89 |
|        booth        |  9.88 | 10.05 |
| television receiver | 28.59 | 31.46 |
|       airplane      | 31.41 | 54.72 |
|      dirt track     |  1.91 |  5.32 |
|       apparel       |  0.05 |  0.06 |
|         pole        |  3.24 |  3.77 |
|         land        |  1.54 |  1.9  |
|      bannister      |  1.18 |  1.69 |
|      escalator      |  9.84 | 10.47 |
|       ottoman       | 19.17 | 26.24 |
|        bottle       |  0.91 |  1.2  |
|        buffet       |  1.53 |  1.64 |
|        poster       |  0.69 |  0.77 |
|        stage        |  0.31 |  0.33 |
|         van         |  1.69 |  1.73 |
|         ship        |  0.0  |  0.0  |
|       fountain      |  0.01 |  0.01 |
|    conveyer belt    | 27.98 | 37.94 |
|        canopy       |  0.28 |  0.28 |
|        washer       | 54.54 | 57.16 |
|      plaything      |  5.18 |  5.57 |
|    swimming pool    |  11.0 | 15.26 |
|        stool        |  9.72 | 10.75 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  4.55 |  6.02 |
|      waterfall      | 16.42 | 90.66 |
|         tent        | 34.24 | 40.64 |
|         bag         |  0.02 |  0.02 |
|       minibike      |  18.3 | 20.48 |
|        cradle       | 58.47 | 68.82 |
|         oven        | 10.55 |  11.7 |
|         ball        | 13.27 | 14.93 |
|         food        |  9.8  |  10.0 |
|         step        |  0.29 |  0.35 |
|         tank        |  17.4 | 20.54 |
|      trade name     |  5.19 |  5.35 |
|      microwave      | 18.15 |  19.1 |
|         pot         |  4.89 |  5.11 |
|        animal       | 23.25 | 32.94 |
|       bicycle       |  3.02 |  3.21 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 25.49 | 30.89 |
|        screen       | 58.98 |  75.4 |
|       blanket       |  0.17 |  0.2  |
|      sculpture      |  0.34 |  0.42 |
|         hood        | 30.59 | 44.71 |
|        sconce       | 11.75 | 15.34 |
|         vase        | 13.74 | 19.96 |
|    traffic light    |  3.98 |  4.04 |
|         tray        |  2.22 |  3.34 |
|        ashcan       |  9.93 |  10.7 |
|         fan         |  19.9 | 25.07 |
|         pier        | 10.79 |  12.2 |
|      crt screen     |  1.79 |  1.92 |
|        plate        | 24.71 | 38.84 |
|       monitor       |  2.09 |  2.21 |
|    bulletin board   |  7.34 |  7.42 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  21.7 | 34.28 |
|        glass        |  2.18 |  2.29 |
|        clock        |  2.5  |  2.52 |
|         flag        |  4.43 |  4.65 |
+---------------------+-------+-------+
09/16 01:40:48 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 59.5400  mIoU: 19.3800  mAcc: 26.3500  data_time: 0.0028  time: 1.0431
Finished processing corruption type: zoom_blur
Processing corruption type: snow
09/16 01:42:43 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 618045349
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 618045349
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 01:42:43 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='snow',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/snow'

09/16 01:43:28 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 01:43:29 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 01:43:30 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 01:43:31 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 01:46:08 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:42:15  time: 1.1602  data_time: 0.0024  memory: 17171  
09/16 01:47:08 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:08:38  time: 1.3415  data_time: 0.0021  memory: 16951  
09/16 01:47:44 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:52:04  time: 0.7814  data_time: 0.0020  memory: 16944  
09/16 01:48:34 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:45:25  time: 0.8576  data_time: 0.0020  memory: 16953  
09/16 01:49:18 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:40:31  time: 0.6843  data_time: 0.0020  memory: 16951  
09/16 01:49:55 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:36:18  time: 0.3366  data_time: 0.0021  memory: 16947  
09/16 01:50:42 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:33:50  time: 0.6653  data_time: 0.0056  memory: 16951  
09/16 01:51:18 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:31:08  time: 0.7695  data_time: 0.0019  memory: 16950  
09/16 01:51:37 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:27:53  time: 0.4211  data_time: 0.0027  memory: 16873  
09/16 01:52:00 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:25:26  time: 0.3103  data_time: 0.0019  memory: 16932  
09/16 01:52:26 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:23:30  time: 0.8072  data_time: 0.0023  memory: 16951  
09/16 01:52:45 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:21:33  time: 0.4933  data_time: 0.0021  memory: 16879  
09/16 01:53:16 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:20:14  time: 0.7809  data_time: 0.0018  memory: 16953  
09/16 01:53:49 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:19:07  time: 0.3479  data_time: 0.0023  memory: 16954  
09/16 01:54:23 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:18:05  time: 1.2451  data_time: 0.0019  memory: 16956  
09/16 01:54:42 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:16:46  time: 0.3180  data_time: 0.0021  memory: 16944  
09/16 01:54:59 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:15:30  time: 0.3275  data_time: 0.0021  memory: 647  
09/16 01:55:17 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:14:22  time: 0.3833  data_time: 0.0018  memory: 16869  
09/16 01:55:48 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:13:34  time: 0.5283  data_time: 0.0019  memory: 16951  
09/16 01:56:10 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:12:39  time: 0.3056  data_time: 0.0019  memory: 16927  
09/16 01:56:38 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:11:52  time: 0.9011  data_time: 0.0027  memory: 16954  
09/16 01:57:02 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:11:03  time: 0.3119  data_time: 0.0020  memory: 16941  
09/16 01:57:23 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:10:14  time: 0.4346  data_time: 0.0020  memory: 16934  
09/16 01:57:39 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:09:25  time: 0.3073  data_time: 0.0018  memory: 1844  
09/16 01:58:00 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:08:41  time: 0.4206  data_time: 0.0019  memory: 16944  
09/16 01:58:15 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:07:56  time: 0.3212  data_time: 0.0019  memory: 1483  
09/16 01:58:35 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:07:15  time: 0.2940  data_time: 0.0019  memory: 16929  
09/16 01:59:07 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:06:41  time: 0.7719  data_time: 0.0019  memory: 16948  
09/16 01:59:28 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:06:02  time: 0.7131  data_time: 0.0018  memory: 16936  
09/16 01:59:43 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:05:23  time: 0.2991  data_time: 0.0018  memory: 647  
09/16 02:00:01 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:04:47  time: 0.3231  data_time: 0.0019  memory: 16878  
09/16 02:00:17 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:04:11  time: 0.3146  data_time: 0.0020  memory: 1527  
09/16 02:00:40 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:03:38  time: 0.2948  data_time: 0.0018  memory: 16951  
09/16 02:01:03 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:05  time: 0.3153  data_time: 0.0021  memory: 16942  
09/16 02:01:25 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:33  time: 0.3192  data_time: 0.0017  memory: 16932  
09/16 02:01:44 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:01  time: 0.3184  data_time: 0.0020  memory: 16931  
09/16 02:02:00 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:29  time: 0.3165  data_time: 0.0020  memory: 597  
09/16 02:02:20 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:59  time: 0.3154  data_time: 0.0019  memory: 16954  
09/16 02:02:41 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:29  time: 0.3049  data_time: 0.0019  memory: 16935  
09/16 02:03:00 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2909  data_time: 0.0017  memory: 16883  
09/16 02:03:01 - mmengine - INFO - per class results:
09/16 02:03:01 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 54.57 | 82.48 |
|       building      | 62.99 |  89.7 |
|         sky         | 78.36 | 81.86 |
|        floor        | 51.92 | 85.98 |
|         tree        | 50.91 | 82.53 |
|       ceiling       | 55.75 | 68.03 |
|         road        | 47.19 | 49.72 |
|         bed         | 58.95 | 66.21 |
|      windowpane     | 45.49 | 56.71 |
|        grass        | 56.63 | 79.52 |
|       cabinet       | 33.39 | 45.79 |
|       sidewalk      | 36.98 | 58.18 |
|        person       | 60.41 | 74.62 |
|        earth        | 22.17 |  33.0 |
|         door        | 14.41 | 17.35 |
|        table        | 36.92 |  45.7 |
|       mountain      | 28.67 | 36.83 |
|        plant        | 38.31 | 54.18 |
|       curtain       | 36.61 | 47.65 |
|        chair        | 36.16 | 48.41 |
|         car         | 71.68 | 80.07 |
|        water        | 28.86 | 40.08 |
|       painting      | 54.07 | 65.11 |
|         sofa        |  38.3 | 43.42 |
|        shelf        | 24.67 | 49.89 |
|        house        | 14.38 | 14.75 |
|         sea         | 15.09 | 19.17 |
|        mirror       | 27.72 | 29.57 |
|         rug         |  19.2 | 19.78 |
|        field        | 10.93 | 15.07 |
|       armchair      | 22.46 | 30.65 |
|         seat        | 28.86 | 50.01 |
|        fence        | 17.95 | 30.14 |
|         desk        | 17.15 | 18.67 |
|         rock        | 17.08 | 24.51 |
|       wardrobe      | 20.26 | 23.04 |
|         lamp        | 48.75 | 58.83 |
|       bathtub       | 21.88 | 22.75 |
|       railing       | 16.99 | 19.96 |
|       cushion       | 31.69 | 40.45 |
|         base        |  6.08 | 13.15 |
|         box         | 10.73 | 18.14 |
|        column       | 12.07 |  13.5 |
|      signboard      | 26.66 | 38.39 |
|   chest of drawers  | 20.98 | 25.77 |
|       counter       |  7.86 |  8.88 |
|         sand        |  4.63 |  5.27 |
|         sink        | 41.55 | 46.55 |
|      skyscraper     | 11.46 | 15.86 |
|      fireplace      |  40.1 | 44.16 |
|     refrigerator    | 26.64 | 26.86 |
|      grandstand     | 21.74 | 66.31 |
|         path        |  8.53 |  9.95 |
|        stairs       | 15.16 | 16.28 |
|        runway       | 15.29 | 15.37 |
|         case        | 28.98 | 40.33 |
|      pool table     | 28.11 | 28.22 |
|        pillow       | 28.54 |  33.1 |
|     screen door     |  5.85 |  7.28 |
|       stairway      |  8.14 | 10.11 |
|        river        |  10.6 | 12.35 |
|        bridge       | 12.24 | 12.93 |
|       bookcase      | 13.86 | 14.51 |
|        blind        |  8.22 |  8.81 |
|     coffee table    | 22.38 |  23.0 |
|        toilet       | 28.69 | 29.06 |
|        flower       |  26.7 | 46.03 |
|         book        | 34.73 | 44.96 |
|         hill        |  0.2  |  0.22 |
|        bench        | 18.07 | 19.34 |
|      countertop     | 24.04 | 26.47 |
|        stove        |  44.1 | 49.86 |
|         palm        |  37.4 | 57.88 |
|    kitchen island   | 15.67 | 19.56 |
|       computer      |  42.1 |  47.2 |
|     swivel chair    | 11.65 | 11.87 |
|         boat        | 30.46 | 36.29 |
|         bar         |  4.67 |  5.15 |
|    arcade machine   |  4.64 |  4.71 |
|        hovel        |  28.4 | 40.93 |
|         bus         | 77.46 |  88.4 |
|        towel        | 11.84 | 13.09 |
|        light        | 23.36 | 24.45 |
|        truck        |  7.28 |  9.65 |
|        tower        |  4.1  |  4.82 |
|      chandelier     | 48.61 | 65.09 |
|        awning       |  8.25 |  8.66 |
|     streetlight     | 15.14 | 16.87 |
|        booth        |  5.63 |  5.63 |
| television receiver | 24.55 | 26.19 |
|       airplane      | 32.08 | 33.98 |
|      dirt track     |  0.0  |  0.0  |
|       apparel       |  5.99 | 23.12 |
|         pole        |  12.0 | 15.83 |
|         land        |  0.25 |  0.26 |
|      bannister      |  2.01 |  2.24 |
|      escalator      |  3.25 |  4.63 |
|       ottoman       |  7.59 |  8.36 |
|        bottle       |  5.83 | 21.42 |
|        buffet       |  0.25 |  0.27 |
|        poster       | 12.35 | 17.55 |
|        stage        |  2.22 |  2.23 |
|         van         | 23.35 | 26.64 |
|         ship        |  1.17 |  1.2  |
|       fountain      |  0.79 |  1.24 |
|    conveyer belt    |  29.1 | 29.11 |
|        canopy       |  0.52 |  0.58 |
|        washer       | 51.67 | 53.73 |
|      plaything      |  9.0  | 26.46 |
|    swimming pool    |  9.36 |  9.52 |
|        stool        | 17.63 | 22.88 |
|        barrel       |  0.0  |  0.0  |
|        basket       |  17.2 | 24.05 |
|      waterfall      | 38.14 | 50.21 |
|         tent        | 11.47 | 11.79 |
|         bag         |  3.03 |  6.88 |
|       minibike      | 35.05 | 41.43 |
|        cradle       | 30.54 | 37.91 |
|         oven        | 14.18 | 17.57 |
|         ball        |  6.9  |  7.23 |
|         food        | 28.37 | 38.12 |
|         step        |  0.03 |  0.03 |
|         tank        |  2.46 |  3.05 |
|      trade name     | 11.36 | 11.76 |
|      microwave      | 12.71 | 12.87 |
|         pot         | 18.06 | 19.25 |
|        animal       | 24.96 | 26.46 |
|       bicycle       | 27.14 | 56.97 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     |  19.6 | 20.04 |
|        screen       | 39.51 | 45.22 |
|       blanket       |  0.49 |  0.49 |
|      sculpture      |  2.23 |  3.3  |
|         hood        | 20.42 | 20.94 |
|        sconce       | 12.34 | 13.75 |
|         vase        | 24.41 | 36.24 |
|    traffic light    | 15.45 | 17.27 |
|         tray        |  2.01 |  2.47 |
|        ashcan       | 21.94 | 26.75 |
|         fan         | 25.54 | 26.74 |
|         pier        |  7.04 |  7.38 |
|      crt screen     | 13.89 | 28.51 |
|        plate        | 37.93 | 44.21 |
|       monitor       | 47.84 | 56.53 |
|    bulletin board   | 24.95 | 28.45 |
|        shower       |  0.0  |  0.0  |
|       radiator      |  1.3  |  1.33 |
|        glass        | 10.52 |  13.5 |
|        clock        | 16.38 | 18.02 |
|         flag        | 16.12 | 17.37 |
+---------------------+-------+-------+
09/16 02:03:01 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 64.8300  mIoU: 22.2500  mAcc: 28.3500  data_time: 0.0026  time: 0.5846
Finished processing corruption type: snow
Processing corruption type: frost
09/16 02:03:43 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1938572128
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1938572128
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 02:03:43 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='frost',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/frost'

09/16 02:03:55 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 02:03:55 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 02:03:55 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 02:03:56 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 02:05:30 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:00:42  time: 0.8660  data_time: 0.0021  memory: 17171  
09/16 02:06:16 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:44:24  time: 1.0702  data_time: 0.0019  memory: 16951  
09/16 02:06:40 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:33:41  time: 0.5037  data_time: 0.0031  memory: 16944  
09/16 02:07:16 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:29:56  time: 0.6291  data_time: 0.0029  memory: 16953  
09/16 02:07:47 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:59  time: 0.4280  data_time: 0.0018  memory: 16951  
09/16 02:08:13 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:24:13  time: 0.0851  data_time: 0.0020  memory: 16947  
09/16 02:08:46 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:46  time: 0.4212  data_time: 0.0019  memory: 16951  
09/16 02:09:10 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:55  time: 0.4954  data_time: 0.0028  memory: 16950  
09/16 02:09:18 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:27  time: 0.1864  data_time: 0.0019  memory: 16873  
09/16 02:09:29 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:36  time: 0.0752  data_time: 0.0018  memory: 16932  
09/16 02:09:41 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:09  time: 0.5083  data_time: 0.0020  memory: 16951  
09/16 02:09:48 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:41  time: 0.2434  data_time: 0.0020  memory: 16879  
09/16 02:10:06 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:47  time: 0.4891  data_time: 0.0017  memory: 16953  
09/16 02:10:26 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:04  time: 0.0856  data_time: 0.0021  memory: 16954  
09/16 02:10:47 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:25  time: 1.0475  data_time: 0.0031  memory: 16956  
09/16 02:10:55 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:28  time: 0.0744  data_time: 0.0020  memory: 16944  
09/16 02:10:59 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:32  time: 0.0757  data_time: 0.0021  memory: 647  
09/16 02:11:06 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:45  time: 0.1729  data_time: 0.0018  memory: 16869  
09/16 02:11:25 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:15  time: 0.2844  data_time: 0.0019  memory: 16951  
09/16 02:11:36 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:39  time: 0.0696  data_time: 0.0019  memory: 16927  
09/16 02:11:51 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:09  time: 0.6092  data_time: 0.0019  memory: 16954  
09/16 02:12:03 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:38  time: 0.0770  data_time: 0.0020  memory: 16941  
09/16 02:12:11 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:05  time: 0.1821  data_time: 0.0019  memory: 16934  
09/16 02:12:15 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:32  time: 0.0729  data_time: 0.0019  memory: 1844  
09/16 02:12:24 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:04  time: 0.1847  data_time: 0.0018  memory: 16944  
09/16 02:12:28 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:35  time: 0.0850  data_time: 0.0033  memory: 1483  
09/16 02:12:35 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:09  time: 0.0714  data_time: 0.0017  memory: 16929  
09/16 02:12:54 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:50  time: 0.4948  data_time: 0.0018  memory: 16948  
09/16 02:13:03 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:27  time: 0.4222  data_time: 0.0018  memory: 16936  
09/16 02:13:06 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:03  time: 0.0698  data_time: 0.0018  memory: 647  
09/16 02:13:12 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:41  time: 0.0753  data_time: 0.0019  memory: 16878  
09/16 02:13:16 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:19  time: 0.0695  data_time: 0.0019  memory: 1527  
09/16 02:13:27 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:01  time: 0.0675  data_time: 0.0017  memory: 16951  
09/16 02:13:37 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:42  time: 0.0718  data_time: 0.0020  memory: 16942  
09/16 02:13:46 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:24  time: 0.0808  data_time: 0.0018  memory: 16932  
09/16 02:13:53 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:06  time: 0.0731  data_time: 0.0020  memory: 16931  
09/16 02:13:57 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:48  time: 0.0741  data_time: 0.0020  memory: 597  
09/16 02:14:05 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:32  time: 0.0799  data_time: 0.0019  memory: 16954  
09/16 02:14:14 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:15  time: 0.0697  data_time: 0.0018  memory: 16935  
09/16 02:14:21 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0673  data_time: 0.0016  memory: 16883  
09/16 02:14:22 - mmengine - INFO - per class results:
09/16 02:14:22 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 61.28 |  87.1 |
|       building      | 75.82 | 91.04 |
|         sky         | 76.47 | 79.38 |
|        floor        | 69.01 | 86.31 |
|         tree        | 63.62 | 85.04 |
|       ceiling       | 64.36 | 72.77 |
|         road        | 71.48 | 80.15 |
|         bed         | 77.39 | 91.02 |
|      windowpane     | 48.76 | 62.08 |
|        grass        | 60.32 | 76.48 |
|       cabinet       | 47.31 |  55.9 |
|       sidewalk      | 48.96 | 59.88 |
|        person       | 67.65 |  83.7 |
|        earth        | 27.19 | 48.62 |
|         door        | 20.89 | 25.73 |
|        table        | 48.67 | 65.74 |
|       mountain      | 29.78 |  69.6 |
|        plant        | 43.64 |  54.9 |
|       curtain       | 49.13 | 62.88 |
|        chair        |  46.9 |  60.8 |
|         car         | 76.87 | 85.53 |
|        water        | 46.36 | 61.97 |
|       painting      | 59.79 | 77.75 |
|         sofa        | 54.92 | 72.19 |
|        shelf        | 33.64 | 46.07 |
|        house        | 45.41 | 53.54 |
|         sea         | 32.03 | 48.47 |
|        mirror       | 42.59 | 48.55 |
|         rug         | 37.43 | 42.13 |
|        field        | 25.34 | 38.47 |
|       armchair      | 34.39 | 47.63 |
|         seat        | 40.92 | 47.07 |
|        fence        | 21.44 | 31.25 |
|         desk        | 31.82 | 40.45 |
|         rock        | 25.66 | 38.14 |
|       wardrobe      | 32.92 | 42.21 |
|         lamp        | 52.83 | 64.66 |
|       bathtub       | 36.63 | 43.44 |
|       railing       | 27.15 | 39.46 |
|       cushion       | 44.47 | 54.22 |
|         base        |  7.24 |  8.78 |
|         box         | 15.86 | 21.06 |
|        column       | 23.64 | 28.13 |
|      signboard      | 30.16 | 41.06 |
|   chest of drawers  | 32.52 | 37.14 |
|       counter       | 15.59 | 22.92 |
|         sand        |  21.9 | 25.39 |
|         sink        | 48.51 |  56.7 |
|      skyscraper     | 32.01 |  41.3 |
|      fireplace      | 57.96 | 76.75 |
|     refrigerator    | 39.61 | 42.05 |
|      grandstand     | 37.84 | 60.35 |
|         path        | 17.53 | 23.07 |
|        stairs       | 34.32 | 41.88 |
|        runway       |  54.8 | 59.48 |
|         case        | 48.55 | 83.38 |
|      pool table     | 79.26 | 82.68 |
|        pillow       | 39.34 | 45.79 |
|     screen door     | 32.27 | 66.28 |
|       stairway      | 25.77 | 32.64 |
|        river        | 11.61 | 14.03 |
|        bridge       | 62.25 | 67.51 |
|       bookcase      | 32.05 | 39.84 |
|        blind        | 25.11 | 26.39 |
|     coffee table    | 57.57 | 69.73 |
|        toilet       | 57.88 | 59.71 |
|        flower       | 30.23 | 43.27 |
|         book        | 40.95 | 62.57 |
|         hill        |  6.85 |  9.53 |
|        bench        | 31.78 | 37.15 |
|      countertop     | 39.55 |  61.2 |
|        stove        | 54.67 | 60.57 |
|         palm        | 42.04 | 53.29 |
|    kitchen island   | 30.29 | 51.22 |
|       computer      | 47.79 | 52.98 |
|     swivel chair    | 28.02 | 31.12 |
|         boat        | 33.86 | 36.76 |
|         bar         |  9.08 |  9.98 |
|    arcade machine   | 20.76 | 21.84 |
|        hovel        | 34.29 |  36.7 |
|         bus         | 73.05 | 85.38 |
|        towel        |  25.9 | 42.43 |
|        light        | 37.85 | 41.96 |
|        truck        | 10.12 | 12.16 |
|        tower        |  23.2 | 29.73 |
|      chandelier     | 58.39 | 71.89 |
|        awning       | 13.06 | 13.59 |
|     streetlight     |  16.1 | 17.97 |
|        booth        | 26.98 |  27.1 |
| television receiver | 32.85 | 34.84 |
|       airplane      | 47.85 | 61.25 |
|      dirt track     |  2.62 |  4.81 |
|       apparel       | 14.97 |  20.3 |
|         pole        |  14.1 | 20.56 |
|         land        |  0.43 |  0.47 |
|      bannister      |  4.05 |  4.64 |
|      escalator      |  5.26 |  5.32 |
|       ottoman       | 21.09 | 23.74 |
|        bottle       | 10.67 | 17.44 |
|        buffet       |  7.46 |  8.0  |
|        poster       | 14.03 | 16.53 |
|        stage        |  3.95 |  4.39 |
|         van         | 27.75 | 32.45 |
|         ship        |  2.16 |  2.17 |
|       fountain      |  4.36 |  4.53 |
|    conveyer belt    | 32.96 | 37.64 |
|        canopy       |  0.21 |  0.23 |
|        washer       | 48.55 | 48.57 |
|      plaything      | 14.16 | 17.82 |
|    swimming pool    | 29.77 | 38.57 |
|        stool        | 25.04 | 31.81 |
|        barrel       | 31.26 | 33.09 |
|        basket       | 23.52 | 29.87 |
|      waterfall      |  43.4 | 52.33 |
|         tent        |  67.6 | 69.77 |
|         bag         |  3.84 |  4.63 |
|       minibike      | 33.15 | 35.71 |
|        cradle       | 63.86 | 84.42 |
|         oven        | 23.29 | 28.52 |
|         ball        |  46.4 | 57.37 |
|         food        | 40.23 | 53.87 |
|         step        |  3.27 |  3.68 |
|         tank        | 20.79 | 21.11 |
|      trade name     | 18.18 | 20.77 |
|      microwave      | 26.62 | 27.97 |
|         pot         |  25.7 | 27.94 |
|        animal       | 41.51 | 43.75 |
|       bicycle       | 40.44 | 63.42 |
|         lake        | 61.46 | 61.52 |
|      dishwasher     | 38.42 | 39.25 |
|        screen       | 36.03 | 37.87 |
|       blanket       |  3.58 |  3.68 |
|      sculpture      |  10.6 | 12.55 |
|         hood        | 45.58 | 47.54 |
|        sconce       | 18.99 | 21.26 |
|         vase        | 24.52 | 38.29 |
|    traffic light    | 20.53 |  23.3 |
|         tray        |  5.67 |  7.43 |
|        ashcan       | 22.25 | 23.76 |
|         fan         |  41.9 | 51.87 |
|         pier        | 15.16 | 16.21 |
|      crt screen     |  0.05 |  0.06 |
|        plate        | 42.16 | 52.16 |
|       monitor       | 43.59 | 49.74 |
|    bulletin board   |  22.5 |  24.9 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 15.46 | 15.94 |
|        glass        | 11.78 | 12.99 |
|        clock        | 18.27 | 20.63 |
|         flag        | 27.04 | 28.88 |
+---------------------+-------+-------+
09/16 02:14:22 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 72.9500  mIoU: 33.4700  mAcc: 41.2700  data_time: 0.0023  time: 0.3126
Finished processing corruption type: frost
Processing corruption type: fog
09/16 02:14:29 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1001285290
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1001285290
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 02:14:29 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='fog',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/fog'

09/16 02:14:35 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 02:14:35 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 02:14:36 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 02:14:36 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 02:16:15 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:03:58  time: 1.0212  data_time: 0.0022  memory: 17171  
09/16 02:17:09 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:48:22  time: 1.2243  data_time: 0.0020  memory: 16951  
09/16 02:17:40 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:37:44  time: 0.6591  data_time: 0.0020  memory: 16944  
09/16 02:18:23 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:34:04  time: 0.7557  data_time: 0.0019  memory: 16953  
09/16 02:19:03 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:31:07  time: 0.5795  data_time: 0.0020  memory: 16951  
09/16 02:19:36 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:28:16  time: 0.2252  data_time: 0.0021  memory: 16947  
09/16 02:20:17 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:26:45  time: 0.5655  data_time: 0.0019  memory: 16951  
09/16 02:20:48 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:24:46  time: 0.6572  data_time: 0.0019  memory: 16950  
09/16 02:21:02 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:22:10  time: 0.3206  data_time: 0.0019  memory: 16873  
09/16 02:21:20 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:20:12  time: 0.2161  data_time: 0.0019  memory: 16932  
09/16 02:21:40 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:18:38  time: 0.6769  data_time: 0.0021  memory: 16951  
09/16 02:21:55 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:17:03  time: 0.3905  data_time: 0.0028  memory: 16879  
09/16 02:22:20 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:16:03  time: 0.6672  data_time: 0.0018  memory: 16953  
09/16 02:22:48 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:15:12  time: 0.2283  data_time: 0.0021  memory: 16954  
09/16 02:23:16 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:14:26  time: 1.1469  data_time: 0.0018  memory: 16956  
09/16 02:23:31 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:13:21  time: 0.1980  data_time: 0.0019  memory: 16944  
09/16 02:23:41 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:12:17  time: 0.2102  data_time: 0.0021  memory: 647  
09/16 02:23:55 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:22  time: 0.3034  data_time: 0.0018  memory: 16869  
09/16 02:24:21 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:45  time: 0.4105  data_time: 0.0019  memory: 16951  
09/16 02:24:38 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:10:01  time: 0.2036  data_time: 0.0018  memory: 16927  
09/16 02:25:00 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:24  time: 0.7630  data_time: 0.0019  memory: 16954  
09/16 02:25:19 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:45  time: 0.2063  data_time: 0.0019  memory: 16941  
09/16 02:25:34 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:08:05  time: 0.3159  data_time: 0.0019  memory: 16934  
09/16 02:25:44 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:25  time: 0.2061  data_time: 0.0018  memory: 1844  
09/16 02:26:00 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:50  time: 0.3147  data_time: 0.0018  memory: 16944  
09/16 02:26:11 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:13  time: 0.2083  data_time: 0.0018  memory: 1483  
09/16 02:26:25 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:41  time: 0.2040  data_time: 0.0018  memory: 16929  
09/16 02:26:52 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:15  time: 0.6520  data_time: 0.0018  memory: 16948  
09/16 02:27:07 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:44  time: 0.5981  data_time: 0.0019  memory: 16936  
09/16 02:27:18 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:13  time: 0.2042  data_time: 0.0018  memory: 647  
09/16 02:27:30 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:44  time: 0.2122  data_time: 0.0019  memory: 16878  
09/16 02:27:41 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:16  time: 0.2030  data_time: 0.0020  memory: 1527  
09/16 02:27:59 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:50  time: 0.2036  data_time: 0.0018  memory: 16951  
09/16 02:28:16 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:24  time: 0.2124  data_time: 0.0021  memory: 16942  
09/16 02:28:32 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:59  time: 0.2119  data_time: 0.0018  memory: 16932  
09/16 02:28:46 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:34  time: 0.2108  data_time: 0.0020  memory: 16931  
09/16 02:28:56 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:09  time: 0.2097  data_time: 0.0020  memory: 597  
09/16 02:29:11 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:46  time: 0.2130  data_time: 0.0019  memory: 16954  
09/16 02:29:27 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:22  time: 0.2101  data_time: 0.0018  memory: 16935  
09/16 02:29:41 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1985  data_time: 0.0016  memory: 16883  
09/16 02:29:41 - mmengine - INFO - per class results:
09/16 02:29:41 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  71.3 | 87.45 |
|       building      | 77.09 | 92.34 |
|         sky         | 92.61 | 96.28 |
|        floor        | 76.36 | 88.77 |
|         tree        | 68.76 | 85.89 |
|       ceiling       | 79.01 |  88.4 |
|         road        | 79.28 | 88.14 |
|         bed         | 84.04 | 95.03 |
|      windowpane     | 55.67 | 74.09 |
|        grass        | 62.03 | 78.73 |
|       cabinet       | 53.86 |  67.7 |
|       sidewalk      | 60.23 | 74.46 |
|        person       | 72.84 | 88.32 |
|        earth        | 29.45 | 43.76 |
|         door        | 35.56 | 44.15 |
|        table        | 53.79 | 71.03 |
|       mountain      | 50.13 | 69.91 |
|        plant        | 45.72 | 57.17 |
|       curtain       | 64.04 | 77.98 |
|        chair        | 51.15 | 70.55 |
|         car         | 79.42 | 86.52 |
|        water        | 40.27 | 55.89 |
|       painting      | 65.93 | 81.95 |
|         sofa        | 58.79 | 76.46 |
|        shelf        | 37.59 | 58.51 |
|        house        | 37.96 | 42.01 |
|         sea         | 40.05 | 68.99 |
|        mirror       |  53.2 | 60.17 |
|         rug         | 45.35 | 49.44 |
|        field        | 16.59 | 19.97 |
|       armchair      | 39.98 | 51.21 |
|         seat        | 44.04 | 54.92 |
|        fence        | 20.13 | 26.36 |
|         desk        | 42.94 | 55.34 |
|         rock        | 29.35 | 41.52 |
|       wardrobe      | 35.84 | 51.75 |
|         lamp        | 56.96 | 72.69 |
|       bathtub       | 53.04 | 79.06 |
|       railing       | 28.49 | 46.86 |
|       cushion       | 45.05 | 56.06 |
|         base        | 12.74 |  16.0 |
|         box         | 17.27 | 22.32 |
|        column       | 36.33 | 47.06 |
|      signboard      | 31.51 | 45.07 |
|   chest of drawers  |  37.5 | 49.02 |
|       counter       | 25.31 | 30.43 |
|         sand        | 31.06 | 38.91 |
|         sink        | 58.42 |  77.1 |
|      skyscraper     | 33.78 | 39.54 |
|      fireplace      | 61.23 | 70.19 |
|     refrigerator    | 55.52 | 64.06 |
|      grandstand     | 43.16 | 63.58 |
|         path        | 16.26 | 22.51 |
|        stairs       | 32.46 | 37.68 |
|        runway       | 58.94 |  84.7 |
|         case        | 47.59 | 75.41 |
|      pool table     | 89.94 | 93.33 |
|        pillow       | 50.27 | 65.82 |
|     screen door     | 51.27 |  74.4 |
|       stairway      |  23.1 |  33.1 |
|        river        |  7.65 | 11.69 |
|        bridge       | 35.94 | 38.16 |
|       bookcase      | 29.75 | 37.84 |
|        blind        |  35.1 | 39.29 |
|     coffee table    | 59.54 | 71.89 |
|        toilet       | 77.06 | 89.95 |
|        flower       | 32.04 | 43.36 |
|         book        | 35.94 | 54.22 |
|         hill        |  3.45 |  5.71 |
|        bench        | 35.59 |  41.4 |
|      countertop     | 46.73 | 65.57 |
|        stove        | 67.21 | 71.37 |
|         palm        | 42.83 | 53.31 |
|    kitchen island   | 40.35 | 70.07 |
|       computer      | 49.28 | 63.76 |
|     swivel chair    | 36.97 | 45.44 |
|         boat        | 45.22 | 51.35 |
|         bar         | 11.26 | 12.93 |
|    arcade machine   | 25.61 | 26.59 |
|        hovel        | 26.04 | 27.15 |
|         bus         |  80.0 | 92.24 |
|        towel        | 44.56 | 62.11 |
|        light        | 46.06 | 53.99 |
|        truck        | 11.08 | 13.34 |
|        tower        | 31.72 | 43.65 |
|      chandelier     | 63.34 | 74.42 |
|        awning       | 12.24 | 12.81 |
|     streetlight     | 17.61 | 21.16 |
|        booth        | 26.96 | 28.65 |
| television receiver |  55.3 | 60.94 |
|       airplane      | 36.63 | 69.67 |
|      dirt track     | 11.92 | 19.68 |
|       apparel       | 23.24 | 33.29 |
|         pole        | 17.62 | 25.03 |
|         land        |  5.55 |  7.4  |
|      bannister      |  4.6  |  6.32 |
|      escalator      | 12.75 | 12.96 |
|       ottoman       | 35.63 | 41.85 |
|        bottle       | 12.06 | 21.01 |
|        buffet       | 25.53 | 32.45 |
|        poster       | 17.83 | 26.68 |
|        stage        |  5.3  |  5.84 |
|         van         | 38.44 | 50.72 |
|         ship        | 68.99 | 70.04 |
|       fountain      |  5.15 |  5.31 |
|    conveyer belt    |  51.2 | 56.92 |
|        canopy       |  4.54 |  4.75 |
|        washer       | 60.99 | 64.76 |
|      plaything      | 11.97 | 18.99 |
|    swimming pool    |  9.99 | 12.17 |
|        stool        | 30.08 | 34.62 |
|        barrel       | 50.71 | 57.57 |
|        basket       | 23.63 | 27.72 |
|      waterfall      | 46.87 | 59.62 |
|         tent        | 54.04 | 99.43 |
|         bag         |  7.88 | 10.03 |
|       minibike      | 48.81 | 53.63 |
|        cradle       | 64.34 | 96.58 |
|         oven        | 25.84 |  28.9 |
|         ball        | 37.39 | 49.08 |
|         food        | 35.26 | 37.95 |
|         step        |  1.63 |  1.71 |
|         tank        | 27.55 | 28.03 |
|      trade name     | 16.73 | 18.22 |
|      microwave      | 33.65 | 36.28 |
|         pot         | 30.85 | 33.79 |
|        animal       | 38.03 | 40.04 |
|       bicycle       | 41.11 | 63.83 |
|         lake        | 46.15 | 63.63 |
|      dishwasher     | 48.87 | 54.45 |
|        screen       | 51.33 | 64.16 |
|       blanket       |  3.17 |  3.47 |
|      sculpture      | 34.58 | 40.64 |
|         hood        | 51.97 | 55.48 |
|        sconce       | 31.88 | 37.73 |
|         vase        | 26.42 | 40.45 |
|    traffic light    | 20.34 | 26.13 |
|         tray        |  3.54 |  4.32 |
|        ashcan       | 31.39 | 37.82 |
|         fan         |  53.0 | 64.85 |
|         pier        | 17.56 | 19.68 |
|      crt screen     |  0.21 |  0.72 |
|        plate        | 39.78 | 53.56 |
|       monitor       | 15.67 | 18.74 |
|    bulletin board   | 30.32 | 39.22 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 30.91 | 38.78 |
|        glass        | 12.61 |  15.4 |
|        clock        | 23.14 | 27.08 |
|         flag        | 22.81 | 23.94 |
+---------------------+-------+-------+
09/16 02:29:41 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.5700  mIoU: 38.3300  mAcc: 48.0200  data_time: 0.0022  time: 0.4524
Finished processing corruption type: fog
Processing corruption type: brightness
09/16 02:29:53 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 549054254
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 549054254
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 02:29:53 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='brightness',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/brightness'

09/16 02:30:01 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 02:30:01 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 02:30:02 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 02:30:03 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 02:31:41 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:04:17  time: 1.0002  data_time: 0.0021  memory: 17171  
09/16 02:32:34 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:48:03  time: 1.2015  data_time: 0.0020  memory: 16951  
09/16 02:33:05 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:37:30  time: 0.6581  data_time: 0.0019  memory: 16944  
09/16 02:33:49 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:33:54  time: 0.7791  data_time: 0.0019  memory: 16953  
09/16 02:34:28 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:30:56  time: 0.5766  data_time: 0.0026  memory: 16951  
09/16 02:35:00 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:28:06  time: 0.2429  data_time: 0.0020  memory: 16947  
09/16 02:35:41 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:26:34  time: 0.5670  data_time: 0.0019  memory: 16951  
09/16 02:36:13 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:24:39  time: 0.6530  data_time: 0.0019  memory: 16950  
09/16 02:36:27 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:22:04  time: 0.3276  data_time: 0.0039  memory: 16873  
09/16 02:36:45 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:20:08  time: 0.2272  data_time: 0.0019  memory: 16932  
09/16 02:37:06 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:18:36  time: 0.6707  data_time: 0.0021  memory: 16951  
09/16 02:37:21 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:17:03  time: 0.4092  data_time: 0.0021  memory: 16879  
09/16 02:37:46 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:16:03  time: 0.6434  data_time: 0.0018  memory: 16953  
09/16 02:38:15 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:15:13  time: 0.2458  data_time: 0.0021  memory: 16954  
09/16 02:38:43 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:14:27  time: 1.1317  data_time: 0.0019  memory: 16956  
09/16 02:38:58 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:13:23  time: 0.2330  data_time: 0.0020  memory: 16944  
09/16 02:39:10 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:12:20  time: 0.2360  data_time: 0.0021  memory: 647  
09/16 02:39:24 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:11:26  time: 0.3059  data_time: 0.0018  memory: 16869  
09/16 02:39:51 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:10:50  time: 0.4312  data_time: 0.0020  memory: 16951  
09/16 02:40:09 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:10:06  time: 0.2191  data_time: 0.0019  memory: 16927  
09/16 02:40:32 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:09:29  time: 0.7708  data_time: 0.0019  memory: 16954  
09/16 02:40:52 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:08:50  time: 0.2248  data_time: 0.0020  memory: 16941  
09/16 02:41:07 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:08:11  time: 0.3387  data_time: 0.0019  memory: 16934  
09/16 02:41:19 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:07:31  time: 0.2265  data_time: 0.0019  memory: 1844  
09/16 02:41:36 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:55  time: 0.3343  data_time: 0.0019  memory: 16944  
09/16 02:41:47 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:06:19  time: 0.2411  data_time: 0.0025  memory: 1483  
09/16 02:42:01 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:45  time: 0.2110  data_time: 0.0018  memory: 16929  
09/16 02:42:28 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:05:19  time: 0.6556  data_time: 0.0018  memory: 16948  
09/16 02:42:44 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:48  time: 0.5991  data_time: 0.0026  memory: 16936  
09/16 02:42:55 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:04:17  time: 0.2118  data_time: 0.0018  memory: 647  
09/16 02:43:08 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:48  time: 0.2313  data_time: 0.0018  memory: 16878  
09/16 02:43:19 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:19  time: 0.2213  data_time: 0.0019  memory: 1527  
09/16 02:43:38 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:52  time: 0.2114  data_time: 0.0018  memory: 16951  
09/16 02:43:56 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:27  time: 0.2348  data_time: 0.0020  memory: 16942  
09/16 02:44:13 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:02:01  time: 0.2283  data_time: 0.0018  memory: 16932  
09/16 02:44:27 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:36  time: 0.2403  data_time: 0.0020  memory: 16931  
09/16 02:44:39 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:11  time: 0.2393  data_time: 0.0020  memory: 597  
09/16 02:44:55 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:46  time: 0.2248  data_time: 0.0018  memory: 16954  
09/16 02:45:11 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:23  time: 0.2142  data_time: 0.0017  memory: 16935  
09/16 02:45:26 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2083  data_time: 0.0016  memory: 16883  
09/16 02:45:27 - mmengine - INFO - per class results:
09/16 02:45:27 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.68 | 87.89 |
|       building      | 78.86 | 92.04 |
|         sky         |  93.2 |  96.9 |
|        floor        | 77.44 | 90.41 |
|         tree        | 71.47 | 85.88 |
|       ceiling       | 80.42 | 89.62 |
|         road        | 80.61 | 89.69 |
|         bed         | 85.83 | 94.73 |
|      windowpane     | 57.74 | 74.12 |
|        grass        | 63.18 | 83.17 |
|       cabinet       | 56.08 | 70.22 |
|       sidewalk      |  64.5 | 77.97 |
|        person       | 74.04 | 89.27 |
|        earth        | 31.22 | 42.36 |
|         door        | 38.55 | 49.97 |
|        table        | 56.67 | 73.19 |
|       mountain      | 51.91 | 70.92 |
|        plant        | 46.52 | 60.59 |
|       curtain       | 65.58 | 78.66 |
|        chair        | 52.67 | 68.62 |
|         car         | 80.42 | 88.77 |
|        water        | 45.17 |  60.8 |
|       painting      | 66.67 | 82.15 |
|         sofa        |  61.3 | 80.27 |
|        shelf        | 41.24 | 61.36 |
|        house        | 38.37 | 43.25 |
|         sea         | 45.02 | 72.65 |
|        mirror       | 54.49 | 62.13 |
|         rug         | 50.79 |  56.3 |
|        field        | 22.12 |  31.0 |
|       armchair      | 39.63 | 53.51 |
|         seat        | 56.36 | 74.85 |
|        fence        | 32.28 | 43.26 |
|         desk        | 44.84 | 61.81 |
|         rock        |  25.6 | 37.53 |
|       wardrobe      | 40.32 | 58.49 |
|         lamp        | 57.75 | 71.46 |
|       bathtub       | 69.65 |  77.0 |
|       railing       | 31.02 | 42.87 |
|       cushion       | 52.48 | 66.77 |
|         base        | 14.64 |  17.5 |
|         box         | 20.22 | 26.69 |
|        column       | 37.81 | 47.54 |
|      signboard      | 31.73 | 45.57 |
|   chest of drawers  | 38.87 | 51.93 |
|       counter       | 26.41 |  32.0 |
|         sand        | 40.67 | 54.89 |
|         sink        |  64.9 | 77.39 |
|      skyscraper     | 45.54 | 55.66 |
|      fireplace      | 62.77 | 75.14 |
|     refrigerator    | 61.11 | 72.36 |
|      grandstand     | 41.01 | 60.77 |
|         path        | 17.69 | 25.03 |
|        stairs       | 31.27 | 36.32 |
|        runway       | 63.44 |  82.6 |
|         case        | 52.67 |  74.0 |
|      pool table     | 91.52 | 94.47 |
|        pillow       |  50.9 | 61.64 |
|     screen door     | 56.03 | 73.71 |
|       stairway      | 29.03 | 35.41 |
|        river        | 13.38 | 22.19 |
|        bridge       | 38.93 | 42.79 |
|       bookcase      | 38.86 | 50.64 |
|        blind        | 38.35 | 43.34 |
|     coffee table    |  60.7 | 76.12 |
|        toilet       | 81.07 |  89.8 |
|        flower       |  33.7 | 51.08 |
|         book        | 42.36 | 65.18 |
|         hill        |  4.76 |  6.93 |
|        bench        | 39.55 | 46.06 |
|      countertop     | 48.11 | 66.52 |
|        stove        | 71.47 | 79.01 |
|         palm        | 44.33 | 58.82 |
|    kitchen island   |  40.5 | 69.56 |
|       computer      | 53.29 | 64.23 |
|     swivel chair    | 43.07 | 54.73 |
|         boat        | 39.32 | 44.73 |
|         bar         | 13.94 | 16.47 |
|    arcade machine   | 32.87 | 34.76 |
|        hovel        | 37.42 | 40.83 |
|         bus         | 76.14 | 92.42 |
|        towel        | 48.82 | 58.57 |
|        light        |  48.4 | 56.43 |
|        truck        | 12.46 | 16.08 |
|        tower        | 27.18 | 33.91 |
|      chandelier     |  63.9 | 77.19 |
|        awning       | 21.69 | 23.19 |
|     streetlight     | 18.59 | 23.44 |
|        booth        |  33.0 |  33.6 |
| television receiver | 62.33 | 71.43 |
|       airplane      | 46.88 | 63.28 |
|      dirt track     | 10.44 | 19.52 |
|       apparel       | 31.27 | 45.79 |
|         pole        | 17.26 | 25.13 |
|         land        |  1.19 |  1.45 |
|      bannister      |  3.97 |  5.02 |
|      escalator      | 14.35 |  15.4 |
|       ottoman       | 33.02 |  41.3 |
|        bottle       | 12.02 |  22.4 |
|        buffet       | 30.96 | 37.21 |
|        poster       | 21.93 | 25.55 |
|        stage        |  9.79 | 11.21 |
|         van         | 37.41 | 45.63 |
|         ship        | 82.89 | 83.95 |
|       fountain      |  7.8  |  7.89 |
|    conveyer belt    | 51.57 | 62.33 |
|        canopy       |  4.11 |  4.4  |
|        washer       | 66.82 |  69.5 |
|      plaything      | 16.29 | 24.31 |
|    swimming pool    | 44.72 | 54.78 |
|        stool        | 33.55 | 39.42 |
|        barrel       | 40.52 | 63.72 |
|        basket       | 26.71 | 34.13 |
|      waterfall      | 48.72 | 59.27 |
|         tent        | 86.12 | 98.59 |
|         bag         |  7.3  |  8.6  |
|       minibike      | 40.43 | 45.24 |
|        cradle       | 71.73 | 95.88 |
|         oven        | 24.57 | 51.79 |
|         ball        | 43.76 | 63.31 |
|         food        | 45.71 | 56.18 |
|         step        |  1.59 |  1.73 |
|         tank        | 33.52 | 36.57 |
|      trade name     | 22.91 |  26.0 |
|      microwave      | 36.34 |  39.0 |
|         pot         | 37.27 | 42.79 |
|        animal       | 40.88 | 42.84 |
|       bicycle       | 43.96 | 65.28 |
|         lake        | 56.13 | 63.56 |
|      dishwasher     | 56.28 | 58.92 |
|        screen       | 53.12 | 64.22 |
|       blanket       |  4.27 |  4.57 |
|      sculpture      | 30.15 | 34.62 |
|         hood        | 55.41 | 59.77 |
|        sconce       | 33.42 | 40.74 |
|         vase        | 27.62 | 41.28 |
|    traffic light    | 24.38 | 31.75 |
|         tray        |  6.47 |  8.82 |
|        ashcan       | 36.01 | 46.54 |
|         fan         |  54.5 | 65.01 |
|         pier        | 23.21 | 27.12 |
|      crt screen     |  0.17 |  0.37 |
|        plate        | 43.15 | 59.65 |
|       monitor       | 37.99 | 45.86 |
|    bulletin board   | 32.75 | 39.65 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 34.16 | 40.32 |
|        glass        | 12.48 | 13.83 |
|        clock        | 23.62 | 28.84 |
|         flag        | 29.82 | 32.38 |
+---------------------+-------+-------+
09/16 02:45:27 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.0300  mIoU: 41.7800  mAcc: 51.6500  data_time: 0.0023  time: 0.4617
Finished processing corruption type: brightness
Processing corruption type: contrast
09/16 02:47:05 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 622976944
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 622976944
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 02:47:05 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='contrast',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/contrast'

09/16 02:47:44 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 02:47:45 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 02:47:46 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 02:47:46 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 02:50:00 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:26:52  time: 0.8626  data_time: 0.0026  memory: 17171  
09/16 02:50:47 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:57:06  time: 1.0667  data_time: 0.0020  memory: 16951  
09/16 02:51:10 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:41:53  time: 0.5091  data_time: 0.0022  memory: 16944  
09/16 02:51:46 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:35:55  time: 0.6253  data_time: 0.0020  memory: 16953  
09/16 02:52:17 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:31:37  time: 0.4270  data_time: 0.0019  memory: 16951  
09/16 02:52:43 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:27:58  time: 0.0843  data_time: 0.0033  memory: 16947  
09/16 02:53:16 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:25:52  time: 0.4174  data_time: 0.0019  memory: 16951  
09/16 02:53:40 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:23:32  time: 0.4945  data_time: 0.0019  memory: 16950  
09/16 02:53:47 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:20:42  time: 0.1866  data_time: 0.0019  memory: 16873  
09/16 02:53:58 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:18:34  time: 0.0756  data_time: 0.0019  memory: 16932  
09/16 02:54:10 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:16:51  time: 0.5112  data_time: 0.0020  memory: 16951  
09/16 02:54:17 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:15:12  time: 0.2435  data_time: 0.0021  memory: 16879  
09/16 02:54:35 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:14:08  time: 0.4897  data_time: 0.0018  memory: 16953  
09/16 02:54:55 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:13:16  time: 0.0827  data_time: 0.0021  memory: 16954  
09/16 02:55:16 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:30  time: 1.0504  data_time: 0.0019  memory: 16956  
09/16 02:55:24 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:26  time: 0.0719  data_time: 0.0021  memory: 16944  
09/16 02:55:28 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:24  time: 0.0730  data_time: 0.0021  memory: 647  
09/16 02:55:35 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:32  time: 0.1731  data_time: 0.0020  memory: 16869  
09/16 02:55:54 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:58  time: 0.2814  data_time: 0.0020  memory: 16951  
09/16 02:56:04 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:17  time: 0.0681  data_time: 0.0019  memory: 16927  
09/16 02:56:19 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:44  time: 0.6101  data_time: 0.0026  memory: 16954  
09/16 02:56:31 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:09  time: 0.0722  data_time: 0.0020  memory: 16941  
09/16 02:56:39 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:33  time: 0.1793  data_time: 0.0019  memory: 16934  
09/16 02:56:43 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:57  time: 0.0716  data_time: 0.0018  memory: 1844  
09/16 02:56:52 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:27  time: 0.1822  data_time: 0.0019  memory: 16944  
09/16 02:56:55 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:55  time: 0.0699  data_time: 0.0019  memory: 1483  
09/16 02:57:02 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:27  time: 0.0682  data_time: 0.0017  memory: 16929  
09/16 02:57:21 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:06  time: 0.4917  data_time: 0.0017  memory: 16948  
09/16 02:57:29 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:41  time: 0.4274  data_time: 0.0042  memory: 16936  
09/16 02:57:33 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:15  time: 0.0656  data_time: 0.0018  memory: 647  
09/16 02:57:38 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:51  time: 0.0733  data_time: 0.0019  memory: 16878  
09/16 02:57:42 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:28  time: 0.0681  data_time: 0.0020  memory: 1527  
09/16 02:57:53 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:08  time: 0.0636  data_time: 0.0017  memory: 16951  
09/16 02:58:03 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:48  time: 0.0705  data_time: 0.0020  memory: 16942  
09/16 02:58:12 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:29  time: 0.0735  data_time: 0.0018  memory: 16932  
09/16 02:58:19 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:10  time: 0.0713  data_time: 0.0019  memory: 16931  
09/16 02:58:22 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:51  time: 0.0725  data_time: 0.0021  memory: 597  
09/16 02:58:30 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:33  time: 0.0781  data_time: 0.0020  memory: 16954  
09/16 02:58:39 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.0682  data_time: 0.0019  memory: 16935  
09/16 02:58:46 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0638  data_time: 0.0015  memory: 16883  
09/16 02:58:47 - mmengine - INFO - per class results:
09/16 02:58:47 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 70.78 | 87.78 |
|       building      | 76.91 |  91.9 |
|         sky         | 92.84 | 96.35 |
|        floor        | 76.11 | 89.01 |
|         tree        | 68.75 | 85.91 |
|       ceiling       | 79.35 | 89.11 |
|         road        | 79.63 | 88.68 |
|         bed         | 84.01 | 95.03 |
|      windowpane     | 55.65 | 72.12 |
|        grass        | 60.97 | 77.75 |
|       cabinet       | 53.95 | 67.71 |
|       sidewalk      | 60.09 | 73.06 |
|        person       | 73.21 | 87.69 |
|        earth        | 30.89 | 48.13 |
|         door        | 35.55 | 43.75 |
|        table        | 53.64 | 70.68 |
|       mountain      | 48.43 | 67.34 |
|        plant        | 45.59 | 53.81 |
|       curtain       | 63.57 | 77.36 |
|        chair        |  50.3 | 70.13 |
|         car         | 79.49 | 86.64 |
|        water        | 44.45 | 63.71 |
|       painting      | 64.12 | 80.76 |
|         sofa        | 59.17 | 75.62 |
|        shelf        |  37.7 | 56.84 |
|        house        | 39.02 |  45.5 |
|         sea         |  46.6 |  72.8 |
|        mirror       | 52.87 | 60.56 |
|         rug         | 46.25 | 49.39 |
|        field        | 17.56 | 22.77 |
|       armchair      | 39.94 | 53.59 |
|         seat        | 46.78 | 58.58 |
|        fence        | 20.51 | 25.99 |
|         desk        | 42.77 |  56.3 |
|         rock        | 24.06 | 31.07 |
|       wardrobe      | 35.54 | 51.93 |
|         lamp        | 56.87 | 72.31 |
|       bathtub       | 55.88 | 78.74 |
|       railing       | 27.82 | 43.95 |
|       cushion       | 44.49 | 55.47 |
|         base        | 14.91 | 18.45 |
|         box         |  17.3 | 24.33 |
|        column       | 35.87 | 45.93 |
|      signboard      | 31.99 |  45.3 |
|   chest of drawers  | 37.38 |  50.4 |
|       counter       | 28.33 | 35.57 |
|         sand        | 27.11 | 33.89 |
|         sink        | 59.15 | 76.04 |
|      skyscraper     | 42.21 | 52.68 |
|      fireplace      | 60.84 | 70.97 |
|     refrigerator    |  56.8 | 67.72 |
|      grandstand     | 38.52 | 56.36 |
|         path        | 15.99 | 22.64 |
|        stairs       | 26.75 | 30.96 |
|        runway       |  59.6 | 84.08 |
|         case        |  40.8 | 74.43 |
|      pool table     | 89.02 | 94.07 |
|        pillow       | 49.27 | 62.77 |
|     screen door     | 56.07 |  76.0 |
|       stairway      | 24.08 | 32.05 |
|        river        |  5.64 |  7.81 |
|        bridge       | 28.63 | 30.69 |
|       bookcase      | 34.37 | 43.48 |
|        blind        | 35.24 | 39.84 |
|     coffee table    |  58.0 |  70.4 |
|        toilet       |  78.3 | 89.22 |
|        flower       | 31.13 | 41.92 |
|         book        |  37.6 | 55.12 |
|         hill        |  4.06 |  5.37 |
|        bench        | 35.85 | 42.59 |
|      countertop     | 46.34 | 68.64 |
|        stove        | 62.02 | 65.18 |
|         palm        | 39.94 |  48.1 |
|    kitchen island   | 39.03 | 67.66 |
|       computer      |  50.5 | 61.48 |
|     swivel chair    | 37.48 | 45.19 |
|         boat        | 32.01 | 34.32 |
|         bar         | 12.35 | 13.36 |
|    arcade machine   | 16.56 | 17.02 |
|        hovel        | 18.23 |  19.0 |
|         bus         | 79.72 | 89.54 |
|        towel        | 43.71 | 59.66 |
|        light        | 41.17 | 46.07 |
|        truck        | 11.47 | 13.85 |
|        tower        | 34.02 | 44.92 |
|      chandelier     | 62.84 | 74.14 |
|        awning       |  16.4 | 17.11 |
|     streetlight     | 17.45 | 20.76 |
|        booth        | 28.68 | 29.44 |
| television receiver | 51.04 | 55.05 |
|       airplane      | 42.62 | 65.11 |
|      dirt track     | 10.87 | 18.24 |
|       apparel       |  19.8 |  26.3 |
|         pole        | 18.99 | 26.73 |
|         land        | 10.07 | 13.56 |
|      bannister      |  4.59 |  5.94 |
|      escalator      |  6.98 |  7.45 |
|       ottoman       | 35.71 | 42.41 |
|        bottle       | 10.76 | 18.48 |
|        buffet       | 32.11 | 40.36 |
|        poster       |  17.2 |  21.2 |
|        stage        |  5.68 |  6.64 |
|         van         | 35.41 | 47.74 |
|         ship        | 76.09 | 77.23 |
|       fountain      |  2.14 |  2.16 |
|    conveyer belt    | 52.77 | 57.57 |
|        canopy       |  3.36 |  3.6  |
|        washer       | 58.78 | 61.74 |
|      plaything      |  10.2 | 16.08 |
|    swimming pool    |  9.73 | 11.74 |
|        stool        |  28.7 | 33.11 |
|        barrel       | 51.52 | 60.44 |
|        basket       | 22.87 | 28.75 |
|      waterfall      | 40.18 | 47.24 |
|         tent        |  60.8 | 99.42 |
|         bag         |  5.82 |  6.84 |
|       minibike      | 48.49 | 52.85 |
|        cradle       |  67.8 |  96.3 |
|         oven        | 27.39 |  32.7 |
|         ball        |  36.9 | 49.77 |
|         food        |  26.7 | 29.73 |
|         step        |  2.02 |  2.13 |
|         tank        | 30.15 | 30.72 |
|      trade name     | 17.64 | 18.93 |
|      microwave      | 33.94 | 36.48 |
|         pot         | 31.15 | 33.84 |
|        animal       | 37.65 |  38.7 |
|       bicycle       | 40.75 | 63.49 |
|         lake        | 39.86 | 63.63 |
|      dishwasher     | 50.62 | 55.23 |
|        screen       | 53.14 | 64.95 |
|       blanket       |  3.46 |  3.81 |
|      sculpture      | 34.56 | 39.69 |
|         hood        | 51.53 | 55.99 |
|        sconce       | 30.95 | 35.94 |
|         vase        | 25.51 | 38.29 |
|    traffic light    | 20.49 | 26.01 |
|         tray        |  4.51 |  5.6  |
|        ashcan       | 32.99 | 37.64 |
|         fan         | 53.92 | 66.26 |
|         pier        | 23.26 | 25.95 |
|      crt screen     |  0.0  |  0.0  |
|        plate        | 38.29 | 50.93 |
|       monitor       | 24.83 | 28.32 |
|    bulletin board   | 30.08 | 40.05 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 34.02 | 41.94 |
|        glass        | 13.24 | 16.47 |
|        clock        | 22.91 | 25.56 |
|         flag        | 21.51 | 22.83 |
+---------------------+-------+-------+
09/16 02:58:47 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.5500  mIoU: 38.1900  mAcc: 47.4900  data_time: 0.0025  time: 0.3300
Finished processing corruption type: contrast
Processing corruption type: elastic_transform
09/16 02:59:17 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1764018520
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1764018520
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 02:59:18 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/elastic_transform'

09/16 02:59:37 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 02:59:37 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 02:59:39 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 02:59:39 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 03:02:25 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:48:00  time: 1.9947  data_time: 0.0022  memory: 17171  
09/16 03:04:04 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:23:52  time: 2.1734  data_time: 0.0028  memory: 16951  
09/16 03:05:20 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:09:59  time: 1.6065  data_time: 0.0030  memory: 16944  
09/16 03:06:49 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 1:04:28  time: 1.6599  data_time: 0.0027  memory: 16953  
09/16 03:08:11 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:59:45  time: 1.4496  data_time: 0.0023  memory: 16951  
09/16 03:09:26 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:55:22  time: 1.1267  data_time: 0.0023  memory: 16947  
09/16 03:10:50 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:52:43  time: 1.3973  data_time: 0.0023  memory: 16951  
09/16 03:12:05 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:49:43  time: 1.5609  data_time: 0.0024  memory: 16950  
09/16 03:12:58 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:45:53  time: 1.1096  data_time: 0.0019  memory: 16873  
09/16 03:14:00 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:43:01  time: 1.0583  data_time: 0.0018  memory: 16932  
09/16 03:15:07 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:40:45  time: 1.6179  data_time: 0.0024  memory: 16951  
09/16 03:16:04 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:38:18  time: 1.2942  data_time: 0.0022  memory: 16879  
09/16 03:17:12 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:36:27  time: 1.5305  data_time: 0.0018  memory: 16953  
09/16 03:18:26 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:34:52  time: 1.1422  data_time: 0.0021  memory: 16954  
09/16 03:19:40 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:33:20  time: 2.0176  data_time: 0.0037  memory: 16956  
09/16 03:20:35 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:31:23  time: 0.9971  data_time: 0.0018  memory: 16944  
09/16 03:21:28 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:29:30  time: 1.1246  data_time: 0.0021  memory: 647  
09/16 03:22:22 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:27:45  time: 1.0744  data_time: 0.0019  memory: 16869  
09/16 03:23:33 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:26:24  time: 1.2890  data_time: 0.0036  memory: 16951  
09/16 03:24:33 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:24:53  time: 1.0562  data_time: 0.0021  memory: 16927  
09/16 03:25:41 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:23:33  time: 1.6978  data_time: 0.0024  memory: 16954  
09/16 03:26:44 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:22:09  time: 1.0937  data_time: 0.0036  memory: 16941  
09/16 03:27:42 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:20:43  time: 1.2101  data_time: 0.0021  memory: 16934  
09/16 03:28:38 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:19:18  time: 1.0749  data_time: 0.0025  memory: 1844  
09/16 03:29:35 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:17:57  time: 1.1604  data_time: 0.0020  memory: 16944  
09/16 03:30:27 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:16:34  time: 1.0951  data_time: 0.0019  memory: 1483  
09/16 03:31:24 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:15:17  time: 0.9951  data_time: 0.0019  memory: 16929  
09/16 03:32:35 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:14:06  time: 1.5790  data_time: 0.0018  memory: 16948  
09/16 03:33:32 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:12:50  time: 1.5057  data_time: 0.0019  memory: 16936  
09/16 03:34:24 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:11:34  time: 0.9839  data_time: 0.0019  memory: 647  
09/16 03:35:22 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:10:22  time: 1.1037  data_time: 0.0020  memory: 16878  
09/16 03:36:14 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:09:08  time: 1.0623  data_time: 0.0021  memory: 1527  
09/16 03:37:15 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:58  time: 1.0009  data_time: 0.0019  memory: 16951  
09/16 03:38:17 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:49  time: 1.1083  data_time: 0.0036  memory: 16942  
09/16 03:39:18 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:05:39  time: 1.0732  data_time: 0.0019  memory: 16932  
09/16 03:40:13 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:04:30  time: 1.0879  data_time: 0.0020  memory: 16931  
09/16 03:41:08 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:03:21  time: 1.0976  data_time: 0.0033  memory: 597  
09/16 03:42:03 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:02:13  time: 1.0513  data_time: 0.0032  memory: 16954  
09/16 03:43:02 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:06  time: 1.0487  data_time: 0.0019  memory: 16935  
09/16 03:43:58 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.9728  data_time: 0.0034  memory: 16883  
09/16 03:43:58 - mmengine - INFO - per class results:
09/16 03:43:58 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 61.09 | 78.75 |
|       building      | 71.34 | 88.45 |
|         sky         | 83.95 | 90.75 |
|        floor        | 66.84 | 82.76 |
|         tree        | 61.79 | 78.89 |
|       ceiling       |  67.1 | 80.71 |
|         road        | 73.34 | 85.25 |
|         bed         | 74.78 | 87.18 |
|      windowpane     | 46.42 | 64.62 |
|        grass        | 58.19 | 78.04 |
|       cabinet       | 46.51 | 62.24 |
|       sidewalk      | 51.87 | 68.16 |
|        person       | 58.62 | 77.47 |
|        earth        | 29.76 | 42.27 |
|         door        | 30.06 | 39.71 |
|        table        | 42.09 | 61.84 |
|       mountain      | 46.03 | 61.98 |
|        plant        | 39.16 | 53.83 |
|       curtain       |  50.4 | 68.31 |
|        chair        | 37.92 |  54.9 |
|         car         | 60.38 | 74.65 |
|        water        | 41.56 | 55.64 |
|       painting      | 45.27 |  65.6 |
|         sofa        | 49.44 | 70.11 |
|        shelf        | 32.24 | 52.01 |
|        house        | 29.15 | 34.88 |
|         sea         | 39.84 | 65.91 |
|        mirror       | 45.75 | 55.35 |
|         rug         | 40.52 | 47.55 |
|        field        | 21.71 | 29.88 |
|       armchair      | 31.32 | 45.56 |
|         seat        | 52.84 | 69.99 |
|        fence        | 24.85 | 34.57 |
|         desk        |  38.0 | 53.29 |
|         rock        | 26.67 |  41.8 |
|       wardrobe      | 36.34 |  51.6 |
|         lamp        | 28.14 |  44.7 |
|       bathtub       | 62.07 | 71.82 |
|       railing       | 23.68 | 34.41 |
|       cushion       | 37.42 | 52.34 |
|         base        | 12.66 | 15.34 |
|         box         | 15.04 | 20.72 |
|        column       | 23.86 | 33.09 |
|      signboard      | 18.73 | 29.86 |
|   chest of drawers  | 32.52 | 46.26 |
|       counter       | 21.18 | 24.64 |
|         sand        | 30.58 | 42.55 |
|         sink        | 43.01 | 58.46 |
|      skyscraper     | 43.15 | 52.77 |
|      fireplace      | 52.87 | 72.15 |
|     refrigerator    | 48.26 | 60.04 |
|      grandstand     | 38.35 | 59.23 |
|         path        | 11.91 | 16.81 |
|        stairs       | 30.02 | 34.79 |
|        runway       | 60.85 | 79.66 |
|         case        |  41.9 |  65.2 |
|      pool table     | 75.34 | 84.42 |
|        pillow       | 37.51 | 49.62 |
|     screen door     | 51.71 | 66.85 |
|       stairway      | 23.86 | 29.16 |
|        river        | 10.91 | 18.65 |
|        bridge       | 52.17 | 61.85 |
|       bookcase      | 29.14 | 45.63 |
|        blind        | 30.41 | 33.65 |
|     coffee table    | 45.16 | 65.43 |
|        toilet       | 54.16 | 70.97 |
|        flower       | 24.07 | 41.08 |
|         book        | 28.36 | 45.31 |
|         hill        |  3.57 |  5.58 |
|        bench        | 28.06 | 35.45 |
|      countertop     | 35.35 | 51.88 |
|        stove        | 54.53 | 69.09 |
|         palm        | 35.49 | 49.98 |
|    kitchen island   | 35.08 | 57.36 |
|       computer      | 42.52 | 54.48 |
|     swivel chair    | 29.14 |  40.1 |
|         boat        | 32.53 | 42.11 |
|         bar         | 14.42 | 17.64 |
|    arcade machine   | 29.05 | 30.84 |
|        hovel        | 29.66 | 32.18 |
|         bus         | 63.84 | 83.26 |
|        towel        |  32.5 | 45.45 |
|        light        | 14.19 | 22.08 |
|        truck        | 14.32 | 19.46 |
|        tower        | 21.21 | 28.33 |
|      chandelier     | 37.93 | 54.13 |
|        awning       | 10.64 | 12.52 |
|     streetlight     |  6.05 |  8.94 |
|        booth        | 29.42 | 29.66 |
| television receiver | 40.85 | 54.82 |
|       airplane      | 35.21 | 53.31 |
|      dirt track     |  5.58 | 13.12 |
|       apparel       |  22.1 | 34.48 |
|         pole        |  6.67 | 10.13 |
|         land        |  0.38 |  0.46 |
|      bannister      |  1.03 |  1.36 |
|      escalator      |  4.54 |  4.7  |
|       ottoman       | 27.76 | 38.37 |
|        bottle       |  7.81 | 15.13 |
|        buffet       | 31.31 | 36.27 |
|        poster       | 16.78 | 20.48 |
|        stage        |  7.84 | 10.26 |
|         van         | 34.25 | 41.09 |
|         ship        | 76.51 |  77.7 |
|       fountain      |  7.8  |  8.41 |
|    conveyer belt    | 49.88 | 58.21 |
|        canopy       |  3.79 |  4.03 |
|        washer       | 62.99 | 68.18 |
|      plaything      | 11.88 |  18.6 |
|    swimming pool    | 25.56 | 31.65 |
|        stool        | 17.86 | 24.52 |
|        barrel       | 45.28 | 58.91 |
|        basket       | 17.35 | 23.28 |
|      waterfall      | 50.95 | 71.22 |
|         tent        | 80.39 | 89.53 |
|         bag         |  6.66 |  7.53 |
|       minibike      | 36.56 | 47.89 |
|        cradle       | 63.35 | 87.94 |
|         oven        | 14.97 | 33.27 |
|         ball        | 41.13 | 60.85 |
|         food        | 43.56 | 57.04 |
|         step        |  0.68 |  0.74 |
|         tank        | 30.94 | 35.66 |
|      trade name     | 15.17 | 17.34 |
|      microwave      |  26.4 | 30.02 |
|         pot         | 19.66 | 25.75 |
|        animal       | 38.89 | 43.07 |
|       bicycle       | 31.16 | 51.27 |
|         lake        | 37.98 | 63.27 |
|      dishwasher     |  40.0 | 44.76 |
|        screen       | 45.36 | 56.87 |
|       blanket       |  2.48 |  2.78 |
|      sculpture      | 22.69 |  29.0 |
|         hood        | 39.65 |  48.8 |
|        sconce       | 19.35 | 27.15 |
|         vase        | 12.52 | 24.73 |
|    traffic light    | 11.97 | 18.67 |
|         tray        |  4.14 |  6.44 |
|        ashcan       | 21.31 | 33.15 |
|         fan         | 23.26 |  32.6 |
|         pier        | 20.49 | 25.84 |
|      crt screen     |  0.4  |  0.91 |
|        plate        | 30.45 | 44.63 |
|       monitor       | 29.97 | 37.93 |
|    bulletin board   | 25.93 | 33.63 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 28.77 | 34.31 |
|        glass        |  6.85 |  8.19 |
|        clock        | 11.01 | 14.93 |
|         flag        | 20.63 | 24.46 |
+---------------------+-------+-------+
09/16 03:43:58 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 72.5300  mIoU: 33.1200  mAcc: 43.6800  data_time: 0.0028  time: 1.3292
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
09/16 03:44:51 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 844405807
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 844405807
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 03:44:51 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/pixelate'

09/16 03:45:19 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 03:45:19 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 03:45:20 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 03:45:20 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 03:47:24 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:20:21  time: 0.8509  data_time: 0.0020  memory: 17171  
09/16 03:48:10 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:53:45  time: 1.0607  data_time: 0.0021  memory: 16951  
09/16 03:48:33 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:39:36  time: 0.4866  data_time: 0.0020  memory: 16944  
09/16 03:49:08 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:34:12  time: 0.6152  data_time: 0.0022  memory: 16953  
09/16 03:49:40 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:30:14  time: 0.4199  data_time: 0.0041  memory: 16951  
09/16 03:50:04 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:26:48  time: 0.0727  data_time: 0.0021  memory: 16947  
09/16 03:50:37 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:24:52  time: 0.4083  data_time: 0.0019  memory: 16951  
09/16 03:51:00 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:22:40  time: 0.4804  data_time: 0.0017  memory: 16950  
09/16 03:51:08 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:19:56  time: 0.1731  data_time: 0.0019  memory: 16873  
09/16 03:51:18 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:17:51  time: 0.0625  data_time: 0.0019  memory: 16932  
09/16 03:51:29 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:16:12  time: 0.4957  data_time: 0.0021  memory: 16951  
09/16 03:51:36 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:35  time: 0.2293  data_time: 0.0020  memory: 16879  
09/16 03:51:53 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:34  time: 0.4775  data_time: 0.0019  memory: 16953  
09/16 03:52:12 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:45  time: 0.0700  data_time: 0.0021  memory: 16954  
09/16 03:52:33 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:00  time: 1.0458  data_time: 0.0040  memory: 16956  
09/16 03:52:40 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:59  time: 0.0567  data_time: 0.0020  memory: 16944  
09/16 03:52:43 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:58  time: 0.0568  data_time: 0.0019  memory: 647  
09/16 03:52:49 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:08  time: 0.1605  data_time: 0.0018  memory: 16869  
09/16 03:53:07 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:36  time: 0.2717  data_time: 0.0019  memory: 16951  
09/16 03:53:17 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:56  time: 0.0559  data_time: 0.0020  memory: 16927  
09/16 03:53:32 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:24  time: 0.5945  data_time: 0.0020  memory: 16954  
09/16 03:53:43 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:51  time: 0.0607  data_time: 0.0019  memory: 16941  
09/16 03:53:50 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:16  time: 0.1640  data_time: 0.0020  memory: 16934  
09/16 03:53:53 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:41  time: 0.0579  data_time: 0.0020  memory: 1844  
09/16 03:54:02 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:12  time: 0.1703  data_time: 0.0018  memory: 16944  
09/16 03:54:04 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:42  time: 0.0565  data_time: 0.0019  memory: 1483  
09/16 03:54:11 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:15  time: 0.0571  data_time: 0.0018  memory: 16929  
09/16 03:54:30 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:55  time: 0.4796  data_time: 0.0019  memory: 16948  
09/16 03:54:37 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:31  time: 0.4144  data_time: 0.0035  memory: 16936  
09/16 03:54:40 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:06  time: 0.0539  data_time: 0.0018  memory: 647  
09/16 03:54:45 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:43  time: 0.0596  data_time: 0.0018  memory: 16878  
09/16 03:54:48 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:21  time: 0.0555  data_time: 0.0020  memory: 1527  
09/16 03:54:58 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:02  time: 0.0524  data_time: 0.0018  memory: 16951  
09/16 03:55:08 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:43  time: 0.0597  data_time: 0.0020  memory: 16942  
09/16 03:55:16 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:25  time: 0.0629  data_time: 0.0019  memory: 16932  
09/16 03:55:22 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:06  time: 0.0587  data_time: 0.0020  memory: 16931  
09/16 03:55:25 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:49  time: 0.0592  data_time: 0.0020  memory: 597  
09/16 03:55:32 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:32  time: 0.0656  data_time: 0.0018  memory: 16954  
09/16 03:55:40 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:15  time: 0.0540  data_time: 0.0018  memory: 16935  
09/16 03:55:47 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0549  data_time: 0.0016  memory: 16883  
09/16 03:55:48 - mmengine - INFO - per class results:
09/16 03:55:48 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.72 | 87.73 |
|       building      | 79.03 | 93.29 |
|         sky         | 93.47 | 96.81 |
|        floor        | 77.85 | 90.28 |
|         tree        | 71.25 |  85.7 |
|       ceiling       | 80.06 | 89.03 |
|         road        | 81.05 | 90.37 |
|         bed         | 85.65 | 94.29 |
|      windowpane     | 57.76 | 74.34 |
|        grass        | 64.69 | 82.95 |
|       cabinet       | 56.51 |  71.4 |
|       sidewalk      | 64.91 | 78.76 |
|        person       | 74.95 | 87.68 |
|        earth        | 33.25 | 46.74 |
|         door        | 37.61 | 48.75 |
|        table        | 55.67 | 73.97 |
|       mountain      | 50.89 | 67.24 |
|        plant        | 47.31 | 59.41 |
|       curtain       | 66.49 | 80.01 |
|        chair        | 52.36 | 66.98 |
|         car         | 80.36 | 87.86 |
|        water        | 45.19 | 61.92 |
|       painting      | 66.91 | 82.69 |
|         sofa        | 59.59 | 81.61 |
|        shelf        |  41.5 | 62.31 |
|        house        | 42.26 | 47.57 |
|         sea         | 44.75 | 71.39 |
|        mirror       | 56.03 | 63.84 |
|         rug         | 51.79 |  57.3 |
|        field        | 24.57 | 31.16 |
|       armchair      | 35.78 | 46.34 |
|         seat        | 56.48 | 73.96 |
|        fence        | 32.34 | 41.48 |
|         desk        | 45.39 | 60.79 |
|         rock        | 26.68 | 39.82 |
|       wardrobe      | 40.44 | 56.66 |
|         lamp        | 57.49 | 71.33 |
|       bathtub       | 71.02 |  77.6 |
|       railing       | 31.96 | 43.91 |
|       cushion       | 50.76 | 63.72 |
|         base        | 16.18 | 18.81 |
|         box         | 20.07 | 26.57 |
|        column       | 36.96 | 45.44 |
|      signboard      | 30.55 | 41.92 |
|   chest of drawers  | 37.96 | 52.14 |
|       counter       | 25.75 | 31.27 |
|         sand        | 30.95 | 45.59 |
|         sink        | 64.32 | 77.57 |
|      skyscraper     | 47.44 | 54.68 |
|      fireplace      | 63.91 |  80.0 |
|     refrigerator    | 61.38 | 75.78 |
|      grandstand     | 39.87 | 62.87 |
|         path        | 16.45 |  23.5 |
|        stairs       | 32.17 | 38.55 |
|        runway       | 63.01 |  83.2 |
|         case        | 51.55 | 74.38 |
|      pool table     | 91.21 | 94.63 |
|        pillow       |  50.4 | 61.55 |
|     screen door     | 57.46 | 74.09 |
|       stairway      | 29.21 | 35.11 |
|        river        | 15.35 | 23.04 |
|        bridge       |  64.4 | 73.33 |
|       bookcase      | 38.66 | 51.51 |
|        blind        | 40.93 | 44.91 |
|     coffee table    | 61.53 | 77.27 |
|        toilet       | 82.63 | 90.45 |
|        flower       | 33.89 | 47.73 |
|         book        | 43.04 |  64.2 |
|         hill        |  4.3  |  6.57 |
|        bench        |  38.2 | 45.21 |
|      countertop     |  50.5 | 67.49 |
|        stove        | 70.98 | 80.15 |
|         palm        | 44.11 | 54.04 |
|    kitchen island   | 39.98 | 69.05 |
|       computer      | 52.12 | 63.24 |
|     swivel chair    | 43.12 | 55.56 |
|         boat        | 35.82 | 41.27 |
|         bar         | 14.18 | 17.64 |
|    arcade machine   | 32.08 | 33.46 |
|        hovel        | 36.92 | 38.82 |
|         bus         | 76.72 | 93.73 |
|        towel        | 50.74 | 58.11 |
|        light        | 50.13 | 57.98 |
|        truck        | 15.24 | 21.13 |
|        tower        | 29.47 | 36.78 |
|      chandelier     | 60.94 | 77.11 |
|        awning       | 21.47 | 22.96 |
|     streetlight     | 19.31 | 24.82 |
|        booth        | 32.81 |  33.3 |
| television receiver | 58.97 | 71.66 |
|       airplane      | 47.61 | 61.18 |
|      dirt track     | 11.23 | 19.97 |
|       apparel       | 30.58 | 45.55 |
|         pole        | 17.26 | 24.98 |
|         land        |  1.0  |  1.18 |
|      bannister      |  3.56 |  4.47 |
|      escalator      | 14.15 | 14.85 |
|       ottoman       | 32.44 | 41.77 |
|        bottle       |  13.3 | 25.62 |
|        buffet       | 38.92 | 50.14 |
|        poster       | 21.53 | 25.01 |
|        stage        |  8.24 | 11.18 |
|         van         | 40.65 | 53.89 |
|         ship        | 70.25 | 71.21 |
|       fountain      |  5.47 |  5.81 |
|    conveyer belt    | 51.38 | 66.14 |
|        canopy       |  4.3  |  4.44 |
|        washer       | 66.84 | 69.53 |
|      plaything      | 16.28 | 20.99 |
|    swimming pool    | 37.82 | 47.21 |
|        stool        | 33.81 | 41.07 |
|        barrel       |  29.3 | 64.94 |
|        basket       | 25.59 | 30.51 |
|      waterfall      | 51.44 |  66.0 |
|         tent        | 90.11 | 98.22 |
|         bag         |  7.83 |  8.62 |
|       minibike      | 38.26 | 41.36 |
|        cradle       | 71.01 |  95.7 |
|         oven        | 23.02 | 50.37 |
|         ball        | 45.46 | 59.23 |
|         food        | 45.86 | 52.86 |
|         step        |  2.31 |  2.55 |
|         tank        | 31.28 | 38.43 |
|      trade name     | 22.51 | 25.59 |
|      microwave      | 35.73 | 38.93 |
|         pot         | 36.47 | 41.24 |
|        animal       | 44.58 | 46.19 |
|       bicycle       | 39.74 | 59.04 |
|         lake        | 42.94 | 63.61 |
|      dishwasher     | 48.92 | 53.52 |
|        screen       |  61.0 | 73.88 |
|       blanket       |  2.53 |  2.6  |
|      sculpture      | 29.65 | 36.16 |
|         hood        | 54.36 | 59.73 |
|        sconce       | 33.63 | 40.04 |
|         vase        | 27.85 | 42.11 |
|    traffic light    |  24.5 |  32.8 |
|         tray        |  5.58 |  7.68 |
|        ashcan       | 40.83 | 52.93 |
|         fan         | 53.52 | 63.37 |
|         pier        | 23.94 | 27.41 |
|      crt screen     |  0.31 |  0.74 |
|        plate        | 39.59 | 51.01 |
|       monitor       | 30.51 | 36.69 |
|    bulletin board   | 32.75 | 40.43 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 33.79 | 39.05 |
|        glass        | 11.44 |  12.5 |
|        clock        | 24.64 | 29.11 |
|         flag        | 28.52 | 30.38 |
+---------------------+-------+-------+
09/16 03:55:48 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.1700  mIoU: 41.6500  mAcc: 51.6700  data_time: 0.0025  time: 0.3134
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
09/16 03:56:49 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1900418449
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1900418449
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 03:56:50 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/jpeg_compression'

09/16 03:57:12 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 03:57:12 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 03:57:13 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 03:57:14 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 03:59:05 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:12:14  time: 0.8515  data_time: 0.0019  memory: 17171  
09/16 03:59:52 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:49:53  time: 1.0643  data_time: 0.0020  memory: 16951  
09/16 04:00:15 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:37:08  time: 0.4937  data_time: 0.0019  memory: 16944  
09/16 04:00:50 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:32:25  time: 0.6195  data_time: 0.0019  memory: 16953  
09/16 04:01:22 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:28:53  time: 0.4288  data_time: 0.0024  memory: 16951  
09/16 04:01:47 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:25:44  time: 0.0775  data_time: 0.0019  memory: 16947  
09/16 04:02:20 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:23:59  time: 0.4151  data_time: 0.0036  memory: 16951  
09/16 04:02:43 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:56  time: 0.4880  data_time: 0.0017  memory: 16950  
09/16 04:02:51 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:19:19  time: 0.1806  data_time: 0.0019  memory: 16873  
09/16 04:03:01 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:17:20  time: 0.0684  data_time: 0.0017  memory: 16932  
09/16 04:03:13 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:15:46  time: 0.5075  data_time: 0.0020  memory: 16951  
09/16 04:03:20 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:14:13  time: 0.2366  data_time: 0.0020  memory: 16879  
09/16 04:03:38 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:13:15  time: 0.4984  data_time: 0.0017  memory: 16953  
09/16 04:03:58 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:29  time: 0.0775  data_time: 0.0020  memory: 16954  
09/16 04:04:19 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:46  time: 1.0444  data_time: 0.0027  memory: 16956  
09/16 04:04:26 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:47  time: 0.0677  data_time: 0.0024  memory: 16944  
09/16 04:04:29 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:48  time: 0.0653  data_time: 0.0019  memory: 647  
09/16 04:04:36 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:59  time: 0.1666  data_time: 0.0025  memory: 16869  
09/16 04:04:54 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:28  time: 0.2779  data_time: 0.0020  memory: 16951  
09/16 04:05:05 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:50  time: 0.0635  data_time: 0.0019  memory: 16927  
09/16 04:05:19 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:18  time: 0.6011  data_time: 0.0018  memory: 16954  
09/16 04:05:31 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:46  time: 0.0662  data_time: 0.0020  memory: 16941  
09/16 04:05:38 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:12  time: 0.1732  data_time: 0.0019  memory: 16934  
09/16 04:05:42 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:38  time: 0.0644  data_time: 0.0018  memory: 1844  
09/16 04:05:51 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:09  time: 0.1785  data_time: 0.0018  memory: 16944  
09/16 04:05:54 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:39  time: 0.0652  data_time: 0.0019  memory: 1483  
09/16 04:06:01 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:13  time: 0.0644  data_time: 0.0019  memory: 16929  
09/16 04:06:20 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:53  time: 0.4915  data_time: 0.0019  memory: 16948  
09/16 04:06:28 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:29  time: 0.4172  data_time: 0.0018  memory: 16936  
09/16 04:06:31 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:05  time: 0.0615  data_time: 0.0017  memory: 647  
09/16 04:06:36 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:43  time: 0.0690  data_time: 0.0031  memory: 16878  
09/16 04:06:39 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:21  time: 0.0625  data_time: 0.0019  memory: 1527  
09/16 04:06:50 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:02  time: 0.0583  data_time: 0.0018  memory: 16951  
09/16 04:07:00 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:43  time: 0.0638  data_time: 0.0020  memory: 16942  
09/16 04:07:08 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:24  time: 0.0677  data_time: 0.0018  memory: 16932  
09/16 04:07:15 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:06  time: 0.0659  data_time: 0.0021  memory: 16931  
09/16 04:07:18 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:48  time: 0.0658  data_time: 0.0019  memory: 597  
09/16 04:07:26 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:32  time: 0.0739  data_time: 0.0035  memory: 16954  
09/16 04:07:34 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:15  time: 0.0611  data_time: 0.0018  memory: 16935  
09/16 04:07:41 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0604  data_time: 0.0016  memory: 16883  
09/16 04:07:42 - mmengine - INFO - per class results:
09/16 04:07:42 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 71.24 | 88.37 |
|       building      |  78.5 | 91.91 |
|         sky         | 93.03 | 96.74 |
|        floor        | 75.37 |  90.6 |
|         tree        | 71.48 | 85.42 |
|       ceiling       | 77.89 | 86.77 |
|         road        | 80.03 | 90.14 |
|         bed         | 84.43 | 93.39 |
|      windowpane     | 56.43 | 73.08 |
|        grass        | 63.69 | 79.91 |
|       cabinet       | 53.57 | 68.34 |
|       sidewalk      | 61.25 | 74.65 |
|        person       | 74.38 | 87.75 |
|        earth        | 31.47 |  46.6 |
|         door        | 35.67 | 46.48 |
|        table        | 53.65 | 69.71 |
|       mountain      |  51.3 | 70.03 |
|        plant        |  46.9 | 58.15 |
|       curtain       | 64.27 | 75.29 |
|        chair        | 51.15 | 63.32 |
|         car         |  80.7 | 88.94 |
|        water        | 45.35 |  62.1 |
|       painting      |  67.5 | 80.61 |
|         sofa        |  61.0 |  81.5 |
|        shelf        | 39.08 | 58.86 |
|        house        |  43.4 | 48.87 |
|         sea         | 40.99 | 65.43 |
|        mirror       | 51.69 | 58.62 |
|         rug         |  41.8 | 45.09 |
|        field        | 31.11 | 41.25 |
|       armchair      | 36.97 | 47.26 |
|         seat        |  57.4 | 76.89 |
|        fence        | 32.71 | 43.19 |
|         desk        | 45.13 |  61.0 |
|         rock        | 26.87 | 40.14 |
|       wardrobe      | 39.62 | 59.16 |
|         lamp        | 57.95 | 70.25 |
|       bathtub       | 65.97 | 72.22 |
|       railing       |  29.8 | 39.25 |
|       cushion       | 48.14 | 62.52 |
|         base        |  9.64 | 11.47 |
|         box         | 17.84 | 23.16 |
|        column       | 35.33 | 43.54 |
|      signboard      | 30.32 | 41.28 |
|   chest of drawers  | 36.79 | 51.88 |
|       counter       | 19.28 | 23.19 |
|         sand        | 20.43 | 30.65 |
|         sink        | 64.82 |  76.6 |
|      skyscraper     | 46.34 | 58.67 |
|      fireplace      | 63.66 | 75.99 |
|     refrigerator    | 61.28 | 77.05 |
|      grandstand     | 43.21 | 63.39 |
|         path        | 16.95 | 24.15 |
|        stairs       | 29.55 | 34.21 |
|        runway       | 65.31 | 84.54 |
|         case        | 51.84 | 70.59 |
|      pool table     | 89.58 |  94.5 |
|        pillow       |  46.9 |  55.8 |
|     screen door     | 52.73 | 63.17 |
|       stairway      | 31.21 | 38.04 |
|        river        |  7.73 | 12.09 |
|        bridge       | 47.45 | 52.76 |
|       bookcase      | 37.88 | 49.37 |
|        blind        | 35.98 | 37.86 |
|     coffee table    | 61.51 | 76.11 |
|        toilet       | 80.97 | 88.11 |
|        flower       | 33.41 | 48.41 |
|         book        | 42.55 | 61.21 |
|         hill        |  4.21 |  6.59 |
|        bench        |  39.3 | 46.08 |
|      countertop     | 48.77 |  63.3 |
|        stove        | 69.32 | 82.11 |
|         palm        | 46.28 | 59.73 |
|    kitchen island   |  42.5 | 70.75 |
|       computer      | 51.44 | 61.88 |
|     swivel chair    | 42.39 | 51.37 |
|         boat        | 33.18 | 40.97 |
|         bar         | 13.98 | 17.42 |
|    arcade machine   | 39.76 | 42.21 |
|        hovel        | 35.83 | 40.78 |
|         bus         | 76.53 | 91.35 |
|        towel        |  46.1 | 50.65 |
|        light        | 47.16 | 53.26 |
|        truck        | 14.47 | 18.55 |
|        tower        | 31.81 | 39.42 |
|      chandelier     | 64.91 | 78.78 |
|        awning       |  19.1 | 20.15 |
|     streetlight     | 18.14 | 21.91 |
|        booth        | 31.38 | 32.45 |
| television receiver | 56.54 | 70.08 |
|       airplane      |  50.0 |  63.1 |
|      dirt track     |  6.28 | 12.65 |
|       apparel       | 29.57 | 45.22 |
|         pole        | 14.07 | 20.19 |
|         land        |  0.82 |  1.05 |
|      bannister      |  3.2  |  4.02 |
|      escalator      | 14.32 | 14.74 |
|       ottoman       | 32.42 | 40.09 |
|        bottle       | 11.97 | 21.25 |
|        buffet       |  33.6 | 39.09 |
|        poster       | 24.03 | 27.64 |
|        stage        |  9.92 | 12.04 |
|         van         | 35.43 | 45.61 |
|         ship        | 62.46 | 66.79 |
|       fountain      |  7.52 |  7.62 |
|    conveyer belt    | 44.36 | 63.41 |
|        canopy       |  1.4  |  1.5  |
|        washer       | 65.58 | 71.52 |
|      plaything      |  20.6 |  24.6 |
|    swimming pool    | 26.85 | 31.84 |
|        stool        | 29.49 | 36.95 |
|        barrel       | 23.67 | 50.78 |
|        basket       | 24.41 | 29.45 |
|      waterfall      | 53.68 | 66.56 |
|         tent        | 80.49 | 99.06 |
|         bag         |  6.28 |  6.98 |
|       minibike      | 49.19 | 55.37 |
|        cradle       | 71.37 | 95.78 |
|         oven        | 15.72 | 35.96 |
|         ball        | 44.48 | 55.75 |
|         food        | 42.22 | 52.22 |
|         step        |  1.81 |  2.04 |
|         tank        | 31.99 | 43.08 |
|      trade name     | 22.27 | 25.32 |
|      microwave      | 35.08 | 38.51 |
|         pot         | 34.96 | 38.56 |
|        animal       | 43.49 | 46.98 |
|       bicycle       | 41.93 | 63.44 |
|         lake        |  39.9 |  63.3 |
|      dishwasher     | 50.25 | 56.08 |
|        screen       | 53.03 | 61.91 |
|       blanket       |  3.27 |  3.37 |
|      sculpture      | 31.52 |  42.2 |
|         hood        | 51.64 | 57.58 |
|        sconce       | 27.88 | 32.05 |
|         vase        | 23.94 | 37.45 |
|    traffic light    | 22.75 | 28.65 |
|         tray        |  5.08 |  7.34 |
|        ashcan       | 37.67 | 47.54 |
|         fan         |  52.2 | 62.43 |
|         pier        | 29.07 | 33.36 |
|      crt screen     |  0.21 |  0.44 |
|        plate        | 40.91 | 52.09 |
|       monitor       | 34.99 | 39.84 |
|    bulletin board   | 33.88 | 38.45 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 29.78 | 33.62 |
|        glass        | 10.23 |  11.0 |
|        clock        | 21.11 | 24.87 |
|         flag        | 27.97 | 30.21 |
+---------------------+-------+-------+
09/16 04:07:42 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.2700  mIoU: 40.3100  mAcc: 49.9200  data_time: 0.0023  time: 0.3135
Finished processing corruption type: jpeg_compression
Processing corruption type: elastic_transform
09/16 04:08:32 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1149841934
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1149841934
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 04:08:32 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/elastic_transform'

09/16 04:08:59 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 04:08:59 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 04:09:00 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 04:09:01 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 04:11:41 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:43:55  time: 2.0004  data_time: 0.0029  memory: 17171  
09/16 04:13:19 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:21:49  time: 2.1505  data_time: 0.0019  memory: 16951  
09/16 04:14:35 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:08:39  time: 1.5860  data_time: 0.0031  memory: 16944  
09/16 04:16:04 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 1:03:27  time: 1.6467  data_time: 0.0027  memory: 16953  
09/16 04:17:26 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:58:56  time: 1.4497  data_time: 0.0029  memory: 16951  
09/16 04:18:39 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:54:33  time: 1.0617  data_time: 0.0020  memory: 16947  
09/16 04:20:00 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:51:47  time: 1.3159  data_time: 0.0019  memory: 16951  
09/16 04:21:12 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:48:42  time: 1.4993  data_time: 0.0018  memory: 16950  
09/16 04:22:02 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:44:50  time: 1.0568  data_time: 0.0018  memory: 16873  
09/16 04:23:00 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:41:57  time: 0.9966  data_time: 0.0018  memory: 16932  
09/16 04:24:03 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:39:38  time: 1.5247  data_time: 0.0021  memory: 16951  
09/16 04:24:57 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:37:10  time: 1.2302  data_time: 0.0021  memory: 16879  
09/16 04:26:02 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:35:20  time: 1.4807  data_time: 0.0017  memory: 16953  
09/16 04:27:12 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:33:46  time: 1.0649  data_time: 0.0020  memory: 16954  
09/16 04:28:23 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:32:17  time: 2.0189  data_time: 0.0021  memory: 16956  
09/16 04:29:19 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:30:27  time: 1.1112  data_time: 0.0021  memory: 16944  
09/16 04:30:15 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:28:43  time: 1.1121  data_time: 0.0022  memory: 647  
09/16 04:31:09 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:27:02  time: 1.0754  data_time: 0.0025  memory: 16869  
09/16 04:32:19 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:25:45  time: 1.2709  data_time: 0.0027  memory: 16951  
09/16 04:33:18 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:24:17  time: 1.0415  data_time: 0.0019  memory: 16927  
09/16 04:34:26 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:22:59  time: 1.6977  data_time: 0.0021  memory: 16954  
09/16 04:35:28 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:21:38  time: 1.0767  data_time: 0.0020  memory: 16941  
09/16 04:36:26 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:20:16  time: 1.1900  data_time: 0.0018  memory: 16934  
09/16 04:37:21 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:18:53  time: 1.0504  data_time: 0.0020  memory: 1844  
09/16 04:38:19 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:17:34  time: 1.1595  data_time: 0.0032  memory: 16944  
09/16 04:39:10 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:16:14  time: 1.0868  data_time: 0.0019  memory: 1483  
09/16 04:40:08 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:14:58  time: 1.0265  data_time: 0.0024  memory: 16929  
09/16 04:41:18 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:13:50  time: 1.5690  data_time: 0.0023  memory: 16948  
09/16 04:42:14 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:12:36  time: 1.5016  data_time: 0.0019  memory: 16936  
09/16 04:43:07 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:11:21  time: 0.9915  data_time: 0.0027  memory: 647  
09/16 04:44:05 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:10:10  time: 1.1133  data_time: 0.0021  memory: 16878  
09/16 04:44:57 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:08:59  time: 1.0582  data_time: 0.0021  memory: 1527  
09/16 04:45:58 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:50  time: 0.9914  data_time: 0.0024  memory: 16951  
09/16 04:46:59 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:41  time: 1.0973  data_time: 0.0031  memory: 16942  
09/16 04:47:59 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:05:34  time: 1.0853  data_time: 0.0018  memory: 16932  
09/16 04:48:55 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:04:26  time: 1.1077  data_time: 0.0023  memory: 16931  
09/16 04:49:50 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:03:18  time: 1.1038  data_time: 0.0023  memory: 597  
09/16 04:50:46 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:02:11  time: 1.0565  data_time: 0.0023  memory: 16954  
09/16 04:51:46 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:05  time: 1.0495  data_time: 0.0018  memory: 16935  
09/16 04:52:41 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.9697  data_time: 0.0016  memory: 16883  
09/16 04:52:41 - mmengine - INFO - per class results:
09/16 04:52:41 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 61.15 | 78.93 |
|       building      |  71.1 | 88.33 |
|         sky         | 84.05 | 91.26 |
|        floor        | 66.53 | 82.21 |
|         tree        | 61.59 | 77.94 |
|       ceiling       | 67.18 | 80.39 |
|         road        | 73.25 | 85.56 |
|         bed         | 74.18 | 87.05 |
|      windowpane     | 45.98 | 63.43 |
|        grass        | 58.44 |  77.6 |
|       cabinet       | 47.16 | 62.11 |
|       sidewalk      | 53.17 | 68.89 |
|        person       | 58.11 | 76.96 |
|        earth        | 29.98 | 42.33 |
|         door        | 31.23 | 41.27 |
|        table        | 42.11 |  61.7 |
|       mountain      | 44.09 | 61.56 |
|        plant        | 39.36 | 53.69 |
|       curtain       | 49.28 | 67.53 |
|        chair        | 38.24 |  55.5 |
|         car         | 59.32 | 74.46 |
|        water        | 40.99 | 55.99 |
|       painting      | 46.61 | 66.31 |
|         sofa        | 48.39 | 69.19 |
|        shelf        | 34.05 | 53.76 |
|        house        | 26.92 | 30.67 |
|         sea         | 38.75 | 66.45 |
|        mirror       |  46.3 | 55.99 |
|         rug         | 41.85 | 50.54 |
|        field        | 17.65 | 26.75 |
|       armchair      | 30.51 | 44.89 |
|         seat        |  54.1 | 72.77 |
|        fence        | 25.74 | 35.85 |
|         desk        | 35.73 | 50.54 |
|         rock        | 26.32 | 40.94 |
|       wardrobe      |  36.6 | 53.07 |
|         lamp        | 30.17 | 47.83 |
|       bathtub       | 58.16 | 67.65 |
|       railing       |  22.5 | 33.33 |
|       cushion       | 34.65 |  49.4 |
|         base        | 13.57 | 15.26 |
|         box         | 13.91 | 18.97 |
|        column       | 24.75 | 34.29 |
|      signboard      | 19.85 | 30.63 |
|   chest of drawers  | 33.94 | 46.39 |
|       counter       | 23.37 | 28.15 |
|         sand        | 32.76 | 43.21 |
|         sink        | 44.29 | 60.16 |
|      skyscraper     | 42.75 | 55.79 |
|      fireplace      | 56.05 | 72.31 |
|     refrigerator    | 49.45 | 60.98 |
|      grandstand     |  38.7 | 59.83 |
|         path        | 15.71 | 21.84 |
|        stairs       | 27.16 | 31.16 |
|        runway       | 56.11 | 71.13 |
|         case        | 44.83 | 71.79 |
|      pool table     | 77.68 | 88.23 |
|        pillow       | 36.82 | 49.86 |
|     screen door     | 52.61 | 66.95 |
|       stairway      | 24.51 | 28.81 |
|        river        | 13.04 |  19.8 |
|        bridge       | 44.41 | 53.43 |
|       bookcase      |  32.2 | 46.34 |
|        blind        | 31.67 |  35.7 |
|     coffee table    | 45.63 | 62.59 |
|        toilet       |  53.3 | 68.42 |
|        flower       | 24.19 | 38.96 |
|         book        | 29.81 | 49.41 |
|         hill        |  3.12 |  4.29 |
|        bench        | 36.21 | 43.51 |
|      countertop     | 36.22 | 54.85 |
|        stove        |  56.2 | 67.34 |
|         palm        | 36.75 | 49.96 |
|    kitchen island   | 32.72 | 56.77 |
|       computer      | 41.32 | 54.09 |
|     swivel chair    | 33.28 | 48.42 |
|         boat        | 36.03 | 49.34 |
|         bar         | 13.73 | 16.74 |
|    arcade machine   | 29.53 | 32.19 |
|        hovel        | 36.43 | 40.74 |
|         bus         | 70.45 | 87.17 |
|        towel        | 27.97 | 38.45 |
|        light        | 13.28 |  20.9 |
|        truck        |  8.72 | 11.16 |
|        tower        | 13.39 | 16.98 |
|      chandelier     | 39.07 | 54.68 |
|        awning       | 14.46 | 16.52 |
|     streetlight     |  6.35 |  9.59 |
|        booth        | 30.22 |  30.6 |
| television receiver | 41.73 | 56.21 |
|       airplane      | 35.22 | 49.77 |
|      dirt track     |  8.86 |  16.8 |
|       apparel       | 23.97 | 43.12 |
|         pole        |  7.06 | 10.86 |
|         land        |  0.14 |  0.17 |
|      bannister      |  1.02 |  1.32 |
|      escalator      |  17.2 |  18.0 |
|       ottoman       | 29.24 | 39.09 |
|        bottle       |  7.53 | 16.02 |
|        buffet       | 31.24 | 38.23 |
|        poster       | 23.81 | 29.69 |
|        stage        |  8.58 | 10.41 |
|         van         |  26.9 | 35.59 |
|         ship        | 57.83 | 59.43 |
|       fountain      | 12.62 | 13.32 |
|    conveyer belt    |  42.4 | 52.98 |
|        canopy       |  4.43 |  5.26 |
|        washer       | 59.78 | 63.66 |
|      plaything      |  9.93 |  14.6 |
|    swimming pool    | 31.38 | 39.54 |
|        stool        | 20.77 |  28.4 |
|        barrel       | 51.54 | 57.05 |
|        basket       | 18.79 | 25.41 |
|      waterfall      | 50.82 | 66.14 |
|         tent        | 77.83 |  95.0 |
|         bag         |  5.97 |  6.9  |
|       minibike      | 34.99 |  44.7 |
|        cradle       |  60.5 | 91.13 |
|         oven        | 21.31 | 45.76 |
|         ball        | 38.37 | 57.25 |
|         food        | 38.97 | 51.86 |
|         step        |  1.34 |  1.44 |
|         tank        | 27.44 | 32.81 |
|      trade name     |  13.1 | 14.98 |
|      microwave      | 29.47 |  32.6 |
|         pot         |  21.2 | 28.56 |
|        animal       | 40.16 | 46.32 |
|       bicycle       | 31.73 | 52.57 |
|         lake        | 37.27 |  62.9 |
|      dishwasher     | 43.35 | 47.42 |
|        screen       | 50.59 | 64.98 |
|       blanket       |  3.14 |  3.3  |
|      sculpture      | 22.46 | 31.88 |
|         hood        | 35.71 | 45.54 |
|        sconce       |  16.4 | 24.24 |
|         vase        | 12.42 | 22.96 |
|    traffic light    | 13.43 | 19.45 |
|         tray        |  3.73 |  5.39 |
|        ashcan       | 20.14 | 31.51 |
|         fan         |  25.5 | 39.61 |
|         pier        | 19.79 | 23.13 |
|      crt screen     |  1.25 |  3.01 |
|        plate        | 28.67 | 43.55 |
|       monitor       | 24.37 | 32.59 |
|    bulletin board   | 27.73 | 33.99 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 25.24 | 32.73 |
|        glass        |  6.04 |  7.08 |
|        clock        | 13.75 | 19.16 |
|         flag        | 15.69 |  18.8 |
+---------------------+-------+-------+
09/16 04:52:41 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 72.5100  mIoU: 33.2100  mAcc: 43.9400  data_time: 0.0026  time: 1.3102
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
09/16 04:53:00 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1067609806
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1067609806
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 04:53:01 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/pixelate'

09/16 04:53:13 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 04:53:13 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 04:53:14 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 04:53:15 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 04:54:49 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:01:19  time: 0.8514  data_time: 0.0018  memory: 17171  
09/16 04:55:35 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:44:28  time: 1.0420  data_time: 0.0019  memory: 16951  
09/16 04:55:58 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:33:32  time: 0.4836  data_time: 0.0019  memory: 16944  
09/16 04:56:33 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:29:43  time: 0.6127  data_time: 0.0019  memory: 16953  
09/16 04:57:04 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:45  time: 0.4152  data_time: 0.0017  memory: 16951  
09/16 04:57:29 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:59  time: 0.0692  data_time: 0.0019  memory: 16947  
09/16 04:58:01 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:30  time: 0.4053  data_time: 0.0018  memory: 16951  
09/16 04:58:25 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:20:39  time: 0.4817  data_time: 0.0017  memory: 16950  
09/16 04:58:32 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:18:11  time: 0.1715  data_time: 0.0017  memory: 16873  
09/16 04:58:42 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:16:20  time: 0.0597  data_time: 0.0017  memory: 16932  
09/16 04:58:53 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:14:52  time: 0.4970  data_time: 0.0019  memory: 16951  
09/16 04:59:00 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:24  time: 0.2260  data_time: 0.0020  memory: 16879  
09/16 04:59:17 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:31  time: 0.4721  data_time: 0.0017  memory: 16953  
09/16 04:59:36 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:11:48  time: 0.0711  data_time: 0.0041  memory: 16954  
09/16 04:59:57 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:09  time: 1.0364  data_time: 0.0017  memory: 16956  
09/16 05:00:04 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:13  time: 0.0563  data_time: 0.0019  memory: 16944  
09/16 05:00:07 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:09:17  time: 0.0593  data_time: 0.0021  memory: 647  
09/16 05:00:13 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:08:30  time: 0.1588  data_time: 0.0018  memory: 16869  
09/16 05:00:31 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:02  time: 0.2748  data_time: 0.0020  memory: 16951  
09/16 05:00:41 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:07:26  time: 0.0553  data_time: 0.0019  memory: 16927  
09/16 05:00:56 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:56  time: 0.6085  data_time: 0.0029  memory: 16954  
09/16 05:01:06 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:25  time: 0.0596  data_time: 0.0019  memory: 16941  
09/16 05:01:14 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:53  time: 0.1645  data_time: 0.0018  memory: 16934  
09/16 05:01:17 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:21  time: 0.0570  data_time: 0.0018  memory: 1844  
09/16 05:01:25 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:54  time: 0.1810  data_time: 0.0038  memory: 16944  
09/16 05:01:28 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:25  time: 0.0569  data_time: 0.0020  memory: 1483  
09/16 05:01:34 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:00  time: 0.0566  data_time: 0.0017  memory: 16929  
09/16 05:01:53 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:42  time: 0.4785  data_time: 0.0019  memory: 16948  
09/16 05:02:01 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:19  time: 0.4084  data_time: 0.0019  memory: 16936  
09/16 05:02:03 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:56  time: 0.0540  data_time: 0.0017  memory: 647  
09/16 05:02:08 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:34  time: 0.0599  data_time: 0.0018  memory: 16878  
09/16 05:02:11 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:14  time: 0.0552  data_time: 0.0019  memory: 1527  
09/16 05:02:22 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:55  time: 0.0528  data_time: 0.0019  memory: 16951  
09/16 05:02:31 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:38  time: 0.0567  data_time: 0.0019  memory: 16942  
09/16 05:02:39 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:20  time: 0.0608  data_time: 0.0017  memory: 16932  
09/16 05:02:46 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:03  time: 0.0580  data_time: 0.0020  memory: 16931  
09/16 05:02:48 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:46  time: 0.0572  data_time: 0.0019  memory: 597  
09/16 05:02:56 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:30  time: 0.0666  data_time: 0.0032  memory: 16954  
09/16 05:03:04 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:15  time: 0.0545  data_time: 0.0017  memory: 16935  
09/16 05:03:11 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0548  data_time: 0.0016  memory: 16883  
09/16 05:03:11 - mmengine - INFO - per class results:
09/16 05:03:11 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.72 | 87.73 |
|       building      | 79.03 | 93.29 |
|         sky         | 93.47 | 96.81 |
|        floor        | 77.85 | 90.28 |
|         tree        | 71.25 |  85.7 |
|       ceiling       | 80.06 | 89.03 |
|         road        | 81.05 | 90.37 |
|         bed         | 85.65 | 94.29 |
|      windowpane     | 57.76 | 74.34 |
|        grass        | 64.69 | 82.95 |
|       cabinet       | 56.51 |  71.4 |
|       sidewalk      | 64.91 | 78.76 |
|        person       | 74.95 | 87.68 |
|        earth        | 33.25 | 46.74 |
|         door        | 37.61 | 48.75 |
|        table        | 55.67 | 73.97 |
|       mountain      | 50.89 | 67.24 |
|        plant        | 47.31 | 59.41 |
|       curtain       | 66.49 | 80.01 |
|        chair        | 52.36 | 66.98 |
|         car         | 80.36 | 87.86 |
|        water        | 45.19 | 61.92 |
|       painting      | 66.91 | 82.69 |
|         sofa        | 59.59 | 81.61 |
|        shelf        |  41.5 | 62.31 |
|        house        | 42.26 | 47.57 |
|         sea         | 44.75 | 71.39 |
|        mirror       | 56.03 | 63.84 |
|         rug         | 51.79 |  57.3 |
|        field        | 24.57 | 31.16 |
|       armchair      | 35.78 | 46.34 |
|         seat        | 56.48 | 73.96 |
|        fence        | 32.34 | 41.48 |
|         desk        | 45.39 | 60.79 |
|         rock        | 26.68 | 39.82 |
|       wardrobe      | 40.44 | 56.66 |
|         lamp        | 57.49 | 71.33 |
|       bathtub       | 71.02 |  77.6 |
|       railing       | 31.96 | 43.91 |
|       cushion       | 50.76 | 63.72 |
|         base        | 16.18 | 18.81 |
|         box         | 20.07 | 26.57 |
|        column       | 36.96 | 45.44 |
|      signboard      | 30.55 | 41.92 |
|   chest of drawers  | 37.96 | 52.14 |
|       counter       | 25.75 | 31.27 |
|         sand        | 30.95 | 45.59 |
|         sink        | 64.32 | 77.57 |
|      skyscraper     | 47.44 | 54.68 |
|      fireplace      | 63.91 |  80.0 |
|     refrigerator    | 61.38 | 75.78 |
|      grandstand     | 39.87 | 62.87 |
|         path        | 16.45 |  23.5 |
|        stairs       | 32.17 | 38.55 |
|        runway       | 63.01 |  83.2 |
|         case        | 51.55 | 74.38 |
|      pool table     | 91.21 | 94.63 |
|        pillow       |  50.4 | 61.55 |
|     screen door     | 57.46 | 74.09 |
|       stairway      | 29.21 | 35.11 |
|        river        | 15.35 | 23.04 |
|        bridge       |  64.4 | 73.33 |
|       bookcase      | 38.66 | 51.51 |
|        blind        | 40.93 | 44.91 |
|     coffee table    | 61.53 | 77.27 |
|        toilet       | 82.63 | 90.45 |
|        flower       | 33.89 | 47.73 |
|         book        | 43.04 |  64.2 |
|         hill        |  4.3  |  6.57 |
|        bench        |  38.2 | 45.21 |
|      countertop     |  50.5 | 67.49 |
|        stove        | 70.98 | 80.15 |
|         palm        | 44.11 | 54.04 |
|    kitchen island   | 39.98 | 69.05 |
|       computer      | 52.12 | 63.24 |
|     swivel chair    | 43.12 | 55.56 |
|         boat        | 35.82 | 41.27 |
|         bar         | 14.18 | 17.64 |
|    arcade machine   | 32.08 | 33.46 |
|        hovel        | 36.92 | 38.82 |
|         bus         | 76.72 | 93.73 |
|        towel        | 50.74 | 58.11 |
|        light        | 50.13 | 57.98 |
|        truck        | 15.24 | 21.13 |
|        tower        | 29.47 | 36.78 |
|      chandelier     | 60.94 | 77.11 |
|        awning       | 21.47 | 22.96 |
|     streetlight     | 19.31 | 24.82 |
|        booth        | 32.81 |  33.3 |
| television receiver | 58.97 | 71.66 |
|       airplane      | 47.61 | 61.18 |
|      dirt track     | 11.23 | 19.97 |
|       apparel       | 30.58 | 45.55 |
|         pole        | 17.26 | 24.98 |
|         land        |  1.0  |  1.18 |
|      bannister      |  3.56 |  4.47 |
|      escalator      | 14.15 | 14.85 |
|       ottoman       | 32.44 | 41.77 |
|        bottle       |  13.3 | 25.62 |
|        buffet       | 38.92 | 50.14 |
|        poster       | 21.53 | 25.01 |
|        stage        |  8.24 | 11.18 |
|         van         | 40.65 | 53.89 |
|         ship        | 70.25 | 71.21 |
|       fountain      |  5.47 |  5.81 |
|    conveyer belt    | 51.38 | 66.14 |
|        canopy       |  4.3  |  4.44 |
|        washer       | 66.84 | 69.53 |
|      plaything      | 16.28 | 20.99 |
|    swimming pool    | 37.82 | 47.21 |
|        stool        | 33.81 | 41.07 |
|        barrel       |  29.3 | 64.94 |
|        basket       | 25.59 | 30.51 |
|      waterfall      | 51.44 |  66.0 |
|         tent        | 90.11 | 98.22 |
|         bag         |  7.83 |  8.62 |
|       minibike      | 38.26 | 41.36 |
|        cradle       | 71.01 |  95.7 |
|         oven        | 23.02 | 50.37 |
|         ball        | 45.46 | 59.23 |
|         food        | 45.86 | 52.86 |
|         step        |  2.31 |  2.55 |
|         tank        | 31.28 | 38.43 |
|      trade name     | 22.51 | 25.59 |
|      microwave      | 35.73 | 38.93 |
|         pot         | 36.47 | 41.24 |
|        animal       | 44.58 | 46.19 |
|       bicycle       | 39.74 | 59.04 |
|         lake        | 42.94 | 63.61 |
|      dishwasher     | 48.92 | 53.52 |
|        screen       |  61.0 | 73.88 |
|       blanket       |  2.53 |  2.6  |
|      sculpture      | 29.65 | 36.16 |
|         hood        | 54.36 | 59.73 |
|        sconce       | 33.63 | 40.04 |
|         vase        | 27.85 | 42.11 |
|    traffic light    |  24.5 |  32.8 |
|         tray        |  5.58 |  7.68 |
|        ashcan       | 40.83 | 52.93 |
|         fan         | 53.52 | 63.37 |
|         pier        | 23.94 | 27.41 |
|      crt screen     |  0.31 |  0.74 |
|        plate        | 39.59 | 51.01 |
|       monitor       | 30.51 | 36.69 |
|    bulletin board   | 32.75 | 40.43 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 33.79 | 39.05 |
|        glass        | 11.44 |  12.5 |
|        clock        | 24.64 | 29.11 |
|         flag        | 28.52 | 30.38 |
+---------------------+-------+-------+
09/16 05:03:11 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.1700  mIoU: 41.6500  mAcc: 51.6700  data_time: 0.0022  time: 0.2978
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
09/16 05:04:42 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 714316005
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 714316005
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

09/16 05:04:43 - mmengine - INFO - Config:
crop_size = (
    512,
    512,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        contract_dilation=True,
        depth=50,
        dilations=(
            1,
            1,
            2,
            4,
        ),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        norm_eval=False,
        num_stages=4,
        out_indices=(
            0,
            1,
            2,
            3,
        ),
        strides=(
            1,
            2,
            1,
            1,
        ),
        style='pytorch',
        type='ResNetV1c'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=2048,
        in_index=3,
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='PSPHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2048,
        512,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/pspnet/pspnet_r50-d8_4xb4-160k_ade20k-512x512/jpeg_compression'

09/16 05:05:22 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
09/16 05:05:23 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
09/16 05:05:24 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 05:05:25 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/pspnet/pspnet_r50-d8_512x512_160k_ade20k_20200615_184358-1890b0bd.pth
09/16 05:07:40 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:27:53  time: 0.8642  data_time: 0.0019  memory: 17171  
09/16 05:08:26 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:57:32  time: 1.0650  data_time: 0.0021  memory: 16951  
09/16 05:08:50 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:42:07  time: 0.4960  data_time: 0.0023  memory: 16944  
09/16 05:09:25 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:36:06  time: 0.6412  data_time: 0.0066  memory: 16953  
09/16 05:09:57 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:31:45  time: 0.4302  data_time: 0.0021  memory: 16951  
09/16 05:10:22 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:28:03  time: 0.0772  data_time: 0.0020  memory: 16947  
09/16 05:10:55 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:25:56  time: 0.4142  data_time: 0.0018  memory: 16951  
09/16 05:11:19 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:23:35  time: 0.4887  data_time: 0.0018  memory: 16950  
09/16 05:11:26 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:20:44  time: 0.1791  data_time: 0.0019  memory: 16873  
09/16 05:11:36 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:18:34  time: 0.0708  data_time: 0.0018  memory: 16932  
09/16 05:11:48 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:16:51  time: 0.5059  data_time: 0.0020  memory: 16951  
09/16 05:11:55 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:15:10  time: 0.2355  data_time: 0.0020  memory: 16879  
09/16 05:12:12 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:14:06  time: 0.4784  data_time: 0.0018  memory: 16953  
09/16 05:12:33 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:13:14  time: 0.0768  data_time: 0.0020  memory: 16954  
09/16 05:12:53 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:12:27  time: 1.0381  data_time: 0.0019  memory: 16956  
09/16 05:13:01 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:11:24  time: 0.0671  data_time: 0.0020  memory: 16944  
09/16 05:13:04 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:21  time: 0.0661  data_time: 0.0020  memory: 647  
09/16 05:13:11 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:29  time: 0.1658  data_time: 0.0018  memory: 16869  
09/16 05:13:29 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:55  time: 0.2787  data_time: 0.0019  memory: 16951  
09/16 05:13:40 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:14  time: 0.0630  data_time: 0.0018  memory: 16927  
09/16 05:13:55 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:41  time: 0.6040  data_time: 0.0019  memory: 16954  
09/16 05:14:06 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:06  time: 0.0659  data_time: 0.0020  memory: 16941  
09/16 05:14:14 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:06:31  time: 0.1727  data_time: 0.0019  memory: 16934  
09/16 05:14:17 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:55  time: 0.0647  data_time: 0.0019  memory: 1844  
09/16 05:14:26 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:05:24  time: 0.1767  data_time: 0.0018  memory: 16944  
09/16 05:14:29 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:53  time: 0.0644  data_time: 0.0018  memory: 1483  
09/16 05:14:36 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:25  time: 0.0648  data_time: 0.0018  memory: 16929  
09/16 05:14:55 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:04  time: 0.4979  data_time: 0.0035  memory: 16948  
09/16 05:15:03 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:39  time: 0.4166  data_time: 0.0019  memory: 16936  
09/16 05:15:06 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:13  time: 0.0635  data_time: 0.0037  memory: 647  
09/16 05:15:11 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:50  time: 0.0676  data_time: 0.0020  memory: 16878  
09/16 05:15:15 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:27  time: 0.0619  data_time: 0.0020  memory: 1527  
09/16 05:15:25 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:07  time: 0.0587  data_time: 0.0017  memory: 16951  
09/16 05:15:35 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:47  time: 0.0656  data_time: 0.0020  memory: 16942  
09/16 05:15:44 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:28  time: 0.0694  data_time: 0.0019  memory: 16932  
09/16 05:15:51 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:09  time: 0.0666  data_time: 0.0021  memory: 16931  
09/16 05:15:54 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:51  time: 0.0659  data_time: 0.0020  memory: 597  
09/16 05:16:02 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:33  time: 0.0716  data_time: 0.0019  memory: 16954  
09/16 05:16:10 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:16  time: 0.0627  data_time: 0.0019  memory: 16935  
09/16 05:16:17 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0602  data_time: 0.0016  memory: 16883  
09/16 05:16:17 - mmengine - INFO - per class results:
09/16 05:16:17 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 71.24 | 88.37 |
|       building      |  78.5 | 91.91 |
|         sky         | 93.03 | 96.74 |
|        floor        | 75.37 |  90.6 |
|         tree        | 71.48 | 85.42 |
|       ceiling       | 77.89 | 86.77 |
|         road        | 80.03 | 90.14 |
|         bed         | 84.43 | 93.39 |
|      windowpane     | 56.43 | 73.08 |
|        grass        | 63.69 | 79.91 |
|       cabinet       | 53.57 | 68.34 |
|       sidewalk      | 61.25 | 74.65 |
|        person       | 74.38 | 87.75 |
|        earth        | 31.47 |  46.6 |
|         door        | 35.67 | 46.48 |
|        table        | 53.65 | 69.71 |
|       mountain      |  51.3 | 70.03 |
|        plant        |  46.9 | 58.15 |
|       curtain       | 64.27 | 75.29 |
|        chair        | 51.15 | 63.32 |
|         car         |  80.7 | 88.94 |
|        water        | 45.35 |  62.1 |
|       painting      |  67.5 | 80.61 |
|         sofa        |  61.0 |  81.5 |
|        shelf        | 39.08 | 58.86 |
|        house        |  43.4 | 48.87 |
|         sea         | 40.99 | 65.43 |
|        mirror       | 51.69 | 58.62 |
|         rug         |  41.8 | 45.09 |
|        field        | 31.11 | 41.25 |
|       armchair      | 36.97 | 47.26 |
|         seat        |  57.4 | 76.89 |
|        fence        | 32.71 | 43.19 |
|         desk        | 45.13 |  61.0 |
|         rock        | 26.87 | 40.14 |
|       wardrobe      | 39.62 | 59.16 |
|         lamp        | 57.95 | 70.25 |
|       bathtub       | 65.97 | 72.22 |
|       railing       |  29.8 | 39.25 |
|       cushion       | 48.14 | 62.52 |
|         base        |  9.64 | 11.47 |
|         box         | 17.84 | 23.16 |
|        column       | 35.33 | 43.54 |
|      signboard      | 30.32 | 41.28 |
|   chest of drawers  | 36.79 | 51.88 |
|       counter       | 19.28 | 23.19 |
|         sand        | 20.43 | 30.65 |
|         sink        | 64.82 |  76.6 |
|      skyscraper     | 46.34 | 58.67 |
|      fireplace      | 63.66 | 75.99 |
|     refrigerator    | 61.28 | 77.05 |
|      grandstand     | 43.21 | 63.39 |
|         path        | 16.95 | 24.15 |
|        stairs       | 29.55 | 34.21 |
|        runway       | 65.31 | 84.54 |
|         case        | 51.84 | 70.59 |
|      pool table     | 89.58 |  94.5 |
|        pillow       |  46.9 |  55.8 |
|     screen door     | 52.73 | 63.17 |
|       stairway      | 31.21 | 38.04 |
|        river        |  7.73 | 12.09 |
|        bridge       | 47.45 | 52.76 |
|       bookcase      | 37.88 | 49.37 |
|        blind        | 35.98 | 37.86 |
|     coffee table    | 61.51 | 76.11 |
|        toilet       | 80.97 | 88.11 |
|        flower       | 33.41 | 48.41 |
|         book        | 42.55 | 61.21 |
|         hill        |  4.21 |  6.59 |
|        bench        |  39.3 | 46.08 |
|      countertop     | 48.77 |  63.3 |
|        stove        | 69.32 | 82.11 |
|         palm        | 46.28 | 59.73 |
|    kitchen island   |  42.5 | 70.75 |
|       computer      | 51.44 | 61.88 |
|     swivel chair    | 42.39 | 51.37 |
|         boat        | 33.18 | 40.97 |
|         bar         | 13.98 | 17.42 |
|    arcade machine   | 39.76 | 42.21 |
|        hovel        | 35.83 | 40.78 |
|         bus         | 76.53 | 91.35 |
|        towel        |  46.1 | 50.65 |
|        light        | 47.16 | 53.26 |
|        truck        | 14.47 | 18.55 |
|        tower        | 31.81 | 39.42 |
|      chandelier     | 64.91 | 78.78 |
|        awning       |  19.1 | 20.15 |
|     streetlight     | 18.14 | 21.91 |
|        booth        | 31.38 | 32.45 |
| television receiver | 56.54 | 70.08 |
|       airplane      |  50.0 |  63.1 |
|      dirt track     |  6.28 | 12.65 |
|       apparel       | 29.57 | 45.22 |
|         pole        | 14.07 | 20.19 |
|         land        |  0.82 |  1.05 |
|      bannister      |  3.2  |  4.02 |
|      escalator      | 14.32 | 14.74 |
|       ottoman       | 32.42 | 40.09 |
|        bottle       | 11.97 | 21.25 |
|        buffet       |  33.6 | 39.09 |
|        poster       | 24.03 | 27.64 |
|        stage        |  9.92 | 12.04 |
|         van         | 35.43 | 45.61 |
|         ship        | 62.46 | 66.79 |
|       fountain      |  7.52 |  7.62 |
|    conveyer belt    | 44.36 | 63.41 |
|        canopy       |  1.4  |  1.5  |
|        washer       | 65.58 | 71.52 |
|      plaything      |  20.6 |  24.6 |
|    swimming pool    | 26.85 | 31.84 |
|        stool        | 29.49 | 36.95 |
|        barrel       | 23.67 | 50.78 |
|        basket       | 24.41 | 29.45 |
|      waterfall      | 53.68 | 66.56 |
|         tent        | 80.49 | 99.06 |
|         bag         |  6.28 |  6.98 |
|       minibike      | 49.19 | 55.37 |
|        cradle       | 71.37 | 95.78 |
|         oven        | 15.72 | 35.96 |
|         ball        | 44.48 | 55.75 |
|         food        | 42.22 | 52.22 |
|         step        |  1.81 |  2.04 |
|         tank        | 31.99 | 43.08 |
|      trade name     | 22.27 | 25.32 |
|      microwave      | 35.08 | 38.51 |
|         pot         | 34.96 | 38.56 |
|        animal       | 43.49 | 46.98 |
|       bicycle       | 41.93 | 63.44 |
|         lake        |  39.9 |  63.3 |
|      dishwasher     | 50.25 | 56.08 |
|        screen       | 53.03 | 61.91 |
|       blanket       |  3.27 |  3.37 |
|      sculpture      | 31.52 |  42.2 |
|         hood        | 51.64 | 57.58 |
|        sconce       | 27.88 | 32.05 |
|         vase        | 23.94 | 37.45 |
|    traffic light    | 22.75 | 28.65 |
|         tray        |  5.08 |  7.34 |
|        ashcan       | 37.67 | 47.54 |
|         fan         |  52.2 | 62.43 |
|         pier        | 29.07 | 33.36 |
|      crt screen     |  0.21 |  0.44 |
|        plate        | 40.91 | 52.09 |
|       monitor       | 34.99 | 39.84 |
|    bulletin board   | 33.88 | 38.45 |
|        shower       |  0.0  |  0.0  |
|       radiator      | 29.78 | 33.62 |
|        glass        | 10.23 |  11.0 |
|        clock        | 21.11 | 24.87 |
|         flag        | 27.97 | 30.21 |
+---------------------+-------+-------+
09/16 05:16:17 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 79.2700  mIoU: 40.3100  mAcc: 49.9200  data_time: 0.0025  time: 0.3261
Finished processing corruption type: jpeg_compression
Runtime: 1726456586

============================= JOB FEEDBACK =============================

NodeName=uc2n513
Job ID: 24240119
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 07:51:49
CPU Efficiency: 5.02% of 6-12:40:32 core-walltime
Job Wall-clock time: 09:47:32
Memory Utilized: 2.92 GB
Memory Efficiency: 2.92% of 100.00 GB
