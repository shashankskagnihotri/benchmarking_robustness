Started at Sun Oct  6 01:02:51 CEST 2024
Processing corruption type: gaussian_noise
10/06 01:04:31 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 672777747
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 672777747
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 01:04:32 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='gaussian_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/gaussian_noise'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 01:05:49,927 - mmseg - INFO - using core type: DCNv3
2024-10-06 01:05:49,927 - mmseg - INFO - using activation layer: GELU
2024-10-06 01:05:49,927 - mmseg - INFO - using main norm layer: LN
2024-10-06 01:05:49,927 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 01:05:49,927 - mmseg - INFO - level2_post_norm: False
2024-10-06 01:05:49,927 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 01:05:49,927 - mmseg - INFO - res_post_norm: False
2024-10-06 01:05:49,927 - mmseg - INFO - use_dcn_v4_op: False
10/06 01:05:52 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 01:05:53 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 01:05:56 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 01:05:59 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 01:06:53 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:35:25  time: 0.4739  data_time: 0.0015  memory: 21070  
10/06 01:07:20 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:25:35  time: 0.6261  data_time: 0.0015  memory: 11890  
10/06 01:07:35 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:19:46  time: 0.2926  data_time: 0.0015  memory: 10810  
10/06 01:07:57 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:17:41  time: 0.3847  data_time: 0.0015  memory: 11893  
10/06 01:08:19 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:16:17  time: 0.2373  data_time: 0.0015  memory: 11870  
10/06 01:08:36 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:14:51  time: 0.1133  data_time: 0.0015  memory: 11897  
10/06 01:08:56 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:55  time: 0.2741  data_time: 0.0014  memory: 11905  
10/06 01:09:12 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:53  time: 0.2712  data_time: 0.0024  memory: 11872  
10/06 01:09:21 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:11:36  time: 0.2090  data_time: 0.0014  memory: 9599  
10/06 01:09:29 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:10:31  time: 0.1092  data_time: 0.0014  memory: 10790  
10/06 01:09:39 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:39  time: 0.2784  data_time: 0.0015  memory: 10822  
10/06 01:09:47 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:51  time: 0.2538  data_time: 0.0015  memory: 9783  
10/06 01:09:59 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:08:18  time: 0.3013  data_time: 0.0014  memory: 10827  
10/06 01:10:14 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:53  time: 0.1158  data_time: 0.0015  memory: 11903  
10/06 01:10:29 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:30  time: 0.6116  data_time: 0.0014  memory: 10832  
10/06 01:10:36 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:55  time: 0.1106  data_time: 0.0016  memory: 10811  
10/06 01:10:42 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:22  time: 0.1130  data_time: 0.0016  memory: 776  
10/06 01:10:50 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:56  time: 0.2012  data_time: 0.0014  memory: 9040  
10/06 01:11:05 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:38  time: 0.3690  data_time: 0.0014  memory: 10906  
10/06 01:11:15 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:15  time: 0.1058  data_time: 0.0014  memory: 10908  
10/06 01:11:27 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:56  time: 0.4596  data_time: 0.0014  memory: 10829  
10/06 01:11:38 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:37  time: 0.1093  data_time: 0.0015  memory: 10804  
10/06 01:11:46 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:16  time: 0.2298  data_time: 0.0014  memory: 10792  
10/06 01:11:52 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:55  time: 0.1078  data_time: 0.0014  memory: 1962  
10/06 01:12:01 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:37  time: 0.2324  data_time: 0.0014  memory: 11893  
10/06 01:12:06 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:17  time: 0.1013  data_time: 0.0014  memory: 778  
10/06 01:12:12 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:59  time: 0.1050  data_time: 0.0014  memory: 10787  
10/06 01:12:25 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:45  time: 0.3062  data_time: 0.0014  memory: 10816  
10/06 01:12:33 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:29  time: 0.2704  data_time: 0.0014  memory: 10798  
10/06 01:12:39 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:13  time: 0.1038  data_time: 0.0014  memory: 776  
10/06 01:12:46 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:58  time: 0.1055  data_time: 0.0014  memory: 10717  
10/06 01:12:51 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:43  time: 0.1015  data_time: 0.0015  memory: 774  
10/06 01:13:02 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:29  time: 0.1043  data_time: 0.0014  memory: 11903  
10/06 01:13:12 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:16  time: 0.1068  data_time: 0.0029  memory: 10806  
10/06 01:13:20 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:03  time: 0.1138  data_time: 0.0014  memory: 10789  
10/06 01:13:27 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:49  time: 0.1032  data_time: 0.0015  memory: 10790  
10/06 01:13:32 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:36  time: 0.1091  data_time: 0.0015  memory: 724  
10/06 01:13:39 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:24  time: 0.1075  data_time: 0.0014  memory: 10829  
10/06 01:13:48 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:12  time: 0.1060  data_time: 0.0014  memory: 10795  
10/06 01:13:58 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1011  data_time: 0.0013  memory: 8666  
10/06 01:13:58 - mmengine - INFO - per class results:
10/06 01:13:58 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  72.5 | 87.78 |
|       building      | 79.09 | 87.84 |
|         sky         | 92.42 |  96.4 |
|        floor        | 76.93 | 87.75 |
|         tree        |  66.5 | 90.99 |
|       ceiling       | 78.53 | 86.54 |
|         road        | 77.74 |  89.9 |
|         bed         | 86.48 | 94.12 |
|      windowpane     |  57.8 | 75.88 |
|        grass        | 52.93 | 67.31 |
|       cabinet       | 52.39 | 64.75 |
|       sidewalk      | 48.67 | 55.32 |
|        person       | 76.75 | 90.19 |
|        earth        | 28.61 | 46.47 |
|         door        | 41.45 | 49.07 |
|        table        | 54.85 | 71.56 |
|       mountain      | 49.81 | 62.19 |
|        plant        | 41.82 | 52.52 |
|       curtain       | 61.66 | 74.34 |
|        chair        | 52.02 | 64.34 |
|         car         | 81.71 | 90.38 |
|        water        |  41.7 | 52.51 |
|       painting      | 69.12 | 81.38 |
|         sofa        | 63.33 | 84.21 |
|        shelf        | 35.15 | 48.18 |
|        house        | 44.59 | 81.68 |
|         sea         | 41.34 | 63.41 |
|        mirror       | 60.65 | 65.93 |
|         rug         | 51.37 | 59.43 |
|        field        | 22.84 |  61.3 |
|       armchair      | 38.08 |  55.8 |
|         seat        | 55.96 | 69.64 |
|        fence        | 34.55 | 51.61 |
|         desk        | 42.03 | 68.16 |
|         rock        | 31.61 |  52.2 |
|       wardrobe      | 42.06 | 65.01 |
|         lamp        | 58.51 | 68.62 |
|       bathtub       | 69.95 | 82.09 |
|       railing       | 26.36 | 36.57 |
|       cushion       | 47.93 | 54.97 |
|         base        | 10.84 | 12.55 |
|         box         | 18.35 | 21.75 |
|        column       | 42.75 | 59.26 |
|      signboard      | 33.65 | 41.45 |
|   chest of drawers  | 37.35 | 60.35 |
|       counter       | 23.87 | 32.18 |
|         sand        | 25.82 | 40.62 |
|         sink        | 65.41 |  74.1 |
|      skyscraper     | 45.03 | 58.62 |
|      fireplace      | 69.85 | 85.31 |
|     refrigerator    | 69.56 | 87.44 |
|      grandstand     | 35.46 | 67.11 |
|         path        |  24.7 | 36.28 |
|        stairs       | 31.37 | 42.39 |
|        runway       |  74.7 |  93.3 |
|         case        |  39.5 | 50.16 |
|      pool table     | 90.14 | 95.28 |
|        pillow       | 53.25 | 66.18 |
|     screen door     | 47.32 | 48.92 |
|       stairway      | 30.26 |  43.1 |
|        river        |  5.34 | 12.53 |
|        bridge       | 28.17 | 36.83 |
|       bookcase      |  35.6 | 54.21 |
|        blind        | 29.91 | 34.44 |
|     coffee table    | 63.32 | 75.98 |
|        toilet       | 79.73 | 85.94 |
|        flower       | 37.28 | 51.22 |
|         book        | 44.47 | 61.67 |
|         hill        | 16.12 | 21.87 |
|        bench        | 41.78 | 51.02 |
|      countertop     | 47.13 | 70.14 |
|        stove        | 76.55 | 82.32 |
|         palm        | 43.36 | 49.89 |
|    kitchen island   | 20.35 | 34.05 |
|       computer      |  55.7 | 61.92 |
|     swivel chair    |  33.9 | 40.56 |
|         boat        | 45.82 | 49.98 |
|         bar         | 29.42 | 40.41 |
|    arcade machine   | 29.01 | 29.83 |
|        hovel        | 11.01 | 11.98 |
|         bus         | 86.45 | 95.01 |
|        towel        |  48.9 | 57.89 |
|        light        | 43.74 |  48.0 |
|        truck        |  26.9 | 32.72 |
|        tower        | 16.38 | 27.58 |
|      chandelier     | 61.42 | 78.59 |
|        awning       | 18.55 |  22.2 |
|     streetlight     | 21.55 | 27.62 |
|        booth        | 46.81 | 48.01 |
| television receiver | 55.94 | 69.31 |
|       airplane      | 58.25 |  68.2 |
|      dirt track     |  6.75 | 13.86 |
|       apparel       | 33.51 | 45.43 |
|         pole        | 18.97 | 32.46 |
|         land        |  3.33 |  6.42 |
|      bannister      | 15.65 | 21.66 |
|      escalator      | 37.35 | 45.76 |
|       ottoman       | 42.25 | 52.12 |
|        bottle       | 29.78 | 41.94 |
|        buffet       | 32.55 | 37.54 |
|        poster       | 25.65 | 28.35 |
|        stage        | 15.69 | 21.83 |
|         van         | 43.15 | 59.52 |
|         ship        |  4.61 |  6.12 |
|       fountain      | 19.08 | 20.85 |
|    conveyer belt    | 67.24 | 84.14 |
|        canopy       | 25.58 | 28.69 |
|        washer       | 70.45 | 72.67 |
|      plaything      | 22.73 | 26.94 |
|    swimming pool    | 22.14 | 33.53 |
|        stool        | 38.86 | 48.85 |
|        barrel       | 33.26 | 42.48 |
|        basket       | 27.16 | 34.97 |
|      waterfall      | 44.95 | 50.68 |
|         tent        | 86.36 | 98.23 |
|         bag         |  7.31 |  8.15 |
|       minibike      |  62.2 | 70.47 |
|        cradle       | 82.35 |  92.5 |
|         oven        | 44.57 | 65.21 |
|         ball        | 46.13 | 59.86 |
|         food        | 46.11 | 59.72 |
|         step        |  3.97 |  4.5  |
|         tank        | 44.64 | 49.09 |
|      trade name     | 28.87 | 34.12 |
|      microwave      | 56.14 | 60.82 |
|         pot         | 33.16 | 36.92 |
|        animal       | 53.99 | 55.28 |
|       bicycle       | 54.79 | 74.87 |
|         lake        |  9.21 |  9.38 |
|      dishwasher     | 55.95 |  72.2 |
|        screen       | 60.42 | 79.97 |
|       blanket       | 10.62 | 12.66 |
|      sculpture      | 48.61 | 56.77 |
|         hood        | 46.26 |  47.4 |
|        sconce       | 32.96 | 37.26 |
|         vase        | 35.62 | 43.73 |
|    traffic light    | 26.75 | 37.22 |
|         tray        |  4.99 |  9.99 |
|        ashcan       | 36.61 | 43.32 |
|         fan         | 55.84 | 67.52 |
|         pier        |  15.7 | 18.72 |
|      crt screen     |  1.89 |  3.38 |
|        plate        |  41.8 | 51.84 |
|       monitor       | 33.96 | 47.86 |
|    bulletin board   | 28.46 | 44.79 |
|        shower       |  1.22 |  5.97 |
|       radiator      | 37.13 | 42.61 |
|        glass        | 10.99 | 11.44 |
|        clock        | 31.46 | 38.63 |
|         flag        | 40.98 | 46.83 |
+---------------------+-------+-------+
10/06 01:13:58 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.7700  mIoU: 42.2300  mAcc: 52.6200  data_time: 0.0017  time: 0.2393
Finished processing corruption type: gaussian_noise
Processing corruption type: shot_noise
10/06 01:14:02 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 118742326
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 118742326
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 01:14:03 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='shot_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/shot_noise'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 01:14:06,789 - mmseg - INFO - using core type: DCNv3
2024-10-06 01:14:06,789 - mmseg - INFO - using activation layer: GELU
2024-10-06 01:14:06,790 - mmseg - INFO - using main norm layer: LN
2024-10-06 01:14:06,790 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 01:14:06,790 - mmseg - INFO - level2_post_norm: False
2024-10-06 01:14:06,790 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 01:14:06,790 - mmseg - INFO - res_post_norm: False
2024-10-06 01:14:06,790 - mmseg - INFO - use_dcn_v4_op: False
10/06 01:14:08 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 01:14:08 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 01:14:10 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 01:14:11 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 01:15:05 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:35:28  time: 0.5618  data_time: 0.0015  memory: 21070  
10/06 01:15:36 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:26:49  time: 0.7031  data_time: 0.0016  memory: 11890  
10/06 01:15:55 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:21:22  time: 0.3734  data_time: 0.0016  memory: 10810  
10/06 01:16:21 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:19:28  time: 0.4672  data_time: 0.0015  memory: 11893  
10/06 01:16:46 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:18:06  time: 0.3047  data_time: 0.0014  memory: 11870  
10/06 01:17:08 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:16:42  time: 0.1879  data_time: 0.0015  memory: 11897  
10/06 01:17:31 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:15:45  time: 0.3474  data_time: 0.0014  memory: 11905  
10/06 01:17:52 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:14:43  time: 0.3539  data_time: 0.0014  memory: 11872  
10/06 01:18:04 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:13:23  time: 0.2802  data_time: 0.0014  memory: 9599  
10/06 01:18:16 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:12:15  time: 0.1859  data_time: 0.0014  memory: 10790  
10/06 01:18:30 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:11:21  time: 0.3564  data_time: 0.0015  memory: 10822  
10/06 01:18:42 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:10:31  time: 0.3415  data_time: 0.0016  memory: 9783  
10/06 01:18:58 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:09:55  time: 0.3816  data_time: 0.0014  memory: 10827  
10/06 01:19:16 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:09:27  time: 0.1966  data_time: 0.0016  memory: 11903  
10/06 01:19:36 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:09:01  time: 0.6931  data_time: 0.0014  memory: 10832  
10/06 01:19:46 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:08:23  time: 0.1782  data_time: 0.0016  memory: 10811  
10/06 01:19:56 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:07:46  time: 0.1941  data_time: 0.0016  memory: 776  
10/06 01:20:08 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:16  time: 0.2658  data_time: 0.0014  memory: 9040  
10/06 01:20:27 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:06:55  time: 0.4370  data_time: 0.0015  memory: 10906  
10/06 01:20:40 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:29  time: 0.1802  data_time: 0.0015  memory: 10908  
10/06 01:20:56 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:06  time: 0.5412  data_time: 0.0015  memory: 10829  
10/06 01:21:11 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:05:43  time: 0.1780  data_time: 0.0015  memory: 10804  
10/06 01:21:23 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:19  time: 0.3153  data_time: 0.0015  memory: 10792  
10/06 01:21:32 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:04:54  time: 0.1802  data_time: 0.0014  memory: 1962  
10/06 01:21:45 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:32  time: 0.2998  data_time: 0.0014  memory: 11893  
10/06 01:21:54 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:09  time: 0.1867  data_time: 0.0014  memory: 778  
10/06 01:22:04 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:03:47  time: 0.1750  data_time: 0.0015  memory: 10787  
10/06 01:22:21 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:29  time: 0.3942  data_time: 0.0015  memory: 10816  
10/06 01:22:32 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:10  time: 0.3447  data_time: 0.0014  memory: 10798  
10/06 01:22:42 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:50  time: 0.1739  data_time: 0.0014  memory: 776  
10/06 01:22:52 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:31  time: 0.1876  data_time: 0.0015  memory: 10717  
10/06 01:23:02 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:12  time: 0.1859  data_time: 0.0016  memory: 774  
10/06 01:23:16 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:55  time: 0.1739  data_time: 0.0014  memory: 11903  
10/06 01:23:30 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:38  time: 0.1876  data_time: 0.0016  memory: 10806  
10/06 01:23:42 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:21  time: 0.1923  data_time: 0.0014  memory: 10789  
10/06 01:23:53 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:04  time: 0.1922  data_time: 0.0016  memory: 10790  
10/06 01:24:02 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:47  time: 0.1933  data_time: 0.0016  memory: 724  
10/06 01:24:13 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:31  time: 0.1803  data_time: 0.0014  memory: 10829  
10/06 01:24:26 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:15  time: 0.1712  data_time: 0.0014  memory: 10795  
10/06 01:24:38 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1722  data_time: 0.0014  memory: 8666  
10/06 01:24:38 - mmengine - INFO - per class results:
10/06 01:24:38 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 72.09 | 87.68 |
|       building      | 79.78 |  88.3 |
|         sky         | 91.84 | 95.89 |
|        floor        | 77.04 | 87.92 |
|         tree        | 66.67 | 91.38 |
|       ceiling       | 77.43 | 85.44 |
|         road        | 78.49 | 90.76 |
|         bed         | 87.15 | 94.71 |
|      windowpane     | 56.95 | 74.92 |
|        grass        | 52.96 | 66.33 |
|       cabinet       | 52.93 | 64.56 |
|       sidewalk      | 48.19 | 54.14 |
|        person       | 77.35 | 90.39 |
|        earth        | 28.07 | 47.15 |
|         door        |  40.2 | 47.54 |
|        table        | 55.44 | 72.55 |
|       mountain      | 48.68 | 60.64 |
|        plant        | 42.97 | 53.61 |
|       curtain       | 61.03 | 73.55 |
|        chair        | 53.09 | 66.65 |
|         car         | 82.65 |  91.0 |
|        water        | 39.92 | 50.93 |
|       painting      |  67.7 | 80.15 |
|         sofa        | 62.85 | 83.07 |
|        shelf        | 35.47 | 48.73 |
|        house        | 46.54 | 82.52 |
|         sea         | 40.56 |  61.3 |
|        mirror       | 60.21 | 65.59 |
|         rug         | 46.83 | 53.63 |
|        field        | 22.81 | 61.65 |
|       armchair      | 36.48 | 55.59 |
|         seat        | 58.03 | 72.61 |
|        fence        | 33.84 | 51.08 |
|         desk        | 39.72 | 67.08 |
|         rock        | 34.04 | 55.51 |
|       wardrobe      | 42.02 | 64.37 |
|         lamp        | 56.37 | 66.39 |
|       bathtub       | 68.05 | 78.38 |
|       railing       | 26.35 |  37.0 |
|       cushion       | 49.28 | 55.74 |
|         base        | 14.93 | 17.67 |
|         box         | 17.62 | 21.48 |
|        column       | 40.24 |  58.7 |
|      signboard      | 34.15 | 41.79 |
|   chest of drawers  | 36.74 | 59.66 |
|       counter       | 25.55 | 35.78 |
|         sand        | 22.83 |  37.4 |
|         sink        | 65.15 | 72.89 |
|      skyscraper     | 50.15 | 64.54 |
|      fireplace      | 68.56 | 85.35 |
|     refrigerator    | 67.68 | 82.98 |
|      grandstand     | 36.27 | 67.27 |
|         path        | 25.95 | 37.39 |
|        stairs       | 31.37 | 42.38 |
|        runway       | 74.38 |  88.7 |
|         case        | 38.45 | 49.69 |
|      pool table     | 91.08 | 95.24 |
|        pillow       | 52.18 | 65.02 |
|     screen door     | 39.11 | 40.02 |
|       stairway      | 30.47 | 43.32 |
|        river        |  5.27 |  13.7 |
|        bridge       | 29.94 | 36.16 |
|       bookcase      | 35.88 |  51.0 |
|        blind        | 28.65 | 32.74 |
|     coffee table    | 63.48 | 76.32 |
|        toilet       | 77.19 | 84.88 |
|        flower       | 35.71 | 49.23 |
|         book        | 44.18 |  61.4 |
|         hill        | 14.96 | 20.44 |
|        bench        | 43.95 | 52.58 |
|      countertop     | 45.49 | 67.88 |
|        stove        | 72.52 | 78.72 |
|         palm        | 45.41 | 52.56 |
|    kitchen island   | 19.47 | 33.24 |
|       computer      | 55.94 | 61.45 |
|     swivel chair    |  34.4 | 45.19 |
|         boat        | 52.78 | 56.87 |
|         bar         | 27.71 | 38.43 |
|    arcade machine   | 30.19 | 31.18 |
|        hovel        | 14.36 | 16.76 |
|         bus         | 80.17 | 95.64 |
|        towel        | 43.07 | 49.35 |
|        light        | 41.43 | 44.76 |
|        truck        |  32.2 |  42.8 |
|        tower        | 20.31 | 35.91 |
|      chandelier     |  58.2 | 75.51 |
|        awning       | 19.34 | 22.85 |
|     streetlight     | 21.78 | 28.23 |
|        booth        | 50.17 | 51.43 |
| television receiver | 64.61 | 72.63 |
|       airplane      | 56.47 | 68.56 |
|      dirt track     |  7.5  | 14.76 |
|       apparel       | 33.85 | 45.27 |
|         pole        |  18.0 | 31.13 |
|         land        |  3.49 |  6.14 |
|      bannister      | 15.39 | 21.08 |
|      escalator      | 29.96 | 36.71 |
|       ottoman       | 40.61 | 50.28 |
|        bottle       | 30.53 | 45.99 |
|        buffet       | 31.08 | 36.34 |
|        poster       | 18.61 | 19.68 |
|        stage        | 16.05 | 22.42 |
|         van         | 46.16 | 59.87 |
|         ship        |  5.2  |  6.11 |
|       fountain      | 19.66 | 20.99 |
|    conveyer belt    |  63.1 | 82.41 |
|        canopy       | 12.19 | 14.17 |
|        washer       | 67.25 | 69.51 |
|      plaything      | 20.42 | 23.77 |
|    swimming pool    | 20.41 | 31.83 |
|        stool        | 37.72 | 49.33 |
|        barrel       | 41.95 | 66.94 |
|        basket       | 29.46 | 38.89 |
|      waterfall      | 40.58 | 43.89 |
|         tent        | 79.94 | 98.07 |
|         bag         |  6.2  |  6.88 |
|       minibike      | 65.59 | 74.13 |
|        cradle       | 80.92 | 92.69 |
|         oven        |  47.6 | 71.45 |
|         ball        |  40.8 | 60.45 |
|         food        | 44.84 | 58.75 |
|         step        |  5.71 |  6.43 |
|         tank        | 44.94 | 48.77 |
|      trade name     | 26.24 | 30.51 |
|      microwave      | 54.61 |  57.6 |
|         pot         | 31.73 | 35.47 |
|        animal       | 58.01 | 59.71 |
|       bicycle       | 56.31 | 74.95 |
|         lake        | 10.83 | 10.86 |
|      dishwasher     | 57.93 | 71.06 |
|        screen       | 58.23 | 76.57 |
|       blanket       |  9.31 | 11.21 |
|      sculpture      | 55.97 | 67.54 |
|         hood        | 45.05 | 46.18 |
|        sconce       | 27.98 | 30.89 |
|         vase        | 33.86 |  42.8 |
|    traffic light    | 26.01 | 35.97 |
|         tray        |  5.53 | 11.38 |
|        ashcan       | 37.61 | 48.66 |
|         fan         | 53.55 | 64.65 |
|         pier        | 14.48 | 17.91 |
|      crt screen     |  3.74 |  8.39 |
|        plate        | 37.86 | 45.93 |
|       monitor       | 30.38 | 41.47 |
|    bulletin board   |  27.7 | 40.38 |
|        shower       |  1.69 |  7.79 |
|       radiator      |  28.6 | 34.27 |
|        glass        | 10.35 | 10.71 |
|        clock        | 31.26 | 39.39 |
|         flag        | 41.86 | 48.49 |
+---------------------+-------+-------+
10/06 01:24:39 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.6300  mIoU: 41.7900  mAcc: 52.3900  data_time: 0.0016  time: 0.3137
Finished processing corruption type: shot_noise
Processing corruption type: impulse_noise
10/06 01:24:42 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 463122540
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 463122540
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 01:24:43 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='impulse_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/impulse_noise'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 01:24:46,843 - mmseg - INFO - using core type: DCNv3
2024-10-06 01:24:46,843 - mmseg - INFO - using activation layer: GELU
2024-10-06 01:24:46,843 - mmseg - INFO - using main norm layer: LN
2024-10-06 01:24:46,843 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 01:24:46,843 - mmseg - INFO - level2_post_norm: False
2024-10-06 01:24:46,843 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 01:24:46,843 - mmseg - INFO - res_post_norm: False
2024-10-06 01:24:46,843 - mmseg - INFO - use_dcn_v4_op: False
10/06 01:24:48 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 01:24:48 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 01:24:50 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 01:24:51 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 01:25:41 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:32:26  time: 0.4549  data_time: 0.0015  memory: 21070  
10/06 01:26:06 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:49  time: 0.6004  data_time: 0.0015  memory: 11890  
10/06 01:26:21 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:27  time: 0.2733  data_time: 0.0015  memory: 10810  
10/06 01:26:42 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:36  time: 0.3693  data_time: 0.0015  memory: 11893  
10/06 01:27:02 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:19  time: 0.2180  data_time: 0.0015  memory: 11870  
10/06 01:27:19 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:59  time: 0.0968  data_time: 0.0016  memory: 11897  
10/06 01:27:38 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:08  time: 0.2576  data_time: 0.0015  memory: 11905  
10/06 01:27:53 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:10  time: 0.2570  data_time: 0.0014  memory: 11872  
10/06 01:28:02 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:56  time: 0.1950  data_time: 0.0014  memory: 9599  
10/06 01:28:09 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:53  time: 0.0905  data_time: 0.0014  memory: 10790  
10/06 01:28:17 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:03  time: 0.2606  data_time: 0.0015  memory: 10822  
10/06 01:28:25 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:18  time: 0.2414  data_time: 0.0016  memory: 9783  
10/06 01:28:36 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:47  time: 0.2855  data_time: 0.0014  memory: 10827  
10/06 01:28:50 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:23  time: 0.0982  data_time: 0.0016  memory: 11903  
10/06 01:29:04 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:02  time: 0.6009  data_time: 0.0015  memory: 10832  
10/06 01:29:10 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:28  time: 0.0892  data_time: 0.0016  memory: 10811  
10/06 01:29:15 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:56  time: 0.0913  data_time: 0.0016  memory: 776  
10/06 01:29:23 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:32  time: 0.1891  data_time: 0.0014  memory: 9040  
10/06 01:29:36 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:15  time: 0.3532  data_time: 0.0015  memory: 10906  
10/06 01:29:45 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:54  time: 0.0800  data_time: 0.0014  memory: 10908  
10/06 01:29:57 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:36  time: 0.4448  data_time: 0.0015  memory: 10829  
10/06 01:30:06 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:18  time: 0.0818  data_time: 0.0015  memory: 10804  
10/06 01:30:14 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:58  time: 0.2170  data_time: 0.0015  memory: 10792  
10/06 01:30:19 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:38  time: 0.0937  data_time: 0.0015  memory: 1962  
10/06 01:30:26 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:21  time: 0.2075  data_time: 0.0014  memory: 11893  
10/06 01:30:31 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:02  time: 0.0854  data_time: 0.0014  memory: 778  
10/06 01:30:36 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:46  time: 0.0891  data_time: 0.0015  memory: 10787  
10/06 01:30:48 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:32  time: 0.2814  data_time: 0.0014  memory: 10816  
10/06 01:30:55 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:18  time: 0.2562  data_time: 0.0015  memory: 10798  
10/06 01:31:00 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:02  time: 0.0875  data_time: 0.0014  memory: 776  
10/06 01:31:06 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:48  time: 0.0870  data_time: 0.0014  memory: 10717  
10/06 01:31:11 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:34  time: 0.0865  data_time: 0.0015  memory: 774  
10/06 01:31:21 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:22  time: 0.0873  data_time: 0.0014  memory: 11903  
10/06 01:31:30 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:10  time: 0.0899  data_time: 0.0015  memory: 10806  
10/06 01:31:37 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:58  time: 0.0959  data_time: 0.0014  memory: 10789  
10/06 01:31:43 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:45  time: 0.0936  data_time: 0.0016  memory: 10790  
10/06 01:31:47 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:33  time: 0.0874  data_time: 0.0015  memory: 724  
10/06 01:31:54 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:22  time: 0.0917  data_time: 0.0014  memory: 10829  
10/06 01:32:02 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:11  time: 0.0893  data_time: 0.0014  memory: 10795  
10/06 01:32:10 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0808  data_time: 0.0012  memory: 8666  
10/06 01:32:10 - mmengine - INFO - per class results:
10/06 01:32:10 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 71.04 |  87.8 |
|       building      | 78.66 | 90.05 |
|         sky         | 90.96 | 94.29 |
|        floor        | 76.04 | 87.49 |
|         tree        | 65.71 | 89.57 |
|       ceiling       | 77.12 | 84.17 |
|         road        | 78.24 |  87.4 |
|         bed         |  85.4 | 93.62 |
|      windowpane     | 56.25 | 73.68 |
|        grass        | 58.07 |  70.1 |
|       cabinet       | 52.03 | 64.64 |
|       sidewalk      | 55.23 | 66.65 |
|        person       | 76.55 | 88.61 |
|        earth        | 29.27 |  49.3 |
|         door        | 36.39 | 41.22 |
|        table        | 54.38 | 72.02 |
|       mountain      | 47.87 | 62.39 |
|        plant        | 41.95 | 52.09 |
|       curtain       | 59.55 | 72.65 |
|        chair        | 51.47 | 63.43 |
|         car         | 80.19 | 90.53 |
|        water        |  42.2 | 52.66 |
|       painting      | 68.07 | 80.71 |
|         sofa        | 61.66 |  85.3 |
|        shelf        | 36.08 | 51.69 |
|        house        | 43.94 | 70.65 |
|         sea         | 39.59 | 61.29 |
|        mirror       | 59.35 | 65.49 |
|         rug         | 45.65 | 52.96 |
|        field        | 25.62 | 63.45 |
|       armchair      | 37.23 | 56.08 |
|         seat        | 53.96 | 66.14 |
|        fence        |  32.0 | 52.35 |
|         desk        | 43.73 | 70.62 |
|         rock        | 41.62 | 60.91 |
|       wardrobe      | 44.38 | 68.95 |
|         lamp        | 57.45 | 65.58 |
|       bathtub       | 68.72 | 77.48 |
|       railing       | 26.59 | 35.27 |
|       cushion       | 45.92 | 51.48 |
|         base        | 11.67 | 14.97 |
|         box         | 18.48 | 24.09 |
|        column       | 37.37 | 50.74 |
|      signboard      | 33.58 | 43.08 |
|   chest of drawers  | 38.31 | 60.23 |
|       counter       | 21.48 | 28.13 |
|         sand        | 25.82 |  39.8 |
|         sink        | 64.54 | 72.31 |
|      skyscraper     | 55.17 | 72.21 |
|      fireplace      | 67.65 | 79.15 |
|     refrigerator    | 70.31 | 87.09 |
|      grandstand     | 39.49 | 71.63 |
|         path        | 24.95 | 34.79 |
|        stairs       | 27.84 | 38.14 |
|        runway       | 77.06 | 93.18 |
|         case        | 40.89 |  53.0 |
|      pool table     | 89.55 | 94.14 |
|        pillow       | 52.27 |  64.7 |
|     screen door     | 34.89 | 36.13 |
|       stairway      | 30.81 | 45.36 |
|        river        |  5.49 | 11.15 |
|        bridge       | 28.32 | 32.75 |
|       bookcase      | 35.59 | 48.66 |
|        blind        | 20.03 |  22.3 |
|     coffee table    | 63.63 | 76.39 |
|        toilet       | 75.76 | 83.32 |
|        flower       | 33.48 | 45.27 |
|         book        | 43.47 | 60.11 |
|         hill        | 16.68 | 25.73 |
|        bench        | 44.49 | 51.46 |
|      countertop     | 44.16 | 64.19 |
|        stove        | 72.62 | 78.48 |
|         palm        |  40.3 | 46.61 |
|    kitchen island   |  21.5 | 36.16 |
|       computer      | 58.11 | 62.68 |
|     swivel chair    | 35.01 | 41.34 |
|         boat        | 55.64 | 59.23 |
|         bar         | 29.98 | 38.72 |
|    arcade machine   | 32.32 | 33.57 |
|        hovel        | 16.95 | 18.47 |
|         bus         |  89.2 | 95.32 |
|        towel        | 46.88 | 50.64 |
|        light        | 40.06 | 43.13 |
|        truck        | 27.49 | 34.69 |
|        tower        | 30.47 | 51.63 |
|      chandelier     | 62.84 | 78.68 |
|        awning       | 13.95 | 15.74 |
|     streetlight     | 21.38 | 27.39 |
|        booth        | 58.77 |  63.8 |
| television receiver | 59.82 | 73.65 |
|       airplane      | 59.72 |  68.3 |
|      dirt track     |  0.0  |  0.0  |
|       apparel       | 35.27 | 46.53 |
|         pole        |  20.2 | 32.47 |
|         land        |  1.03 |  1.68 |
|      bannister      | 13.36 | 18.01 |
|      escalator      | 34.36 | 42.69 |
|       ottoman       | 43.53 | 52.17 |
|        bottle       | 26.45 |  37.6 |
|        buffet       |  40.7 | 48.12 |
|        poster       | 21.34 | 24.84 |
|        stage        | 16.28 | 22.06 |
|         van         | 41.11 | 58.51 |
|         ship        |  4.81 |  5.9  |
|       fountain      | 19.78 | 20.66 |
|    conveyer belt    | 64.62 | 80.66 |
|        canopy       | 19.52 | 22.54 |
|        washer       | 72.67 | 74.37 |
|      plaything      | 22.99 | 28.75 |
|    swimming pool    | 25.24 | 39.79 |
|        stool        | 33.97 | 42.63 |
|        barrel       | 36.79 | 39.28 |
|        basket       | 24.58 | 33.83 |
|      waterfall      | 34.41 | 37.93 |
|         tent        | 86.34 | 98.25 |
|         bag         |  6.97 |  7.48 |
|       minibike      | 52.86 | 59.29 |
|        cradle       | 78.03 | 90.11 |
|         oven        | 41.07 | 62.85 |
|         ball        | 43.32 | 56.16 |
|         food        | 45.17 | 57.06 |
|         step        |  1.93 |  2.19 |
|         tank        | 42.95 | 47.11 |
|      trade name     | 24.42 | 27.96 |
|      microwave      |  43.6 | 45.98 |
|         pot         | 28.33 | 31.06 |
|        animal       | 55.95 | 57.58 |
|       bicycle       | 54.06 | 73.85 |
|         lake        |  1.21 |  1.21 |
|      dishwasher     | 53.45 | 58.66 |
|        screen       | 47.26 | 59.29 |
|       blanket       |  8.22 |  8.83 |
|      sculpture      | 55.63 | 65.64 |
|         hood        | 45.77 | 48.51 |
|        sconce       | 27.57 | 30.98 |
|         vase        | 33.11 | 40.39 |
|    traffic light    | 26.24 | 34.06 |
|         tray        |  5.76 | 10.81 |
|        ashcan       | 33.87 |  39.4 |
|         fan         | 53.52 | 62.59 |
|         pier        |  16.1 | 18.59 |
|      crt screen     |  2.11 |  4.3  |
|        plate        |  45.4 | 54.53 |
|       monitor       | 46.44 | 60.14 |
|    bulletin board   | 27.13 | 34.91 |
|        shower       |  0.86 |  5.73 |
|       radiator      | 31.22 | 35.49 |
|        glass        | 11.24 | 11.69 |
|        clock        | 30.36 |  39.4 |
|         flag        | 29.98 | 33.01 |
+---------------------+-------+-------+
10/06 01:32:10 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.4100  mIoU: 41.5500  mAcc: 51.3300  data_time: 0.0016  time: 0.2195
Finished processing corruption type: impulse_noise
Processing corruption type: defocus_blur
10/06 01:32:13 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 155524687
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 155524687
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 01:32:15 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='defocus_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/defocus_blur'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 01:32:18,408 - mmseg - INFO - using core type: DCNv3
2024-10-06 01:32:18,408 - mmseg - INFO - using activation layer: GELU
2024-10-06 01:32:18,408 - mmseg - INFO - using main norm layer: LN
2024-10-06 01:32:18,408 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 01:32:18,408 - mmseg - INFO - level2_post_norm: False
2024-10-06 01:32:18,408 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 01:32:18,408 - mmseg - INFO - res_post_norm: False
2024-10-06 01:32:18,408 - mmseg - INFO - use_dcn_v4_op: False
10/06 01:32:20 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 01:32:20 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 01:32:21 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 01:32:23 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 01:33:13 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:32:43  time: 0.4607  data_time: 0.0015  memory: 21070  
10/06 01:33:39 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:24:06  time: 0.6162  data_time: 0.0016  memory: 11890  
10/06 01:33:54 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:42  time: 0.2809  data_time: 0.0015  memory: 10810  
10/06 01:34:15 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:51  time: 0.3784  data_time: 0.0014  memory: 11893  
10/06 01:34:36 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:35  time: 0.2256  data_time: 0.0015  memory: 11870  
10/06 01:34:54 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:14:15  time: 0.1037  data_time: 0.0015  memory: 11897  
10/06 01:35:13 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:23  time: 0.2610  data_time: 0.0014  memory: 11905  
10/06 01:35:29 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:24  time: 0.2609  data_time: 0.0014  memory: 11872  
10/06 01:35:37 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:11:10  time: 0.2067  data_time: 0.0014  memory: 9599  
10/06 01:35:45 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:10:07  time: 0.0915  data_time: 0.0014  memory: 10790  
10/06 01:35:54 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:09:16  time: 0.2658  data_time: 0.0015  memory: 10822  
10/06 01:36:01 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:30  time: 0.2525  data_time: 0.0016  memory: 9783  
10/06 01:36:13 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:58  time: 0.2863  data_time: 0.0013  memory: 10827  
10/06 01:36:27 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:34  time: 0.1001  data_time: 0.0015  memory: 11903  
10/06 01:36:42 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:07:12  time: 0.6100  data_time: 0.0014  memory: 10832  
10/06 01:36:49 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:39  time: 0.0979  data_time: 0.0015  memory: 10811  
10/06 01:36:54 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:06:06  time: 0.1017  data_time: 0.0016  memory: 776  
10/06 01:37:02 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:41  time: 0.1966  data_time: 0.0014  memory: 9040  
10/06 01:37:16 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:24  time: 0.3610  data_time: 0.0015  memory: 10906  
10/06 01:37:25 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:05:02  time: 0.0879  data_time: 0.0014  memory: 10908  
10/06 01:37:37 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:44  time: 0.4553  data_time: 0.0015  memory: 10829  
10/06 01:37:48 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:26  time: 0.1014  data_time: 0.0015  memory: 10804  
10/06 01:37:56 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:04:06  time: 0.2290  data_time: 0.0015  memory: 10792  
10/06 01:38:01 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:45  time: 0.1019  data_time: 0.0015  memory: 1962  
10/06 01:38:09 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:27  time: 0.2245  data_time: 0.0015  memory: 11893  
10/06 01:38:14 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:09  time: 0.1014  data_time: 0.0015  memory: 778  
10/06 01:38:21 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:52  time: 0.1009  data_time: 0.0015  memory: 10787  
10/06 01:38:33 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:38  time: 0.2909  data_time: 0.0014  memory: 10816  
10/06 01:38:41 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:23  time: 0.2644  data_time: 0.0014  memory: 10798  
10/06 01:38:46 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:07  time: 0.0864  data_time: 0.0014  memory: 776  
10/06 01:38:52 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:53  time: 0.1050  data_time: 0.0015  memory: 10717  
10/06 01:38:57 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:38  time: 0.1022  data_time: 0.0016  memory: 774  
10/06 01:39:08 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:25  time: 0.0976  data_time: 0.0014  memory: 11903  
10/06 01:39:17 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:13  time: 0.1057  data_time: 0.0016  memory: 10806  
10/06 01:39:26 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:00  time: 0.0955  data_time: 0.0014  memory: 10789  
10/06 01:39:32 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:47  time: 0.0976  data_time: 0.0016  memory: 10790  
10/06 01:39:37 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:35  time: 0.0997  data_time: 0.0016  memory: 724  
10/06 01:39:43 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:23  time: 0.1018  data_time: 0.0015  memory: 10829  
10/06 01:39:52 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:11  time: 0.0977  data_time: 0.0015  memory: 10795  
10/06 01:40:01 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0940  data_time: 0.0018  memory: 8666  
10/06 01:40:01 - mmengine - INFO - per class results:
10/06 01:40:01 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.01 |  87.5 |
|       building      | 79.16 | 91.75 |
|         sky         |  93.5 | 96.82 |
|        floor        | 80.02 | 90.13 |
|         tree        | 72.12 | 84.69 |
|       ceiling       | 83.23 | 90.22 |
|         road        | 82.85 | 92.07 |
|         bed         | 88.43 | 95.57 |
|      windowpane     | 59.85 |  77.2 |
|        grass        | 66.35 | 80.13 |
|       cabinet       | 57.42 | 70.77 |
|       sidewalk      | 61.81 | 71.77 |
|        person       |  75.9 | 87.99 |
|        earth        | 35.04 | 51.98 |
|         door        | 48.47 | 62.01 |
|        table        | 57.81 | 76.01 |
|       mountain      | 56.84 | 73.82 |
|        plant        | 47.85 | 60.87 |
|       curtain       | 67.91 | 82.89 |
|        chair        | 54.02 |  68.4 |
|         car         | 81.03 | 91.39 |
|        water        | 54.19 | 68.63 |
|       painting      | 68.54 | 83.42 |
|         sofa        | 63.97 |  80.8 |
|        shelf        | 37.37 | 53.67 |
|        house        | 36.32 | 52.74 |
|         sea         | 51.29 | 67.83 |
|        mirror       | 65.21 | 72.84 |
|         rug         | 57.68 | 69.08 |
|        field        | 31.28 | 44.37 |
|       armchair      | 40.84 | 62.86 |
|         seat        | 56.48 | 76.43 |
|        fence        | 42.03 | 58.92 |
|         desk        | 46.54 | 59.31 |
|         rock        | 42.95 | 69.82 |
|       wardrobe      | 50.34 | 75.16 |
|         lamp        | 60.22 | 72.95 |
|       bathtub       | 72.34 | 80.57 |
|       railing       | 29.95 | 44.05 |
|       cushion       | 52.43 | 60.76 |
|         base        | 22.91 | 33.69 |
|         box         | 20.75 | 24.91 |
|        column       | 41.74 | 52.99 |
|      signboard      | 32.78 | 42.05 |
|   chest of drawers  | 36.88 | 55.29 |
|       counter       | 26.17 | 31.95 |
|         sand        | 35.25 | 50.26 |
|         sink        | 65.39 | 75.75 |
|      skyscraper     | 48.95 | 60.15 |
|      fireplace      | 72.51 | 87.88 |
|     refrigerator    | 69.27 | 78.26 |
|      grandstand     | 34.68 | 76.11 |
|         path        | 25.05 | 36.89 |
|        stairs       | 21.51 | 27.88 |
|        runway       | 70.83 | 91.72 |
|         case        | 41.82 | 55.55 |
|      pool table     | 91.57 | 94.88 |
|        pillow       | 56.07 | 65.84 |
|     screen door     | 62.39 | 67.39 |
|       stairway      | 28.63 | 37.74 |
|        river        |  8.15 | 15.82 |
|        bridge       | 42.83 |  53.2 |
|       bookcase      | 32.42 | 54.16 |
|        blind        | 28.72 | 29.87 |
|     coffee table    | 60.52 |  82.5 |
|        toilet       | 83.17 | 88.97 |
|        flower       | 39.22 | 52.14 |
|         book        | 44.88 | 60.26 |
|         hill        | 12.97 | 18.87 |
|        bench        | 48.11 | 58.42 |
|      countertop     | 50.63 | 76.07 |
|        stove        | 74.88 | 83.45 |
|         palm        | 44.69 | 50.61 |
|    kitchen island   | 34.91 | 55.52 |
|       computer      | 65.56 | 76.17 |
|     swivel chair    | 40.81 | 60.97 |
|         boat        | 59.26 | 70.23 |
|         bar         | 25.42 | 33.62 |
|    arcade machine   | 73.62 | 79.45 |
|        hovel        | 15.73 | 16.73 |
|         bus         | 83.36 | 95.69 |
|        towel        | 60.77 | 75.51 |
|        light        | 49.25 |  56.5 |
|        truck        | 35.94 | 48.22 |
|        tower        | 20.77 | 34.06 |
|      chandelier     |  64.4 | 76.94 |
|        awning       | 19.08 | 23.73 |
|     streetlight     |  21.0 | 29.35 |
|        booth        |  43.2 | 45.05 |
| television receiver |  65.8 | 80.96 |
|       airplane      | 56.96 | 69.03 |
|      dirt track     | 20.79 | 35.54 |
|       apparel       | 25.53 | 35.58 |
|         pole        | 17.24 | 20.76 |
|         land        |  2.14 |  4.59 |
|      bannister      | 15.34 |  23.7 |
|      escalator      | 27.03 | 31.12 |
|       ottoman       | 40.22 | 51.95 |
|        bottle       | 25.12 | 36.01 |
|        buffet       | 45.35 | 51.11 |
|        poster       | 29.06 | 34.44 |
|        stage        | 19.14 | 29.22 |
|         van         |  39.1 | 43.96 |
|         ship        | 30.01 | 36.31 |
|       fountain      | 22.09 | 24.43 |
|    conveyer belt    | 63.62 | 83.06 |
|        canopy       | 36.51 | 48.14 |
|        washer       | 74.12 | 74.81 |
|      plaything      | 18.78 | 38.73 |
|    swimming pool    | 33.36 | 60.58 |
|        stool        | 36.86 | 52.35 |
|        barrel       | 38.46 | 64.47 |
|        basket       | 20.22 |  23.3 |
|      waterfall      | 64.08 | 93.75 |
|         tent        | 93.78 | 98.46 |
|         bag         |  7.0  |  7.72 |
|       minibike      | 60.97 | 73.27 |
|        cradle       | 72.86 | 96.05 |
|         oven        | 42.16 | 48.21 |
|         ball        | 44.79 | 57.55 |
|         food        | 46.23 |  54.4 |
|         step        | 13.72 | 15.02 |
|         tank        | 54.49 | 61.06 |
|      trade name     | 23.67 | 27.31 |
|      microwave      | 78.48 | 86.41 |
|         pot         | 37.56 | 43.49 |
|        animal       | 59.42 | 62.19 |
|       bicycle       | 46.32 | 56.76 |
|         lake        | 47.91 | 63.48 |
|      dishwasher     | 65.84 | 74.35 |
|        screen       | 72.86 | 86.37 |
|       blanket       |  10.8 | 12.58 |
|      sculpture      | 54.47 | 72.83 |
|         hood        | 52.48 | 55.98 |
|        sconce       | 38.04 | 50.35 |
|         vase        | 32.04 | 39.49 |
|    traffic light    | 26.97 | 43.94 |
|         tray        |  4.67 |  6.75 |
|        ashcan       | 35.33 | 50.66 |
|         fan         | 56.13 | 66.89 |
|         pier        | 54.45 | 86.33 |
|      crt screen     | 16.13 | 25.89 |
|        plate        | 36.51 | 49.72 |
|       monitor       | 30.92 | 44.94 |
|    bulletin board   | 32.58 | 43.79 |
|        shower       |  3.05 | 17.92 |
|       radiator      | 40.46 |  43.6 |
|        glass        |  7.41 |  7.72 |
|        clock        | 35.65 |  44.2 |
|         flag        | 41.72 | 45.94 |
+---------------------+-------+-------+
10/06 01:40:01 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.4000  mIoU: 46.1300  mAcc: 57.7100  data_time: 0.0016  time: 0.2291
Finished processing corruption type: defocus_blur
Processing corruption type: glass_blur
10/06 01:40:04 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1512047573
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1512047573
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 01:40:05 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='glass_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/glass_blur'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 01:40:09,050 - mmseg - INFO - using core type: DCNv3
2024-10-06 01:40:09,050 - mmseg - INFO - using activation layer: GELU
2024-10-06 01:40:09,050 - mmseg - INFO - using main norm layer: LN
2024-10-06 01:40:09,050 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 01:40:09,051 - mmseg - INFO - level2_post_norm: False
2024-10-06 01:40:09,051 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 01:40:09,051 - mmseg - INFO - res_post_norm: False
2024-10-06 01:40:09,051 - mmseg - INFO - use_dcn_v4_op: False
10/06 01:40:11 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 01:40:11 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 01:40:12 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 01:40:13 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 01:46:46 - mmengine - INFO - Iter(test) [  50/2000]    eta: 4:15:00  time: 7.7007  data_time: 0.0015  memory: 21070  
10/06 01:52:49 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 3:59:22  time: 7.6213  data_time: 0.0019  memory: 11890  
10/06 01:58:41 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 3:47:40  time: 7.2046  data_time: 0.0016  memory: 10810  
10/06 02:04:46 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 3:40:54  time: 7.1226  data_time: 0.0025  memory: 11893  
10/06 02:10:33 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 3:32:21  time: 6.8315  data_time: 0.0016  memory: 11870  
10/06 02:16:17 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 3:24:19  time: 7.0294  data_time: 0.0017  memory: 11897  
10/06 02:22:07 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 3:17:32  time: 6.5100  data_time: 0.0015  memory: 11905  
10/06 02:27:47 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 3:10:15  time: 6.9120  data_time: 0.0015  memory: 11872  
10/06 02:32:52 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 3:01:18  time: 6.2155  data_time: 0.0015  memory: 9599  
10/06 02:38:22 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 2:54:26  time: 6.4093  data_time: 0.0015  memory: 10790  
10/06 02:44:13 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 2:48:43  time: 7.0685  data_time: 0.0016  memory: 10822  
10/06 02:49:43 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 2:42:09  time: 6.9539  data_time: 0.0017  memory: 9783  
10/06 02:55:15 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 2:35:50  time: 6.8310  data_time: 0.0014  memory: 10827  
10/06 03:01:08 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 2:30:15  time: 6.8282  data_time: 0.0016  memory: 11903  
10/06 03:06:51 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 2:24:23  time: 6.9191  data_time: 0.0015  memory: 10832  
10/06 03:12:04 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 2:17:46  time: 6.6102  data_time: 0.0016  memory: 10811  
10/06 03:17:36 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 2:11:45  time: 6.7428  data_time: 0.0017  memory: 776  
10/06 03:22:45 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 2:05:18  time: 6.0003  data_time: 0.0015  memory: 9040  
10/06 03:28:29 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 1:59:39  time: 6.7438  data_time: 0.0016  memory: 10906  
10/06 03:33:49 - mmengine - INFO - Iter(test) [1000/2000]    eta: 1:53:35  time: 6.2830  data_time: 0.0015  memory: 10908  
10/06 03:39:32 - mmengine - INFO - Iter(test) [1050/2000]    eta: 1:47:56  time: 7.1845  data_time: 0.0015  memory: 10829  
10/06 03:45:06 - mmengine - INFO - Iter(test) [1100/2000]    eta: 1:42:10  time: 6.4459  data_time: 0.0016  memory: 10804  
10/06 03:50:32 - mmengine - INFO - Iter(test) [1150/2000]    eta: 1:36:19  time: 6.7264  data_time: 0.0022  memory: 10792  
10/06 03:56:06 - mmengine - INFO - Iter(test) [1200/2000]    eta: 1:30:35  time: 6.4216  data_time: 0.0015  memory: 1962  
10/06 04:01:26 - mmengine - INFO - Iter(test) [1250/2000]    eta: 1:24:43  time: 6.4804  data_time: 0.0015  memory: 11893  
10/06 04:06:35 - mmengine - INFO - Iter(test) [1300/2000]    eta: 1:18:48  time: 6.6008  data_time: 0.0015  memory: 778  
10/06 04:11:59 - mmengine - INFO - Iter(test) [1350/2000]    eta: 1:13:04  time: 6.0714  data_time: 0.0015  memory: 10787  
10/06 04:17:32 - mmengine - INFO - Iter(test) [1400/2000]    eta: 1:07:25  time: 7.0536  data_time: 0.0015  memory: 10816  
10/06 04:22:49 - mmengine - INFO - Iter(test) [1450/2000]    eta: 1:01:40  time: 6.9471  data_time: 0.0015  memory: 10798  
10/06 04:28:09 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:55:58  time: 6.1188  data_time: 0.0014  memory: 776  
10/06 04:33:53 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:50:25  time: 6.6926  data_time: 0.0015  memory: 10717  
10/06 04:39:11 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:44:44  time: 6.4692  data_time: 0.0016  memory: 774  
10/06 04:44:38 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:39:07  time: 6.0666  data_time: 0.0015  memory: 11903  
10/06 04:50:15 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:33:32  time: 6.6205  data_time: 0.0016  memory: 10806  
10/06 04:55:54 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:27:57  time: 6.5143  data_time: 0.0023  memory: 10789  
10/06 05:01:10 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:22:19  time: 6.6399  data_time: 0.0017  memory: 10790  
10/06 05:06:40 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:16:44  time: 6.6045  data_time: 0.0034  memory: 724  
10/06 05:11:52 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:11:08  time: 6.3875  data_time: 0.0015  memory: 10829  
10/06 05:17:27 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:05:34  time: 6.4023  data_time: 0.0015  memory: 10795  
10/06 05:22:48 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 5.9831  data_time: 0.0014  memory: 8666  
10/06 05:22:48 - mmengine - INFO - per class results:
10/06 05:22:48 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 73.61 | 88.57 |
|       building      | 80.09 | 88.88 |
|         sky         | 93.55 | 97.77 |
|        floor        | 77.96 |  89.3 |
|         tree        |  70.4 | 87.08 |
|       ceiling       | 82.86 | 92.14 |
|         road        | 81.65 | 91.17 |
|         bed         | 86.93 | 93.72 |
|      windowpane     | 55.61 | 72.21 |
|        grass        | 62.77 |  78.7 |
|       cabinet       | 52.99 |  66.0 |
|       sidewalk      | 56.18 | 62.32 |
|        person       | 76.86 | 89.36 |
|        earth        | 30.89 | 49.39 |
|         door        | 43.91 | 53.32 |
|        table        | 54.99 | 71.14 |
|       mountain      | 53.24 | 68.83 |
|        plant        | 45.77 | 60.64 |
|       curtain       | 59.21 |  85.2 |
|        chair        |  51.6 | 73.12 |
|         car         | 80.96 |  87.9 |
|        water        | 52.96 | 68.14 |
|       painting      | 68.18 | 82.84 |
|         sofa        | 64.43 | 79.32 |
|        shelf        | 37.03 | 56.32 |
|        house        | 45.67 |  74.4 |
|         sea         | 44.99 | 67.81 |
|        mirror       | 60.28 | 71.01 |
|         rug         | 56.12 | 73.61 |
|        field        | 24.78 | 40.91 |
|       armchair      | 37.87 | 49.38 |
|         seat        | 60.52 | 79.07 |
|        fence        | 35.65 | 59.42 |
|         desk        | 39.07 | 50.53 |
|         rock        |  31.2 |  47.6 |
|       wardrobe      | 44.45 | 66.62 |
|         lamp        | 59.05 | 68.72 |
|       bathtub       | 67.55 | 73.45 |
|       railing       | 31.38 |  35.7 |
|       cushion       | 52.08 | 67.95 |
|         base        | 14.87 | 24.42 |
|         box         | 16.74 | 22.73 |
|        column       | 39.22 | 52.31 |
|      signboard      | 32.01 | 40.44 |
|   chest of drawers  | 37.75 | 58.15 |
|       counter       | 18.09 | 22.33 |
|         sand        | 29.71 | 52.54 |
|         sink        | 63.58 | 70.85 |
|      skyscraper     | 58.18 | 74.06 |
|      fireplace      | 70.86 | 80.06 |
|     refrigerator    | 54.68 | 58.97 |
|      grandstand     |  34.9 | 80.26 |
|         path        | 21.29 | 28.82 |
|        stairs       | 31.01 | 41.61 |
|        runway       | 72.31 | 86.78 |
|         case        | 39.92 | 50.66 |
|      pool table     | 90.43 | 92.19 |
|        pillow       | 53.28 | 60.62 |
|     screen door     | 36.67 | 37.27 |
|       stairway      | 31.23 | 35.03 |
|        river        |  6.0  | 10.92 |
|        bridge       | 36.43 | 39.53 |
|       bookcase      | 20.89 | 23.75 |
|        blind        | 18.13 | 18.64 |
|     coffee table    | 62.16 | 79.59 |
|        toilet       | 81.77 | 84.89 |
|        flower       | 36.29 | 58.96 |
|         book        | 32.06 | 39.13 |
|         hill        | 14.04 | 22.27 |
|        bench        | 40.36 | 46.76 |
|      countertop     | 44.24 |  51.2 |
|        stove        | 65.51 | 69.62 |
|         palm        | 39.79 | 45.18 |
|    kitchen island   | 33.42 | 55.89 |
|       computer      | 51.73 | 58.03 |
|     swivel chair    | 41.02 | 57.12 |
|         boat        |  60.8 | 64.67 |
|         bar         | 21.14 | 24.76 |
|    arcade machine   | 67.63 | 75.77 |
|        hovel        | 21.78 | 27.14 |
|         bus         | 83.21 | 84.68 |
|        towel        | 51.37 | 60.56 |
|        light        | 45.48 | 52.39 |
|        truck        | 28.77 | 39.31 |
|        tower        | 32.28 | 47.35 |
|      chandelier     | 65.75 | 78.23 |
|        awning       | 20.85 | 24.89 |
|     streetlight     | 16.48 | 20.45 |
|        booth        | 19.15 | 19.33 |
| television receiver | 60.58 | 65.95 |
|       airplane      | 51.01 | 58.03 |
|      dirt track     |  4.43 | 11.36 |
|       apparel       | 35.24 | 46.76 |
|         pole        | 16.79 | 23.98 |
|         land        |  2.76 |  5.85 |
|      bannister      |  6.19 |  7.27 |
|      escalator      | 19.22 | 19.59 |
|       ottoman       | 42.33 | 59.23 |
|        bottle       | 25.71 | 33.87 |
|        buffet       | 30.85 | 31.82 |
|        poster       | 21.56 | 30.95 |
|        stage        | 17.68 | 26.97 |
|         van         | 43.88 | 57.24 |
|         ship        |  6.52 |  7.31 |
|       fountain      | 21.75 | 25.47 |
|    conveyer belt    | 53.94 | 57.56 |
|        canopy       | 31.52 | 36.46 |
|        washer       | 53.06 | 53.38 |
|      plaything      | 18.65 | 35.79 |
|    swimming pool    | 46.79 | 84.37 |
|        stool        | 34.13 | 56.43 |
|        barrel       | 40.18 | 64.38 |
|        basket       | 23.03 | 26.51 |
|      waterfall      | 53.82 | 74.39 |
|         tent        | 94.88 | 97.38 |
|         bag         |  6.5  |  6.67 |
|       minibike      | 59.96 | 67.75 |
|        cradle       | 72.43 | 95.56 |
|         oven        | 38.91 |  48.4 |
|         ball        | 40.36 | 63.71 |
|         food        | 40.69 | 46.16 |
|         step        |  9.49 |  9.55 |
|         tank        | 57.84 | 61.89 |
|      trade name     | 19.54 | 21.98 |
|      microwave      |  36.0 |  37.1 |
|         pot         | 32.14 | 34.51 |
|        animal       | 55.33 | 56.92 |
|       bicycle       | 50.75 | 66.81 |
|         lake        | 60.52 | 61.26 |
|      dishwasher     | 47.31 | 52.67 |
|        screen       | 60.72 | 70.52 |
|       blanket       |  6.46 |  7.83 |
|      sculpture      | 23.72 | 24.11 |
|         hood        |  30.4 | 30.81 |
|        sconce       | 35.84 |  43.3 |
|         vase        | 26.33 | 28.99 |
|    traffic light    | 25.14 | 31.83 |
|         tray        |  4.09 |  7.15 |
|        ashcan       |  38.7 | 42.05 |
|         fan         | 51.43 | 57.99 |
|         pier        | 10.95 | 16.04 |
|      crt screen     | 13.71 | 29.74 |
|        plate        | 23.81 | 27.24 |
|       monitor       | 53.05 | 65.29 |
|    bulletin board   | 24.66 | 35.41 |
|        shower       |  2.18 | 14.92 |
|       radiator      | 41.06 | 45.26 |
|        glass        |  5.55 |  5.64 |
|        clock        | 30.44 | 33.85 |
|         flag        |  30.4 | 32.99 |
+---------------------+-------+-------+
10/06 05:22:48 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.0400  mIoU: 42.0900  mAcc: 51.9400  data_time: 0.0018  time: 6.6771
Finished processing corruption type: glass_blur
Processing corruption type: motion_blur
10/06 05:22:54 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 910976643
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 910976643
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 05:22:55 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='motion_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/motion_blur'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 05:23:00,279 - mmseg - INFO - using core type: DCNv3
2024-10-06 05:23:00,279 - mmseg - INFO - using activation layer: GELU
2024-10-06 05:23:00,280 - mmseg - INFO - using main norm layer: LN
2024-10-06 05:23:00,280 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 05:23:00,280 - mmseg - INFO - level2_post_norm: False
2024-10-06 05:23:00,280 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 05:23:00,280 - mmseg - INFO - res_post_norm: False
2024-10-06 05:23:00,280 - mmseg - INFO - use_dcn_v4_op: False
10/06 05:23:02 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 05:23:02 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 05:23:04 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 05:23:06 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 05:24:33 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:57:04  time: 1.1842  data_time: 0.0015  memory: 21070  
10/06 05:25:35 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:47:16  time: 1.3207  data_time: 0.0015  memory: 11890  
10/06 05:26:24 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:40:50  time: 0.9758  data_time: 0.0015  memory: 10810  
10/06 05:27:21 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:38:19  time: 1.0928  data_time: 0.0015  memory: 11893  
10/06 05:28:17 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:36:16  time: 0.9299  data_time: 0.0014  memory: 11870  
10/06 05:29:09 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:34:17  time: 0.8325  data_time: 0.0015  memory: 11897  
10/06 05:30:02 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:32:44  time: 0.9383  data_time: 0.0014  memory: 11905  
10/06 05:30:53 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:31:08  time: 0.9725  data_time: 0.0014  memory: 11872  
10/06 05:31:32 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:29:04  time: 0.8321  data_time: 0.0014  memory: 9599  
10/06 05:32:15 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:27:27  time: 0.7437  data_time: 0.0014  memory: 10790  
10/06 05:32:59 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:26:03  time: 0.9886  data_time: 0.0015  memory: 10822  
10/06 05:33:39 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:24:37  time: 0.9265  data_time: 0.0016  memory: 9783  
10/06 05:34:25 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:23:30  time: 0.9893  data_time: 0.0014  memory: 10827  
10/06 05:35:15 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:22:35  time: 0.8078  data_time: 0.0015  memory: 11903  
10/06 05:36:07 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:21:41  time: 1.3075  data_time: 0.0015  memory: 10832  
10/06 05:36:45 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:20:29  time: 0.7613  data_time: 0.0015  memory: 10811  
10/06 05:37:23 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:19:20  time: 0.7733  data_time: 0.0016  memory: 776  
10/06 05:38:04 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:18:17  time: 0.8345  data_time: 0.0014  memory: 9040  
10/06 05:38:53 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:17:27  time: 1.0514  data_time: 0.0015  memory: 10906  
10/06 05:39:36 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:16:30  time: 0.7637  data_time: 0.0015  memory: 10908  
10/06 05:40:24 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:15:39  time: 1.2150  data_time: 0.0014  memory: 10829  
10/06 05:41:09 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:14:46  time: 0.7707  data_time: 0.0015  memory: 10804  
10/06 05:41:51 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:13:51  time: 0.9099  data_time: 0.0014  memory: 10792  
10/06 05:42:31 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:12:57  time: 0.7630  data_time: 0.0014  memory: 1962  
10/06 05:43:14 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:12:04  time: 0.9004  data_time: 0.0014  memory: 11893  
10/06 05:43:51 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:11:10  time: 0.7678  data_time: 0.0014  memory: 778  
10/06 05:44:32 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:10:19  time: 0.7272  data_time: 0.0014  memory: 10787  
10/06 05:45:18 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:09:31  time: 1.0458  data_time: 0.0014  memory: 10816  
10/06 05:46:00 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:08:41  time: 1.0087  data_time: 0.0015  memory: 10798  
10/06 05:46:39 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:07:50  time: 0.7378  data_time: 0.0014  memory: 776  
10/06 05:47:21 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:07:02  time: 0.8246  data_time: 0.0015  memory: 10717  
10/06 05:47:58 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:06:13  time: 0.7449  data_time: 0.0016  memory: 774  
10/06 05:48:42 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:05:25  time: 0.7518  data_time: 0.0014  memory: 11903  
10/06 05:49:27 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:39  time: 0.8085  data_time: 0.0016  memory: 10806  
10/06 05:50:10 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:52  time: 0.8184  data_time: 0.0015  memory: 10789  
10/06 05:50:49 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:04  time: 0.7736  data_time: 0.0016  memory: 10790  
10/06 05:51:28 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:17  time: 0.7480  data_time: 0.0016  memory: 724  
10/06 05:52:06 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:31  time: 0.7829  data_time: 0.0014  memory: 10829  
10/06 05:52:50 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:45  time: 0.7811  data_time: 0.0014  memory: 10795  
10/06 05:53:32 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6846  data_time: 0.0014  memory: 8666  
10/06 05:53:32 - mmengine - INFO - per class results:
10/06 05:53:32 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 74.36 | 84.53 |
|       building      | 77.69 | 92.59 |
|         sky         | 93.25 | 96.15 |
|        floor        | 78.46 | 89.69 |
|         tree        | 71.48 | 84.78 |
|       ceiling       | 83.82 | 92.86 |
|         road        |  83.0 | 90.01 |
|         bed         | 87.68 | 95.17 |
|      windowpane     | 59.54 | 75.93 |
|        grass        | 63.98 | 83.15 |
|       cabinet       | 57.04 | 68.72 |
|       sidewalk      | 62.94 | 77.98 |
|        person       | 76.05 | 89.82 |
|        earth        | 32.42 | 47.29 |
|         door        | 46.89 | 61.43 |
|        table        | 57.62 | 74.61 |
|       mountain      | 55.15 | 68.44 |
|        plant        | 48.11 | 62.53 |
|       curtain       | 65.81 | 82.65 |
|        chair        | 54.04 | 69.79 |
|         car         | 80.29 | 91.13 |
|        water        | 57.34 | 72.95 |
|       painting      | 66.35 | 84.43 |
|         sofa        | 62.89 | 80.71 |
|        shelf        | 36.63 | 60.59 |
|        house        | 33.03 | 46.91 |
|         sea         | 58.93 | 79.53 |
|        mirror       | 65.04 | 73.63 |
|         rug         | 52.96 | 66.34 |
|        field        | 25.02 | 34.62 |
|       armchair      |  38.5 | 58.86 |
|         seat        |  59.0 | 78.18 |
|        fence        |  34.6 | 55.39 |
|         desk        | 45.27 | 61.77 |
|         rock        | 37.81 | 58.74 |
|       wardrobe      | 50.22 | 72.98 |
|         lamp        | 58.71 | 72.72 |
|       bathtub       | 74.42 | 82.24 |
|       railing       | 31.99 | 47.26 |
|       cushion       | 55.05 | 65.25 |
|         base        | 17.02 | 22.55 |
|         box         | 22.39 |  28.4 |
|        column       | 41.74 | 56.21 |
|      signboard      | 34.43 | 46.02 |
|   chest of drawers  | 32.61 | 58.76 |
|       counter       | 25.59 | 31.29 |
|         sand        | 32.69 | 55.41 |
|         sink        | 67.55 | 76.07 |
|      skyscraper     |  33.9 | 42.26 |
|      fireplace      | 67.17 | 89.57 |
|     refrigerator    | 69.06 | 82.78 |
|      grandstand     | 39.65 | 75.71 |
|         path        | 23.04 | 33.37 |
|        stairs       | 23.63 |  29.5 |
|        runway       | 71.27 | 94.05 |
|         case        |  40.8 | 49.45 |
|      pool table     | 90.77 | 94.93 |
|        pillow       | 56.49 | 67.24 |
|     screen door     | 66.11 | 74.38 |
|       stairway      | 28.82 | 34.32 |
|        river        | 10.97 | 15.68 |
|        bridge       |  33.4 | 38.92 |
|       bookcase      | 36.12 | 54.42 |
|        blind        | 31.61 | 39.28 |
|     coffee table    | 60.66 | 80.02 |
|        toilet       | 83.79 |  89.4 |
|        flower       | 37.05 |  47.7 |
|         book        | 44.03 | 60.92 |
|         hill        | 10.78 | 15.98 |
|        bench        | 42.52 | 51.43 |
|      countertop     | 47.12 | 68.99 |
|        stove        | 74.02 | 81.05 |
|         palm        | 42.98 | 55.65 |
|    kitchen island   | 33.51 | 53.64 |
|       computer      | 67.11 | 77.03 |
|     swivel chair    | 40.51 | 60.73 |
|         boat        | 69.73 | 80.01 |
|         bar         | 22.95 | 30.06 |
|    arcade machine   | 59.48 | 63.53 |
|        hovel        |  3.1  |  3.28 |
|         bus         | 87.65 | 94.63 |
|        towel        | 61.04 | 73.49 |
|        light        | 51.96 | 61.12 |
|        truck        | 30.22 | 47.52 |
|        tower        | 32.05 |  45.0 |
|      chandelier     | 64.07 | 74.38 |
|        awning       | 23.01 | 30.54 |
|     streetlight     | 19.57 | 25.73 |
|        booth        | 41.12 | 42.66 |
| television receiver | 63.76 | 77.17 |
|       airplane      |  58.3 | 68.79 |
|      dirt track     | 14.91 | 38.78 |
|       apparel       | 22.04 | 31.97 |
|         pole        | 17.55 | 25.46 |
|         land        |  4.67 |  6.52 |
|      bannister      | 13.75 | 19.53 |
|      escalator      | 28.57 | 36.02 |
|       ottoman       | 43.77 |  54.0 |
|        bottle       | 25.09 | 31.79 |
|        buffet       | 35.74 | 39.11 |
|        poster       | 27.05 | 37.73 |
|        stage        | 17.35 | 26.19 |
|         van         | 44.58 | 52.73 |
|         ship        |  6.01 |  6.71 |
|       fountain      | 20.59 | 21.94 |
|    conveyer belt    | 63.91 |  82.9 |
|        canopy       | 39.49 |  49.5 |
|        washer       | 76.11 | 77.27 |
|      plaything      | 23.08 | 34.27 |
|    swimming pool    | 33.67 | 53.61 |
|        stool        | 37.11 | 51.76 |
|        barrel       | 32.87 | 64.88 |
|        basket       | 26.28 | 41.18 |
|      waterfall      | 39.56 | 45.32 |
|         tent        |  94.5 | 97.99 |
|         bag         | 10.87 | 14.01 |
|       minibike      | 49.89 | 65.24 |
|        cradle       |  79.3 | 94.15 |
|         oven        | 51.92 | 64.15 |
|         ball        |  51.8 | 63.42 |
|         food        | 42.02 | 47.89 |
|         step        |  7.96 |  8.58 |
|         tank        | 55.97 | 61.52 |
|      trade name     | 25.99 | 31.29 |
|      microwave      |  81.3 | 86.74 |
|         pot         | 34.91 | 40.72 |
|        animal       | 57.98 | 60.15 |
|       bicycle       | 41.23 | 75.49 |
|         lake        | 59.03 | 60.69 |
|      dishwasher     | 62.93 | 80.21 |
|        screen       | 72.31 | 86.85 |
|       blanket       | 15.69 | 18.99 |
|      sculpture      | 54.58 | 60.29 |
|         hood        | 58.14 | 61.43 |
|        sconce       | 40.06 | 52.74 |
|         vase        |  32.0 | 36.53 |
|    traffic light    | 27.22 | 42.45 |
|         tray        |  6.07 |  8.13 |
|        ashcan       | 31.72 | 50.76 |
|         fan         |  54.2 | 74.49 |
|         pier        | 36.58 | 52.02 |
|      crt screen     |  5.03 |  6.27 |
|        plate        | 43.25 |  64.7 |
|       monitor       | 42.15 | 59.25 |
|    bulletin board   |  35.0 | 49.63 |
|        shower       |  5.34 | 18.85 |
|       radiator      | 53.23 | 61.72 |
|        glass        | 10.59 | 11.18 |
|        clock        | 32.06 |  39.6 |
|         flag        | 35.41 | 37.59 |
+---------------------+-------+-------+
10/06 05:53:32 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 80.8500  mIoU: 45.4300  mAcc: 57.0600  data_time: 0.0016  time: 0.9133
Finished processing corruption type: motion_blur
Processing corruption type: zoom_blur
10/06 05:53:36 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 147066472
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 147066472
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 05:53:37 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='zoom_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/zoom_blur'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 05:53:40,608 - mmseg - INFO - using core type: DCNv3
2024-10-06 05:53:40,608 - mmseg - INFO - using activation layer: GELU
2024-10-06 05:53:40,608 - mmseg - INFO - using main norm layer: LN
2024-10-06 05:53:40,608 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 05:53:40,608 - mmseg - INFO - level2_post_norm: False
2024-10-06 05:53:40,608 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 05:53:40,608 - mmseg - INFO - res_post_norm: False
2024-10-06 05:53:40,608 - mmseg - INFO - use_dcn_v4_op: False
10/06 05:53:42 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 05:53:42 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 05:53:43 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 05:53:45 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 05:55:06 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:52:59  time: 1.1433  data_time: 0.0015  memory: 21070  
10/06 05:56:03 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:43:55  time: 1.2709  data_time: 0.0015  memory: 11890  
10/06 05:56:50 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:38:03  time: 0.9242  data_time: 0.0015  memory: 10810  
10/06 05:57:43 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:35:46  time: 1.0148  data_time: 0.0015  memory: 11893  
10/06 05:58:35 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:33:48  time: 0.8335  data_time: 0.0014  memory: 11870  
10/06 05:59:22 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:31:52  time: 0.7527  data_time: 0.0015  memory: 11897  
10/06 06:00:12 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:30:27  time: 0.8379  data_time: 0.0014  memory: 11905  
10/06 06:00:59 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:28:57  time: 0.9084  data_time: 0.0014  memory: 11872  
10/06 06:01:36 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:27:01  time: 0.7762  data_time: 0.0014  memory: 9599  
10/06 06:02:14 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:25:28  time: 0.6931  data_time: 0.0015  memory: 10790  
10/06 06:02:56 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:24:12  time: 0.9170  data_time: 0.0016  memory: 10822  
10/06 06:03:34 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:22:54  time: 0.8749  data_time: 0.0016  memory: 9783  
10/06 06:04:16 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:21:51  time: 0.9143  data_time: 0.0014  memory: 10827  
10/06 06:05:03 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:20:59  time: 0.7641  data_time: 0.0033  memory: 11903  
10/06 06:05:49 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:20:07  time: 1.2092  data_time: 0.0014  memory: 10832  
10/06 06:06:25 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:19:00  time: 0.7252  data_time: 0.0016  memory: 10811  
10/06 06:07:01 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:17:57  time: 0.7441  data_time: 0.0016  memory: 776  
10/06 06:07:39 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:16:59  time: 0.7600  data_time: 0.0015  memory: 9040  
10/06 06:08:24 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:16:11  time: 0.9835  data_time: 0.0015  memory: 10906  
10/06 06:09:03 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:15:18  time: 0.7020  data_time: 0.0015  memory: 10908  
10/06 06:09:47 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:14:30  time: 1.1068  data_time: 0.0015  memory: 10829  
10/06 06:10:28 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:13:41  time: 0.7025  data_time: 0.0015  memory: 10804  
10/06 06:11:07 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:12:50  time: 0.8491  data_time: 0.0015  memory: 10792  
10/06 06:11:43 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:11:59  time: 0.7153  data_time: 0.0015  memory: 1962  
10/06 06:12:21 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:11:09  time: 0.8348  data_time: 0.0015  memory: 11893  
10/06 06:12:55 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:10:19  time: 0.7212  data_time: 0.0015  memory: 778  
10/06 06:13:32 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:09:31  time: 0.6470  data_time: 0.0014  memory: 10787  
10/06 06:14:14 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:08:46  time: 0.9344  data_time: 0.0014  memory: 10816  
10/06 06:14:51 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:08:00  time: 0.8862  data_time: 0.0014  memory: 10798  
10/06 06:15:26 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:07:13  time: 0.6637  data_time: 0.0014  memory: 776  
10/06 06:16:05 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:06:29  time: 0.7334  data_time: 0.0015  memory: 10717  
10/06 06:16:41 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:43  time: 0.7373  data_time: 0.0016  memory: 774  
10/06 06:17:22 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:05:00  time: 0.7204  data_time: 0.0014  memory: 11903  
10/06 06:18:03 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:17  time: 0.7307  data_time: 0.0016  memory: 10806  
10/06 06:18:43 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:34  time: 0.7235  data_time: 0.0014  memory: 10789  
10/06 06:19:19 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:50  time: 0.7371  data_time: 0.0016  memory: 10790  
10/06 06:19:55 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:07  time: 0.7166  data_time: 0.0016  memory: 724  
10/06 06:20:30 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:24  time: 0.6929  data_time: 0.0014  memory: 10829  
10/06 06:21:10 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:42  time: 0.6781  data_time: 0.0014  memory: 10795  
10/06 06:21:48 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6436  data_time: 0.0014  memory: 8666  
10/06 06:21:48 - mmengine - INFO - per class results:
10/06 06:21:48 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 56.56 | 84.14 |
|       building      | 64.26 | 85.23 |
|         sky         | 84.96 |  89.5 |
|        floor        | 55.62 | 86.26 |
|         tree        | 39.23 |  46.5 |
|       ceiling       | 59.86 | 88.26 |
|         road        | 56.88 | 63.82 |
|         bed         | 73.44 | 87.98 |
|      windowpane     | 41.18 | 53.25 |
|        grass        | 46.75 | 68.65 |
|       cabinet       | 42.29 | 52.63 |
|       sidewalk      | 29.73 | 46.42 |
|        person       | 56.53 | 75.67 |
|        earth        | 15.11 | 20.48 |
|         door        | 16.21 | 18.68 |
|        table        | 40.74 | 51.28 |
|       mountain      | 25.82 | 30.22 |
|        plant        | 18.81 | 25.68 |
|       curtain       | 40.92 | 62.83 |
|        chair        | 30.94 | 39.85 |
|         car         | 61.85 | 77.07 |
|        water        | 37.24 | 55.43 |
|       painting      | 48.73 | 67.98 |
|         sofa        |  41.3 |  57.6 |
|        shelf        | 21.32 | 33.62 |
|        house        |  15.8 | 17.23 |
|         sea         | 40.56 | 48.75 |
|        mirror       | 44.24 | 48.74 |
|         rug         | 14.57 | 14.79 |
|        field        | 13.86 | 38.54 |
|       armchair      | 29.16 | 48.07 |
|         seat        |  30.7 | 41.24 |
|        fence        | 12.39 | 25.63 |
|         desk        | 33.08 | 40.14 |
|         rock        | 13.92 |  14.6 |
|       wardrobe      | 30.61 | 47.91 |
|         lamp        | 35.47 | 46.01 |
|       bathtub       | 65.81 | 81.06 |
|       railing       | 11.84 | 15.38 |
|       cushion       | 26.29 | 30.64 |
|         base        |  9.18 | 10.67 |
|         box         |  4.28 |  5.02 |
|        column       | 13.79 | 16.01 |
|      signboard      | 18.86 | 22.06 |
|   chest of drawers  | 29.03 | 33.48 |
|       counter       | 15.75 | 23.35 |
|         sand        | 10.05 | 29.84 |
|         sink        |  51.7 | 60.75 |
|      skyscraper     | 28.12 |  34.8 |
|      fireplace      | 58.05 | 65.04 |
|     refrigerator    |  34.6 | 38.68 |
|      grandstand     | 19.96 | 45.87 |
|         path        |  5.97 |  6.99 |
|        stairs       |  1.58 |  1.68 |
|        runway       | 57.95 | 83.13 |
|         case        |  4.62 |  5.0  |
|      pool table     | 77.49 | 82.05 |
|        pillow       | 35.43 | 46.11 |
|     screen door     | 43.76 | 48.65 |
|       stairway      | 16.76 | 17.62 |
|        river        |  2.51 |  3.11 |
|        bridge       |  17.3 | 22.48 |
|       bookcase      | 25.06 | 43.28 |
|        blind        | 16.88 | 21.21 |
|     coffee table    | 36.18 | 41.38 |
|        toilet       | 68.77 | 75.01 |
|        flower       | 16.42 | 19.95 |
|         book        | 31.09 | 40.19 |
|         hill        |  2.6  |  5.68 |
|        bench        | 31.49 | 35.82 |
|      countertop     | 43.69 | 56.29 |
|        stove        | 61.17 | 68.08 |
|         palm        | 20.61 | 42.07 |
|    kitchen island   |  20.7 | 22.35 |
|       computer      | 42.37 |  46.7 |
|     swivel chair    | 18.56 | 22.88 |
|         boat        | 13.93 | 14.03 |
|         bar         |  0.94 |  1.04 |
|    arcade machine   | 12.57 | 13.41 |
|        hovel        |  6.14 |  7.01 |
|         bus         | 70.75 | 76.77 |
|        towel        | 26.51 | 33.45 |
|        light        | 18.13 |  21.4 |
|        truck        | 15.17 |  16.6 |
|        tower        | 45.34 | 56.09 |
|      chandelier     |  20.9 | 21.85 |
|        awning       |  7.56 |  8.43 |
|     streetlight     |  2.38 |  2.48 |
|        booth        | 17.02 | 17.19 |
| television receiver | 44.75 | 56.57 |
|       airplane      | 40.19 | 55.41 |
|      dirt track     |  6.6  |  9.23 |
|       apparel       |  1.48 |  1.71 |
|         pole        |  5.29 |  5.66 |
|         land        |  1.05 |  2.26 |
|      bannister      |  2.66 |  4.99 |
|      escalator      | 13.62 | 20.43 |
|       ottoman       | 18.93 | 20.77 |
|        bottle       |  7.24 |  7.46 |
|        buffet       |  1.4  |  1.4  |
|        poster       |  8.0  | 13.44 |
|        stage        |  3.8  |  4.71 |
|         van         |  7.53 |  7.72 |
|         ship        |  4.35 |  6.56 |
|       fountain      |  0.36 |  0.41 |
|    conveyer belt    |  23.1 | 31.17 |
|        canopy       |  4.36 |  4.41 |
|        washer       | 71.66 | 76.08 |
|      plaything      |  7.13 |  8.02 |
|    swimming pool    | 13.95 | 20.89 |
|        stool        | 18.86 | 21.88 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 14.86 | 17.27 |
|      waterfall      | 17.11 | 24.76 |
|         tent        | 82.76 | 99.29 |
|         bag         |  5.47 |  6.43 |
|       minibike      | 46.29 |  57.6 |
|        cradle       | 58.17 | 68.66 |
|         oven        | 23.92 | 26.88 |
|         ball        |  1.15 |  2.5  |
|         food        |  2.73 |  2.8  |
|         step        |  5.66 |  5.92 |
|         tank        | 37.45 | 39.07 |
|      trade name     | 13.13 | 14.42 |
|      microwave      | 22.77 | 24.34 |
|         pot         | 10.54 | 11.05 |
|        animal       | 39.38 |  42.1 |
|       bicycle       | 18.97 | 24.24 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 27.03 | 39.21 |
|        screen       | 59.48 | 86.55 |
|       blanket       |  2.34 |  2.46 |
|      sculpture      | 12.77 | 14.43 |
|         hood        | 33.66 | 39.03 |
|        sconce       | 15.07 | 18.52 |
|         vase        | 10.56 | 12.39 |
|    traffic light    | 10.22 | 10.79 |
|         tray        |  3.52 |  4.42 |
|        ashcan       | 22.31 |  25.2 |
|         fan         | 28.64 | 40.15 |
|         pier        | 35.29 | 37.36 |
|      crt screen     |  1.2  |  1.28 |
|        plate        | 16.89 | 21.32 |
|       monitor       | 41.48 | 50.73 |
|    bulletin board   |  8.77 | 10.66 |
|        shower       |  1.55 |  2.33 |
|       radiator      | 27.17 |  37.2 |
|        glass        |  0.36 |  0.37 |
|        clock        |  6.74 |  7.21 |
|         flag        | 16.07 | 20.84 |
+---------------------+-------+-------+
10/06 06:21:48 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 66.2900  mIoU: 25.7500  mAcc: 32.6100  data_time: 0.0017  time: 0.8416
Finished processing corruption type: zoom_blur
Processing corruption type: snow
10/06 06:21:53 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1746789857
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1746789857
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 06:21:55 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='snow',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/snow'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 06:21:58,226 - mmseg - INFO - using core type: DCNv3
2024-10-06 06:21:58,226 - mmseg - INFO - using activation layer: GELU
2024-10-06 06:21:58,226 - mmseg - INFO - using main norm layer: LN
2024-10-06 06:21:58,226 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 06:21:58,226 - mmseg - INFO - level2_post_norm: False
2024-10-06 06:21:58,227 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 06:21:58,227 - mmseg - INFO - res_post_norm: False
2024-10-06 06:21:58,227 - mmseg - INFO - use_dcn_v4_op: False
10/06 06:22:00 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 06:22:00 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 06:22:01 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 06:22:02 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 06:23:03 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:39:16  time: 0.6864  data_time: 0.0016  memory: 21070  
10/06 06:23:39 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:30:35  time: 0.8325  data_time: 0.0016  memory: 11890  
10/06 06:24:04 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:25:03  time: 0.5024  data_time: 0.0015  memory: 10810  
10/06 06:24:36 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:23:06  time: 0.5899  data_time: 0.0015  memory: 11893  
10/06 06:25:08 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:21:36  time: 0.4227  data_time: 0.0015  memory: 11870  
10/06 06:25:35 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:20:05  time: 0.3158  data_time: 0.0016  memory: 11897  
10/06 06:26:05 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:19:02  time: 0.4592  data_time: 0.0015  memory: 11905  
10/06 06:26:31 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:17:53  time: 0.4675  data_time: 0.0014  memory: 11872  
10/06 06:26:49 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:16:25  time: 0.3803  data_time: 0.0014  memory: 9599  
10/06 06:27:06 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:15:12  time: 0.2869  data_time: 0.0015  memory: 10790  
10/06 06:27:26 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:14:12  time: 0.4737  data_time: 0.0016  memory: 10822  
10/06 06:27:44 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:13:16  time: 0.4729  data_time: 0.0025  memory: 9783  
10/06 06:28:06 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:12:35  time: 0.4938  data_time: 0.0014  memory: 10827  
10/06 06:28:31 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:12:01  time: 0.3113  data_time: 0.0016  memory: 11903  
10/06 06:28:56 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:11:29  time: 0.8101  data_time: 0.0015  memory: 10832  
10/06 06:29:12 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:10:44  time: 0.3012  data_time: 0.0016  memory: 10811  
10/06 06:29:28 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:10:02  time: 0.2923  data_time: 0.0016  memory: 776  
10/06 06:29:46 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:09:26  time: 0.3727  data_time: 0.0014  memory: 9040  
10/06 06:30:10 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:08:59  time: 0.5506  data_time: 0.0015  memory: 10906  
10/06 06:30:29 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:08:26  time: 0.2824  data_time: 0.0015  memory: 10908  
10/06 06:30:52 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:07:58  time: 0.6565  data_time: 0.0014  memory: 10829  
10/06 06:31:13 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:07:30  time: 0.3019  data_time: 0.0015  memory: 10804  
10/06 06:31:31 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:07:00  time: 0.4292  data_time: 0.0015  memory: 10792  
10/06 06:31:47 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:06:29  time: 0.2898  data_time: 0.0015  memory: 1962  
10/06 06:32:05 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:06:01  time: 0.4248  data_time: 0.0015  memory: 11893  
10/06 06:32:19 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:05:32  time: 0.3098  data_time: 0.0015  memory: 778  
10/06 06:32:36 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:05:04  time: 0.2914  data_time: 0.0015  memory: 10787  
10/06 06:32:58 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:04:41  time: 0.5195  data_time: 0.0015  memory: 10816  
10/06 06:33:16 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:04:15  time: 0.4748  data_time: 0.0014  memory: 10798  
10/06 06:33:31 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:49  time: 0.2751  data_time: 0.0015  memory: 776  
10/06 06:33:48 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:03:24  time: 0.2993  data_time: 0.0015  memory: 10717  
10/06 06:34:03 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:03:00  time: 0.3045  data_time: 0.0016  memory: 774  
10/06 06:34:23 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:37  time: 0.2898  data_time: 0.0014  memory: 11903  
10/06 06:34:43 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:02:14  time: 0.3101  data_time: 0.0016  memory: 10806  
10/06 06:35:02 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:51  time: 0.3170  data_time: 0.0014  memory: 10789  
10/06 06:35:18 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:28  time: 0.3183  data_time: 0.0016  memory: 10790  
10/06 06:35:33 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:05  time: 0.3015  data_time: 0.0016  memory: 724  
10/06 06:35:49 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:43  time: 0.2844  data_time: 0.0014  memory: 10829  
10/06 06:36:08 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:21  time: 0.2868  data_time: 0.0015  memory: 10795  
10/06 06:36:27 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2652  data_time: 0.0014  memory: 8666  
10/06 06:36:27 - mmengine - INFO - per class results:
10/06 06:36:27 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  67.7 | 85.55 |
|       building      |  74.6 | 92.45 |
|         sky         |  89.1 | 92.33 |
|        floor        | 71.03 |  90.1 |
|         tree        |  67.7 | 83.42 |
|       ceiling       |  73.1 | 84.24 |
|         road        | 63.82 | 67.85 |
|         bed         | 83.08 | 90.51 |
|      windowpane     | 55.12 | 70.35 |
|        grass        | 57.64 | 74.89 |
|       cabinet       | 49.22 | 59.87 |
|       sidewalk      | 44.91 | 76.88 |
|        person       |  73.9 | 87.54 |
|        earth        | 25.11 | 31.48 |
|         door        | 25.38 | 28.47 |
|        table        | 48.22 | 64.56 |
|       mountain      | 44.37 | 64.15 |
|        plant        | 43.72 | 52.91 |
|       curtain       | 57.55 | 72.45 |
|        chair        | 50.76 | 64.05 |
|         car         | 79.81 | 90.07 |
|        water        | 37.73 | 63.79 |
|       painting      | 61.76 | 84.23 |
|         sofa        | 58.84 | 75.07 |
|        shelf        | 32.33 | 59.25 |
|        house        | 35.44 | 46.58 |
|         sea         | 49.26 | 67.13 |
|        mirror       | 55.87 | 66.29 |
|         rug         | 34.17 | 36.01 |
|        field        |  22.3 | 49.22 |
|       armchair      | 33.69 | 54.06 |
|         seat        | 41.85 | 60.48 |
|        fence        | 27.99 | 56.32 |
|         desk        | 34.76 | 41.98 |
|         rock        | 40.71 | 54.42 |
|       wardrobe      | 40.55 | 59.96 |
|         lamp        | 55.61 | 64.97 |
|       bathtub       | 63.86 |  71.7 |
|       railing       | 22.25 | 29.05 |
|       cushion       | 49.15 | 56.42 |
|         base        |  10.8 |  22.3 |
|         box         | 12.43 | 31.31 |
|        column       | 34.32 | 41.17 |
|      signboard      | 31.32 | 44.19 |
|   chest of drawers  | 32.74 | 61.68 |
|       counter       | 27.06 |  34.1 |
|         sand        | 30.74 | 37.38 |
|         sink        | 63.28 | 69.41 |
|      skyscraper     | 10.15 | 10.65 |
|      fireplace      | 67.61 | 78.18 |
|     refrigerator    | 62.47 | 68.09 |
|      grandstand     | 21.69 |  85.1 |
|         path        | 16.55 | 22.43 |
|        stairs       | 13.89 | 15.97 |
|        runway       | 55.73 |  71.9 |
|         case        | 36.02 |  41.9 |
|      pool table     | 88.51 | 93.73 |
|        pillow       | 51.47 | 61.45 |
|     screen door     | 48.22 | 52.82 |
|       stairway      | 24.56 | 36.34 |
|        river        |  5.09 |  7.99 |
|        bridge       |  27.6 | 30.97 |
|       bookcase      | 15.78 | 17.57 |
|        blind        | 14.51 | 15.72 |
|     coffee table    |  56.6 | 73.65 |
|        toilet       | 75.98 | 80.23 |
|        flower       | 37.94 | 48.78 |
|         book        | 39.96 |  49.1 |
|         hill        |  6.44 |  7.94 |
|        bench        | 30.19 | 33.82 |
|      countertop     | 47.22 | 62.74 |
|        stove        | 60.47 | 68.43 |
|         palm        | 45.58 |  58.5 |
|    kitchen island   | 24.36 | 36.29 |
|       computer      | 47.85 | 51.87 |
|     swivel chair    | 27.25 | 28.96 |
|         boat        | 42.54 | 50.92 |
|         bar         | 25.01 |  27.6 |
|    arcade machine   |  28.7 | 30.48 |
|        hovel        | 12.63 | 13.56 |
|         bus         | 81.45 | 96.71 |
|        towel        | 36.21 | 37.72 |
|        light        | 29.09 | 29.99 |
|        truck        | 30.01 | 42.54 |
|        tower        | 34.95 | 51.85 |
|      chandelier     | 54.31 | 63.33 |
|        awning       |  9.15 |  9.5  |
|     streetlight     | 18.69 |  21.4 |
|        booth        | 26.25 | 27.46 |
| television receiver | 53.18 | 60.46 |
|       airplane      | 43.95 | 58.61 |
|      dirt track     |  0.0  |  0.0  |
|       apparel       | 24.21 | 26.72 |
|         pole        |  14.4 |  20.2 |
|         land        |  0.05 |  0.05 |
|      bannister      | 10.59 | 12.98 |
|      escalator      | 13.46 | 17.26 |
|       ottoman       | 25.46 | 30.25 |
|        bottle       | 20.73 | 26.19 |
|        buffet       | 32.02 | 33.16 |
|        poster       | 17.09 | 23.84 |
|        stage        | 11.56 | 15.77 |
|         van         | 40.03 |  55.3 |
|         ship        |  3.88 |  6.26 |
|       fountain      | 16.53 | 19.79 |
|    conveyer belt    | 39.78 |  54.4 |
|        canopy       | 32.45 | 36.51 |
|        washer       | 63.09 | 64.77 |
|      plaything      | 14.12 | 19.95 |
|    swimming pool    | 30.97 | 47.65 |
|        stool        |  24.2 | 27.89 |
|        barrel       |  0.0  |  0.0  |
|        basket       | 23.07 | 39.74 |
|      waterfall      | 18.45 | 20.28 |
|         tent        | 84.44 | 99.11 |
|         bag         |  6.11 |  7.36 |
|       minibike      |  43.8 |  50.9 |
|        cradle       | 75.48 | 92.15 |
|         oven        | 38.51 | 43.65 |
|         ball        | 40.46 | 61.32 |
|         food        | 25.61 | 27.34 |
|         step        |  16.3 | 21.58 |
|         tank        | 36.69 | 38.25 |
|      trade name     | 15.35 | 16.32 |
|      microwave      |  30.2 | 31.19 |
|         pot         | 26.62 | 29.27 |
|        animal       | 49.25 | 56.04 |
|       bicycle       | 47.31 | 71.82 |
|         lake        |  0.42 |  0.43 |
|      dishwasher     | 46.79 | 52.56 |
|        screen       | 55.51 | 65.95 |
|       blanket       |  5.55 |  5.74 |
|      sculpture      | 43.18 | 66.22 |
|         hood        | 37.82 | 38.85 |
|        sconce       | 31.28 | 38.31 |
|         vase        | 36.11 |  44.7 |
|    traffic light    | 28.36 | 38.43 |
|         tray        |  4.23 |  6.55 |
|        ashcan       | 26.46 | 29.18 |
|         fan         | 48.21 | 54.43 |
|         pier        | 64.46 | 79.44 |
|      crt screen     |  5.46 | 26.68 |
|        plate        | 37.33 | 42.44 |
|       monitor       |  5.73 |  6.53 |
|    bulletin board   | 33.33 | 34.52 |
|        shower       |  2.82 | 12.29 |
|       radiator      | 34.38 | 35.47 |
|        glass        | 11.87 | 12.78 |
|        clock        | 17.49 |  25.9 |
|         flag        | 28.08 | 30.84 |
+---------------------+-------+-------+
10/06 06:36:27 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 75.5100  mIoU: 36.6000  mAcc: 45.9300  data_time: 0.0017  time: 0.4321
Finished processing corruption type: snow
Processing corruption type: frost
10/06 06:36:30 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 358955797
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 358955797
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 06:36:31 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='frost',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/frost'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 06:36:35,092 - mmseg - INFO - using core type: DCNv3
2024-10-06 06:36:35,092 - mmseg - INFO - using activation layer: GELU
2024-10-06 06:36:35,092 - mmseg - INFO - using main norm layer: LN
2024-10-06 06:36:35,092 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 06:36:35,092 - mmseg - INFO - level2_post_norm: False
2024-10-06 06:36:35,092 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 06:36:35,092 - mmseg - INFO - res_post_norm: False
2024-10-06 06:36:35,092 - mmseg - INFO - use_dcn_v4_op: False
10/06 06:36:37 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 06:36:37 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 06:36:38 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 06:36:39 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 06:37:29 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:32:17  time: 0.4463  data_time: 0.0014  memory: 21070  
10/06 06:37:54 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:42  time: 0.5976  data_time: 0.0015  memory: 11890  
10/06 06:38:08 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:20  time: 0.2619  data_time: 0.0015  memory: 10810  
10/06 06:38:29 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:28  time: 0.3574  data_time: 0.0014  memory: 11893  
10/06 06:38:50 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:12  time: 0.2067  data_time: 0.0014  memory: 11870  
10/06 06:39:07 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:54  time: 0.0849  data_time: 0.0015  memory: 11897  
10/06 06:39:26 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:13:03  time: 0.2532  data_time: 0.0014  memory: 11905  
10/06 06:39:41 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:12:06  time: 0.2567  data_time: 0.0014  memory: 11872  
10/06 06:39:49 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:52  time: 0.1855  data_time: 0.0014  memory: 9599  
10/06 06:39:56 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:49  time: 0.0892  data_time: 0.0014  memory: 10790  
10/06 06:40:04 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:59  time: 0.2589  data_time: 0.0015  memory: 10822  
10/06 06:40:11 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:13  time: 0.2326  data_time: 0.0015  memory: 9783  
10/06 06:40:22 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:42  time: 0.2811  data_time: 0.0014  memory: 10827  
10/06 06:40:36 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:19  time: 0.0976  data_time: 0.0016  memory: 11903  
10/06 06:40:50 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:58  time: 0.5888  data_time: 0.0014  memory: 10832  
10/06 06:40:56 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:25  time: 0.0876  data_time: 0.0016  memory: 10811  
10/06 06:41:01 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:53  time: 0.0888  data_time: 0.0016  memory: 776  
10/06 06:41:08 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:29  time: 0.1782  data_time: 0.0014  memory: 9040  
10/06 06:41:22 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:12  time: 0.3493  data_time: 0.0015  memory: 10906  
10/06 06:41:30 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:51  time: 0.0802  data_time: 0.0014  memory: 10908  
10/06 06:41:42 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:33  time: 0.4426  data_time: 0.0015  memory: 10829  
10/06 06:41:52 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:15  time: 0.0895  data_time: 0.0015  memory: 10804  
10/06 06:41:59 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:56  time: 0.2195  data_time: 0.0015  memory: 10792  
10/06 06:42:04 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:36  time: 0.0918  data_time: 0.0015  memory: 1962  
10/06 06:42:11 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:19  time: 0.2075  data_time: 0.0015  memory: 11893  
10/06 06:42:16 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:03:01  time: 0.0874  data_time: 0.0015  memory: 778  
10/06 06:42:21 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:44  time: 0.0873  data_time: 0.0014  memory: 10787  
10/06 06:42:33 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:31  time: 0.2791  data_time: 0.0014  memory: 10816  
10/06 06:42:40 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:16  time: 0.2509  data_time: 0.0014  memory: 10798  
10/06 06:42:44 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:02:01  time: 0.0794  data_time: 0.0014  memory: 776  
10/06 06:42:50 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:47  time: 0.0824  data_time: 0.0014  memory: 10717  
10/06 06:42:54 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:33  time: 0.0874  data_time: 0.0016  memory: 774  
10/06 06:43:04 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:21  time: 0.0799  data_time: 0.0014  memory: 11903  
10/06 06:43:13 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:09  time: 0.0861  data_time: 0.0016  memory: 10806  
10/06 06:43:20 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:57  time: 0.0921  data_time: 0.0014  memory: 10789  
10/06 06:43:26 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:45  time: 0.0813  data_time: 0.0016  memory: 10790  
10/06 06:43:30 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:33  time: 0.0810  data_time: 0.0016  memory: 724  
10/06 06:43:36 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:21  time: 0.0866  data_time: 0.0014  memory: 10829  
10/06 06:43:44 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:10  time: 0.0852  data_time: 0.0014  memory: 10795  
10/06 06:43:52 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0786  data_time: 0.0013  memory: 8666  
10/06 06:43:52 - mmengine - INFO - per class results:
10/06 06:43:52 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 69.75 | 87.97 |
|       building      | 79.05 | 88.71 |
|         sky         | 68.62 | 70.64 |
|        floor        | 73.63 | 90.23 |
|         tree        | 63.67 | 86.42 |
|       ceiling       | 74.15 | 84.41 |
|         road        | 77.18 | 85.19 |
|         bed         | 84.66 | 92.43 |
|      windowpane     | 57.07 |  74.1 |
|        grass        | 64.14 | 79.46 |
|       cabinet       | 51.37 | 61.01 |
|       sidewalk      | 57.15 | 68.29 |
|        person       | 76.89 | 87.92 |
|        earth        | 31.97 | 50.16 |
|         door        | 34.24 | 40.92 |
|        table        |  54.9 | 72.18 |
|       mountain      | 25.96 | 75.25 |
|        plant        | 46.08 | 58.08 |
|       curtain       |  61.0 | 75.02 |
|        chair        | 52.95 |  67.2 |
|         car         | 81.58 | 90.43 |
|        water        | 52.11 | 73.96 |
|       painting      |  65.0 | 84.17 |
|         sofa        | 59.73 | 78.75 |
|        shelf        | 34.57 | 46.47 |
|        house        | 44.17 |  67.8 |
|         sea         | 42.62 | 51.91 |
|        mirror       | 57.46 | 64.55 |
|         rug         | 48.41 | 54.75 |
|        field        | 25.56 | 37.66 |
|       armchair      |  35.2 | 52.44 |
|         seat        | 57.36 | 73.96 |
|        fence        | 37.68 | 55.65 |
|         desk        | 40.51 | 54.07 |
|         rock        |  37.3 | 52.19 |
|       wardrobe      | 37.28 | 50.72 |
|         lamp        |  58.2 | 68.77 |
|       bathtub       | 61.75 | 68.74 |
|       railing       |  30.4 | 43.48 |
|       cushion       | 50.51 | 59.88 |
|         base        | 16.52 | 19.65 |
|         box         | 18.62 | 26.38 |
|        column       | 37.42 | 47.93 |
|      signboard      | 33.82 | 44.32 |
|   chest of drawers  | 36.36 | 48.43 |
|       counter       | 19.84 |  28.8 |
|         sand        | 31.65 | 42.14 |
|         sink        | 61.84 | 67.69 |
|      skyscraper     | 56.49 |  70.4 |
|      fireplace      | 66.99 | 87.58 |
|     refrigerator    | 71.14 | 82.91 |
|      grandstand     | 32.56 | 74.82 |
|         path        | 19.72 | 31.62 |
|        stairs       | 34.17 | 42.76 |
|        runway       | 65.81 | 74.84 |
|         case        | 44.28 |  60.9 |
|      pool table     |  91.5 | 94.45 |
|        pillow       | 52.59 | 62.45 |
|     screen door     | 47.81 | 75.81 |
|       stairway      | 36.98 | 43.44 |
|        river        |  7.71 | 11.61 |
|        bridge       | 53.12 | 61.85 |
|       bookcase      | 35.55 | 51.56 |
|        blind        | 19.47 | 21.09 |
|     coffee table    | 58.86 | 74.92 |
|        toilet       |  71.9 | 76.59 |
|        flower       | 39.14 | 51.07 |
|         book        | 44.73 | 65.79 |
|         hill        |  5.21 |  7.54 |
|        bench        | 47.37 | 58.26 |
|      countertop     | 46.73 | 76.39 |
|        stove        | 65.95 | 69.63 |
|         palm        | 47.84 | 61.47 |
|    kitchen island   | 30.13 | 59.44 |
|       computer      | 56.53 | 61.06 |
|     swivel chair    | 31.42 | 33.38 |
|         boat        | 46.07 | 50.76 |
|         bar         | 26.22 | 30.26 |
|    arcade machine   | 39.29 | 40.42 |
|        hovel        | 44.15 | 50.92 |
|         bus         | 90.24 | 95.22 |
|        towel        | 49.99 |  61.6 |
|        light        |  39.5 | 43.93 |
|        truck        | 28.19 |  36.6 |
|        tower        | 22.46 | 43.69 |
|      chandelier     | 62.13 | 75.01 |
|        awning       | 20.57 |  24.7 |
|     streetlight     | 22.79 | 26.11 |
|        booth        | 43.31 |  51.0 |
| television receiver | 46.15 |  49.9 |
|       airplane      | 54.87 | 63.69 |
|      dirt track     | 16.61 | 45.63 |
|       apparel       | 36.41 | 44.34 |
|         pole        | 23.13 | 34.93 |
|         land        |  0.2  |  0.26 |
|      bannister      | 15.94 | 20.29 |
|      escalator      |  9.31 |  9.51 |
|       ottoman       | 27.73 | 35.12 |
|        bottle       | 29.22 | 40.56 |
|        buffet       | 32.25 | 34.34 |
|        poster       | 14.61 | 19.72 |
|        stage        | 11.08 | 14.13 |
|         van         |  43.3 | 56.32 |
|         ship        |  5.69 |  8.13 |
|       fountain      | 16.86 | 18.99 |
|    conveyer belt    | 53.34 | 60.56 |
|        canopy       | 33.26 | 42.43 |
|        washer       | 69.63 | 70.95 |
|      plaything      | 25.24 |  30.7 |
|    swimming pool    | 52.09 | 70.85 |
|        stool        | 29.91 | 41.39 |
|        barrel       |  0.84 |  1.48 |
|        basket       | 26.52 | 36.67 |
|      waterfall      | 29.79 | 35.31 |
|         tent        | 92.14 | 97.51 |
|         bag         | 10.19 | 11.81 |
|       minibike      | 58.17 | 68.01 |
|        cradle       | 80.58 | 92.05 |
|         oven        | 22.43 | 47.78 |
|         ball        | 44.97 | 62.22 |
|         food        | 55.29 | 71.72 |
|         step        |  6.34 |  8.58 |
|         tank        | 29.56 | 30.74 |
|      trade name     | 25.55 | 30.46 |
|      microwave      | 44.04 | 45.59 |
|         pot         | 37.06 | 41.93 |
|        animal       |  52.7 | 53.73 |
|       bicycle       | 52.75 | 74.27 |
|         lake        | 51.66 | 51.99 |
|      dishwasher     | 45.48 | 48.84 |
|        screen       | 67.91 | 78.72 |
|       blanket       | 11.27 | 12.99 |
|      sculpture      | 52.03 | 78.52 |
|         hood        | 43.38 | 47.12 |
|        sconce       | 35.54 | 41.48 |
|         vase        | 38.29 | 49.27 |
|    traffic light    | 28.91 | 36.59 |
|         tray        |  8.47 | 12.82 |
|        ashcan       | 31.18 | 34.78 |
|         fan         | 48.72 |  56.8 |
|         pier        | 42.94 | 54.36 |
|      crt screen     |  7.08 |  9.98 |
|        plate        |  36.8 | 45.95 |
|       monitor       | 38.87 | 41.68 |
|    bulletin board   | 35.63 | 42.55 |
|        shower       |  2.41 |  8.41 |
|       radiator      | 28.22 |  30.4 |
|        glass        | 12.67 | 13.17 |
|        clock        | 20.51 | 23.84 |
|         flag        | 44.96 | 49.77 |
+---------------------+-------+-------+
10/06 06:43:52 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 76.5500  mIoU: 41.8900  mAcc: 52.1200  data_time: 0.0016  time: 0.2163
Finished processing corruption type: frost
Processing corruption type: fog
10/06 06:43:55 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1502708486
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1502708486
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 06:43:57 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='fog',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/fog'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 06:44:00,318 - mmseg - INFO - using core type: DCNv3
2024-10-06 06:44:00,318 - mmseg - INFO - using activation layer: GELU
2024-10-06 06:44:00,318 - mmseg - INFO - using main norm layer: LN
2024-10-06 06:44:00,318 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 06:44:00,318 - mmseg - INFO - level2_post_norm: False
2024-10-06 06:44:00,318 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 06:44:00,318 - mmseg - INFO - res_post_norm: False
2024-10-06 06:44:00,319 - mmseg - INFO - use_dcn_v4_op: False
10/06 06:44:02 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 06:44:02 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 06:44:03 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 06:44:04 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 06:45:00 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:35:55  time: 0.5734  data_time: 0.0016  memory: 21070  
10/06 06:45:31 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:27:22  time: 0.7140  data_time: 0.0016  memory: 11890  
10/06 06:45:51 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:21:57  time: 0.3884  data_time: 0.0015  memory: 10810  
10/06 06:46:18 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:20:02  time: 0.4886  data_time: 0.0015  memory: 11893  
10/06 06:46:45 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:18:43  time: 0.3360  data_time: 0.0015  memory: 11870  
10/06 06:47:08 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:17:19  time: 0.2073  data_time: 0.0015  memory: 11897  
10/06 06:47:33 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:16:23  time: 0.3744  data_time: 0.0014  memory: 11905  
10/06 06:47:54 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:15:19  time: 0.3793  data_time: 0.0033  memory: 11872  
10/06 06:48:09 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:14:00  time: 0.3079  data_time: 0.0014  memory: 9599  
10/06 06:48:22 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:12:52  time: 0.2141  data_time: 0.0015  memory: 10790  
10/06 06:48:36 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:11:55  time: 0.3783  data_time: 0.0015  memory: 10822  
10/06 06:48:49 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:04  time: 0.3560  data_time: 0.0015  memory: 9783  
10/06 06:49:07 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:10:27  time: 0.4009  data_time: 0.0013  memory: 10827  
10/06 06:49:26 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:09:57  time: 0.2094  data_time: 0.0016  memory: 11903  
10/06 06:49:47 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:09:30  time: 0.7189  data_time: 0.0014  memory: 10832  
10/06 06:49:59 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:08:52  time: 0.2136  data_time: 0.0016  memory: 10811  
10/06 06:50:10 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:14  time: 0.2086  data_time: 0.0016  memory: 776  
10/06 06:50:24 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:43  time: 0.3097  data_time: 0.0014  memory: 9040  
10/06 06:50:44 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:21  time: 0.4742  data_time: 0.0015  memory: 10906  
10/06 06:50:58 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:53  time: 0.2088  data_time: 0.0014  memory: 10908  
10/06 06:51:16 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:30  time: 0.5627  data_time: 0.0015  memory: 10829  
10/06 06:51:31 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:05  time: 0.2045  data_time: 0.0018  memory: 10804  
10/06 06:51:45 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:40  time: 0.3363  data_time: 0.0014  memory: 10792  
10/06 06:51:55 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:13  time: 0.2124  data_time: 0.0015  memory: 1962  
10/06 06:52:09 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:50  time: 0.3253  data_time: 0.0014  memory: 11893  
10/06 06:52:20 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:26  time: 0.2113  data_time: 0.0015  memory: 778  
10/06 06:52:31 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:04  time: 0.2028  data_time: 0.0014  memory: 10787  
10/06 06:52:49 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:44  time: 0.3981  data_time: 0.0014  memory: 10816  
10/06 06:53:02 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:24  time: 0.3750  data_time: 0.0014  memory: 10798  
10/06 06:53:13 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:02  time: 0.2047  data_time: 0.0014  memory: 776  
10/06 06:53:25 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:42  time: 0.2091  data_time: 0.0015  memory: 10717  
10/06 06:53:35 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:22  time: 0.2084  data_time: 0.0015  memory: 774  
10/06 06:53:51 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:04  time: 0.1994  data_time: 0.0014  memory: 11903  
10/06 06:54:06 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:46  time: 0.2024  data_time: 0.0016  memory: 10806  
10/06 06:54:19 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:27  time: 0.2177  data_time: 0.0015  memory: 10789  
10/06 06:54:31 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:09  time: 0.2044  data_time: 0.0016  memory: 10790  
10/06 06:54:42 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:51  time: 0.2146  data_time: 0.0016  memory: 724  
10/06 06:54:54 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:34  time: 0.2120  data_time: 0.0015  memory: 10829  
10/06 06:55:08 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.1997  data_time: 0.0014  memory: 10795  
10/06 06:55:22 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.2023  data_time: 0.0013  memory: 8666  
10/06 06:55:22 - mmengine - INFO - per class results:
10/06 06:55:22 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 76.81 | 88.11 |
|       building      | 81.85 | 91.87 |
|         sky         | 93.96 | 97.42 |
|        floor        | 80.47 | 90.86 |
|         tree        | 72.67 |  86.8 |
|       ceiling       | 84.66 | 91.59 |
|         road        |  84.4 | 91.37 |
|         bed         | 89.64 | 95.33 |
|      windowpane     | 61.18 | 78.21 |
|        grass        | 64.17 | 77.52 |
|       cabinet       | 58.69 | 71.43 |
|       sidewalk      | 66.72 | 79.87 |
|        person       | 80.02 | 91.25 |
|        earth        | 32.96 | 48.33 |
|         door        | 51.72 | 65.65 |
|        table        | 60.66 | 75.95 |
|       mountain      |  54.6 | 73.76 |
|        plant        | 49.56 | 61.23 |
|       curtain       | 72.29 | 84.39 |
|        chair        | 57.04 |  72.4 |
|         car         | 84.03 | 91.47 |
|        water        | 55.98 |  72.6 |
|       painting      | 71.18 | 89.56 |
|         sofa        | 62.58 | 80.64 |
|        shelf        | 38.74 | 54.23 |
|        house        | 47.64 | 67.24 |
|         sea         | 49.31 | 65.59 |
|        mirror       | 65.47 | 72.55 |
|         rug         | 56.62 | 65.94 |
|        field        | 29.12 | 43.66 |
|       armchair      | 38.46 | 56.17 |
|         seat        | 63.17 | 79.02 |
|        fence        | 43.99 | 61.52 |
|         desk        | 49.96 | 67.36 |
|         rock        | 41.47 | 64.03 |
|       wardrobe      | 48.54 | 70.63 |
|         lamp        | 63.68 | 76.96 |
|       bathtub       | 73.12 | 82.23 |
|       railing       | 32.45 | 46.52 |
|       cushion       | 58.57 | 70.84 |
|         base        | 22.74 | 27.19 |
|         box         | 26.33 | 33.58 |
|        column       | 45.65 | 58.23 |
|      signboard      | 37.58 |  50.5 |
|   chest of drawers  | 39.52 | 61.94 |
|       counter       |  31.6 | 39.39 |
|         sand        | 39.57 |  56.7 |
|         sink        | 70.33 | 77.44 |
|      skyscraper     | 61.46 | 79.84 |
|      fireplace      | 73.05 | 87.57 |
|     refrigerator    | 74.65 | 84.05 |
|      grandstand     | 36.29 | 71.28 |
|         path        |  22.3 |  34.6 |
|        stairs       | 31.88 | 41.63 |
|        runway       |  70.2 | 94.79 |
|         case        | 44.78 | 59.38 |
|      pool table     | 92.21 | 94.94 |
|        pillow       | 62.31 | 73.86 |
|     screen door     | 74.29 | 83.06 |
|       stairway      | 31.39 | 37.82 |
|        river        | 10.59 | 23.69 |
|        bridge       | 53.59 | 63.57 |
|       bookcase      | 35.48 | 59.48 |
|        blind        | 42.94 | 48.54 |
|     coffee table    |  60.4 | 82.51 |
|        toilet       | 84.82 |  90.8 |
|        flower       | 41.07 | 50.74 |
|         book        |  46.1 | 67.98 |
|         hill        | 15.37 | 21.54 |
|        bench        | 44.56 | 54.65 |
|      countertop     | 52.32 | 76.71 |
|        stove        | 76.16 | 80.63 |
|         palm        | 50.83 | 68.25 |
|    kitchen island   |  37.0 | 62.71 |
|       computer      | 74.21 | 83.66 |
|     swivel chair    | 40.51 | 55.68 |
|         boat        | 54.08 | 61.07 |
|         bar         | 33.05 | 43.38 |
|    arcade machine   | 71.18 | 74.93 |
|        hovel        | 13.48 | 14.26 |
|         bus         | 91.27 | 96.46 |
|        towel        | 65.62 | 76.08 |
|        light        | 52.03 | 59.36 |
|        truck        | 37.12 | 49.24 |
|        tower        | 32.57 | 51.98 |
|      chandelier     | 69.55 |  82.3 |
|        awning       |  24.5 | 28.99 |
|     streetlight     | 26.18 |  34.5 |
|        booth        | 51.15 | 53.83 |
| television receiver | 65.94 | 79.39 |
|       airplane      | 64.56 | 76.84 |
|      dirt track     | 23.98 |  50.6 |
|       apparel       | 35.79 | 47.97 |
|         pole        | 20.95 | 31.28 |
|         land        |  4.04 |  5.44 |
|      bannister      | 16.68 | 22.32 |
|      escalator      | 25.27 |  28.3 |
|       ottoman       | 48.32 | 62.63 |
|        bottle       | 29.56 | 38.35 |
|        buffet       | 35.77 |  41.4 |
|        poster       | 26.55 | 39.38 |
|        stage        | 16.64 | 24.37 |
|         van         | 47.97 | 63.22 |
|         ship        |  9.43 | 13.08 |
|       fountain      | 20.39 | 20.79 |
|    conveyer belt    | 67.51 | 83.74 |
|        canopy       | 34.95 | 45.46 |
|        washer       | 73.53 | 76.15 |
|      plaything      | 32.63 | 47.22 |
|    swimming pool    | 37.95 | 57.32 |
|        stool        |  35.5 | 49.97 |
|        barrel       | 50.88 | 65.48 |
|        basket       | 34.64 | 44.65 |
|      waterfall      | 60.58 | 73.67 |
|         tent        | 93.47 | 98.67 |
|         bag         | 10.62 | 12.22 |
|       minibike      | 69.88 | 77.95 |
|        cradle       | 82.01 |  94.5 |
|         oven        | 49.01 | 60.33 |
|         ball        | 51.57 | 65.48 |
|         food        | 56.01 | 65.79 |
|         step        | 16.76 | 19.24 |
|         tank        |  49.4 | 51.25 |
|      trade name     | 29.69 | 35.53 |
|      microwave      | 83.31 | 89.68 |
|         pot         | 41.67 |  49.5 |
|        animal       | 58.28 |  59.6 |
|       bicycle       | 56.61 | 76.49 |
|         lake        | 57.68 | 63.08 |
|      dishwasher     | 65.73 | 81.22 |
|        screen       | 59.51 | 70.12 |
|       blanket       | 15.87 | 18.32 |
|      sculpture      | 65.77 | 83.01 |
|         hood        |  55.6 |  58.1 |
|        sconce       | 43.88 | 54.51 |
|         vase        | 39.25 | 51.92 |
|    traffic light    | 30.38 | 44.77 |
|         tray        |  6.63 | 10.26 |
|        ashcan       | 47.11 |  59.6 |
|         fan         | 59.96 | 69.85 |
|         pier        | 38.94 | 49.35 |
|      crt screen     |  9.37 |  18.7 |
|        plate        | 49.91 |  65.9 |
|       monitor       | 37.52 | 45.96 |
|    bulletin board   | 40.04 |  56.7 |
|        shower       |  5.58 |  8.19 |
|       radiator      | 49.63 | 59.89 |
|        glass        | 15.21 | 16.47 |
|        clock        | 36.45 | 46.15 |
|         flag        | 43.65 | 47.25 |
+---------------------+-------+-------+
10/06 06:55:22 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.5700  mIoU: 49.1100  mAcc: 60.5500  data_time: 0.0016  time: 0.3388
Finished processing corruption type: fog
Processing corruption type: brightness
10/06 06:55:25 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 334424062
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 334424062
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 06:55:27 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='brightness',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/brightness'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 06:55:29,983 - mmseg - INFO - using core type: DCNv3
2024-10-06 06:55:29,983 - mmseg - INFO - using activation layer: GELU
2024-10-06 06:55:29,983 - mmseg - INFO - using main norm layer: LN
2024-10-06 06:55:29,984 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 06:55:29,984 - mmseg - INFO - level2_post_norm: False
2024-10-06 06:55:29,984 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 06:55:29,984 - mmseg - INFO - res_post_norm: False
2024-10-06 06:55:29,984 - mmseg - INFO - use_dcn_v4_op: False
10/06 06:55:31 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 06:55:31 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 06:55:33 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 06:55:34 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 06:56:30 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:36:32  time: 0.5991  data_time: 0.0015  memory: 21070  
10/06 06:57:02 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:27:50  time: 0.7419  data_time: 0.0016  memory: 11890  
10/06 06:57:23 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:22:21  time: 0.4106  data_time: 0.0015  memory: 10810  
10/06 06:57:50 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:20:24  time: 0.4857  data_time: 0.0015  memory: 11893  
10/06 06:58:17 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:19:02  time: 0.3463  data_time: 0.0014  memory: 11870  
10/06 06:58:40 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:17:35  time: 0.2273  data_time: 0.0015  memory: 11897  
10/06 06:59:06 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:16:37  time: 0.3767  data_time: 0.0014  memory: 11905  
10/06 06:59:27 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:15:32  time: 0.3753  data_time: 0.0014  memory: 11872  
10/06 06:59:41 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:14:09  time: 0.3152  data_time: 0.0014  memory: 9599  
10/06 06:59:54 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:13:00  time: 0.2149  data_time: 0.0014  memory: 10790  
10/06 07:00:09 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:12:05  time: 0.3804  data_time: 0.0015  memory: 10822  
10/06 07:00:23 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:11:13  time: 0.3756  data_time: 0.0015  memory: 9783  
10/06 07:00:40 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:10:36  time: 0.4149  data_time: 0.0014  memory: 10827  
10/06 07:01:01 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:10:06  time: 0.2327  data_time: 0.0016  memory: 11903  
10/06 07:01:22 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:09:39  time: 0.7232  data_time: 0.0014  memory: 10832  
10/06 07:01:34 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:08:59  time: 0.2246  data_time: 0.0016  memory: 10811  
10/06 07:01:45 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:08:21  time: 0.2199  data_time: 0.0016  memory: 776  
10/06 07:01:59 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:07:50  time: 0.3070  data_time: 0.0014  memory: 9040  
10/06 07:02:19 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:07:27  time: 0.4812  data_time: 0.0015  memory: 10906  
10/06 07:02:34 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:06:59  time: 0.2115  data_time: 0.0014  memory: 10908  
10/06 07:02:52 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:06:35  time: 0.5656  data_time: 0.0014  memory: 10829  
10/06 07:03:08 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:06:11  time: 0.2057  data_time: 0.0015  memory: 10804  
10/06 07:03:21 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:05:45  time: 0.3503  data_time: 0.0015  memory: 10792  
10/06 07:03:32 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:05:18  time: 0.2109  data_time: 0.0015  memory: 1962  
10/06 07:03:46 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:04:55  time: 0.3324  data_time: 0.0014  memory: 11893  
10/06 07:03:56 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:04:30  time: 0.2182  data_time: 0.0014  memory: 778  
10/06 07:04:08 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:04:07  time: 0.1902  data_time: 0.0014  memory: 10787  
10/06 07:04:26 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:03:48  time: 0.4174  data_time: 0.0014  memory: 10816  
10/06 07:04:39 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:03:26  time: 0.3912  data_time: 0.0014  memory: 10798  
10/06 07:04:50 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:03:05  time: 0.1936  data_time: 0.0014  memory: 776  
10/06 07:05:03 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:02:45  time: 0.2224  data_time: 0.0014  memory: 10717  
10/06 07:05:13 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:02:24  time: 0.2129  data_time: 0.0016  memory: 774  
10/06 07:05:29 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:02:06  time: 0.1913  data_time: 0.0014  memory: 11903  
10/06 07:05:44 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:47  time: 0.2115  data_time: 0.0015  memory: 10806  
10/06 07:05:58 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:01:29  time: 0.2215  data_time: 0.0013  memory: 10789  
10/06 07:06:10 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:01:10  time: 0.2117  data_time: 0.0016  memory: 10790  
10/06 07:06:21 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:52  time: 0.2217  data_time: 0.0016  memory: 724  
10/06 07:06:33 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:34  time: 0.2140  data_time: 0.0014  memory: 10829  
10/06 07:06:47 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:17  time: 0.1975  data_time: 0.0014  memory: 10795  
10/06 07:07:01 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.1994  data_time: 0.0013  memory: 8666  
10/06 07:07:01 - mmengine - INFO - per class results:
10/06 07:07:01 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 76.99 | 88.25 |
|       building      | 81.88 | 91.51 |
|         sky         | 93.96 | 97.63 |
|        floor        | 80.54 | 90.64 |
|         tree        | 72.99 | 86.88 |
|       ceiling       | 84.55 | 91.52 |
|         road        | 84.63 | 91.57 |
|         bed         | 89.63 | 95.57 |
|      windowpane     | 61.88 | 78.81 |
|        grass        | 65.86 | 79.72 |
|       cabinet       | 59.36 | 72.06 |
|       sidewalk      | 66.76 | 79.39 |
|        person       | 80.24 | 91.54 |
|        earth        | 34.25 | 49.72 |
|         door        |  52.5 | 67.02 |
|        table        | 61.03 | 75.73 |
|       mountain      | 53.99 | 74.84 |
|        plant        | 50.43 | 62.08 |
|       curtain       | 72.66 |  84.6 |
|        chair        | 57.25 | 71.86 |
|         car         | 83.82 | 91.75 |
|        water        | 57.02 |  73.1 |
|       painting      | 72.67 | 89.74 |
|         sofa        | 62.46 | 80.47 |
|        shelf        | 40.49 | 57.17 |
|        house        | 44.81 | 66.88 |
|         sea         | 59.07 | 74.48 |
|        mirror       | 65.63 | 72.44 |
|         rug         | 57.67 | 68.86 |
|        field        | 28.59 | 44.12 |
|       armchair      | 37.98 | 56.14 |
|         seat        | 61.88 | 79.48 |
|        fence        | 42.82 | 61.06 |
|         desk        | 47.58 | 65.92 |
|         rock        | 37.28 | 54.27 |
|       wardrobe      | 50.97 | 72.29 |
|         lamp        |  63.2 | 76.36 |
|       bathtub       | 75.28 | 83.04 |
|       railing       | 32.06 | 44.45 |
|       cushion       | 58.76 | 71.69 |
|         base        | 19.21 | 23.17 |
|         box         | 26.34 | 33.25 |
|        column       | 44.44 | 56.57 |
|      signboard      | 37.93 | 50.88 |
|   chest of drawers  | 39.41 | 62.17 |
|       counter       | 28.68 | 35.32 |
|         sand        | 36.35 | 56.48 |
|         sink        | 70.14 | 77.78 |
|      skyscraper     | 56.58 | 72.76 |
|      fireplace      | 75.74 | 88.86 |
|     refrigerator    | 74.33 | 84.25 |
|      grandstand     | 38.69 | 68.15 |
|         path        | 22.62 | 34.68 |
|        stairs       | 31.46 |  42.0 |
|        runway       | 70.69 | 92.68 |
|         case        | 44.49 | 58.19 |
|      pool table     | 92.65 | 95.56 |
|        pillow       | 60.74 | 70.63 |
|     screen door     | 74.92 | 80.27 |
|       stairway      | 32.36 | 39.09 |
|        river        | 10.51 |  22.9 |
|        bridge       | 61.39 | 69.01 |
|       bookcase      |  36.4 | 56.04 |
|        blind        | 40.49 | 45.53 |
|     coffee table    | 60.47 | 83.95 |
|        toilet       | 85.08 | 90.96 |
|        flower       | 41.88 | 54.16 |
|         book        | 46.73 | 71.42 |
|         hill        | 10.19 | 13.21 |
|        bench        | 45.99 | 56.01 |
|      countertop     |  52.8 | 76.12 |
|        stove        | 77.44 | 83.17 |
|         palm        | 49.56 | 65.75 |
|    kitchen island   | 37.57 | 63.75 |
|       computer      | 72.97 | 81.95 |
|     swivel chair    |  37.7 | 51.96 |
|         boat        | 57.61 | 66.94 |
|         bar         | 29.81 | 39.32 |
|    arcade machine   | 66.47 | 70.08 |
|        hovel        |  15.8 | 17.23 |
|         bus         | 90.75 | 96.46 |
|        towel        | 63.85 | 75.77 |
|        light        | 53.22 |  61.4 |
|        truck        | 38.77 | 51.04 |
|        tower        | 32.55 | 49.89 |
|      chandelier     | 67.93 | 81.34 |
|        awning       |  24.4 | 29.94 |
|     streetlight     | 25.83 | 33.68 |
|        booth        | 47.24 | 52.66 |
| television receiver | 68.99 | 79.06 |
|       airplane      |  59.0 | 74.77 |
|      dirt track     | 18.22 | 40.24 |
|       apparel       | 40.11 |  51.4 |
|         pole        |  20.6 | 31.23 |
|         land        |  3.71 |  4.91 |
|      bannister      | 16.33 | 22.16 |
|      escalator      | 29.48 | 33.59 |
|       ottoman       | 45.05 | 60.07 |
|        bottle       | 29.28 | 39.95 |
|        buffet       | 38.13 | 44.02 |
|        poster       | 24.91 | 35.49 |
|        stage        |  16.6 | 22.11 |
|         van         | 46.53 | 62.65 |
|         ship        | 18.83 | 24.51 |
|       fountain      |  20.2 | 21.12 |
|    conveyer belt    | 60.28 | 77.47 |
|        canopy       | 37.02 |  49.5 |
|        washer       | 72.63 | 75.03 |
|      plaything      | 29.33 | 45.82 |
|    swimming pool    | 41.62 | 63.46 |
|        stool        | 36.11 | 51.24 |
|        barrel       | 55.61 | 71.58 |
|        basket       | 34.83 | 46.41 |
|      waterfall      | 59.18 |  72.9 |
|         tent        | 94.92 | 98.17 |
|         bag         | 10.96 | 12.63 |
|       minibike      |  66.7 | 76.88 |
|        cradle       | 82.36 | 95.63 |
|         oven        | 48.51 | 68.19 |
|         ball        | 51.84 | 61.82 |
|         food        | 57.31 | 70.09 |
|         step        | 17.29 | 19.39 |
|         tank        | 56.22 | 60.35 |
|      trade name     | 30.54 |  37.3 |
|      microwave      | 78.97 | 83.89 |
|         pot         | 39.63 | 46.31 |
|        animal       | 59.98 |  61.9 |
|       bicycle       | 55.36 |  75.4 |
|         lake        | 63.03 | 63.45 |
|      dishwasher     | 71.66 | 81.92 |
|        screen       | 59.26 | 70.16 |
|       blanket       | 16.65 | 19.66 |
|      sculpture      | 66.51 | 81.58 |
|         hood        |  58.7 | 61.81 |
|        sconce       | 44.48 | 54.23 |
|         vase        |  39.5 | 48.97 |
|    traffic light    | 30.77 | 46.35 |
|         tray        |  7.15 | 10.92 |
|        ashcan       | 49.65 | 60.08 |
|         fan         | 62.46 | 72.04 |
|         pier        | 51.45 | 67.59 |
|      crt screen     |  6.26 | 12.71 |
|        plate        | 50.51 | 67.58 |
|       monitor       | 38.59 |  48.3 |
|    bulletin board   | 40.29 | 52.57 |
|        shower       |  6.63 |  9.32 |
|       radiator      | 49.74 | 60.42 |
|        glass        | 14.94 |  16.2 |
|        clock        | 36.81 | 46.91 |
|         flag        | 43.25 | 47.04 |
+---------------------+-------+-------+
10/06 07:07:01 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.7200  mIoU: 49.3500  mAcc: 60.7200  data_time: 0.0016  time: 0.3436
Finished processing corruption type: brightness
Processing corruption type: contrast
10/06 07:07:05 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1315216025
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1315216025
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 07:07:06 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='contrast',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/contrast'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 07:07:09,186 - mmseg - INFO - using core type: DCNv3
2024-10-06 07:07:09,186 - mmseg - INFO - using activation layer: GELU
2024-10-06 07:07:09,187 - mmseg - INFO - using main norm layer: LN
2024-10-06 07:07:09,187 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 07:07:09,187 - mmseg - INFO - level2_post_norm: False
2024-10-06 07:07:09,187 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 07:07:09,187 - mmseg - INFO - res_post_norm: False
2024-10-06 07:07:09,187 - mmseg - INFO - use_dcn_v4_op: False
10/06 07:07:10 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 07:07:11 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 07:07:12 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 07:07:13 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 07:08:03 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:32:15  time: 0.4516  data_time: 0.0016  memory: 21070  
10/06 07:08:28 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:35  time: 0.5933  data_time: 0.0016  memory: 11890  
10/06 07:08:42 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:14  time: 0.2679  data_time: 0.0015  memory: 10810  
10/06 07:09:02 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:23  time: 0.3610  data_time: 0.0015  memory: 11893  
10/06 07:09:23 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:07  time: 0.2101  data_time: 0.0014  memory: 11870  
10/06 07:09:39 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:48  time: 0.0877  data_time: 0.0015  memory: 11897  
10/06 07:09:58 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:12:56  time: 0.2507  data_time: 0.0015  memory: 11905  
10/06 07:10:13 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:11:58  time: 0.2471  data_time: 0.0014  memory: 11872  
10/06 07:10:21 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:45  time: 0.1876  data_time: 0.0014  memory: 9599  
10/06 07:10:27 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:42  time: 0.0784  data_time: 0.0014  memory: 10790  
10/06 07:10:35 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:52  time: 0.2506  data_time: 0.0015  memory: 10822  
10/06 07:10:42 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:07  time: 0.2361  data_time: 0.0016  memory: 9783  
10/06 07:10:53 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:36  time: 0.2711  data_time: 0.0014  memory: 10827  
10/06 07:11:06 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:12  time: 0.0843  data_time: 0.0016  memory: 11903  
10/06 07:11:20 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:52  time: 0.5933  data_time: 0.0015  memory: 10832  
10/06 07:11:26 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:19  time: 0.0787  data_time: 0.0016  memory: 10811  
10/06 07:11:30 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:47  time: 0.0796  data_time: 0.0016  memory: 776  
10/06 07:11:38 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:23  time: 0.1812  data_time: 0.0014  memory: 9040  
10/06 07:11:51 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:06  time: 0.3406  data_time: 0.0015  memory: 10906  
10/06 07:11:59 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:46  time: 0.0828  data_time: 0.0015  memory: 10908  
10/06 07:12:11 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:28  time: 0.4325  data_time: 0.0015  memory: 10829  
10/06 07:12:20 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:11  time: 0.0833  data_time: 0.0015  memory: 10804  
10/06 07:12:27 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:51  time: 0.2079  data_time: 0.0014  memory: 10792  
10/06 07:12:31 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:31  time: 0.0795  data_time: 0.0015  memory: 1962  
10/06 07:12:39 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:15  time: 0.2072  data_time: 0.0014  memory: 11893  
10/06 07:12:43 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:02:57  time: 0.0842  data_time: 0.0014  memory: 778  
10/06 07:12:48 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:41  time: 0.0748  data_time: 0.0014  memory: 10787  
10/06 07:12:59 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:28  time: 0.2808  data_time: 0.0014  memory: 10816  
10/06 07:13:06 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:13  time: 0.2400  data_time: 0.0014  memory: 10798  
10/06 07:13:10 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:58  time: 0.0733  data_time: 0.0014  memory: 776  
10/06 07:13:16 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:45  time: 0.0860  data_time: 0.0014  memory: 10717  
10/06 07:13:20 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:31  time: 0.0816  data_time: 0.0015  memory: 774  
10/06 07:13:30 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:19  time: 0.0726  data_time: 0.0014  memory: 11903  
10/06 07:13:38 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:07  time: 0.0839  data_time: 0.0015  memory: 10806  
10/06 07:13:45 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:56  time: 0.0812  data_time: 0.0014  memory: 10789  
10/06 07:13:51 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:44  time: 0.0814  data_time: 0.0015  memory: 10790  
10/06 07:13:55 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:32  time: 0.0851  data_time: 0.0015  memory: 724  
10/06 07:14:01 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:21  time: 0.0836  data_time: 0.0014  memory: 10829  
10/06 07:14:08 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:10  time: 0.0744  data_time: 0.0014  memory: 10795  
10/06 07:14:16 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0755  data_time: 0.0013  memory: 8666  
10/06 07:14:16 - mmengine - INFO - per class results:
10/06 07:14:16 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 76.55 | 88.24 |
|       building      | 82.03 | 91.29 |
|         sky         | 93.85 | 97.32 |
|        floor        | 80.08 | 90.81 |
|         tree        | 72.36 | 87.72 |
|       ceiling       | 83.64 | 91.26 |
|         road        | 83.46 | 90.37 |
|         bed         |  89.6 |  95.3 |
|      windowpane     | 61.01 | 77.56 |
|        grass        | 62.74 | 74.96 |
|       cabinet       | 59.01 | 71.81 |
|       sidewalk      | 65.16 | 79.35 |
|        person       | 80.09 | 90.97 |
|        earth        | 31.95 | 47.33 |
|         door        | 51.73 | 65.69 |
|        table        | 60.12 | 75.71 |
|       mountain      | 52.92 | 71.79 |
|        plant        | 49.14 | 59.53 |
|       curtain       | 71.51 | 84.57 |
|        chair        | 56.85 | 72.84 |
|         car         | 84.02 | 91.74 |
|        water        | 54.54 | 71.54 |
|       painting      | 69.58 | 89.85 |
|         sofa        | 61.54 | 78.35 |
|        shelf        |  39.2 | 54.88 |
|        house        | 46.65 | 70.11 |
|         sea         | 54.25 | 71.54 |
|        mirror       |  63.9 | 70.59 |
|         rug         | 53.07 | 61.03 |
|        field        | 30.13 | 56.72 |
|       armchair      | 37.84 | 57.76 |
|         seat        | 62.95 | 77.44 |
|        fence        |  41.7 | 58.44 |
|         desk        |  48.6 | 64.58 |
|         rock        | 38.97 | 57.67 |
|       wardrobe      | 48.02 | 69.23 |
|         lamp        | 63.18 | 76.87 |
|       bathtub       | 73.12 | 82.92 |
|       railing       | 32.93 | 47.24 |
|       cushion       | 57.54 | 70.24 |
|         base        | 23.62 | 28.77 |
|         box         |  25.0 | 31.59 |
|        column       | 45.67 |  57.6 |
|      signboard      | 37.51 | 50.03 |
|   chest of drawers  | 38.07 | 62.33 |
|       counter       | 34.96 | 48.25 |
|         sand        | 40.36 | 55.45 |
|         sink        | 69.48 | 76.46 |
|      skyscraper     | 59.73 |  77.4 |
|      fireplace      |  73.5 |  87.3 |
|     refrigerator    | 74.09 | 82.35 |
|      grandstand     | 35.54 |  69.2 |
|         path        | 23.03 | 35.55 |
|        stairs       | 32.05 | 40.41 |
|        runway       | 69.82 | 95.06 |
|         case        | 43.45 | 63.78 |
|      pool table     |  91.5 | 94.36 |
|        pillow       | 60.69 | 71.02 |
|     screen door     | 70.46 |  79.2 |
|       stairway      | 30.68 | 37.27 |
|        river        |  10.1 | 20.97 |
|        bridge       | 54.49 | 64.02 |
|       bookcase      | 34.71 | 55.94 |
|        blind        | 40.49 | 45.45 |
|     coffee table    | 57.89 | 82.01 |
|        toilet       |  83.2 | 90.76 |
|        flower       | 37.65 | 46.54 |
|         book        | 45.02 | 67.23 |
|         hill        | 11.66 | 15.13 |
|        bench        | 45.64 | 54.82 |
|      countertop     | 50.34 | 78.51 |
|        stove        | 73.37 | 75.91 |
|         palm        | 49.56 | 63.05 |
|    kitchen island   | 40.28 | 63.12 |
|       computer      | 73.73 | 83.08 |
|     swivel chair    | 39.24 | 51.39 |
|         boat        | 52.03 | 57.83 |
|         bar         | 24.66 | 30.16 |
|    arcade machine   | 32.99 | 34.48 |
|        hovel        | 11.86 | 12.74 |
|         bus         | 90.91 | 96.25 |
|        towel        | 63.64 | 77.34 |
|        light        | 51.14 | 57.68 |
|        truck        | 37.41 | 47.37 |
|        tower        | 32.32 | 49.04 |
|      chandelier     | 68.79 | 80.45 |
|        awning       | 24.54 | 29.09 |
|     streetlight     | 25.82 | 33.75 |
|        booth        | 53.89 | 56.25 |
| television receiver | 65.63 | 76.84 |
|       airplane      | 61.87 | 76.63 |
|      dirt track     | 27.12 | 51.36 |
|       apparel       | 33.54 | 43.81 |
|         pole        | 20.53 | 30.53 |
|         land        |  4.26 |  5.7  |
|      bannister      | 17.61 | 23.26 |
|      escalator      | 25.52 | 28.68 |
|       ottoman       | 46.45 | 61.87 |
|        bottle       | 30.07 | 41.56 |
|        buffet       | 39.88 | 47.02 |
|        poster       | 28.66 | 37.01 |
|        stage        | 15.83 | 22.01 |
|         van         | 46.53 | 62.12 |
|         ship        | 12.63 | 17.78 |
|       fountain      | 19.84 |  20.1 |
|    conveyer belt    |  70.1 | 85.22 |
|        canopy       | 32.21 | 43.17 |
|        washer       | 71.94 | 74.82 |
|      plaything      | 30.37 | 40.68 |
|    swimming pool    | 36.07 | 53.76 |
|        stool        | 36.16 | 48.99 |
|        barrel       | 49.56 | 65.68 |
|        basket       | 31.19 | 42.96 |
|      waterfall      |  57.2 | 67.01 |
|         tent        | 90.35 | 98.65 |
|         bag         |  9.81 | 10.85 |
|       minibike      | 67.98 |  76.1 |
|        cradle       | 81.15 | 94.93 |
|         oven        | 49.55 | 61.17 |
|         ball        | 52.14 | 63.82 |
|         food        | 56.02 | 62.27 |
|         step        | 17.24 | 20.42 |
|         tank        | 49.48 | 50.71 |
|      trade name     | 28.46 | 33.97 |
|      microwave      | 85.28 | 91.43 |
|         pot         | 39.86 | 46.81 |
|        animal       |  58.9 |  60.3 |
|       bicycle       | 56.23 | 75.93 |
|         lake        | 59.47 | 63.36 |
|      dishwasher     |  65.1 | 77.66 |
|        screen       | 58.79 | 66.67 |
|       blanket       | 15.53 | 17.91 |
|      sculpture      | 66.53 | 83.27 |
|         hood        | 56.05 | 58.79 |
|        sconce       | 44.02 | 52.88 |
|         vase        |  37.8 | 49.72 |
|    traffic light    | 29.28 | 43.77 |
|         tray        |  5.72 |  7.51 |
|        ashcan       | 42.02 | 50.98 |
|         fan         | 58.94 | 68.23 |
|         pier        | 42.99 | 54.96 |
|      crt screen     |  4.65 | 10.26 |
|        plate        | 51.74 | 66.64 |
|       monitor       | 30.09 | 35.32 |
|    bulletin board   | 37.33 | 55.43 |
|        shower       |  5.48 |  7.33 |
|       radiator      | 49.66 | 59.78 |
|        glass        | 14.79 | 16.06 |
|        clock        | 36.51 | 46.48 |
|         flag        |  43.5 | 47.18 |
+---------------------+-------+-------+
10/06 07:14:16 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.2300  mIoU: 48.2100  mAcc: 59.3500  data_time: 0.0016  time: 0.2115
Finished processing corruption type: contrast
Processing corruption type: elastic_transform
10/06 07:14:20 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1551080071
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1551080071
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 07:14:21 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/elastic_transform'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 07:14:24,652 - mmseg - INFO - using core type: DCNv3
2024-10-06 07:14:24,652 - mmseg - INFO - using activation layer: GELU
2024-10-06 07:14:24,652 - mmseg - INFO - using main norm layer: LN
2024-10-06 07:14:24,652 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 07:14:24,652 - mmseg - INFO - level2_post_norm: False
2024-10-06 07:14:24,652 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 07:14:24,652 - mmseg - INFO - res_post_norm: False
2024-10-06 07:14:24,652 - mmseg - INFO - use_dcn_v4_op: False
10/06 07:14:26 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 07:14:26 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 07:14:27 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 07:14:29 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 07:16:05 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:02:26  time: 1.4503  data_time: 0.0016  memory: 21070  
10/06 07:17:16 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:53:04  time: 1.5562  data_time: 0.0022  memory: 11890  
10/06 07:18:17 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:46:57  time: 1.2122  data_time: 0.0015  memory: 10810  
10/06 07:19:25 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:44:25  time: 1.2981  data_time: 0.0015  memory: 11893  
10/06 07:20:30 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:42:09  time: 1.0994  data_time: 0.0015  memory: 11870  
10/06 07:21:31 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:39:54  time: 1.0229  data_time: 0.0016  memory: 11897  
10/06 07:22:36 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:38:15  time: 1.1143  data_time: 0.0015  memory: 11905  
10/06 07:23:36 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:36:30  time: 1.1830  data_time: 0.0014  memory: 11872  
10/06 07:24:25 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:34:14  time: 1.0257  data_time: 0.0015  memory: 9599  
10/06 07:25:17 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:32:24  time: 0.9619  data_time: 0.0015  memory: 10790  
10/06 07:26:13 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:30:56  time: 1.1918  data_time: 0.0015  memory: 10822  
10/06 07:27:05 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:29:23  time: 1.1827  data_time: 0.0016  memory: 9783  
10/06 07:28:00 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:28:05  time: 1.1736  data_time: 0.0014  memory: 10827  
10/06 07:29:01 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:26:59  time: 1.0495  data_time: 0.0016  memory: 11903  
10/06 07:30:01 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:25:54  time: 1.4882  data_time: 0.0014  memory: 10832  
10/06 07:30:50 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:24:32  time: 0.9989  data_time: 0.0016  memory: 10811  
10/06 07:31:41 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:23:16  time: 1.0313  data_time: 0.0017  memory: 776  
10/06 07:32:30 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:22:02  time: 0.9800  data_time: 0.0015  memory: 9040  
10/06 07:33:30 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:21:00  time: 1.2200  data_time: 0.0016  memory: 10906  
10/06 07:34:22 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:19:53  time: 0.9701  data_time: 0.0015  memory: 10908  
10/06 07:35:20 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:18:51  time: 1.3874  data_time: 0.0015  memory: 10829  
10/06 07:36:15 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:17:48  time: 0.9797  data_time: 0.0016  memory: 10804  
10/06 07:37:07 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:16:43  time: 1.1261  data_time: 0.0015  memory: 10792  
10/06 07:37:57 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:15:39  time: 0.9718  data_time: 0.0015  memory: 1962  
10/06 07:38:49 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:14:35  time: 1.0830  data_time: 0.0015  memory: 11893  
10/06 07:39:35 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:13:31  time: 0.9987  data_time: 0.0015  memory: 778  
10/06 07:40:26 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:12:29  time: 0.9260  data_time: 0.0015  memory: 10787  
10/06 07:41:22 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:11:31  time: 1.2446  data_time: 0.0015  memory: 10816  
10/06 07:42:12 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:10:31  time: 1.1761  data_time: 0.0014  memory: 10798  
10/06 07:43:01 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:09:30  time: 0.9433  data_time: 0.0015  memory: 776  
10/06 07:43:54 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:08:32  time: 1.0098  data_time: 0.0015  memory: 10717  
10/06 07:44:43 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:33  time: 0.9980  data_time: 0.0016  memory: 774  
10/06 07:45:37 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:36  time: 0.9095  data_time: 0.0014  memory: 11903  
10/06 07:46:31 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:39  time: 0.9895  data_time: 0.0016  memory: 10806  
10/06 07:47:25 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:42  time: 0.9978  data_time: 0.0015  memory: 10789  
10/06 07:48:14 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:44  time: 0.9846  data_time: 0.0016  memory: 10790  
10/06 07:49:03 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:48  time: 0.9992  data_time: 0.0016  memory: 724  
10/06 07:49:51 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:51  time: 0.9424  data_time: 0.0014  memory: 10829  
10/06 07:50:44 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:55  time: 0.9627  data_time: 0.0015  memory: 10795  
10/06 07:51:35 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.8827  data_time: 0.0013  memory: 8666  
10/06 07:51:35 - mmengine - INFO - per class results:
10/06 07:51:35 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 63.16 |  77.5 |
|       building      | 72.92 | 86.79 |
|         sky         | 84.04 | 91.42 |
|        floor        | 67.78 | 82.19 |
|         tree        | 62.48 | 79.13 |
|       ceiling       | 70.09 | 83.09 |
|         road        | 76.53 | 86.83 |
|         bed         | 75.43 | 87.25 |
|      windowpane     | 48.79 | 66.73 |
|        grass        | 60.07 | 75.98 |
|       cabinet       | 48.71 | 63.16 |
|       sidewalk      | 53.55 | 67.34 |
|        person       | 60.62 | 77.96 |
|        earth        | 32.64 | 48.37 |
|         door        | 41.08 | 55.42 |
|        table        | 43.63 |  62.0 |
|       mountain      | 50.63 | 69.12 |
|        plant        | 41.77 |  56.2 |
|       curtain       | 53.98 |  72.5 |
|        chair        | 39.91 | 57.13 |
|         car         | 61.42 | 76.83 |
|        water        | 53.07 | 69.85 |
|       painting      | 46.95 | 67.89 |
|         sofa        | 50.66 | 68.35 |
|        shelf        | 35.23 | 55.17 |
|        house        | 34.24 | 50.86 |
|         sea         | 52.33 | 67.48 |
|        mirror       | 54.72 | 66.13 |
|         rug         | 44.38 | 59.29 |
|        field        | 26.86 | 39.59 |
|       armchair      | 30.91 | 49.91 |
|         seat        | 56.57 | 74.59 |
|        fence        | 34.32 | 51.18 |
|         desk        | 37.01 | 53.85 |
|         rock        | 35.71 | 58.16 |
|       wardrobe      | 44.66 | 66.97 |
|         lamp        | 32.92 | 50.11 |
|       bathtub       | 62.38 | 74.26 |
|       railing       | 24.07 | 37.91 |
|       cushion       | 40.12 | 53.37 |
|         base        | 21.52 | 28.25 |
|         box         | 21.03 | 28.27 |
|        column       | 26.51 | 39.92 |
|      signboard      | 22.59 | 34.38 |
|   chest of drawers  | 32.73 | 50.59 |
|       counter       | 23.35 | 29.88 |
|         sand        |  33.3 | 51.54 |
|         sink        | 45.55 | 58.76 |
|      skyscraper     |  49.8 | 67.03 |
|      fireplace      | 62.34 | 83.67 |
|     refrigerator    | 62.16 | 75.05 |
|      grandstand     | 34.26 |  69.6 |
|         path        | 18.49 | 28.03 |
|        stairs       | 25.02 | 34.58 |
|        runway       | 62.32 |  82.8 |
|         case        | 40.89 | 53.16 |
|      pool table     | 77.52 | 87.99 |
|        pillow       | 42.83 | 56.27 |
|     screen door     |  62.6 | 71.61 |
|       stairway      | 27.22 | 34.55 |
|        river        |  8.56 | 18.77 |
|        bridge       | 45.35 | 55.27 |
|       bookcase      | 29.19 |  45.8 |
|        blind        | 34.95 | 40.91 |
|     coffee table    | 46.99 | 70.41 |
|        toilet       | 56.42 | 70.64 |
|        flower       | 29.91 | 43.03 |
|         book        | 29.64 | 49.48 |
|         hill        | 10.39 | 14.19 |
|        bench        | 38.48 | 46.22 |
|      countertop     | 38.19 | 63.21 |
|        stove        | 62.18 |  73.0 |
|         palm        | 34.91 | 53.54 |
|    kitchen island   | 28.62 | 50.12 |
|       computer      | 54.97 | 70.45 |
|     swivel chair    | 29.69 | 46.61 |
|         boat        | 60.39 |  74.6 |
|         bar         | 21.91 | 29.84 |
|    arcade machine   | 59.39 | 66.81 |
|        hovel        | 23.69 | 26.61 |
|         bus         | 72.63 |  86.2 |
|        towel        | 34.81 | 50.81 |
|        light        | 15.06 | 23.36 |
|        truck        | 33.69 | 48.33 |
|        tower        |  27.2 | 41.45 |
|      chandelier     | 47.84 | 63.41 |
|        awning       | 11.98 | 16.91 |
|     streetlight     |  8.41 | 13.26 |
|        booth        | 43.32 | 51.12 |
| television receiver |  46.8 | 61.89 |
|       airplane      | 45.19 | 60.74 |
|      dirt track     | 21.09 | 41.36 |
|       apparel       | 24.81 | 38.91 |
|         pole        |  5.47 |  9.27 |
|         land        |  3.34 |  5.37 |
|      bannister      |  9.21 | 13.51 |
|      escalator      | 32.35 |  38.4 |
|       ottoman       | 42.16 | 56.74 |
|        bottle       | 15.35 | 23.11 |
|        buffet       | 31.74 | 36.84 |
|        poster       | 18.01 | 26.01 |
|        stage        | 17.89 | 30.25 |
|         van         | 34.47 | 44.78 |
|         ship        | 36.81 | 45.08 |
|       fountain      | 20.57 | 21.58 |
|    conveyer belt    | 54.55 | 72.49 |
|        canopy       | 29.89 | 46.61 |
|        washer       | 68.42 | 72.78 |
|      plaything      | 22.74 | 36.26 |
|    swimming pool    | 36.61 | 57.68 |
|        stool        | 19.49 | 30.04 |
|        barrel       | 33.48 | 62.23 |
|        basket       | 26.22 | 36.59 |
|      waterfall      | 50.57 | 66.62 |
|         tent        |  78.9 | 94.38 |
|         bag         |  8.89 | 11.02 |
|       minibike      | 46.08 | 59.34 |
|        cradle       | 69.44 | 84.91 |
|         oven        | 45.01 | 61.38 |
|         ball        | 42.59 | 54.15 |
|         food        | 44.45 | 56.33 |
|         step        | 12.87 | 14.81 |
|         tank        | 54.76 |  60.3 |
|      trade name     | 14.83 | 19.49 |
|      microwave      | 69.97 | 80.94 |
|         pot         | 28.67 | 37.07 |
|        animal       | 47.85 | 53.48 |
|       bicycle       | 34.75 | 57.92 |
|         lake        | 57.61 | 59.74 |
|      dishwasher     | 48.54 | 61.69 |
|        screen       | 47.54 | 61.05 |
|       blanket       | 12.37 | 15.56 |
|      sculpture      | 42.51 | 69.55 |
|         hood        |  40.4 | 49.72 |
|        sconce       | 19.12 | 28.78 |
|         vase        | 20.96 | 33.05 |
|    traffic light    | 17.72 | 30.07 |
|         tray        |  5.74 |  8.53 |
|        ashcan       | 25.06 | 39.14 |
|         fan         | 26.33 | 41.19 |
|         pier        | 50.43 | 73.34 |
|      crt screen     | 14.29 | 25.62 |
|        plate        | 33.59 | 49.74 |
|       monitor       | 40.16 | 53.38 |
|    bulletin board   | 29.72 | 44.04 |
|        shower       |  2.02 |  8.92 |
|       radiator      | 37.14 | 48.01 |
|        glass        |  9.23 |  10.6 |
|        clock        | 23.51 | 33.16 |
|         flag        | 22.84 |  30.0 |
+---------------------+-------+-------+
10/06 07:51:35 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 74.3600  mIoU: 38.7300  mAcc: 51.7600  data_time: 0.0017  time: 1.1132
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
10/06 07:51:39 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1779776966
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1779776966
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 07:51:40 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/pixelate'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 07:51:44,014 - mmseg - INFO - using core type: DCNv3
2024-10-06 07:51:44,014 - mmseg - INFO - using activation layer: GELU
2024-10-06 07:51:44,015 - mmseg - INFO - using main norm layer: LN
2024-10-06 07:51:44,015 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 07:51:44,015 - mmseg - INFO - level2_post_norm: False
2024-10-06 07:51:44,015 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 07:51:44,015 - mmseg - INFO - res_post_norm: False
2024-10-06 07:51:44,015 - mmseg - INFO - use_dcn_v4_op: False
10/06 07:51:45 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 07:51:45 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 07:51:47 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 07:51:48 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 07:52:37 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:56  time: 0.4386  data_time: 0.0016  memory: 21070  
10/06 07:53:02 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:18  time: 0.5865  data_time: 0.0016  memory: 11890  
10/06 07:53:15 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:17:55  time: 0.2557  data_time: 0.0015  memory: 10810  
10/06 07:53:35 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:03  time: 0.3491  data_time: 0.0015  memory: 11893  
10/06 07:53:55 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:14:48  time: 0.1991  data_time: 0.0015  memory: 11870  
10/06 07:54:11 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:30  time: 0.0730  data_time: 0.0015  memory: 11897  
10/06 07:54:29 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:12:39  time: 0.2348  data_time: 0.0014  memory: 11905  
10/06 07:54:44 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:11:42  time: 0.2407  data_time: 0.0014  memory: 11872  
10/06 07:54:51 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:29  time: 0.1760  data_time: 0.0027  memory: 9599  
10/06 07:54:57 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:27  time: 0.0759  data_time: 0.0014  memory: 10790  
10/06 07:55:05 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:38  time: 0.2378  data_time: 0.0015  memory: 10822  
10/06 07:55:11 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:07:53  time: 0.2197  data_time: 0.0015  memory: 9783  
10/06 07:55:21 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:23  time: 0.2642  data_time: 0.0013  memory: 10827  
10/06 07:55:34 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:06:59  time: 0.0794  data_time: 0.0016  memory: 11903  
10/06 07:55:48 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:39  time: 0.5796  data_time: 0.0014  memory: 10832  
10/06 07:55:53 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:07  time: 0.0743  data_time: 0.0016  memory: 10811  
10/06 07:55:57 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:36  time: 0.0742  data_time: 0.0016  memory: 776  
10/06 07:56:04 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:12  time: 0.1712  data_time: 0.0014  memory: 9040  
10/06 07:56:17 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:04:57  time: 0.3360  data_time: 0.0015  memory: 10906  
10/06 07:56:25 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:36  time: 0.0662  data_time: 0.0014  memory: 10908  
10/06 07:56:35 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:19  time: 0.4282  data_time: 0.0014  memory: 10829  
10/06 07:56:45 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:02  time: 0.0680  data_time: 0.0015  memory: 10804  
10/06 07:56:51 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:43  time: 0.1977  data_time: 0.0014  memory: 10792  
10/06 07:56:55 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:24  time: 0.0757  data_time: 0.0014  memory: 1962  
10/06 07:57:02 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:08  time: 0.1955  data_time: 0.0014  memory: 11893  
10/06 07:57:05 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:02:50  time: 0.0690  data_time: 0.0014  memory: 778  
10/06 07:57:10 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:35  time: 0.0669  data_time: 0.0014  memory: 10787  
10/06 07:57:21 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:22  time: 0.2704  data_time: 0.0014  memory: 10816  
10/06 07:57:27 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:08  time: 0.2319  data_time: 0.0014  memory: 10798  
10/06 07:57:31 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:54  time: 0.0648  data_time: 0.0013  memory: 776  
10/06 07:57:36 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:41  time: 0.0774  data_time: 0.0015  memory: 10717  
10/06 07:57:40 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:27  time: 0.0736  data_time: 0.0015  memory: 774  
10/06 07:57:49 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:16  time: 0.0640  data_time: 0.0013  memory: 11903  
10/06 07:57:57 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:05  time: 0.0744  data_time: 0.0016  memory: 10806  
10/06 07:58:04 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:53  time: 0.0770  data_time: 0.0013  memory: 10789  
10/06 07:58:09 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:42  time: 0.0704  data_time: 0.0015  memory: 10790  
10/06 07:58:12 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:31  time: 0.0739  data_time: 0.0015  memory: 724  
10/06 07:58:18 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:20  time: 0.0743  data_time: 0.0014  memory: 10829  
10/06 07:58:25 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:10  time: 0.0652  data_time: 0.0014  memory: 10795  
10/06 07:58:32 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0658  data_time: 0.0013  memory: 8666  
10/06 07:58:32 - mmengine - INFO - per class results:
10/06 07:58:32 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.21 | 87.89 |
|       building      | 77.91 | 93.74 |
|         sky         | 93.86 | 97.14 |
|        floor        | 79.94 |  89.9 |
|         tree        | 69.97 | 83.61 |
|       ceiling       | 84.17 |  91.2 |
|         road        | 82.06 | 87.81 |
|         bed         | 88.38 | 95.04 |
|      windowpane     | 59.71 | 78.36 |
|        grass        | 61.99 | 73.66 |
|       cabinet       | 56.73 | 70.19 |
|       sidewalk      | 63.34 | 83.34 |
|        person       | 77.87 | 85.96 |
|        earth        | 31.99 | 46.38 |
|         door        | 46.31 | 59.29 |
|        table        | 57.22 | 73.88 |
|       mountain      | 55.05 | 67.99 |
|        plant        | 47.62 | 59.56 |
|       curtain       | 70.61 | 82.21 |
|        chair        | 55.83 | 70.52 |
|         car         | 79.11 |  85.5 |
|        water        |  49.8 | 66.78 |
|       painting      | 68.83 | 86.41 |
|         sofa        | 64.49 | 87.73 |
|        shelf        | 38.03 | 52.77 |
|        house        |  40.0 | 48.62 |
|         sea         | 50.82 | 67.94 |
|        mirror       |  63.3 | 70.29 |
|         rug         | 55.31 |  66.0 |
|        field        | 28.54 | 54.87 |
|       armchair      | 33.44 | 43.68 |
|         seat        | 56.64 | 82.26 |
|        fence        | 40.19 | 55.65 |
|         desk        | 44.09 | 54.08 |
|         rock        | 36.36 | 61.45 |
|       wardrobe      | 49.46 |  72.3 |
|         lamp        | 61.96 | 73.45 |
|       bathtub       | 73.22 | 80.04 |
|       railing       | 27.84 | 41.72 |
|       cushion       | 55.64 | 68.02 |
|         base        |  16.5 | 19.63 |
|         box         |  24.0 | 31.02 |
|        column       | 41.87 | 49.73 |
|      signboard      |  35.5 | 47.96 |
|   chest of drawers  | 35.45 | 62.01 |
|       counter       |  31.2 | 42.28 |
|         sand        | 33.38 | 49.22 |
|         sink        | 69.41 | 75.83 |
|      skyscraper     | 49.88 | 51.89 |
|      fireplace      | 72.96 | 84.31 |
|     refrigerator    | 73.33 | 84.93 |
|      grandstand     | 33.28 | 74.85 |
|         path        | 19.78 | 26.72 |
|        stairs       | 30.25 |  42.5 |
|        runway       | 70.61 | 93.81 |
|         case        | 37.59 | 59.35 |
|      pool table     | 91.31 |  94.1 |
|        pillow       | 52.26 | 58.46 |
|     screen door     |  72.4 | 80.97 |
|       stairway      | 29.71 | 37.07 |
|        river        |  8.11 | 18.25 |
|        bridge       |  56.0 | 65.19 |
|       bookcase      |  38.4 | 59.32 |
|        blind        | 32.69 | 37.31 |
|     coffee table    | 56.54 | 80.83 |
|        toilet       | 84.62 | 89.34 |
|        flower       | 32.27 |  40.1 |
|         book        | 36.79 | 54.35 |
|         hill        | 15.59 |  20.5 |
|        bench        | 42.04 | 52.76 |
|      countertop     | 49.27 | 65.66 |
|        stove        | 73.23 | 78.87 |
|         palm        | 44.94 | 53.76 |
|    kitchen island   | 37.51 | 70.22 |
|       computer      | 62.58 | 69.64 |
|     swivel chair    | 42.37 | 51.79 |
|         boat        | 35.88 |  37.3 |
|         bar         | 33.33 | 42.23 |
|    arcade machine   | 72.43 | 78.68 |
|        hovel        |  0.0  |  0.0  |
|         bus         | 81.04 |  95.9 |
|        towel        | 59.19 | 65.45 |
|        light        | 51.27 | 58.07 |
|        truck        | 32.23 | 50.96 |
|        tower        | 33.55 | 42.65 |
|      chandelier     | 63.58 | 81.91 |
|        awning       |  18.7 | 21.88 |
|     streetlight     | 23.67 | 33.09 |
|        booth        |  45.0 | 46.66 |
| television receiver | 65.86 | 84.04 |
|       airplane      | 51.51 | 56.02 |
|      dirt track     | 19.22 | 22.07 |
|       apparel       | 30.78 | 38.19 |
|         pole        | 17.93 | 25.26 |
|         land        |  3.03 |  4.97 |
|      bannister      | 14.18 | 20.07 |
|      escalator      |  22.0 | 25.15 |
|       ottoman       | 41.87 | 51.96 |
|        bottle       | 23.68 | 33.42 |
|        buffet       | 44.71 | 55.51 |
|        poster       | 23.36 | 30.36 |
|        stage        | 21.45 |  27.9 |
|         van         | 36.71 |  71.5 |
|         ship        |  3.87 |  6.34 |
|       fountain      | 23.36 | 24.87 |
|    conveyer belt    | 61.95 | 75.79 |
|        canopy       | 32.93 |  34.0 |
|        washer       | 73.38 | 74.07 |
|      plaything      | 18.38 | 22.64 |
|    swimming pool    | 38.87 | 64.02 |
|        stool        | 36.76 | 46.04 |
|        barrel       | 60.27 | 87.14 |
|        basket       | 27.59 | 35.41 |
|      waterfall      | 39.22 | 45.34 |
|         tent        |  95.3 | 97.84 |
|         bag         |  7.79 |  8.21 |
|       minibike      | 39.44 | 41.37 |
|        cradle       | 79.34 | 92.65 |
|         oven        | 32.77 | 62.12 |
|         ball        | 41.21 | 64.38 |
|         food        | 31.77 | 34.46 |
|         step        | 16.36 | 17.82 |
|         tank        | 48.69 | 53.35 |
|      trade name     |  31.1 | 37.58 |
|      microwave      | 49.21 | 54.11 |
|         pot         | 44.19 | 49.75 |
|        animal       | 49.39 | 50.07 |
|       bicycle       | 51.27 | 67.09 |
|         lake        | 62.29 | 63.45 |
|      dishwasher     | 66.97 | 80.77 |
|        screen       | 54.57 | 67.09 |
|       blanket       | 12.44 | 13.65 |
|      sculpture      | 44.24 | 47.26 |
|         hood        | 54.92 |  58.7 |
|        sconce       | 39.87 | 47.33 |
|         vase        | 34.69 | 43.23 |
|    traffic light    | 23.64 | 30.17 |
|         tray        |  7.57 | 12.18 |
|        ashcan       | 42.73 |  51.5 |
|         fan         | 59.31 | 66.13 |
|         pier        | 21.26 | 29.06 |
|      crt screen     |  8.51 | 26.05 |
|        plate        | 36.63 | 45.93 |
|       monitor       | 22.81 | 31.61 |
|    bulletin board   | 40.64 | 51.06 |
|        shower       |  1.98 |  2.15 |
|       radiator      |  46.5 | 62.67 |
|        glass        | 12.03 |  12.7 |
|        clock        | 33.56 | 41.26 |
|         flag        | 30.34 | 32.14 |
+---------------------+-------+-------+
10/06 07:58:32 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.0300  mIoU: 44.9600  mAcc: 55.5700  data_time: 0.0016  time: 0.2020
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
10/06 07:58:36 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1861439009
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1861439009
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 07:58:37 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/jpeg_compression'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 07:58:40,499 - mmseg - INFO - using core type: DCNv3
2024-10-06 07:58:40,499 - mmseg - INFO - using activation layer: GELU
2024-10-06 07:58:40,499 - mmseg - INFO - using main norm layer: LN
2024-10-06 07:58:40,499 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 07:58:40,499 - mmseg - INFO - level2_post_norm: False
2024-10-06 07:58:40,499 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 07:58:40,499 - mmseg - INFO - res_post_norm: False
2024-10-06 07:58:40,499 - mmseg - INFO - use_dcn_v4_op: False
10/06 07:58:42 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 07:58:42 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 07:58:43 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 07:58:45 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 07:59:34 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:32:20  time: 0.4428  data_time: 0.0015  memory: 21070  
10/06 07:59:59 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:36  time: 0.5919  data_time: 0.0015  memory: 11890  
10/06 08:00:13 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:08  time: 0.2587  data_time: 0.0022  memory: 10810  
10/06 08:00:33 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:16  time: 0.3572  data_time: 0.0015  memory: 11893  
10/06 08:00:53 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:15:00  time: 0.2069  data_time: 0.0014  memory: 11870  
10/06 08:01:10 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:42  time: 0.0808  data_time: 0.0016  memory: 11897  
10/06 08:01:28 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:12:51  time: 0.2422  data_time: 0.0014  memory: 11905  
10/06 08:01:43 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:11:54  time: 0.2482  data_time: 0.0014  memory: 11872  
10/06 08:01:50 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:39  time: 0.1784  data_time: 0.0014  memory: 9599  
10/06 08:01:57 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:38  time: 0.0832  data_time: 0.0015  memory: 10790  
10/06 08:02:05 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:48  time: 0.2450  data_time: 0.0015  memory: 10822  
10/06 08:02:12 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:03  time: 0.2287  data_time: 0.0015  memory: 9783  
10/06 08:02:23 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:32  time: 0.2737  data_time: 0.0014  memory: 10827  
10/06 08:02:36 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:09  time: 0.0860  data_time: 0.0016  memory: 11903  
10/06 08:02:50 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:48  time: 0.5840  data_time: 0.0014  memory: 10832  
10/06 08:02:56 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:16  time: 0.0815  data_time: 0.0016  memory: 10811  
10/06 08:03:00 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:44  time: 0.0832  data_time: 0.0016  memory: 776  
10/06 08:03:07 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:20  time: 0.1732  data_time: 0.0013  memory: 9040  
10/06 08:03:20 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:04  time: 0.3442  data_time: 0.0015  memory: 10906  
10/06 08:03:28 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:43  time: 0.0735  data_time: 0.0014  memory: 10908  
10/06 08:03:40 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:26  time: 0.4342  data_time: 0.0015  memory: 10829  
10/06 08:03:49 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:08  time: 0.0739  data_time: 0.0014  memory: 10804  
10/06 08:03:56 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:49  time: 0.2092  data_time: 0.0015  memory: 10792  
10/06 08:04:00 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:30  time: 0.0828  data_time: 0.0015  memory: 1962  
10/06 08:04:07 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:13  time: 0.1983  data_time: 0.0014  memory: 11893  
10/06 08:04:11 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:02:55  time: 0.0778  data_time: 0.0032  memory: 778  
10/06 08:04:16 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:39  time: 0.0795  data_time: 0.0014  memory: 10787  
10/06 08:04:27 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:26  time: 0.2705  data_time: 0.0014  memory: 10816  
10/06 08:04:34 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:12  time: 0.2435  data_time: 0.0014  memory: 10798  
10/06 08:04:38 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:57  time: 0.0769  data_time: 0.0014  memory: 776  
10/06 08:04:44 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:44  time: 0.0837  data_time: 0.0015  memory: 10717  
10/06 08:04:48 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:30  time: 0.0730  data_time: 0.0015  memory: 774  
10/06 08:04:57 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:18  time: 0.0758  data_time: 0.0014  memory: 11903  
10/06 08:05:05 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:07  time: 0.0735  data_time: 0.0015  memory: 10806  
10/06 08:05:12 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:55  time: 0.0835  data_time: 0.0014  memory: 10789  
10/06 08:05:18 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:43  time: 0.0836  data_time: 0.0016  memory: 10790  
10/06 08:05:22 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:32  time: 0.0816  data_time: 0.0016  memory: 724  
10/06 08:05:27 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:21  time: 0.0741  data_time: 0.0014  memory: 10829  
10/06 08:05:35 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:10  time: 0.0786  data_time: 0.0014  memory: 10795  
10/06 08:05:43 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0720  data_time: 0.0013  memory: 8666  
10/06 08:05:43 - mmengine - INFO - per class results:
10/06 08:05:43 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.76 | 88.53 |
|       building      | 81.33 | 92.72 |
|         sky         | 93.92 | 97.43 |
|        floor        | 79.02 | 90.87 |
|         tree        | 72.78 | 86.24 |
|       ceiling       | 82.34 | 89.74 |
|         road        | 81.34 | 90.23 |
|         bed         | 88.93 | 95.24 |
|      windowpane     | 60.12 | 77.32 |
|        grass        | 66.15 | 76.73 |
|       cabinet       | 56.95 | 69.01 |
|       sidewalk      | 62.43 | 76.21 |
|        person       |  79.0 | 89.88 |
|        earth        |  33.9 | 52.46 |
|         door        | 47.12 | 59.42 |
|        table        | 58.38 | 74.84 |
|       mountain      | 55.94 | 74.85 |
|        plant        | 48.59 | 59.01 |
|       curtain       | 71.21 | 82.58 |
|        chair        | 54.99 | 66.01 |
|         car         | 84.01 | 91.66 |
|        water        |  49.7 | 62.59 |
|       painting      | 72.03 | 86.41 |
|         sofa        | 62.96 | 83.03 |
|        shelf        | 38.36 | 54.86 |
|        house        | 42.54 | 58.22 |
|         sea         | 56.05 | 76.58 |
|        mirror       |  63.2 |  68.5 |
|         rug         | 51.73 |  59.8 |
|        field        | 34.18 |  57.3 |
|       armchair      |  39.5 | 56.14 |
|         seat        | 59.32 | 79.39 |
|        fence        | 42.81 | 59.15 |
|         desk        | 49.86 | 66.02 |
|         rock        | 40.98 |  61.5 |
|       wardrobe      | 43.46 | 70.48 |
|         lamp        | 62.15 | 73.94 |
|       bathtub       | 74.25 | 83.21 |
|       railing       | 31.21 | 41.53 |
|       cushion       | 56.21 | 66.92 |
|         base        | 20.47 | 25.34 |
|         box         | 20.77 | 27.19 |
|        column       |  44.4 |  53.8 |
|      signboard      | 34.43 |  43.7 |
|   chest of drawers  | 39.71 | 62.93 |
|       counter       | 26.85 | 31.84 |
|         sand        | 35.88 | 53.92 |
|         sink        |  69.0 | 76.47 |
|      skyscraper     | 61.94 |  80.1 |
|      fireplace      | 74.04 | 84.89 |
|     refrigerator    | 72.92 | 84.18 |
|      grandstand     | 39.61 | 73.63 |
|         path        |  22.1 | 33.35 |
|        stairs       | 30.73 | 38.83 |
|        runway       |  72.2 | 93.47 |
|         case        | 42.81 | 56.11 |
|      pool table     | 91.42 |  95.6 |
|        pillow       |  56.5 | 65.23 |
|     screen door     | 65.56 | 69.25 |
|       stairway      | 30.09 | 38.43 |
|        river        |  8.36 |  20.5 |
|        bridge       | 38.14 | 43.82 |
|       bookcase      | 36.85 | 59.26 |
|        blind        | 26.16 | 27.68 |
|     coffee table    | 59.41 | 82.14 |
|        toilet       | 82.12 | 88.92 |
|        flower       | 39.74 | 50.38 |
|         book        | 47.77 |  69.1 |
|         hill        |  14.1 | 18.21 |
|        bench        | 43.79 | 53.89 |
|      countertop     | 46.58 | 66.58 |
|        stove        |  76.5 | 84.71 |
|         palm        | 48.22 | 62.54 |
|    kitchen island   | 27.98 | 49.15 |
|       computer      | 60.12 | 66.47 |
|     swivel chair    | 43.06 | 57.26 |
|         boat        | 48.81 | 57.22 |
|         bar         | 31.81 |  43.5 |
|    arcade machine   | 85.39 | 90.86 |
|        hovel        | 15.35 | 17.33 |
|         bus         | 87.33 | 96.53 |
|        towel        | 59.54 | 66.98 |
|        light        | 49.59 | 55.23 |
|        truck        | 35.85 | 47.47 |
|        tower        | 32.47 | 49.07 |
|      chandelier     |  66.9 |  79.5 |
|        awning       | 21.49 |  25.3 |
|     streetlight     | 22.32 |  28.4 |
|        booth        | 59.58 | 64.63 |
| television receiver | 66.72 | 77.82 |
|       airplane      | 59.42 | 68.06 |
|      dirt track     | 21.91 | 41.85 |
|       apparel       | 31.29 | 37.82 |
|         pole        | 18.41 | 26.63 |
|         land        |  3.64 |  4.77 |
|      bannister      | 16.97 | 22.33 |
|      escalator      | 37.49 | 56.96 |
|       ottoman       | 44.98 | 56.68 |
|        bottle       | 22.69 | 29.53 |
|        buffet       | 39.34 | 45.82 |
|        poster       | 28.92 | 35.32 |
|        stage        | 19.79 | 27.42 |
|         van         | 44.45 | 60.88 |
|         ship        | 35.01 | 49.31 |
|       fountain      | 22.52 | 23.58 |
|    conveyer belt    | 55.38 | 69.05 |
|        canopy       |  40.2 | 49.07 |
|        washer       | 72.39 | 77.08 |
|      plaything      | 31.23 | 45.36 |
|    swimming pool    | 38.46 | 56.26 |
|        stool        | 38.27 | 48.46 |
|        barrel       | 53.16 | 66.55 |
|        basket       | 28.95 | 36.41 |
|      waterfall      | 58.51 | 70.83 |
|         tent        | 94.54 | 98.27 |
|         bag         |  7.87 |  8.84 |
|       minibike      | 63.62 | 73.13 |
|        cradle       | 76.61 | 94.73 |
|         oven        | 42.46 | 60.06 |
|         ball        |  46.9 | 61.15 |
|         food        | 52.75 | 64.58 |
|         step        | 15.69 | 16.91 |
|         tank        | 46.45 | 48.99 |
|      trade name     | 28.14 | 32.78 |
|      microwave      |  64.3 | 69.39 |
|         pot         | 41.51 | 47.27 |
|        animal       |  57.3 | 59.01 |
|       bicycle       | 55.71 | 71.74 |
|         lake        | 62.18 | 63.27 |
|      dishwasher     | 63.47 | 74.75 |
|        screen       | 53.02 | 66.46 |
|       blanket       |  9.27 | 10.34 |
|      sculpture      |  71.1 |  81.2 |
|         hood        | 55.02 | 58.84 |
|        sconce       | 36.78 |  44.6 |
|         vase        | 37.22 |  44.9 |
|    traffic light    | 26.95 | 38.82 |
|         tray        |  5.94 | 11.09 |
|        ashcan       | 40.33 | 51.12 |
|         fan         | 58.39 | 66.99 |
|         pier        | 48.75 | 61.67 |
|      crt screen     |  4.99 | 12.52 |
|        plate        | 41.95 | 54.72 |
|       monitor       | 22.69 | 27.56 |
|    bulletin board   | 36.69 | 48.65 |
|        shower       |  2.05 |  9.05 |
|       radiator      | 49.64 | 58.71 |
|        glass        | 11.83 | 12.65 |
|        clock        | 33.92 | 38.89 |
|         flag        | 44.61 | 48.43 |
+---------------------+-------+-------+
10/06 08:05:43 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.7900  mIoU: 47.4100  mAcc: 58.2200  data_time: 0.0016  time: 0.2090
Finished processing corruption type: jpeg_compression
Processing corruption type: elastic_transform
10/06 08:05:50 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 946919393
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 946919393
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 08:05:51 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/elastic_transform'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 08:05:57,328 - mmseg - INFO - using core type: DCNv3
2024-10-06 08:05:57,328 - mmseg - INFO - using activation layer: GELU
2024-10-06 08:05:57,328 - mmseg - INFO - using main norm layer: LN
2024-10-06 08:05:57,328 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 08:05:57,328 - mmseg - INFO - level2_post_norm: False
2024-10-06 08:05:57,329 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 08:05:57,329 - mmseg - INFO - res_post_norm: False
2024-10-06 08:05:57,329 - mmseg - INFO - use_dcn_v4_op: False
10/06 08:06:00 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 08:06:00 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 08:06:01 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 08:06:03 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 08:07:39 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:02:25  time: 1.4376  data_time: 0.0015  memory: 21070  
10/06 08:08:50 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:53:03  time: 1.5534  data_time: 0.0016  memory: 11890  
10/06 08:09:51 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:46:54  time: 1.2109  data_time: 0.0015  memory: 10810  
10/06 08:10:59 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:44:23  time: 1.2869  data_time: 0.0015  memory: 11893  
10/06 08:12:04 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:42:10  time: 1.1437  data_time: 0.0014  memory: 11870  
10/06 08:13:06 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:39:59  time: 1.0263  data_time: 0.0017  memory: 11897  
10/06 08:14:10 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:38:18  time: 1.1131  data_time: 0.0015  memory: 11905  
10/06 08:15:11 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:36:31  time: 1.1840  data_time: 0.0014  memory: 11872  
10/06 08:16:00 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:34:15  time: 1.0297  data_time: 0.0014  memory: 9599  
10/06 08:16:52 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:32:27  time: 0.9560  data_time: 0.0015  memory: 10790  
10/06 08:17:48 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:30:59  time: 1.2106  data_time: 0.0016  memory: 10822  
10/06 08:18:40 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:29:26  time: 1.1774  data_time: 0.0016  memory: 9783  
10/06 08:19:35 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:28:07  time: 1.1632  data_time: 0.0014  memory: 10827  
10/06 08:20:36 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:27:01  time: 1.0287  data_time: 0.0016  memory: 11903  
10/06 08:21:37 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:25:56  time: 1.4690  data_time: 0.0014  memory: 10832  
10/06 08:22:25 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:24:33  time: 1.0087  data_time: 0.0017  memory: 10811  
10/06 08:23:16 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:23:17  time: 1.0067  data_time: 0.0016  memory: 776  
10/06 08:24:05 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:22:03  time: 0.9973  data_time: 0.0014  memory: 9040  
10/06 08:25:05 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:21:02  time: 1.2447  data_time: 0.0016  memory: 10906  
10/06 08:25:57 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:19:54  time: 0.9591  data_time: 0.0015  memory: 10908  
10/06 08:26:55 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:18:52  time: 1.3782  data_time: 0.0015  memory: 10829  
10/06 08:27:50 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:17:49  time: 0.9639  data_time: 0.0015  memory: 10804  
10/06 08:28:42 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:16:44  time: 1.1372  data_time: 0.0015  memory: 10792  
10/06 08:29:32 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:15:39  time: 0.9466  data_time: 0.0015  memory: 1962  
10/06 08:30:23 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:14:36  time: 1.0931  data_time: 0.0015  memory: 11893  
10/06 08:31:10 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:13:31  time: 0.9865  data_time: 0.0015  memory: 778  
10/06 08:32:00 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:12:29  time: 0.9447  data_time: 0.0015  memory: 10787  
10/06 08:32:57 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:11:31  time: 1.2181  data_time: 0.0015  memory: 10816  
10/06 08:33:47 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:10:31  time: 1.1959  data_time: 0.0015  memory: 10798  
10/06 08:34:35 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:09:30  time: 0.9149  data_time: 0.0015  memory: 776  
10/06 08:35:28 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:08:32  time: 1.0038  data_time: 0.0015  memory: 10717  
10/06 08:36:16 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:07:33  time: 0.9711  data_time: 0.0016  memory: 774  
10/06 08:37:10 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:35  time: 0.9017  data_time: 0.0015  memory: 11903  
10/06 08:38:04 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:38  time: 1.0019  data_time: 0.0016  memory: 10806  
10/06 08:38:57 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:42  time: 0.9926  data_time: 0.0015  memory: 10789  
10/06 08:39:46 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:44  time: 1.0166  data_time: 0.0016  memory: 10790  
10/06 08:40:36 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:48  time: 0.9984  data_time: 0.0016  memory: 724  
10/06 08:41:24 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:51  time: 0.9740  data_time: 0.0015  memory: 10829  
10/06 08:42:17 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:55  time: 0.9630  data_time: 0.0015  memory: 10795  
10/06 08:43:08 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.8842  data_time: 0.0014  memory: 8666  
10/06 08:43:08 - mmengine - INFO - per class results:
10/06 08:43:08 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 63.52 | 78.33 |
|       building      | 73.07 | 86.85 |
|         sky         | 84.34 | 91.45 |
|        floor        | 68.14 | 82.35 |
|         tree        | 62.26 |  79.1 |
|       ceiling       | 69.77 | 81.82 |
|         road        | 77.15 | 87.15 |
|         bed         | 77.13 | 88.07 |
|      windowpane     | 48.99 | 66.92 |
|        grass        | 59.44 | 75.37 |
|       cabinet       | 48.15 | 61.93 |
|       sidewalk      | 52.96 |  66.7 |
|        person       | 60.86 | 78.21 |
|        earth        | 34.22 | 49.23 |
|         door        | 41.37 | 54.92 |
|        table        | 44.58 | 63.57 |
|       mountain      | 50.78 | 68.58 |
|        plant        | 42.39 | 57.01 |
|       curtain       | 53.13 | 72.43 |
|        chair        | 40.44 | 57.91 |
|         car         | 62.01 | 77.82 |
|        water        | 53.81 |  70.2 |
|       painting      | 45.72 | 66.38 |
|         sofa        | 49.03 | 66.24 |
|        shelf        | 33.89 | 52.54 |
|        house        |  36.7 | 54.58 |
|         sea         | 51.71 |  66.7 |
|        mirror       | 52.23 | 62.97 |
|         rug         | 44.09 | 57.87 |
|        field        | 28.18 | 40.01 |
|       armchair      | 32.22 | 51.43 |
|         seat        | 56.82 | 74.94 |
|        fence        | 34.18 |  51.6 |
|         desk        | 38.67 | 54.95 |
|         rock        | 33.17 | 52.69 |
|       wardrobe      | 43.67 | 68.34 |
|         lamp        | 32.91 | 50.16 |
|       bathtub       | 59.81 | 72.19 |
|       railing       | 24.96 | 40.45 |
|       cushion       | 38.58 | 52.05 |
|         base        | 17.91 | 23.46 |
|         box         | 22.42 | 30.43 |
|        column       | 29.07 |  44.1 |
|      signboard      | 22.55 | 34.08 |
|   chest of drawers  | 32.18 | 51.32 |
|       counter       | 24.39 |  30.5 |
|         sand        | 31.36 | 51.12 |
|         sink        | 46.33 | 60.04 |
|      skyscraper     | 52.24 | 71.77 |
|      fireplace      | 59.81 | 81.63 |
|     refrigerator    | 61.68 | 75.03 |
|      grandstand     | 37.72 | 73.27 |
|         path        | 18.92 | 28.31 |
|        stairs       | 22.13 | 29.76 |
|        runway       | 66.34 | 88.02 |
|         case        | 39.66 | 50.74 |
|      pool table     |  76.3 | 86.45 |
|        pillow       | 42.28 | 56.17 |
|     screen door     |  58.7 |  74.0 |
|       stairway      | 24.57 | 32.24 |
|        river        |  8.73 | 19.04 |
|        bridge       | 50.43 |  60.6 |
|       bookcase      | 29.63 | 48.38 |
|        blind        | 30.13 | 34.75 |
|     coffee table    | 45.83 | 68.32 |
|        toilet       | 59.26 | 75.34 |
|        flower       | 26.67 | 39.01 |
|         book        | 33.03 | 52.25 |
|         hill        |  11.5 | 16.67 |
|        bench        | 38.31 | 48.64 |
|      countertop     | 33.53 | 56.35 |
|        stove        | 63.58 | 74.83 |
|         palm        | 36.49 | 53.92 |
|    kitchen island   | 30.27 | 52.05 |
|       computer      | 58.36 | 73.62 |
|     swivel chair    | 31.92 | 49.49 |
|         boat        | 48.35 | 62.36 |
|         bar         |  26.1 | 35.06 |
|    arcade machine   | 62.58 | 69.61 |
|        hovel        | 21.67 | 24.93 |
|         bus         | 73.17 | 89.75 |
|        towel        | 40.62 | 57.86 |
|        light        | 13.53 | 21.68 |
|        truck        | 30.03 | 45.66 |
|        tower        | 19.06 | 32.82 |
|      chandelier     | 45.55 | 63.02 |
|        awning       | 17.62 | 24.03 |
|     streetlight     |  8.81 | 14.12 |
|        booth        | 35.21 | 37.92 |
| television receiver | 47.26 | 61.15 |
|       airplane      | 36.69 | 51.99 |
|      dirt track     | 24.56 |  53.4 |
|       apparel       | 23.57 | 38.72 |
|         pole        | 10.66 | 16.75 |
|         land        |  2.31 |  3.82 |
|      bannister      |  8.57 | 12.81 |
|      escalator      | 30.42 | 37.21 |
|       ottoman       | 39.01 | 55.52 |
|        bottle       | 22.72 |  36.1 |
|        buffet       | 31.68 | 36.82 |
|        poster       | 20.65 | 29.67 |
|        stage        | 15.63 | 24.46 |
|         van         | 35.37 | 45.29 |
|         ship        |  5.34 |  6.64 |
|       fountain      | 18.25 | 19.88 |
|    conveyer belt    | 64.15 | 83.08 |
|        canopy       | 24.78 | 38.74 |
|        washer       | 65.49 | 70.26 |
|      plaything      | 19.53 | 36.14 |
|    swimming pool    | 40.26 | 64.93 |
|        stool        | 22.89 | 35.32 |
|        barrel       | 32.62 |  63.0 |
|        basket       | 22.48 | 32.92 |
|      waterfall      | 55.87 | 69.67 |
|         tent        |  80.5 | 89.69 |
|         bag         |  7.27 |  9.18 |
|       minibike      | 49.96 | 67.96 |
|        cradle       | 65.63 | 84.15 |
|         oven        | 43.88 | 54.61 |
|         ball        | 42.09 | 54.06 |
|         food        | 47.17 | 59.54 |
|         step        | 11.57 | 13.65 |
|         tank        | 54.83 | 61.22 |
|      trade name     | 16.62 | 21.63 |
|      microwave      | 72.23 | 80.89 |
|         pot         | 26.87 | 35.29 |
|        animal       | 49.58 | 55.95 |
|       bicycle       | 37.74 | 59.42 |
|         lake        | 60.19 | 62.25 |
|      dishwasher     | 52.06 | 67.21 |
|        screen       | 49.65 | 65.16 |
|       blanket       | 13.46 | 16.44 |
|      sculpture      | 40.96 | 67.05 |
|         hood        | 35.69 | 46.51 |
|        sconce       | 18.46 | 27.58 |
|         vase        | 19.96 | 31.37 |
|    traffic light    | 15.94 | 26.99 |
|         tray        |  3.22 |  5.65 |
|        ashcan       | 31.27 | 48.73 |
|         fan         |  29.5 |  43.8 |
|         pier        | 49.84 | 75.12 |
|      crt screen     | 11.01 | 23.53 |
|        plate        | 33.38 | 49.22 |
|       monitor       | 22.28 | 30.15 |
|    bulletin board   |  34.0 | 47.05 |
|        shower       |  2.68 | 10.73 |
|       radiator      | 39.06 | 50.91 |
|        glass        | 10.12 | 11.64 |
|        clock        | 10.97 | 16.99 |
|         flag        |  21.7 | 27.11 |
+---------------------+-------+-------+
10/06 08:43:08 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 74.4700  mIoU: 38.3600  mAcc: 51.5300  data_time: 0.0017  time: 1.1127
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
10/06 08:43:12 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 702932430
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 702932430
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 08:43:13 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/pixelate'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 08:43:16,461 - mmseg - INFO - using core type: DCNv3
2024-10-06 08:43:16,461 - mmseg - INFO - using activation layer: GELU
2024-10-06 08:43:16,462 - mmseg - INFO - using main norm layer: LN
2024-10-06 08:43:16,462 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 08:43:16,462 - mmseg - INFO - level2_post_norm: False
2024-10-06 08:43:16,462 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 08:43:16,462 - mmseg - INFO - res_post_norm: False
2024-10-06 08:43:16,462 - mmseg - INFO - use_dcn_v4_op: False
10/06 08:43:18 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 08:43:18 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 08:43:19 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 08:43:21 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 08:44:10 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:52  time: 0.4322  data_time: 0.0015  memory: 21070  
10/06 08:44:34 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:16  time: 0.5850  data_time: 0.0015  memory: 11890  
10/06 08:44:48 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:17:54  time: 0.2517  data_time: 0.0014  memory: 10810  
10/06 08:45:08 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:04  time: 0.3439  data_time: 0.0014  memory: 11893  
10/06 08:45:28 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:14:48  time: 0.1948  data_time: 0.0014  memory: 11870  
10/06 08:45:44 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:30  time: 0.0770  data_time: 0.0016  memory: 11897  
10/06 08:46:02 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:12:39  time: 0.2400  data_time: 0.0014  memory: 11905  
10/06 08:46:16 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:11:42  time: 0.2418  data_time: 0.0014  memory: 11872  
10/06 08:46:24 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:29  time: 0.1789  data_time: 0.0014  memory: 9599  
10/06 08:46:30 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:27  time: 0.0683  data_time: 0.0014  memory: 10790  
10/06 08:46:37 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:37  time: 0.2430  data_time: 0.0016  memory: 10822  
10/06 08:46:44 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:07:53  time: 0.2237  data_time: 0.0015  memory: 9783  
10/06 08:46:54 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:22  time: 0.2651  data_time: 0.0013  memory: 10827  
10/06 08:47:07 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:06:59  time: 0.0741  data_time: 0.0015  memory: 11903  
10/06 08:47:20 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:39  time: 0.5823  data_time: 0.0014  memory: 10832  
10/06 08:47:26 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:07  time: 0.0688  data_time: 0.0015  memory: 10811  
10/06 08:47:29 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:36  time: 0.0678  data_time: 0.0015  memory: 776  
10/06 08:47:36 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:12  time: 0.1742  data_time: 0.0014  memory: 9040  
10/06 08:47:49 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:04:56  time: 0.3305  data_time: 0.0014  memory: 10906  
10/06 08:47:57 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:35  time: 0.0713  data_time: 0.0014  memory: 10908  
10/06 08:48:08 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:19  time: 0.4242  data_time: 0.0014  memory: 10829  
10/06 08:48:17 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:02  time: 0.0734  data_time: 0.0015  memory: 10804  
10/06 08:48:23 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:43  time: 0.2015  data_time: 0.0014  memory: 10792  
10/06 08:48:27 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:24  time: 0.0695  data_time: 0.0014  memory: 1962  
10/06 08:48:34 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:07  time: 0.1969  data_time: 0.0014  memory: 11893  
10/06 08:48:37 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:02:50  time: 0.0733  data_time: 0.0014  memory: 778  
10/06 08:48:42 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:34  time: 0.0723  data_time: 0.0014  memory: 10787  
10/06 08:48:53 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:22  time: 0.2673  data_time: 0.0029  memory: 10816  
10/06 08:49:00 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:08  time: 0.2361  data_time: 0.0014  memory: 10798  
10/06 08:49:03 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:54  time: 0.0703  data_time: 0.0014  memory: 776  
10/06 08:49:09 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:40  time: 0.0715  data_time: 0.0014  memory: 10717  
10/06 08:49:12 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:27  time: 0.0734  data_time: 0.0015  memory: 774  
10/06 08:49:21 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:16  time: 0.0700  data_time: 0.0014  memory: 11903  
10/06 08:49:29 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:04  time: 0.0689  data_time: 0.0015  memory: 10806  
10/06 08:49:36 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:53  time: 0.0766  data_time: 0.0014  memory: 10789  
10/06 08:49:41 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:42  time: 0.0742  data_time: 0.0016  memory: 10790  
10/06 08:49:45 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:31  time: 0.0681  data_time: 0.0015  memory: 724  
10/06 08:49:50 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:20  time: 0.0686  data_time: 0.0014  memory: 10829  
10/06 08:49:57 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:10  time: 0.0712  data_time: 0.0014  memory: 10795  
10/06 08:50:04 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0615  data_time: 0.0012  memory: 8666  
10/06 08:50:04 - mmengine - INFO - per class results:
10/06 08:50:04 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.21 | 87.89 |
|       building      | 77.91 | 93.74 |
|         sky         | 93.86 | 97.14 |
|        floor        | 79.94 |  89.9 |
|         tree        | 69.97 | 83.61 |
|       ceiling       | 84.17 |  91.2 |
|         road        | 82.06 | 87.81 |
|         bed         | 88.38 | 95.04 |
|      windowpane     | 59.71 | 78.36 |
|        grass        | 61.99 | 73.66 |
|       cabinet       | 56.73 | 70.19 |
|       sidewalk      | 63.34 | 83.34 |
|        person       | 77.87 | 85.96 |
|        earth        | 31.99 | 46.38 |
|         door        | 46.31 | 59.29 |
|        table        | 57.22 | 73.88 |
|       mountain      | 55.05 | 67.99 |
|        plant        | 47.62 | 59.56 |
|       curtain       | 70.61 | 82.21 |
|        chair        | 55.83 | 70.52 |
|         car         | 79.11 |  85.5 |
|        water        |  49.8 | 66.78 |
|       painting      | 68.83 | 86.41 |
|         sofa        | 64.49 | 87.73 |
|        shelf        | 38.03 | 52.77 |
|        house        |  40.0 | 48.62 |
|         sea         | 50.82 | 67.94 |
|        mirror       |  63.3 | 70.29 |
|         rug         | 55.31 |  66.0 |
|        field        | 28.54 | 54.87 |
|       armchair      | 33.44 | 43.68 |
|         seat        | 56.64 | 82.26 |
|        fence        | 40.19 | 55.65 |
|         desk        | 44.09 | 54.08 |
|         rock        | 36.36 | 61.45 |
|       wardrobe      | 49.46 |  72.3 |
|         lamp        | 61.96 | 73.45 |
|       bathtub       | 73.22 | 80.04 |
|       railing       | 27.84 | 41.72 |
|       cushion       | 55.64 | 68.02 |
|         base        |  16.5 | 19.63 |
|         box         |  24.0 | 31.02 |
|        column       | 41.87 | 49.73 |
|      signboard      |  35.5 | 47.96 |
|   chest of drawers  | 35.45 | 62.01 |
|       counter       |  31.2 | 42.28 |
|         sand        | 33.38 | 49.22 |
|         sink        | 69.41 | 75.83 |
|      skyscraper     | 49.88 | 51.89 |
|      fireplace      | 72.96 | 84.31 |
|     refrigerator    | 73.33 | 84.93 |
|      grandstand     | 33.28 | 74.85 |
|         path        | 19.78 | 26.72 |
|        stairs       | 30.25 |  42.5 |
|        runway       | 70.61 | 93.81 |
|         case        | 37.59 | 59.35 |
|      pool table     | 91.31 |  94.1 |
|        pillow       | 52.26 | 58.46 |
|     screen door     |  72.4 | 80.97 |
|       stairway      | 29.71 | 37.07 |
|        river        |  8.11 | 18.25 |
|        bridge       |  56.0 | 65.19 |
|       bookcase      |  38.4 | 59.32 |
|        blind        | 32.69 | 37.31 |
|     coffee table    | 56.54 | 80.83 |
|        toilet       | 84.62 | 89.34 |
|        flower       | 32.27 |  40.1 |
|         book        | 36.79 | 54.35 |
|         hill        | 15.59 |  20.5 |
|        bench        | 42.04 | 52.76 |
|      countertop     | 49.27 | 65.66 |
|        stove        | 73.23 | 78.87 |
|         palm        | 44.94 | 53.76 |
|    kitchen island   | 37.51 | 70.22 |
|       computer      | 62.58 | 69.64 |
|     swivel chair    | 42.37 | 51.79 |
|         boat        | 35.88 |  37.3 |
|         bar         | 33.33 | 42.23 |
|    arcade machine   | 72.43 | 78.68 |
|        hovel        |  0.0  |  0.0  |
|         bus         | 81.04 |  95.9 |
|        towel        | 59.19 | 65.45 |
|        light        | 51.27 | 58.07 |
|        truck        | 32.23 | 50.96 |
|        tower        | 33.55 | 42.65 |
|      chandelier     | 63.58 | 81.91 |
|        awning       |  18.7 | 21.88 |
|     streetlight     | 23.67 | 33.09 |
|        booth        |  45.0 | 46.66 |
| television receiver | 65.86 | 84.04 |
|       airplane      | 51.51 | 56.02 |
|      dirt track     | 19.22 | 22.07 |
|       apparel       | 30.78 | 38.19 |
|         pole        | 17.93 | 25.26 |
|         land        |  3.03 |  4.97 |
|      bannister      | 14.18 | 20.07 |
|      escalator      |  22.0 | 25.15 |
|       ottoman       | 41.87 | 51.96 |
|        bottle       | 23.68 | 33.42 |
|        buffet       | 44.71 | 55.51 |
|        poster       | 23.36 | 30.36 |
|        stage        | 21.45 |  27.9 |
|         van         | 36.71 |  71.5 |
|         ship        |  3.87 |  6.34 |
|       fountain      | 23.36 | 24.87 |
|    conveyer belt    | 61.95 | 75.79 |
|        canopy       | 32.93 |  34.0 |
|        washer       | 73.38 | 74.07 |
|      plaything      | 18.38 | 22.64 |
|    swimming pool    | 38.87 | 64.02 |
|        stool        | 36.76 | 46.04 |
|        barrel       | 60.27 | 87.14 |
|        basket       | 27.59 | 35.41 |
|      waterfall      | 39.22 | 45.34 |
|         tent        |  95.3 | 97.84 |
|         bag         |  7.79 |  8.21 |
|       minibike      | 39.44 | 41.37 |
|        cradle       | 79.34 | 92.65 |
|         oven        | 32.77 | 62.12 |
|         ball        | 41.21 | 64.38 |
|         food        | 31.77 | 34.46 |
|         step        | 16.36 | 17.82 |
|         tank        | 48.69 | 53.35 |
|      trade name     |  31.1 | 37.58 |
|      microwave      | 49.21 | 54.11 |
|         pot         | 44.19 | 49.75 |
|        animal       | 49.39 | 50.07 |
|       bicycle       | 51.27 | 67.09 |
|         lake        | 62.29 | 63.45 |
|      dishwasher     | 66.97 | 80.77 |
|        screen       | 54.57 | 67.09 |
|       blanket       | 12.44 | 13.65 |
|      sculpture      | 44.24 | 47.26 |
|         hood        | 54.92 |  58.7 |
|        sconce       | 39.87 | 47.33 |
|         vase        | 34.69 | 43.23 |
|    traffic light    | 23.64 | 30.17 |
|         tray        |  7.57 | 12.18 |
|        ashcan       | 42.73 |  51.5 |
|         fan         | 59.31 | 66.13 |
|         pier        | 21.26 | 29.06 |
|      crt screen     |  8.51 | 26.05 |
|        plate        | 36.63 | 45.93 |
|       monitor       | 22.81 | 31.61 |
|    bulletin board   | 40.64 | 51.06 |
|        shower       |  1.98 |  2.15 |
|       radiator      |  46.5 | 62.67 |
|        glass        | 12.03 |  12.7 |
|        clock        | 33.56 | 41.26 |
|         flag        | 30.34 | 32.14 |
+---------------------+-------+-------+
10/06 08:50:04 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.0300  mIoU: 44.9600  mAcc: 55.5700  data_time: 0.0016  time: 0.2017
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
10/06 08:50:08 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.10.13 | packaged by conda-forge | (main, Dec 23 2023, 15:36:39) [GCC 12.3.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 482124651
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2023.1-Product Build 20230303 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.4

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 482124651
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

10/06 08:50:09 - mmengine - INFO - Config:
checkpoint_config = dict(by_epoch=False, interval=1000, max_keep_ckpts=1)
crop_size = (
    512,
    512,
)
data = dict(
    samples_per_gpu=2,
    test=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]),
    val=dict(pipeline=[
        dict(type='LoadImageFromFile'),
        dict(
            flip=False,
            img_scale=(
                2048,
                512,
            ),
            transforms=[
                dict(keep_ratio=True, type='Resize'),
                dict(size_divisor=32, type='ResizeToMultiple'),
                dict(type='RandomFlip'),
                dict(
                    mean=[
                        123.675,
                        116.28,
                        103.53,
                    ],
                    std=[
                        58.395,
                        57.12,
                        57.375,
                    ],
                    to_rgb=True,
                    type='Normalize'),
                dict(keys=[
                    'img',
                ], type='ImageToTensor'),
                dict(keys=[
                    'img',
                ], type='Collect'),
            ],
            type='MultiScaleFlipAug'),
    ]))
data_preprocessor = dict(
    bgr_to_rgb=True,
    corruption=None,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=16000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
evaluation = dict(interval=16000, metric='mIoU', save_best='mIoU')
img_norm_cfg = dict(
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    std=[
        58.395,
        57.12,
        57.375,
    ],
    to_rgb=True)
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
lr_config = dict(
    _delete_=True,
    by_epoch=False,
    min_lr=0.0,
    policy='poly',
    power=1.0,
    warmup='linear',
    warmup_iters=1500,
    warmup_ratio=1e-06)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=320,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        channels=80,
        core_op='DCNv3',
        depths=[
            4,
            4,
            21,
            4,
        ],
        drop_path_rate=0.3,
        groups=[
            5,
            10,
            20,
            40,
        ],
        init_cfg=dict(
            checkpoint=
            'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth',
            type='Pretrained'),
        layer_scale=1.0,
        mlp_ratio=4.0,
        norm_layer='LN',
        offset_scale=1.0,
        post_norm=True,
        type='InternImage',
        with_cp=False),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            512,
            512,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=512,
        dropout_ratio=0.1,
        in_channels=[
            80,
            160,
            320,
            640,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    pretrained='open-mmlab://resnet50_v1c',
    test_cfg=dict(mode='whole'),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    clip_grad=None,
    optimizer=dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005),
    type='OptimWrapper')
optimizer = dict(
    betas=(
        0.9,
        0.999,
    ),
    constructor='CustomLayerDecayOptimizerConstructor',
    lr=6e-05,
    paramwise_cfg=dict(
        depths=[
            4,
            4,
            21,
            4,
        ], layer_decay_rate=1.0, num_layers=33),
    type='AdamW',
    weight_decay=0.05)
param_scheduler = [
    dict(
        begin=0,
        by_epoch=False,
        end=160000,
        eta_min=0.0001,
        power=0.9,
        type='PolyLR'),
]
pretrained = 'https://huggingface.co/OpenGVLab/InternImage/resolve/main/internimage_s_1k_224.pth'
resume = False
runner = dict(type='IterBasedRunner')
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(
        flip=False,
        img_scale=(
            2048,
            512,
        ),
        transforms=[
            dict(keep_ratio=True, type='Resize'),
            dict(size_divisor=32, type='ResizeToMultiple'),
            dict(type='RandomFlip'),
            dict(
                mean=[
                    123.675,
                    116.28,
                    103.53,
                ],
                std=[
                    58.395,
                    57.12,
                    57.375,
                ],
                to_rgb=True,
                type='Normalize'),
            dict(keys=[
                'img',
            ], type='ImageToTensor'),
            dict(keys=[
                'img',
            ], type='Collect'),
        ],
        type='MultiScaleFlipAug'),
]
train_cfg = dict(
    max_iters=160000, type='IterBasedTrainLoop', val_interval=16000)
train_dataloader = dict(
    batch_size=4,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2048,
                    512,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    512,
                    512,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2048,
            512,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        512,
        512,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2048,
                512,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/internimage/upernet_internimage_s_512_160k_ade20k/jpeg_compression'

/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
2024-10-06 08:50:12,014 - mmseg - INFO - using core type: DCNv3
2024-10-06 08:50:12,014 - mmseg - INFO - using activation layer: GELU
2024-10-06 08:50:12,014 - mmseg - INFO - using main norm layer: LN
2024-10-06 08:50:12,014 - mmseg - INFO - using dpr: linear, 0.3
2024-10-06 08:50:12,014 - mmseg - INFO - level2_post_norm: False
2024-10-06 08:50:12,014 - mmseg - INFO - level2_post_norm_block_ids: None
2024-10-06 08:50:12,014 - mmseg - INFO - res_post_norm: False
2024-10-06 08:50:12,014 - mmseg - INFO - use_dcn_v4_op: False
10/06 08:50:13 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
10/06 08:50:13 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
10/06 08:50:15 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 08:50:16 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/internimage/upernet_internimage_s_512_160k_ade20k.pth
10/06 08:51:06 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:32:12  time: 0.4415  data_time: 0.0014  memory: 21070  
10/06 08:51:30 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:23:31  time: 0.5892  data_time: 0.0015  memory: 11890  
10/06 08:51:44 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:18:07  time: 0.2596  data_time: 0.0014  memory: 10810  
10/06 08:52:05 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:16:15  time: 0.3518  data_time: 0.0014  memory: 11893  
10/06 08:52:25 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:14:58  time: 0.2006  data_time: 0.0014  memory: 11870  
10/06 08:52:41 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:13:40  time: 0.0862  data_time: 0.0032  memory: 11897  
10/06 08:53:00 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:12:50  time: 0.2469  data_time: 0.0014  memory: 11905  
10/06 08:53:14 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:11:52  time: 0.2465  data_time: 0.0014  memory: 11872  
10/06 08:53:22 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:10:39  time: 0.1838  data_time: 0.0014  memory: 9599  
10/06 08:53:28 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:09:36  time: 0.0739  data_time: 0.0014  memory: 10790  
10/06 08:53:36 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:08:46  time: 0.2491  data_time: 0.0015  memory: 10822  
10/06 08:53:43 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:08:01  time: 0.2307  data_time: 0.0016  memory: 9783  
10/06 08:53:53 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:07:30  time: 0.2660  data_time: 0.0013  memory: 10827  
10/06 08:54:06 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:07:07  time: 0.0796  data_time: 0.0015  memory: 11903  
10/06 08:54:20 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:06:46  time: 0.5903  data_time: 0.0014  memory: 10832  
10/06 08:54:26 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:06:14  time: 0.0745  data_time: 0.0015  memory: 10811  
10/06 08:54:29 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:05:42  time: 0.0740  data_time: 0.0015  memory: 776  
10/06 08:54:37 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:05:18  time: 0.1794  data_time: 0.0014  memory: 9040  
10/06 08:54:50 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:05:02  time: 0.3363  data_time: 0.0014  memory: 10906  
10/06 08:54:58 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:04:41  time: 0.0793  data_time: 0.0015  memory: 10908  
10/06 08:55:09 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:04:24  time: 0.4277  data_time: 0.0015  memory: 10829  
10/06 08:55:18 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:04:07  time: 0.0775  data_time: 0.0015  memory: 10804  
10/06 08:55:25 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:03:48  time: 0.2018  data_time: 0.0014  memory: 10792  
10/06 08:55:29 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:03:28  time: 0.0735  data_time: 0.0014  memory: 1962  
10/06 08:55:36 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:03:11  time: 0.2027  data_time: 0.0014  memory: 11893  
10/06 08:55:40 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:02:54  time: 0.0810  data_time: 0.0014  memory: 778  
10/06 08:55:45 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:02:38  time: 0.0712  data_time: 0.0013  memory: 10787  
10/06 08:55:56 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:02:25  time: 0.2752  data_time: 0.0014  memory: 10816  
10/06 08:56:03 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:02:11  time: 0.2430  data_time: 0.0014  memory: 10798  
10/06 08:56:07 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:01:56  time: 0.0698  data_time: 0.0014  memory: 776  
10/06 08:56:12 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:01:43  time: 0.0837  data_time: 0.0014  memory: 10717  
10/06 08:56:16 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:01:29  time: 0.0783  data_time: 0.0015  memory: 774  
10/06 08:56:25 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:01:18  time: 0.0693  data_time: 0.0013  memory: 11903  
10/06 08:56:34 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:01:06  time: 0.0808  data_time: 0.0015  memory: 10806  
10/06 08:56:41 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:00:54  time: 0.0861  data_time: 0.0029  memory: 10789  
10/06 08:56:46 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:00:43  time: 0.0748  data_time: 0.0015  memory: 10790  
10/06 08:56:50 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:00:31  time: 0.0741  data_time: 0.0015  memory: 724  
10/06 08:56:55 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:00:20  time: 0.0798  data_time: 0.0014  memory: 10829  
10/06 08:57:03 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:10  time: 0.0764  data_time: 0.0014  memory: 10795  
10/06 08:57:10 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.0653  data_time: 0.0012  memory: 8666  
10/06 08:57:10 - mmengine - INFO - per class results:
10/06 08:57:10 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.76 | 88.53 |
|       building      | 81.33 | 92.72 |
|         sky         | 93.92 | 97.43 |
|        floor        | 79.02 | 90.87 |
|         tree        | 72.78 | 86.24 |
|       ceiling       | 82.34 | 89.74 |
|         road        | 81.34 | 90.23 |
|         bed         | 88.93 | 95.24 |
|      windowpane     | 60.12 | 77.32 |
|        grass        | 66.15 | 76.73 |
|       cabinet       | 56.95 | 69.01 |
|       sidewalk      | 62.43 | 76.21 |
|        person       |  79.0 | 89.88 |
|        earth        |  33.9 | 52.46 |
|         door        | 47.12 | 59.42 |
|        table        | 58.38 | 74.84 |
|       mountain      | 55.94 | 74.85 |
|        plant        | 48.59 | 59.01 |
|       curtain       | 71.21 | 82.58 |
|        chair        | 54.99 | 66.01 |
|         car         | 84.01 | 91.66 |
|        water        |  49.7 | 62.59 |
|       painting      | 72.03 | 86.41 |
|         sofa        | 62.96 | 83.03 |
|        shelf        | 38.36 | 54.86 |
|        house        | 42.54 | 58.22 |
|         sea         | 56.05 | 76.58 |
|        mirror       |  63.2 |  68.5 |
|         rug         | 51.73 |  59.8 |
|        field        | 34.18 |  57.3 |
|       armchair      |  39.5 | 56.14 |
|         seat        | 59.32 | 79.39 |
|        fence        | 42.81 | 59.15 |
|         desk        | 49.86 | 66.02 |
|         rock        | 40.98 |  61.5 |
|       wardrobe      | 43.46 | 70.48 |
|         lamp        | 62.15 | 73.94 |
|       bathtub       | 74.25 | 83.21 |
|       railing       | 31.21 | 41.53 |
|       cushion       | 56.21 | 66.92 |
|         base        | 20.47 | 25.34 |
|         box         | 20.77 | 27.19 |
|        column       |  44.4 |  53.8 |
|      signboard      | 34.43 |  43.7 |
|   chest of drawers  | 39.71 | 62.93 |
|       counter       | 26.85 | 31.84 |
|         sand        | 35.88 | 53.92 |
|         sink        |  69.0 | 76.47 |
|      skyscraper     | 61.94 |  80.1 |
|      fireplace      | 74.04 | 84.89 |
|     refrigerator    | 72.92 | 84.18 |
|      grandstand     | 39.61 | 73.63 |
|         path        |  22.1 | 33.35 |
|        stairs       | 30.73 | 38.83 |
|        runway       |  72.2 | 93.47 |
|         case        | 42.81 | 56.11 |
|      pool table     | 91.42 |  95.6 |
|        pillow       |  56.5 | 65.23 |
|     screen door     | 65.56 | 69.25 |
|       stairway      | 30.09 | 38.43 |
|        river        |  8.36 |  20.5 |
|        bridge       | 38.14 | 43.82 |
|       bookcase      | 36.85 | 59.26 |
|        blind        | 26.16 | 27.68 |
|     coffee table    | 59.41 | 82.14 |
|        toilet       | 82.12 | 88.92 |
|        flower       | 39.74 | 50.38 |
|         book        | 47.77 |  69.1 |
|         hill        |  14.1 | 18.21 |
|        bench        | 43.79 | 53.89 |
|      countertop     | 46.58 | 66.58 |
|        stove        |  76.5 | 84.71 |
|         palm        | 48.22 | 62.54 |
|    kitchen island   | 27.98 | 49.15 |
|       computer      | 60.12 | 66.47 |
|     swivel chair    | 43.06 | 57.26 |
|         boat        | 48.81 | 57.22 |
|         bar         | 31.81 |  43.5 |
|    arcade machine   | 85.39 | 90.86 |
|        hovel        | 15.35 | 17.33 |
|         bus         | 87.33 | 96.53 |
|        towel        | 59.54 | 66.98 |
|        light        | 49.59 | 55.23 |
|        truck        | 35.85 | 47.47 |
|        tower        | 32.47 | 49.07 |
|      chandelier     |  66.9 |  79.5 |
|        awning       | 21.49 |  25.3 |
|     streetlight     | 22.32 |  28.4 |
|        booth        | 59.58 | 64.63 |
| television receiver | 66.72 | 77.82 |
|       airplane      | 59.42 | 68.06 |
|      dirt track     | 21.91 | 41.85 |
|       apparel       | 31.29 | 37.82 |
|         pole        | 18.41 | 26.63 |
|         land        |  3.64 |  4.77 |
|      bannister      | 16.97 | 22.33 |
|      escalator      | 37.49 | 56.96 |
|       ottoman       | 44.98 | 56.68 |
|        bottle       | 22.69 | 29.53 |
|        buffet       | 39.34 | 45.82 |
|        poster       | 28.92 | 35.32 |
|        stage        | 19.79 | 27.42 |
|         van         | 44.45 | 60.88 |
|         ship        | 35.01 | 49.31 |
|       fountain      | 22.52 | 23.58 |
|    conveyer belt    | 55.38 | 69.05 |
|        canopy       |  40.2 | 49.07 |
|        washer       | 72.39 | 77.08 |
|      plaything      | 31.23 | 45.36 |
|    swimming pool    | 38.46 | 56.26 |
|        stool        | 38.27 | 48.46 |
|        barrel       | 53.16 | 66.55 |
|        basket       | 28.95 | 36.41 |
|      waterfall      | 58.51 | 70.83 |
|         tent        | 94.54 | 98.27 |
|         bag         |  7.87 |  8.84 |
|       minibike      | 63.62 | 73.13 |
|        cradle       | 76.61 | 94.73 |
|         oven        | 42.46 | 60.06 |
|         ball        |  46.9 | 61.15 |
|         food        | 52.75 | 64.58 |
|         step        | 15.69 | 16.91 |
|         tank        | 46.45 | 48.99 |
|      trade name     | 28.14 | 32.78 |
|      microwave      |  64.3 | 69.39 |
|         pot         | 41.51 | 47.27 |
|        animal       |  57.3 | 59.01 |
|       bicycle       | 55.71 | 71.74 |
|         lake        | 62.18 | 63.27 |
|      dishwasher     | 63.47 | 74.75 |
|        screen       | 53.02 | 66.46 |
|       blanket       |  9.27 | 10.34 |
|      sculpture      |  71.1 |  81.2 |
|         hood        | 55.02 | 58.84 |
|        sconce       | 36.78 |  44.6 |
|         vase        | 37.22 |  44.9 |
|    traffic light    | 26.95 | 38.82 |
|         tray        |  5.94 | 11.09 |
|        ashcan       | 40.33 | 51.12 |
|         fan         | 58.39 | 66.99 |
|         pier        | 48.75 | 61.67 |
|      crt screen     |  4.99 | 12.52 |
|        plate        | 41.95 | 54.72 |
|       monitor       | 22.69 | 27.56 |
|    bulletin board   | 36.69 | 48.65 |
|        shower       |  2.05 |  9.05 |
|       radiator      | 49.64 | 58.71 |
|        glass        | 11.83 | 12.65 |
|        clock        | 33.92 | 38.89 |
|         flag        | 44.61 | 48.43 |
+---------------------+-------+-------+
10/06 08:57:10 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.7900  mIoU: 47.4100  mAcc: 58.2200  data_time: 0.0016  time: 0.2070
Finished processing corruption type: jpeg_compression
Runtime: 1728197831

============================= JOB FEEDBACK =============================

NodeName=uc2n488
Job ID: 24369579
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 06:41:31
CPU Efficiency: 5.28% of 5-06:37:52 core-walltime
Job Wall-clock time: 07:54:52
Memory Utilized: 2.66 GB
Memory Efficiency: 2.66% of 100.00 GB
