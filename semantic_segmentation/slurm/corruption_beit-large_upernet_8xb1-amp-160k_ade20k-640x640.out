Started at Fri Nov 15 05:35:24 CET 2024
Processing corruption type: gaussian_noise
11/15 05:37:10 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 383240926
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 383240926
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 05:37:11 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='gaussian_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/gaussian_noise'

Number of parameters:  441271084
11/15 05:38:45 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 05:38:45 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 05:38:46 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 05:38:55 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 05:40:51 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:15:40  time: 0.9049  data_time: 0.0016  memory: 24548  
11/15 05:41:33 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:50:15  time: 0.8663  data_time: 0.0017  memory: 4003  
11/15 05:42:14 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:40:54  time: 0.8267  data_time: 0.0017  memory: 3937  
11/15 05:42:57 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:36:23  time: 0.8657  data_time: 0.0016  memory: 4098  
11/15 05:43:36 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:32:53  time: 0.8230  data_time: 0.0016  memory: 4154  
11/15 05:44:17 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:30:29  time: 0.8949  data_time: 0.0018  memory: 3995  
11/15 05:44:59 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:28:38  time: 0.7807  data_time: 0.0016  memory: 3994  
11/15 05:45:40 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:27:00  time: 0.8627  data_time: 0.0025  memory: 3999  
11/15 05:46:16 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:25:18  time: 0.7767  data_time: 0.0016  memory: 3934  
11/15 05:46:57 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:24:07  time: 0.7800  data_time: 0.0016  memory: 3938  
11/15 05:47:40 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:23:05  time: 0.9035  data_time: 0.0017  memory: 3990  
11/15 05:48:21 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:22:01  time: 0.8639  data_time: 0.0017  memory: 3998  
11/15 05:49:01 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:20:59  time: 0.8487  data_time: 0.0014  memory: 4018  
11/15 05:49:45 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:20:08  time: 0.8639  data_time: 0.0018  memory: 4014  
11/15 05:50:27 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:19:14  time: 0.8597  data_time: 0.0016  memory: 4029  
11/15 05:51:06 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:18:16  time: 0.9404  data_time: 0.0017  memory: 3940  
11/15 05:51:50 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:17:29  time: 0.9272  data_time: 0.0018  memory: 3929  
11/15 05:52:28 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:16:33  time: 0.7599  data_time: 0.0016  memory: 3960  
11/15 05:53:09 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:15:44  time: 0.7852  data_time: 0.0027  memory: 3985  
11/15 05:53:48 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:14:53  time: 0.7848  data_time: 0.0015  memory: 3987  
11/15 05:54:31 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:14:07  time: 0.9079  data_time: 0.0015  memory: 4033  
11/15 05:55:14 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:13:20  time: 0.8072  data_time: 0.0016  memory: 3975  
11/15 05:55:54 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:12:33  time: 0.8244  data_time: 0.0015  memory: 3968  
11/15 05:56:36 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:11:47  time: 0.7878  data_time: 0.0015  memory: 3998  
11/15 05:57:14 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:10:59  time: 0.7808  data_time: 0.0016  memory: 3955  
11/15 05:57:50 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:10:11  time: 0.8209  data_time: 0.0015  memory: 3929  
11/15 05:58:31 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:09:26  time: 0.7395  data_time: 0.0015  memory: 3930  
11/15 05:59:10 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:08:40  time: 0.8692  data_time: 0.0041  memory: 3987  
11/15 05:59:47 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:07:55  time: 0.8634  data_time: 0.0015  memory: 3986  
11/15 06:00:27 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:07:10  time: 0.7390  data_time: 0.0015  memory: 3929  
11/15 06:01:09 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:06:27  time: 0.8252  data_time: 0.0015  memory: 3976  
11/15 06:01:49 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:43  time: 0.8223  data_time: 0.0016  memory: 3927  
11/15 06:02:26 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:04:59  time: 0.7008  data_time: 0.0015  memory: 4109  
11/15 06:03:10 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:16  time: 0.8405  data_time: 0.0017  memory: 3984  
11/15 06:03:52 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:33  time: 0.7827  data_time: 0.0015  memory: 3992  
11/15 06:04:31 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:50  time: 0.8662  data_time: 0.0017  memory: 3943  
11/15 06:05:14 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:08  time: 0.8758  data_time: 0.0017  memory: 3889  
11/15 06:05:50 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:25  time: 0.7413  data_time: 0.0016  memory: 4014  
11/15 06:06:32 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:42  time: 0.7954  data_time: 0.0015  memory: 4144  
11/15 06:07:11 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7670  data_time: 0.0014  memory: 4022  
11/15 06:07:11 - mmengine - INFO - per class results:
11/15 06:07:11 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 78.06 | 91.64 |
|       building      | 82.72 |  93.7 |
|         sky         | 94.25 | 97.88 |
|        floor        | 81.66 | 91.94 |
|         tree        | 72.75 | 89.59 |
|       ceiling       |  84.3 | 90.78 |
|         road        | 81.81 | 88.21 |
|         bed         |  90.1 | 95.89 |
|      windowpane     |  64.4 | 79.38 |
|        grass        | 69.65 | 82.13 |
|       cabinet       |  62.2 | 71.31 |
|       sidewalk      | 62.29 |  77.8 |
|        person       | 83.43 | 93.15 |
|        earth        | 36.23 | 57.78 |
|         door        | 52.72 |  60.3 |
|        table        | 65.18 | 77.24 |
|       mountain      | 56.58 | 68.33 |
|        plant        | 49.48 | 56.34 |
|       curtain       | 74.06 | 82.77 |
|        chair        | 60.17 | 69.01 |
|         car         | 85.31 | 94.54 |
|        water        | 59.33 | 74.26 |
|       painting      | 74.24 | 83.76 |
|         sofa        | 76.74 | 90.57 |
|        shelf        | 43.68 | 61.23 |
|        house        | 46.85 | 58.28 |
|         sea         | 65.61 |  85.8 |
|        mirror       | 69.03 | 74.01 |
|         rug         | 54.86 | 61.86 |
|        field        | 34.91 | 40.88 |
|       armchair      | 55.46 | 73.44 |
|         seat        | 62.05 | 81.26 |
|        fence        | 46.01 | 57.64 |
|         desk        | 52.96 | 75.17 |
|         rock        | 49.55 |  81.9 |
|       wardrobe      | 47.83 | 67.62 |
|         lamp        | 68.82 | 76.09 |
|       bathtub       | 80.98 | 86.38 |
|       railing       | 34.36 | 42.21 |
|       cushion       | 58.04 | 62.97 |
|         base        | 35.26 | 41.33 |
|         box         | 24.65 | 28.34 |
|        column       | 47.66 | 56.32 |
|      signboard      | 40.17 | 52.14 |
|   chest of drawers  | 44.22 | 59.95 |
|       counter       | 25.44 | 34.47 |
|         sand        | 41.93 | 63.25 |
|         sink        | 74.94 | 79.39 |
|      skyscraper     | 52.75 | 74.82 |
|      fireplace      | 73.79 | 80.71 |
|     refrigerator    | 82.34 | 85.71 |
|      grandstand     | 50.24 | 84.33 |
|         path        | 24.32 | 36.31 |
|        stairs       | 27.43 | 30.61 |
|        runway       | 80.95 | 89.52 |
|         case        | 48.47 | 59.66 |
|      pool table     | 93.93 | 96.29 |
|        pillow       | 60.33 | 74.14 |
|     screen door     | 73.95 | 79.39 |
|       stairway      | 35.75 | 46.65 |
|        river        | 11.23 | 19.97 |
|        bridge       | 37.68 |  41.5 |
|       bookcase      | 38.96 | 59.51 |
|        blind        | 33.47 | 34.45 |
|     coffee table    | 66.52 | 80.98 |
|        toilet       | 85.74 | 90.98 |
|        flower       |  38.7 | 57.34 |
|         book        | 50.29 | 65.16 |
|         hill        |  9.56 | 14.19 |
|        bench        | 45.01 | 49.59 |
|      countertop     | 58.12 | 72.47 |
|        stove        | 78.98 | 84.66 |
|         palm        | 50.27 | 61.79 |
|    kitchen island   | 37.86 | 51.11 |
|       computer      | 77.09 | 89.69 |
|     swivel chair    | 55.41 |  71.4 |
|         boat        | 56.63 | 81.25 |
|         bar         | 57.18 | 77.74 |
|    arcade machine   | 64.99 | 66.04 |
|        hovel        | 23.69 | 25.58 |
|         bus         | 89.85 | 96.25 |
|        towel        | 65.18 | 72.07 |
|        light        | 52.67 | 58.77 |
|        truck        | 36.46 | 46.53 |
|        tower        |  5.87 |  9.37 |
|      chandelier     | 69.81 | 79.53 |
|        awning       | 38.77 | 48.71 |
|     streetlight     | 33.95 | 41.03 |
|        booth        | 42.94 | 45.77 |
| television receiver | 65.98 |  73.9 |
|       airplane      | 61.78 | 68.04 |
|      dirt track     | 21.51 | 42.43 |
|       apparel       | 41.15 |  51.3 |
|         pole        | 31.22 | 50.55 |
|         land        |  3.79 |  5.14 |
|      bannister      | 15.35 | 22.49 |
|      escalator      | 34.76 | 43.76 |
|       ottoman       | 54.78 | 71.39 |
|        bottle       | 40.71 | 57.25 |
|        buffet       | 51.72 | 64.69 |
|        poster       | 24.36 | 29.81 |
|        stage        | 14.39 | 21.01 |
|         van         | 44.13 | 58.39 |
|         ship        | 83.71 | 90.33 |
|       fountain      | 28.49 | 28.79 |
|    conveyer belt    | 86.65 | 93.36 |
|        canopy       | 45.39 |  59.1 |
|        washer       | 84.06 | 87.12 |
|      plaything      |  36.0 | 40.98 |
|    swimming pool    | 73.12 | 87.98 |
|        stool        | 46.62 | 65.15 |
|        barrel       | 53.13 | 67.39 |
|        basket       | 24.83 |  28.1 |
|      waterfall      | 52.01 | 55.78 |
|         tent        | 91.87 | 98.77 |
|         bag         |  8.41 |  9.1  |
|       minibike      | 71.04 |  83.0 |
|        cradle       |  87.7 | 97.48 |
|         oven        | 38.99 | 67.44 |
|         ball        | 49.54 | 69.34 |
|         food        | 51.95 | 66.44 |
|         step        |  7.82 |  8.54 |
|         tank        | 58.72 | 60.33 |
|      trade name     | 22.64 | 23.95 |
|      microwave      | 72.08 | 75.55 |
|         pot         | 47.21 | 51.41 |
|        animal       | 58.76 | 59.71 |
|       bicycle       |  56.8 | 75.28 |
|         lake        | 63.12 | 63.62 |
|      dishwasher     | 69.68 | 72.24 |
|        screen       | 71.16 |  84.7 |
|       blanket       | 19.06 | 20.58 |
|      sculpture      |  72.4 | 81.22 |
|         hood        | 55.94 | 59.73 |
|        sconce       | 48.78 | 53.91 |
|         vase        | 42.48 | 55.38 |
|    traffic light    | 36.04 | 43.37 |
|         tray        | 18.98 |  22.4 |
|        ashcan       | 33.06 | 39.56 |
|         fan         | 65.33 | 75.14 |
|         pier        | 31.26 |  48.0 |
|      crt screen     |  7.28 | 19.25 |
|        plate        | 59.95 | 76.23 |
|       monitor       |  2.99 |  3.26 |
|    bulletin board   | 41.32 | 55.56 |
|        shower       | 10.83 | 12.57 |
|       radiator      |  57.0 | 58.82 |
|        glass        | 15.37 | 15.81 |
|        clock        | 49.39 | 54.03 |
|         flag        | 63.56 | 69.15 |
+---------------------+-------+-------+
11/15 06:07:11 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 83.8100  mIoU: 51.9900  mAcc: 61.9100  data_time: 0.0024  time: 0.8483
Finished processing corruption type: gaussian_noise
Processing corruption type: shot_noise
11/15 06:07:14 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 62996298
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 62996298
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 06:07:15 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='shot_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/shot_noise'

Number of parameters:  441271084
11/15 06:07:24 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 06:07:24 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 06:07:24 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 06:07:28 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 06:08:25 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:37:09  time: 1.0540  data_time: 0.0016  memory: 24548  
11/15 06:09:14 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:33:27  time: 0.9860  data_time: 0.0017  memory: 4003  
11/15 06:10:00 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:31:09  time: 0.9462  data_time: 0.0016  memory: 3937  
11/15 06:10:49 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:30:08  time: 0.9841  data_time: 0.0016  memory: 4098  
11/15 06:11:34 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:28:43  time: 0.9476  data_time: 0.0016  memory: 4154  
11/15 06:12:21 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:27:39  time: 0.9856  data_time: 0.0017  memory: 3995  
11/15 06:13:08 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:26:43  time: 0.8916  data_time: 0.0016  memory: 3994  
11/15 06:13:55 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:25:47  time: 0.9811  data_time: 0.0015  memory: 3999  
11/15 06:14:36 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:24:34  time: 0.8912  data_time: 0.0015  memory: 3934  
11/15 06:15:23 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:23:43  time: 0.8960  data_time: 0.0016  memory: 3938  
11/15 06:16:12 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:23:00  time: 1.0279  data_time: 0.0016  memory: 3990  
11/15 06:16:59 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:22:12  time: 0.9851  data_time: 0.0017  memory: 3998  
11/15 06:17:45 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:21:21  time: 0.9396  data_time: 0.0015  memory: 4018  
11/15 06:18:35 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:20:38  time: 0.9812  data_time: 0.0017  memory: 4014  
11/15 06:19:23 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:19:50  time: 0.9713  data_time: 0.0015  memory: 4029  
11/15 06:20:05 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:18:55  time: 0.9820  data_time: 0.0017  memory: 3940  
11/15 06:20:54 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:18:10  time: 0.9844  data_time: 0.0018  memory: 3929  
11/15 06:21:35 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:17:15  time: 0.7970  data_time: 0.0015  memory: 3960  
11/15 06:22:23 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:16:28  time: 0.8951  data_time: 0.0016  memory: 3985  
11/15 06:23:07 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:15:38  time: 0.8896  data_time: 0.0016  memory: 3987  
11/15 06:23:56 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:14:53  time: 1.0204  data_time: 0.0016  memory: 4033  
11/15 06:24:44 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:14:07  time: 0.8965  data_time: 0.0016  memory: 3975  
11/15 06:25:29 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:13:19  time: 0.9390  data_time: 0.0016  memory: 3968  
11/15 06:26:17 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:12:32  time: 0.8960  data_time: 0.0016  memory: 3998  
11/15 06:27:00 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:11:42  time: 0.8951  data_time: 0.0016  memory: 3955  
11/15 06:27:41 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:10:53  time: 0.9377  data_time: 0.0016  memory: 3929  
11/15 06:28:27 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:10:06  time: 0.8476  data_time: 0.0016  memory: 3930  
11/15 06:29:12 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:09:18  time: 0.9894  data_time: 0.0016  memory: 3987  
11/15 06:29:55 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:08:30  time: 0.9827  data_time: 0.0016  memory: 3986  
11/15 06:30:40 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:07:43  time: 0.8412  data_time: 0.0015  memory: 3929  
11/15 06:31:27 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:06:57  time: 0.9429  data_time: 0.0016  memory: 3976  
11/15 06:32:12 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:06:11  time: 0.9351  data_time: 0.0016  memory: 3927  
11/15 06:32:56 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:05:23  time: 0.8089  data_time: 0.0015  memory: 4109  
11/15 06:33:44 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:38  time: 0.9435  data_time: 0.0017  memory: 3984  
11/15 06:34:32 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:51  time: 0.9064  data_time: 0.0016  memory: 3992  
11/15 06:35:15 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:05  time: 0.9855  data_time: 0.0017  memory: 3943  
11/15 06:36:04 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:19  time: 0.9828  data_time: 0.0017  memory: 3889  
11/15 06:36:46 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:32  time: 0.8487  data_time: 0.0016  memory: 4014  
11/15 06:37:33 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:46  time: 0.8964  data_time: 0.0015  memory: 4144  
11/15 06:38:16 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.8414  data_time: 0.0014  memory: 4022  
11/15 06:38:16 - mmengine - INFO - per class results:
11/15 06:38:16 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 78.06 | 91.63 |
|       building      | 82.71 | 93.38 |
|         sky         | 94.07 |  97.9 |
|        floor        |  82.4 | 91.95 |
|         tree        | 73.97 | 89.36 |
|       ceiling       | 83.25 | 90.37 |
|         road        | 81.92 | 88.95 |
|         bed         | 89.99 |  95.9 |
|      windowpane     |  64.0 | 79.54 |
|        grass        | 69.07 | 81.22 |
|       cabinet       | 61.85 |  70.8 |
|       sidewalk      | 60.41 | 75.75 |
|        person       | 84.23 | 93.52 |
|        earth        | 37.21 | 58.93 |
|         door        | 51.04 | 58.49 |
|        table        | 64.94 | 77.14 |
|       mountain      |  57.8 | 69.15 |
|        plant        | 50.53 |  57.4 |
|       curtain       | 72.97 | 81.12 |
|        chair        | 61.37 | 70.54 |
|         car         | 85.78 | 94.57 |
|        water        | 59.19 | 73.93 |
|       painting      | 74.53 |  83.7 |
|         sofa        | 76.04 | 88.03 |
|        shelf        | 44.81 | 61.43 |
|        house        | 43.19 | 57.39 |
|         sea         | 64.78 |  84.8 |
|        mirror       | 67.88 | 74.07 |
|         rug         | 57.97 | 64.73 |
|        field        | 36.58 | 44.32 |
|       armchair      | 55.09 | 75.67 |
|         seat        | 63.63 | 84.05 |
|        fence        | 46.16 | 59.14 |
|         desk        | 52.96 | 75.92 |
|         rock        | 51.22 | 83.93 |
|       wardrobe      | 46.66 | 66.54 |
|         lamp        | 68.13 | 74.81 |
|       bathtub       | 78.47 | 84.13 |
|       railing       | 34.42 | 42.17 |
|       cushion       | 59.35 | 65.29 |
|         base        | 40.07 | 47.31 |
|         box         | 24.81 | 28.92 |
|        column       | 46.25 | 54.34 |
|      signboard      | 40.06 | 51.89 |
|   chest of drawers  | 39.81 | 57.92 |
|       counter       |  30.7 |  42.3 |
|         sand        | 48.52 | 72.18 |
|         sink        |  74.1 |  79.0 |
|      skyscraper     |  53.7 | 75.54 |
|      fireplace      | 72.42 | 79.81 |
|     refrigerator    | 73.58 | 77.55 |
|      grandstand     | 50.83 | 84.91 |
|         path        | 23.63 | 38.36 |
|        stairs       | 33.03 |  36.5 |
|        runway       | 86.32 | 89.44 |
|         case        | 48.22 |  59.8 |
|      pool table     | 94.49 | 97.04 |
|        pillow       | 59.22 | 72.43 |
|     screen door     | 72.61 |  79.7 |
|       stairway      | 39.93 | 48.43 |
|        river        | 13.12 | 23.28 |
|        bridge       | 38.31 | 42.42 |
|       bookcase      | 38.85 | 59.47 |
|        blind        |  33.7 | 34.74 |
|     coffee table    | 65.68 | 81.33 |
|        toilet       | 85.04 | 90.15 |
|        flower       | 40.37 | 57.59 |
|         book        | 49.19 |  64.9 |
|         hill        |  9.73 | 14.74 |
|        bench        | 49.84 | 55.16 |
|      countertop     | 58.77 |  75.7 |
|        stove        | 80.52 | 85.54 |
|         palm        | 54.57 | 66.86 |
|    kitchen island   | 38.55 | 53.03 |
|       computer      | 76.87 | 89.82 |
|     swivel chair    | 53.26 | 72.91 |
|         boat        | 58.64 | 83.12 |
|         bar         | 59.89 | 74.78 |
|    arcade machine   | 58.14 | 58.64 |
|        hovel        | 16.03 | 17.26 |
|         bus         | 89.17 | 96.34 |
|        towel        |  63.5 | 70.01 |
|        light        | 50.66 | 56.74 |
|        truck        | 38.56 | 48.61 |
|        tower        |  7.16 | 11.43 |
|      chandelier     | 66.39 | 76.17 |
|        awning       | 39.35 | 49.46 |
|     streetlight     | 33.17 | 40.44 |
|        booth        | 45.26 | 47.75 |
| television receiver | 68.32 | 76.16 |
|       airplane      | 66.81 | 73.78 |
|      dirt track     | 21.39 |  40.8 |
|       apparel       | 40.05 | 51.97 |
|         pole        |  32.8 | 52.28 |
|         land        |  3.57 |  5.26 |
|      bannister      | 14.76 | 21.31 |
|      escalator      | 39.86 | 51.84 |
|       ottoman       | 55.68 | 73.39 |
|        bottle       | 40.82 |  57.9 |
|        buffet       | 56.59 | 70.52 |
|        poster       | 22.63 | 27.95 |
|        stage        | 14.56 |  20.8 |
|         van         | 43.22 | 58.38 |
|         ship        | 85.03 | 90.25 |
|       fountain      | 40.19 | 40.55 |
|    conveyer belt    | 85.87 | 92.56 |
|        canopy       | 44.95 | 59.04 |
|        washer       |  82.7 | 85.86 |
|      plaything      | 36.02 | 41.54 |
|    swimming pool    | 64.68 | 87.19 |
|        stool        | 46.34 | 68.83 |
|        barrel       | 53.87 | 72.34 |
|        basket       | 30.89 | 35.31 |
|      waterfall      | 50.36 | 54.58 |
|         tent        | 92.37 | 98.87 |
|         bag         |  9.15 |  10.0 |
|       minibike      | 72.49 | 85.87 |
|        cradle       | 86.16 | 96.26 |
|         oven        |  38.3 | 68.92 |
|         ball        |  47.7 | 69.33 |
|         food        | 51.78 | 65.64 |
|         step        |  9.27 | 10.49 |
|         tank        | 58.81 | 60.02 |
|      trade name     | 22.66 | 23.89 |
|      microwave      | 69.96 | 74.08 |
|         pot         | 50.03 | 54.15 |
|        animal       |  63.1 | 64.43 |
|       bicycle       | 57.02 | 76.15 |
|         lake        | 62.85 | 63.51 |
|      dishwasher     | 69.38 | 72.45 |
|        screen       | 71.29 | 84.57 |
|       blanket       | 21.36 | 22.98 |
|      sculpture      | 72.38 | 81.76 |
|         hood        | 48.74 |  52.7 |
|        sconce       | 44.61 | 49.11 |
|         vase        | 43.04 | 56.31 |
|    traffic light    | 36.86 | 43.69 |
|         tray        |  17.9 | 20.67 |
|        ashcan       | 42.35 | 51.67 |
|         fan         | 63.64 | 73.21 |
|         pier        | 31.31 | 48.93 |
|      crt screen     |  6.39 | 17.24 |
|        plate        | 59.12 | 76.01 |
|       monitor       |  3.88 |  4.45 |
|    bulletin board   | 38.84 |  53.6 |
|        shower       | 10.73 | 13.34 |
|       radiator      | 49.48 | 51.33 |
|        glass        | 15.12 | 15.42 |
|        clock        | 46.85 | 52.67 |
|         flag        | 50.43 | 54.85 |
+---------------------+-------+-------+
11/15 06:38:16 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 83.8500  mIoU: 52.0700  mAcc: 62.3500  data_time: 0.0021  time: 0.9240
Finished processing corruption type: shot_noise
Processing corruption type: impulse_noise
11/15 06:38:41 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 711644743
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 711644743
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 06:38:41 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='impulse_noise',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/impulse_noise'

Number of parameters:  441271084
11/15 06:39:06 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 06:39:06 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 06:39:06 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 06:39:08 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 06:40:02 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:34:40  time: 0.8774  data_time: 0.0016  memory: 24548  
11/15 06:40:43 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:29:51  time: 0.8374  data_time: 0.0017  memory: 4003  
11/15 06:41:21 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:27:15  time: 0.8018  data_time: 0.0017  memory: 3937  
11/15 06:42:02 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:26:06  time: 0.8327  data_time: 0.0016  memory: 4098  
11/15 06:42:40 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:24:42  time: 0.7949  data_time: 0.0016  memory: 4154  
11/15 06:43:19 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:43  time: 0.8383  data_time: 0.0018  memory: 3995  
11/15 06:44:00 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:53  time: 0.7525  data_time: 0.0016  memory: 3994  
11/15 06:44:39 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:22:03  time: 0.8361  data_time: 0.0015  memory: 3999  
11/15 06:45:13 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:20:56  time: 0.7503  data_time: 0.0015  memory: 3934  
11/15 06:45:53 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:20:13  time: 0.7535  data_time: 0.0015  memory: 3938  
11/15 06:46:34 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:19:35  time: 0.8762  data_time: 0.0016  memory: 3990  
11/15 06:47:14 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:18:52  time: 0.8363  data_time: 0.0017  memory: 3998  
11/15 06:47:52 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:18:08  time: 0.7964  data_time: 0.0015  memory: 4018  
11/15 06:48:35 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:17:32  time: 0.8361  data_time: 0.0017  memory: 4014  
11/15 06:49:16 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:16:52  time: 0.8653  data_time: 0.0020  memory: 4029  
11/15 06:49:51 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:16:04  time: 0.8354  data_time: 0.0018  memory: 3940  
11/15 06:50:33 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:15:26  time: 0.8349  data_time: 0.0017  memory: 3929  
11/15 06:51:08 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:14:39  time: 0.6713  data_time: 0.0015  memory: 3960  
11/15 06:51:48 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:13:59  time: 0.7565  data_time: 0.0016  memory: 3985  
11/15 06:52:25 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:13:16  time: 0.7538  data_time: 0.0016  memory: 3987  
11/15 06:53:07 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:12:38  time: 0.8746  data_time: 0.0016  memory: 4033  
11/15 06:53:48 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:11:59  time: 0.7553  data_time: 0.0017  memory: 3975  
11/15 06:54:26 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:11:18  time: 0.7936  data_time: 0.0016  memory: 3968  
11/15 06:55:06 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:10:38  time: 0.7547  data_time: 0.0016  memory: 3998  
11/15 06:55:42 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:09:56  time: 0.7549  data_time: 0.0016  memory: 3955  
11/15 06:56:17 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:09:13  time: 0.7940  data_time: 0.0017  memory: 3929  
11/15 06:56:56 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:08:34  time: 0.7124  data_time: 0.0016  memory: 3930  
11/15 06:57:34 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:07:53  time: 0.8376  data_time: 0.0016  memory: 3987  
11/15 06:58:12 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:07:13  time: 1.0506  data_time: 0.0016  memory: 3986  
11/15 06:58:50 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:06:33  time: 0.7145  data_time: 0.0016  memory: 3929  
11/15 06:59:30 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:05:54  time: 0.7965  data_time: 0.0017  memory: 3976  
11/15 07:00:09 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:15  time: 0.7949  data_time: 0.0017  memory: 3927  
11/15 07:00:45 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:04:35  time: 0.6730  data_time: 0.0016  memory: 4109  
11/15 07:01:26 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:56  time: 0.7947  data_time: 0.0018  memory: 3984  
11/15 07:02:06 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:16  time: 0.7549  data_time: 0.0015  memory: 3992  
11/15 07:02:43 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:37  time: 0.8384  data_time: 0.0018  memory: 3943  
11/15 07:03:25 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:58  time: 0.8350  data_time: 0.0018  memory: 3889  
11/15 07:04:00 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:18  time: 0.7149  data_time: 0.0016  memory: 4014  
11/15 07:04:39 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:39  time: 0.7545  data_time: 0.0016  memory: 4144  
11/15 07:05:16 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7119  data_time: 0.0015  memory: 4022  
11/15 07:05:16 - mmengine - INFO - per class results:
11/15 07:05:16 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  78.6 |  90.8 |
|       building      |  82.9 | 93.03 |
|         sky         | 94.43 |  97.7 |
|        floor        |  81.7 | 92.23 |
|         tree        | 73.69 | 89.43 |
|       ceiling       | 84.67 | 92.27 |
|         road        | 81.33 |  87.8 |
|         bed         | 90.24 | 95.88 |
|      windowpane     | 65.22 | 80.23 |
|        grass        | 67.75 | 80.86 |
|       cabinet       | 61.37 | 71.46 |
|       sidewalk      | 62.03 | 78.56 |
|        person       | 83.22 | 92.87 |
|        earth        | 34.66 | 52.44 |
|         door        | 52.16 | 60.66 |
|        table        | 66.02 | 78.62 |
|       mountain      | 57.49 | 70.49 |
|        plant        | 48.84 | 57.27 |
|       curtain       | 74.47 | 84.87 |
|        chair        | 60.47 |  69.1 |
|         car         | 84.89 | 93.86 |
|        water        | 59.48 | 75.06 |
|       painting      | 74.22 | 84.58 |
|         sofa        | 76.61 | 89.42 |
|        shelf        | 42.18 | 62.73 |
|        house        | 49.71 | 66.09 |
|         sea         |  64.9 | 83.93 |
|        mirror       | 70.49 | 78.28 |
|         rug         | 53.32 | 59.79 |
|        field        | 33.79 | 44.71 |
|       armchair      | 56.07 | 75.06 |
|         seat        | 59.54 | 80.46 |
|        fence        | 47.01 | 61.22 |
|         desk        | 55.79 | 74.93 |
|         rock        | 53.08 | 82.56 |
|       wardrobe      | 46.85 | 67.06 |
|         lamp        | 68.57 | 76.03 |
|       bathtub       |  80.3 | 85.28 |
|       railing       | 35.45 | 44.46 |
|       cushion       | 58.76 |  65.8 |
|         base        | 34.32 | 41.35 |
|         box         | 24.89 | 29.64 |
|        column       | 47.65 | 56.41 |
|      signboard      | 40.07 | 53.91 |
|   chest of drawers  | 46.64 | 64.04 |
|       counter       | 26.03 | 32.82 |
|         sand        | 43.56 | 71.24 |
|         sink        | 74.97 | 80.54 |
|      skyscraper     | 52.93 | 75.65 |
|      fireplace      | 74.78 | 81.99 |
|     refrigerator    | 75.43 | 78.44 |
|      grandstand     | 49.31 | 85.58 |
|         path        | 23.11 | 35.14 |
|        stairs       |  32.9 | 37.06 |
|        runway       | 76.99 | 94.28 |
|         case        | 49.87 | 64.02 |
|      pool table     | 94.24 | 96.67 |
|        pillow       |  59.9 | 73.85 |
|     screen door     | 74.72 | 79.09 |
|       stairway      | 37.07 | 44.94 |
|        river        | 10.74 | 18.62 |
|        bridge       | 52.77 | 58.54 |
|       bookcase      | 40.57 | 57.74 |
|        blind        |  37.9 | 39.36 |
|     coffee table    | 68.09 | 82.21 |
|        toilet       | 85.78 | 91.56 |
|        flower       | 38.97 |  56.0 |
|         book        | 50.39 | 65.79 |
|         hill        |  7.36 | 10.74 |
|        bench        | 47.35 | 53.71 |
|      countertop     | 56.33 | 75.78 |
|        stove        |  80.6 | 85.27 |
|         palm        | 52.48 | 67.05 |
|    kitchen island   | 34.47 |  50.8 |
|       computer      | 76.92 |  91.4 |
|     swivel chair    | 52.33 |  72.1 |
|         boat        | 38.64 | 57.11 |
|         bar         | 53.66 | 71.78 |
|    arcade machine   | 74.86 | 76.17 |
|        hovel        |  41.4 | 45.92 |
|         bus         | 89.98 | 96.62 |
|        towel        | 65.05 | 70.92 |
|        light        | 52.82 | 59.55 |
|        truck        |  36.8 | 47.27 |
|        tower        | 12.63 | 20.32 |
|      chandelier     | 68.75 | 79.46 |
|        awning       | 38.67 | 46.19 |
|     streetlight     | 34.32 | 41.76 |
|        booth        | 46.37 | 48.13 |
| television receiver | 67.56 | 74.24 |
|       airplane      | 61.15 | 67.35 |
|      dirt track     | 23.13 | 43.69 |
|       apparel       | 41.05 | 50.85 |
|         pole        | 32.11 | 50.12 |
|         land        |  2.86 |  4.98 |
|      bannister      | 14.99 | 20.91 |
|      escalator      | 36.58 |  46.7 |
|       ottoman       | 54.16 |  73.2 |
|        bottle       | 39.36 | 59.75 |
|        buffet       | 49.23 | 63.14 |
|        poster       | 29.46 | 37.42 |
|        stage        | 13.64 | 19.71 |
|         van         | 42.88 | 58.47 |
|         ship        | 66.52 | 90.91 |
|       fountain      | 35.81 | 36.09 |
|    conveyer belt    | 87.02 | 92.75 |
|        canopy       | 44.07 | 55.99 |
|        washer       | 84.74 | 89.16 |
|      plaything      | 27.16 | 32.61 |
|    swimming pool    | 59.91 | 81.68 |
|        stool        | 49.27 |  65.4 |
|        barrel       | 55.24 | 72.62 |
|        basket       | 26.66 | 30.65 |
|      waterfall      | 68.31 | 74.82 |
|         tent        | 93.15 | 98.75 |
|         bag         |  9.25 | 10.06 |
|       minibike      | 70.95 | 84.25 |
|        cradle       | 84.22 | 97.44 |
|         oven        | 50.18 |  60.4 |
|         ball        | 48.44 | 68.34 |
|         food        | 50.43 | 64.74 |
|         step        |  4.06 |  4.38 |
|         tank        | 59.57 | 61.65 |
|      trade name     | 22.86 | 24.47 |
|      microwave      | 84.72 | 90.93 |
|         pot         | 46.59 | 50.39 |
|        animal       |  62.9 | 64.29 |
|       bicycle       | 57.65 | 76.32 |
|         lake        | 63.13 | 63.65 |
|      dishwasher     | 70.46 |  74.0 |
|        screen       | 68.68 | 84.01 |
|       blanket       | 19.53 | 21.62 |
|      sculpture      | 74.26 | 81.74 |
|         hood        | 53.39 | 64.46 |
|        sconce       | 44.92 | 50.52 |
|         vase        | 43.36 | 58.56 |
|    traffic light    | 37.03 | 44.58 |
|         tray        | 18.58 | 23.05 |
|        ashcan       | 36.62 | 47.23 |
|         fan         | 65.74 |  76.6 |
|         pier        | 30.83 | 46.38 |
|      crt screen     |  3.69 |  9.82 |
|        plate        | 60.37 | 77.57 |
|       monitor       |  4.58 |  5.27 |
|    bulletin board   | 42.26 | 57.21 |
|        shower       | 11.36 | 13.47 |
|       radiator      | 59.08 | 62.12 |
|        glass        | 14.08 | 14.44 |
|        clock        | 48.46 | 56.54 |
|         flag        | 53.32 | 57.79 |
+---------------------+-------+-------+
11/15 07:05:16 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 83.8700  mIoU: 52.2700  mAcc: 62.8200  data_time: 0.0019  time: 0.7838
Finished processing corruption type: impulse_noise
Processing corruption type: defocus_blur
11/15 07:05:39 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1259640231
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1259640231
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 07:05:40 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='defocus_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/defocus_blur'

Number of parameters:  441271084
11/15 07:05:57 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 07:05:57 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 07:05:57 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 07:06:02 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 07:07:07 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:42:06  time: 0.8826  data_time: 0.0016  memory: 24548  
11/15 07:07:48 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:33:34  time: 0.8442  data_time: 0.0016  memory: 4003  
11/15 07:08:27 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:29:43  time: 0.8036  data_time: 0.0016  memory: 3937  
11/15 07:09:08 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:27:58  time: 0.8417  data_time: 0.0016  memory: 4098  
11/15 07:09:47 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:26:12  time: 0.8032  data_time: 0.0015  memory: 4154  
11/15 07:10:26 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:24:58  time: 0.8446  data_time: 0.0016  memory: 3995  
11/15 07:11:07 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:23:57  time: 0.7602  data_time: 0.0015  memory: 3994  
11/15 07:11:47 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:22:58  time: 0.8415  data_time: 0.0015  memory: 3999  
11/15 07:12:21 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:21:46  time: 0.7598  data_time: 0.0015  memory: 3934  
11/15 07:13:01 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:20:56  time: 0.7629  data_time: 0.0015  memory: 3938  
11/15 07:13:43 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:20:15  time: 0.8836  data_time: 0.0016  memory: 3990  
11/15 07:14:23 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:19:28  time: 0.8465  data_time: 0.0017  memory: 3998  
11/15 07:15:02 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:18:41  time: 0.8039  data_time: 0.0015  memory: 4018  
11/15 07:15:45 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:18:03  time: 0.8455  data_time: 0.0018  memory: 4014  
11/15 07:16:26 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:17:20  time: 0.8443  data_time: 0.0016  memory: 4029  
11/15 07:17:02 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:16:30  time: 0.8414  data_time: 0.0017  memory: 3940  
11/15 07:17:45 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:15:50  time: 0.8471  data_time: 0.0018  memory: 3929  
11/15 07:18:19 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:15:01  time: 0.6800  data_time: 0.0016  memory: 3960  
11/15 07:19:00 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:14:20  time: 0.7656  data_time: 0.0019  memory: 3985  
11/15 07:19:38 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:13:35  time: 0.7658  data_time: 0.0016  memory: 3987  
11/15 07:20:20 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:12:56  time: 0.8840  data_time: 0.0017  memory: 4033  
11/15 07:21:01 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:12:15  time: 0.7637  data_time: 0.0017  memory: 3975  
11/15 07:21:40 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:11:33  time: 0.8040  data_time: 0.0016  memory: 3968  
11/15 07:22:21 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:10:52  time: 0.7631  data_time: 0.0016  memory: 3998  
11/15 07:22:57 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:10:08  time: 0.7608  data_time: 0.0016  memory: 3955  
11/15 07:23:32 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:09:25  time: 0.8031  data_time: 0.0016  memory: 3929  
11/15 07:24:11 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:08:44  time: 0.7187  data_time: 0.0016  memory: 3930  
11/15 07:24:50 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:08:03  time: 0.8453  data_time: 0.0015  memory: 3987  
11/15 07:25:26 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:07:21  time: 0.8423  data_time: 0.0015  memory: 3986  
11/15 07:26:04 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:06:40  time: 0.7202  data_time: 0.0015  memory: 3929  
11/15 07:26:44 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:06:00  time: 0.8050  data_time: 0.0016  memory: 3976  
11/15 07:27:23 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:20  time: 0.8017  data_time: 0.0017  memory: 3927  
11/15 07:28:00 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:04:39  time: 0.6953  data_time: 0.0015  memory: 4109  
11/15 07:28:41 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:59  time: 0.8037  data_time: 0.0018  memory: 3984  
11/15 07:29:22 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:20  time: 0.7614  data_time: 0.0015  memory: 3992  
11/15 07:29:59 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:39  time: 0.8441  data_time: 0.0018  memory: 3943  
11/15 07:30:41 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:59  time: 0.8412  data_time: 0.0018  memory: 3889  
11/15 07:31:17 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:19  time: 0.7235  data_time: 0.0016  memory: 4014  
11/15 07:31:57 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:39  time: 0.7626  data_time: 0.0015  memory: 4144  
11/15 07:32:34 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7190  data_time: 0.0015  memory: 4022  
11/15 07:32:34 - mmengine - INFO - per class results:
11/15 07:32:34 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  81.1 | 89.36 |
|       building      | 83.52 | 93.73 |
|         sky         | 94.85 | 97.54 |
|        floor        |  83.7 | 91.87 |
|         tree        | 76.55 | 88.28 |
|       ceiling       | 87.18 | 93.99 |
|         road        | 84.86 |  91.3 |
|         bed         | 91.53 | 96.83 |
|      windowpane     | 65.14 | 82.71 |
|        grass        | 67.88 |  83.1 |
|       cabinet       | 64.16 | 75.88 |
|       sidewalk      | 69.49 |  81.9 |
|        person       | 83.83 | 93.23 |
|        earth        | 35.54 | 47.69 |
|         door        | 58.76 | 71.46 |
|        table        | 67.58 | 80.47 |
|       mountain      | 61.43 |  76.4 |
|        plant        | 52.24 | 64.88 |
|       curtain       | 77.33 | 88.91 |
|        chair        | 63.33 | 75.76 |
|         car         | 86.02 | 94.15 |
|        water        | 62.58 | 77.12 |
|       painting      | 76.88 | 88.46 |
|         sofa        | 80.09 | 86.99 |
|        shelf        | 45.66 | 64.46 |
|        house        | 50.98 | 63.53 |
|         sea         | 71.65 | 87.57 |
|        mirror       | 74.11 | 82.73 |
|         rug         | 63.83 | 73.36 |
|        field        | 32.94 | 45.24 |
|       armchair      | 59.99 | 81.64 |
|         seat        | 64.04 | 85.92 |
|        fence        | 50.16 | 69.15 |
|         desk        | 55.62 | 75.88 |
|         rock        | 51.74 | 84.32 |
|       wardrobe      | 47.31 | 66.84 |
|         lamp        | 71.38 | 85.44 |
|       bathtub       | 84.61 | 89.15 |
|       railing       | 40.49 | 55.33 |
|       cushion       | 66.26 | 76.84 |
|         base        | 46.48 | 56.08 |
|         box         | 34.62 |  44.1 |
|        column       | 50.98 | 63.36 |
|      signboard      | 39.28 | 53.85 |
|   chest of drawers  | 45.39 | 58.13 |
|       counter       | 40.82 | 51.27 |
|         sand        | 54.26 | 80.69 |
|         sink        | 77.29 | 83.43 |
|      skyscraper     | 47.77 |  60.1 |
|      fireplace      | 79.16 | 87.79 |
|     refrigerator    |  76.2 | 80.53 |
|      grandstand     | 47.23 | 88.99 |
|         path        |  26.3 | 41.14 |
|        stairs       | 26.24 | 30.96 |
|        runway       | 70.16 | 91.58 |
|         case        | 56.91 |  78.0 |
|      pool table     | 94.81 | 98.05 |
|        pillow       | 63.96 | 76.02 |
|     screen door     | 78.42 |  85.2 |
|       stairway      | 43.42 | 59.66 |
|        river        | 14.02 | 25.54 |
|        bridge       |  39.7 | 49.89 |
|       bookcase      | 41.15 | 68.53 |
|        blind        | 36.94 | 39.06 |
|     coffee table    | 64.95 | 84.13 |
|        toilet       | 87.93 | 93.25 |
|        flower       | 48.45 | 68.35 |
|         book        | 46.76 | 68.09 |
|         hill        | 14.61 |  21.8 |
|        bench        | 57.18 | 65.74 |
|      countertop     |  60.9 | 84.68 |
|        stove        | 81.86 | 87.08 |
|         palm        | 52.14 | 74.64 |
|    kitchen island   | 46.36 | 74.08 |
|       computer      | 77.93 | 89.81 |
|     swivel chair    | 45.54 | 72.88 |
|         boat        | 60.64 | 83.86 |
|         bar         | 60.27 | 76.97 |
|    arcade machine   | 88.74 | 93.28 |
|        hovel        |  13.7 |  14.2 |
|         bus         | 90.56 | 97.22 |
|        towel        | 73.84 | 82.39 |
|        light        | 58.62 | 67.72 |
|        truck        | 42.86 | 52.17 |
|        tower        | 14.38 | 23.54 |
|      chandelier     | 70.08 | 82.09 |
|        awning       | 41.67 | 48.81 |
|     streetlight     | 31.29 | 42.87 |
|        booth        | 51.93 | 64.15 |
| television receiver | 74.02 | 86.96 |
|       airplane      | 63.63 | 71.48 |
|      dirt track     | 21.84 | 46.93 |
|       apparel       | 57.54 | 74.29 |
|         pole        |  23.5 |  29.8 |
|         land        |  1.85 |  2.94 |
|      bannister      | 21.38 |  28.7 |
|      escalator      | 54.72 | 77.11 |
|       ottoman       | 51.88 | 72.22 |
|        bottle       | 29.16 | 37.05 |
|        buffet       | 54.96 | 68.55 |
|        poster       | 30.08 | 36.39 |
|        stage        | 19.69 | 36.88 |
|         van         |  44.0 | 56.03 |
|         ship        | 76.65 | 85.22 |
|       fountain      | 26.51 | 27.23 |
|    conveyer belt    | 84.13 |  93.0 |
|        canopy       |  38.5 | 57.36 |
|        washer       | 83.77 | 88.66 |
|      plaything      | 44.38 | 62.99 |
|    swimming pool    | 63.86 | 89.17 |
|        stool        | 50.92 | 66.73 |
|        barrel       |  73.3 | 94.06 |
|        basket       | 35.68 |  42.1 |
|      waterfall      | 78.54 | 88.01 |
|         tent        | 86.17 | 99.47 |
|         bag         | 13.04 | 14.06 |
|       minibike      | 67.58 | 85.21 |
|        cradle       |  83.6 | 98.41 |
|         oven        | 63.65 | 80.23 |
|         ball        | 59.36 | 68.84 |
|         food        | 51.45 | 60.29 |
|         step        |  10.0 | 11.59 |
|         tank        | 62.75 | 66.95 |
|      trade name     | 24.43 | 27.57 |
|      microwave      | 87.45 | 94.04 |
|         pot         | 55.66 | 62.33 |
|        animal       | 64.49 | 66.69 |
|       bicycle       | 58.14 | 76.24 |
|         lake        | 56.71 | 69.97 |
|      dishwasher     | 75.33 | 80.33 |
|        screen       | 71.71 |  90.1 |
|       blanket       | 24.51 | 27.51 |
|      sculpture      | 69.19 | 86.85 |
|         hood        | 59.81 | 74.03 |
|        sconce       |  54.0 | 67.97 |
|         vase        | 44.78 | 60.99 |
|    traffic light    | 41.47 | 59.21 |
|         tray        | 16.42 | 19.66 |
|        ashcan       | 45.04 | 64.41 |
|         fan         | 68.79 | 80.95 |
|         pier        | 34.12 |  51.2 |
|      crt screen     |  6.32 | 17.63 |
|        plate        | 57.13 | 78.38 |
|       monitor       |  3.96 |  4.87 |
|    bulletin board   | 47.51 | 54.35 |
|        shower       | 13.14 | 16.44 |
|       radiator      | 57.67 | 62.68 |
|        glass        | 17.36 |  18.3 |
|        clock        | 45.67 |  58.2 |
|         flag        | 56.22 | 62.91 |
+---------------------+-------+-------+
11/15 07:32:34 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 85.2500  mIoU: 55.0700  mAcc: 67.3600  data_time: 0.0019  time: 0.7958
Finished processing corruption type: defocus_blur
Processing corruption type: glass_blur
11/15 07:32:41 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 837774116
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 837774116
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 07:32:41 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='glass_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/glass_blur'

Number of parameters:  441271084
11/15 07:32:53 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 07:32:53 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 07:32:53 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 07:32:55 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 07:42:18 - mmengine - INFO - Iter(test) [  50/2000]    eta: 6:05:45  time: 11.6643  data_time: 0.0017  memory: 24548  
11/15 07:51:27 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 5:52:12  time: 11.3377  data_time: 0.0018  memory: 4003  
11/15 08:00:17 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 5:37:36  time: 10.8905  data_time: 0.0017  memory: 3937  
11/15 08:09:20 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 5:27:47  time: 10.6231  data_time: 0.0017  memory: 4098  
11/15 08:17:54 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 5:14:54  time: 10.4229  data_time: 0.0017  memory: 4154  
11/15 08:26:27 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 5:03:23  time: 10.8029  data_time: 0.0018  memory: 3995  
11/15 08:35:12 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 4:53:39  time: 10.0044  data_time: 0.0017  memory: 3994  
11/15 08:44:00 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 4:44:20  time: 10.8763  data_time: 0.0016  memory: 3999  
11/15 08:52:02 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 4:32:31  time: 9.7852  data_time: 0.0017  memory: 3934  
11/15 09:00:42 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 4:23:21  time: 10.1491  data_time: 0.0017  memory: 3938  
11/15 09:09:53 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 4:15:38  time: 11.0176  data_time: 0.0018  memory: 3990  
11/15 09:18:31 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 4:06:23  time: 10.8223  data_time: 0.0018  memory: 3998  
11/15 09:27:10 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 3:57:17  time: 10.6284  data_time: 0.0016  memory: 4018  
11/15 09:36:23 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 3:49:18  time: 10.9342  data_time: 0.0018  memory: 4014  
11/15 09:45:16 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 3:40:34  time: 10.3023  data_time: 0.0015  memory: 4029  
11/15 09:53:31 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 3:30:53  time: 10.5884  data_time: 0.0018  memory: 3940  
11/15 10:02:22 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 3:22:12  time: 10.7941  data_time: 0.0017  memory: 3929  
11/15 10:10:36 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 3:12:43  time: 9.5718  data_time: 0.0015  memory: 3960  
11/15 10:19:33 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 3:04:10  time: 10.3112  data_time: 0.0016  memory: 3985  
11/15 10:28:02 - mmengine - INFO - Iter(test) [1000/2000]    eta: 2:55:06  time: 10.2043  data_time: 0.0017  memory: 3987  
11/15 10:37:01 - mmengine - INFO - Iter(test) [1050/2000]    eta: 2:46:34  time: 10.9236  data_time: 0.0016  memory: 4033  
11/15 10:45:53 - mmengine - INFO - Iter(test) [1100/2000]    eta: 2:37:52  time: 10.5445  data_time: 0.0017  memory: 3975  
11/15 10:54:33 - mmengine - INFO - Iter(test) [1150/2000]    eta: 2:29:01  time: 10.6087  data_time: 0.0017  memory: 3968  
11/15 11:03:36 - mmengine - INFO - Iter(test) [1200/2000]    eta: 2:20:27  time: 10.4702  data_time: 0.0017  memory: 3998  
11/15 11:12:05 - mmengine - INFO - Iter(test) [1250/2000]    eta: 2:11:30  time: 10.2681  data_time: 0.0017  memory: 3955  
11/15 11:20:22 - mmengine - INFO - Iter(test) [1300/2000]    eta: 2:02:28  time: 10.6550  data_time: 0.0016  memory: 3929  
11/15 11:29:31 - mmengine - INFO - Iter(test) [1350/2000]    eta: 1:53:55  time: 10.4300  data_time: 0.0018  memory: 3930  
11/15 11:38:48 - mmengine - INFO - Iter(test) [1400/2000]    eta: 1:45:22  time: 11.7680  data_time: 0.0017  memory: 3987  
11/15 11:47:40 - mmengine - INFO - Iter(test) [1450/2000]    eta: 1:36:37  time: 11.6299  data_time: 0.0017  memory: 3986  
11/15 11:56:42 - mmengine - INFO - Iter(test) [1500/2000]    eta: 1:27:55  time: 10.3357  data_time: 0.0017  memory: 3929  
11/15 12:06:22 - mmengine - INFO - Iter(test) [1550/2000]    eta: 1:19:23  time: 11.3710  data_time: 0.0017  memory: 3976  
11/15 12:15:23 - mmengine - INFO - Iter(test) [1600/2000]    eta: 1:10:37  time: 11.0776  data_time: 0.0018  memory: 3927  
11/15 12:24:39 - mmengine - INFO - Iter(test) [1650/2000]    eta: 1:01:52  time: 10.2075  data_time: 0.0017  memory: 4109  
11/15 12:34:14 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:53:10  time: 11.3613  data_time: 0.0019  memory: 3984  
11/15 12:43:52 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:44:25  time: 11.0596  data_time: 0.0017  memory: 3992  
11/15 12:52:50 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:35:32  time: 11.5089  data_time: 0.0020  memory: 3943  
11/15 13:02:18 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:26:42  time: 11.3599  data_time: 0.0019  memory: 3889  
11/15 13:11:06 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:17:47  time: 10.9106  data_time: 0.0018  memory: 4014  
11/15 13:20:37 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:08:54  time: 10.8873  data_time: 0.0018  memory: 4144  
11/15 13:29:40 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 10.2045  data_time: 0.0016  memory: 4022  
11/15 13:29:40 - mmengine - INFO - per class results:
11/15 13:29:40 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 81.03 | 90.35 |
|       building      | 83.58 | 93.72 |
|         sky         | 94.55 | 97.97 |
|        floor        | 83.79 | 91.56 |
|         tree        | 75.68 | 87.91 |
|       ceiling       | 86.49 | 94.19 |
|         road        | 85.73 | 90.99 |
|         bed         | 90.93 | 96.58 |
|      windowpane     | 63.66 | 79.71 |
|        grass        | 67.56 | 82.82 |
|       cabinet       |  63.1 | 72.39 |
|       sidewalk      | 70.91 | 83.14 |
|        person       | 83.74 | 93.36 |
|        earth        | 36.49 | 52.49 |
|         door        | 58.22 | 71.03 |
|        table        | 67.29 | 80.85 |
|       mountain      | 58.75 | 71.92 |
|        plant        | 52.25 | 63.71 |
|       curtain       | 73.21 | 87.66 |
|        chair        | 63.94 | 77.17 |
|         car         | 85.48 | 93.17 |
|        water        |  63.8 | 79.65 |
|       painting      | 76.25 | 87.32 |
|         sofa        | 79.71 | 91.56 |
|        shelf        | 46.82 | 64.72 |
|        house        | 52.71 | 67.92 |
|         sea         | 71.57 | 90.51 |
|        mirror       | 73.52 | 85.17 |
|         rug         | 63.94 | 75.88 |
|        field        | 34.39 | 50.12 |
|       armchair      | 58.71 | 72.51 |
|         seat        | 63.04 | 85.35 |
|        fence        |  46.6 | 61.02 |
|         desk        | 57.56 | 73.99 |
|         rock        | 52.84 | 77.76 |
|       wardrobe      | 52.48 | 71.06 |
|         lamp        |  70.5 | 82.25 |
|       bathtub       | 83.01 | 87.26 |
|       railing       | 38.16 |  50.2 |
|       cushion       | 67.04 | 77.85 |
|         base        | 43.19 | 54.51 |
|         box         | 35.05 | 43.97 |
|        column       | 52.76 | 62.81 |
|      signboard      | 37.79 | 51.74 |
|   chest of drawers  |  39.2 | 58.19 |
|       counter       | 41.16 | 49.82 |
|         sand        | 46.96 | 66.19 |
|         sink        | 74.88 | 82.89 |
|      skyscraper     | 43.12 | 56.01 |
|      fireplace      | 77.75 | 87.78 |
|     refrigerator    |  78.1 | 85.99 |
|      grandstand     | 48.35 | 88.93 |
|         path        | 30.37 | 39.68 |
|        stairs       | 27.03 | 33.64 |
|        runway       | 69.69 | 89.32 |
|         case        | 56.79 | 78.26 |
|      pool table     | 94.47 |  97.3 |
|        pillow       | 60.41 | 67.71 |
|     screen door     | 81.51 | 86.01 |
|       stairway      |  43.5 | 57.33 |
|        river        | 14.63 | 23.76 |
|        bridge       | 42.89 | 49.76 |
|       bookcase      | 43.79 | 70.37 |
|        blind        | 20.07 | 20.83 |
|     coffee table    | 66.14 | 83.87 |
|        toilet       | 88.25 | 92.94 |
|        flower       | 41.43 | 64.48 |
|         book        |  49.1 |  63.4 |
|         hill        | 14.26 | 23.13 |
|        bench        | 53.27 | 59.73 |
|      countertop     | 59.34 | 80.51 |
|        stove        | 83.17 | 88.22 |
|         palm        | 57.86 | 75.65 |
|    kitchen island   | 45.02 | 70.48 |
|       computer      | 78.44 | 89.25 |
|     swivel chair    | 50.47 | 70.68 |
|         boat        | 64.13 | 72.53 |
|         bar         | 60.45 |  72.8 |
|    arcade machine   |  89.2 | 92.91 |
|        hovel        | 14.88 | 15.42 |
|         bus         |  92.0 | 96.52 |
|        towel        | 70.89 | 80.35 |
|        light        | 56.01 | 64.77 |
|        truck        | 40.23 | 53.91 |
|        tower        | 10.46 | 16.99 |
|      chandelier     | 72.83 | 85.16 |
|        awning       | 40.27 | 48.26 |
|     streetlight     | 31.36 | 41.85 |
|        booth        | 55.26 | 57.96 |
| television receiver | 72.64 | 79.52 |
|       airplane      | 70.65 | 75.66 |
|      dirt track     | 11.08 | 34.88 |
|       apparel       | 57.93 | 74.73 |
|         pole        | 27.37 | 36.45 |
|         land        |  0.95 |  1.41 |
|      bannister      | 13.91 | 18.49 |
|      escalator      | 50.36 | 68.37 |
|       ottoman       | 56.56 | 73.37 |
|        bottle       | 32.82 | 41.65 |
|        buffet       | 59.21 |  69.3 |
|        poster       | 36.33 |  44.5 |
|        stage        | 20.64 | 35.11 |
|         van         | 43.68 | 58.79 |
|         ship        | 69.15 | 84.45 |
|       fountain      | 33.24 | 33.74 |
|    conveyer belt    | 80.77 | 93.26 |
|        canopy       | 42.07 | 57.93 |
|        washer       | 77.38 | 79.46 |
|      plaything      | 45.36 | 62.97 |
|    swimming pool    | 65.87 | 90.19 |
|        stool        | 48.27 | 68.77 |
|        barrel       | 31.73 | 73.83 |
|        basket       | 37.03 | 41.92 |
|      waterfall      | 68.69 | 78.25 |
|         tent        | 92.59 | 98.66 |
|         bag         | 12.35 | 13.68 |
|       minibike      | 72.21 | 86.85 |
|        cradle       | 83.46 | 97.62 |
|         oven        | 43.36 | 75.08 |
|         ball        | 60.74 | 70.12 |
|         food        | 48.74 | 59.49 |
|         step        |  5.9  |  6.66 |
|         tank        | 64.52 | 66.92 |
|      trade name     | 18.05 |  19.7 |
|      microwave      | 72.12 | 75.93 |
|         pot         | 55.24 | 62.12 |
|        animal       | 65.44 | 67.34 |
|       bicycle       |  58.4 | 75.53 |
|         lake        | 54.79 | 64.95 |
|      dishwasher     | 73.48 | 78.32 |
|        screen       | 69.08 | 92.06 |
|       blanket       | 21.44 |  24.7 |
|      sculpture      | 79.48 | 86.92 |
|         hood        | 59.07 | 69.41 |
|        sconce       |  49.4 | 58.96 |
|         vase        | 45.23 | 58.93 |
|    traffic light    |  38.7 | 58.21 |
|         tray        | 16.68 | 21.01 |
|        ashcan       | 44.03 | 56.15 |
|         fan         | 69.06 |  80.9 |
|         pier        | 36.06 | 46.63 |
|      crt screen     |  7.32 | 19.56 |
|        plate        | 59.45 |  74.6 |
|       monitor       |  3.56 |  4.57 |
|    bulletin board   | 40.69 |  49.8 |
|        shower       | 15.23 | 17.22 |
|       radiator      | 61.41 | 70.06 |
|        glass        |  15.4 | 15.98 |
|        clock        | 50.79 | 62.16 |
|         flag        | 48.72 | 52.07 |
+---------------------+-------+-------+
11/15 13:29:40 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 85.1000  mIoU: 54.2200  mAcc: 65.7700  data_time: 0.0027  time: 10.7026
Finished processing corruption type: glass_blur
Processing corruption type: motion_blur
11/15 13:31:34 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1783350034
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1783350034
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 13:31:34 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='motion_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/motion_blur'

Number of parameters:  441271084
11/15 13:32:27 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 13:32:27 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 13:32:28 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 13:32:36 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 13:35:25 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:50:15  time: 2.2360  data_time: 0.0018  memory: 24548  
11/15 13:37:13 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:27:45  time: 2.2198  data_time: 0.0044  memory: 4003  
11/15 13:38:54 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:17:40  time: 2.0397  data_time: 0.0018  memory: 3937  
11/15 13:40:40 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 1:12:35  time: 2.0997  data_time: 0.0018  memory: 4098  
11/15 13:42:20 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 1:08:11  time: 2.0536  data_time: 0.0017  memory: 4154  
11/15 13:44:04 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 1:04:57  time: 2.1767  data_time: 0.0019  memory: 3995  
11/15 13:45:47 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 1:02:12  time: 2.0123  data_time: 0.0017  memory: 3994  
11/15 13:47:33 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:59:47  time: 2.1779  data_time: 0.0017  memory: 3999  
11/15 13:49:03 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:56:41  time: 1.9175  data_time: 0.0017  memory: 3934  
11/15 13:50:46 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:54:29  time: 1.9554  data_time: 0.0018  memory: 3938  
11/15 13:52:34 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:52:37  time: 2.2203  data_time: 0.0018  memory: 3990  
11/15 13:54:13 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:50:27  time: 2.0905  data_time: 0.0018  memory: 3998  
11/15 13:55:54 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:48:24  time: 2.0318  data_time: 0.0016  memory: 4018  
11/15 13:57:44 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:46:40  time: 2.1615  data_time: 0.0018  memory: 4014  
11/15 13:59:30 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:44:50  time: 2.0963  data_time: 0.0017  memory: 4029  
11/15 14:01:04 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:42:42  time: 2.0619  data_time: 0.0019  memory: 3940  
11/15 14:02:49 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:40:52  time: 2.0946  data_time: 0.0019  memory: 3929  
11/15 14:04:20 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:38:48  time: 1.7817  data_time: 0.0016  memory: 3960  
11/15 14:06:04 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:37:00  time: 2.0116  data_time: 0.0018  memory: 3985  
11/15 14:07:42 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:35:06  time: 1.9751  data_time: 0.0018  memory: 3987  
11/15 14:09:31 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:33:24  time: 2.2742  data_time: 0.0018  memory: 4033  
11/15 14:11:15 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:31:37  time: 2.0132  data_time: 0.0018  memory: 3975  
11/15 14:12:55 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:29:48  time: 2.0357  data_time: 0.0017  memory: 3968  
11/15 14:14:39 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:28:02  time: 2.0014  data_time: 0.0018  memory: 3998  
11/15 14:16:17 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:26:12  time: 1.9858  data_time: 0.0017  memory: 3955  
11/15 14:17:50 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:24:21  time: 2.0225  data_time: 0.0018  memory: 3929  
11/15 14:19:32 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:22:36  time: 1.8959  data_time: 0.0018  memory: 3930  
11/15 14:21:14 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:20:50  time: 2.1851  data_time: 0.0017  memory: 3987  
11/15 14:22:50 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:19:03  time: 2.2017  data_time: 0.0017  memory: 3986  
11/15 14:24:29 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:17:17  time: 1.8472  data_time: 0.0017  memory: 3929  
11/15 14:26:13 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:15:34  time: 2.0940  data_time: 0.0018  memory: 3976  
11/15 14:27:50 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:13:48  time: 1.9951  data_time: 0.0018  memory: 3927  
11/15 14:29:28 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:12:03  time: 1.8467  data_time: 0.0016  memory: 4109  
11/15 14:31:13 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:10:20  time: 2.1073  data_time: 0.0018  memory: 3984  
11/15 14:32:57 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:08:37  time: 2.0945  data_time: 0.0017  memory: 3992  
11/15 14:34:35 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:06:53  time: 2.1324  data_time: 0.0019  memory: 3943  
11/15 14:36:19 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:05:10  time: 2.0780  data_time: 0.0030  memory: 3889  
11/15 14:38:04 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:03:26  time: 2.3134  data_time: 0.0125  memory: 4014  
11/15 14:39:50 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:43  time: 2.0601  data_time: 0.0017  memory: 4144  
11/15 14:41:28 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 1.8471  data_time: 0.0016  memory: 4022  
11/15 14:41:29 - mmengine - INFO - per class results:
11/15 14:41:29 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 81.42 | 89.63 |
|       building      | 83.86 | 93.84 |
|         sky         | 94.71 | 97.57 |
|        floor        | 84.32 | 91.86 |
|         tree        | 76.06 | 87.22 |
|       ceiling       | 86.62 | 94.71 |
|         road        | 85.15 | 90.56 |
|         bed         | 91.29 | 96.77 |
|      windowpane     | 65.18 | 80.76 |
|        grass        | 67.81 | 84.04 |
|       cabinet       | 64.31 | 75.51 |
|       sidewalk      | 72.16 | 84.83 |
|        person       | 84.34 | 93.78 |
|        earth        | 39.27 | 51.41 |
|         door        | 59.48 | 72.15 |
|        table        |  67.1 | 78.98 |
|       mountain      | 61.46 |  74.6 |
|        plant        | 53.91 | 67.29 |
|       curtain       | 78.14 | 88.21 |
|        chair        | 64.58 | 77.71 |
|         car         | 85.99 | 93.87 |
|        water        | 63.64 | 79.49 |
|       painting      | 77.26 | 88.91 |
|         sofa        | 81.54 | 90.29 |
|        shelf        | 46.62 | 64.02 |
|        house        | 53.75 | 67.87 |
|         sea         | 71.59 | 87.62 |
|        mirror       | 74.03 | 83.15 |
|         rug         | 62.82 | 75.49 |
|        field        | 31.51 | 46.08 |
|       armchair      | 61.43 | 78.76 |
|         seat        | 64.09 | 86.57 |
|        fence        | 47.19 | 62.89 |
|         desk        | 59.01 | 75.74 |
|         rock        | 56.05 | 85.68 |
|       wardrobe      | 55.38 | 66.78 |
|         lamp        |  71.4 | 83.09 |
|       bathtub       | 85.35 | 90.66 |
|       railing       | 40.25 | 55.55 |
|       cushion       | 65.73 | 76.45 |
|         base        | 48.97 | 59.83 |
|         box         |  36.7 | 47.86 |
|        column       | 51.46 | 63.91 |
|      signboard      | 39.94 | 55.83 |
|   chest of drawers  | 35.57 | 59.63 |
|       counter       | 43.78 | 55.66 |
|         sand        | 57.08 | 82.97 |
|         sink        | 79.85 | 87.77 |
|      skyscraper     | 45.36 |  56.7 |
|      fireplace      |  79.3 | 89.99 |
|     refrigerator    | 80.49 | 87.44 |
|      grandstand     | 50.76 | 87.92 |
|         path        | 27.87 | 42.85 |
|        stairs       | 24.93 | 29.67 |
|        runway       | 67.67 | 88.98 |
|         case        | 54.21 | 77.37 |
|      pool table     | 94.67 | 97.67 |
|        pillow       | 64.03 | 75.03 |
|     screen door     | 77.37 | 85.08 |
|       stairway      | 39.11 | 53.35 |
|        river        | 14.52 | 25.25 |
|        bridge       | 53.34 | 58.98 |
|       bookcase      | 45.09 | 69.45 |
|        blind        | 44.14 | 47.55 |
|     coffee table    | 65.63 | 85.74 |
|        toilet       | 88.59 | 93.13 |
|        flower       | 46.71 | 66.05 |
|         book        |  48.8 | 71.16 |
|         hill        | 17.39 | 27.73 |
|        bench        | 56.02 | 65.89 |
|      countertop     | 56.21 | 85.16 |
|        stove        | 83.64 | 89.19 |
|         palm        | 54.72 | 79.79 |
|    kitchen island   | 42.47 | 73.81 |
|       computer      | 79.96 |  90.7 |
|     swivel chair    | 48.34 | 70.12 |
|         boat        | 65.62 | 77.16 |
|         bar         | 58.19 | 67.95 |
|    arcade machine   | 84.78 | 88.22 |
|        hovel        | 14.73 | 15.26 |
|         bus         |  90.0 | 96.93 |
|        towel        |  73.4 | 81.98 |
|        light        | 59.37 | 68.37 |
|        truck        | 41.21 | 52.74 |
|        tower        | 16.76 | 28.17 |
|      chandelier     | 69.62 | 81.43 |
|        awning       | 43.05 | 51.32 |
|     streetlight     | 31.92 | 40.69 |
|        booth        | 54.93 | 60.67 |
| television receiver | 76.62 | 88.25 |
|       airplane      | 69.86 | 76.54 |
|      dirt track     |  8.57 | 47.12 |
|       apparel       | 62.69 | 79.96 |
|         pole        | 29.77 | 42.09 |
|         land        |  1.96 |  2.99 |
|      bannister      | 20.95 | 27.53 |
|      escalator      | 56.17 | 76.74 |
|       ottoman       | 53.96 | 73.25 |
|        bottle       | 35.92 | 49.67 |
|        buffet       | 56.23 |  67.2 |
|        poster       | 26.85 | 34.26 |
|        stage        | 22.87 | 35.29 |
|         van         | 46.39 | 61.02 |
|         ship        | 69.55 | 81.15 |
|       fountain      | 32.93 |  33.7 |
|    conveyer belt    | 84.52 | 95.36 |
|        canopy       |  36.8 | 55.81 |
|        washer       | 88.65 | 93.39 |
|      plaything      | 45.75 | 62.25 |
|    swimming pool    | 83.92 | 89.22 |
|        stool        | 50.95 | 69.27 |
|        barrel       | 40.44 | 89.52 |
|        basket       | 35.47 | 49.47 |
|      waterfall      | 60.63 | 67.21 |
|         tent        | 91.33 | 99.12 |
|         bag         | 16.67 | 19.73 |
|       minibike      |  71.0 | 87.79 |
|        cradle       | 84.51 | 97.78 |
|         oven        | 60.99 | 81.19 |
|         ball        | 59.12 | 69.18 |
|         food        | 53.04 | 60.02 |
|         step        | 15.56 | 17.72 |
|         tank        | 63.27 | 66.58 |
|      trade name     | 25.18 | 28.41 |
|      microwave      | 86.26 | 93.28 |
|         pot         | 56.28 | 63.46 |
|        animal       |  67.9 |  70.5 |
|       bicycle       | 58.98 | 82.16 |
|         lake        | 53.77 | 63.82 |
|      dishwasher     | 73.64 | 79.45 |
|        screen       | 68.88 | 87.93 |
|       blanket       | 28.52 | 32.27 |
|      sculpture      | 75.18 | 87.79 |
|         hood        | 57.84 | 73.79 |
|        sconce       | 54.36 |  66.3 |
|         vase        |  46.6 | 62.61 |
|    traffic light    |  40.1 | 60.74 |
|         tray        | 17.72 | 23.35 |
|        ashcan       | 42.46 | 60.92 |
|         fan         |  68.8 | 83.15 |
|         pier        | 42.11 | 55.88 |
|      crt screen     |  5.64 | 14.94 |
|        plate        | 59.18 | 81.13 |
|       monitor       |  3.59 |  4.48 |
|    bulletin board   | 43.43 | 56.81 |
|        shower       | 16.13 | 18.72 |
|       radiator      | 66.01 | 75.15 |
|        glass        | 19.53 | 20.66 |
|        clock        | 52.23 | 66.13 |
|         flag        |  61.0 | 65.74 |
+---------------------+-------+-------+
11/15 14:41:29 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 85.5500  mIoU: 55.8000  mAcc: 68.2200  data_time: 0.0025  time: 2.0662
Finished processing corruption type: motion_blur
Processing corruption type: zoom_blur
11/15 14:43:05 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 1525439791
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 1525439791
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 14:43:05 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='zoom_blur',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/zoom_blur'

Number of parameters:  441271084
11/15 14:43:52 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 14:43:52 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 14:43:53 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 14:44:01 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 14:46:46 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:47:30  time: 2.1479  data_time: 0.0018  memory: 24548  
11/15 14:48:28 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:24:32  time: 2.0997  data_time: 0.0019  memory: 4003  
11/15 14:50:06 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:15:03  time: 2.0303  data_time: 0.0018  memory: 3937  
11/15 14:51:49 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 1:10:10  time: 2.0435  data_time: 0.0017  memory: 4098  
11/15 14:53:25 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 1:05:46  time: 1.9868  data_time: 0.0017  memory: 4154  
11/15 14:55:02 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 1:02:28  time: 2.0571  data_time: 0.0019  memory: 3995  
11/15 14:56:42 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:59:46  time: 1.8737  data_time: 0.0017  memory: 3994  
11/15 14:58:20 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:57:17  time: 2.0719  data_time: 0.0018  memory: 3999  
11/15 14:59:49 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:54:26  time: 1.8477  data_time: 0.0017  memory: 3934  
11/15 15:01:28 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:52:22  time: 1.9281  data_time: 0.0017  memory: 3938  
11/15 15:03:13 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:50:38  time: 2.1382  data_time: 0.0019  memory: 3990  
11/15 15:04:51 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:48:37  time: 2.0443  data_time: 0.0019  memory: 3998  
11/15 15:06:29 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:46:40  time: 1.9818  data_time: 0.0017  memory: 4018  
11/15 15:08:15 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:45:00  time: 2.0930  data_time: 0.0020  memory: 4014  
11/15 15:09:56 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:43:12  time: 1.9939  data_time: 0.0033  memory: 4029  
11/15 15:11:28 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:41:10  time: 2.0295  data_time: 0.0019  memory: 3940  
11/15 15:13:09 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:39:24  time: 2.0278  data_time: 0.0019  memory: 3929  
11/15 15:14:38 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:37:24  time: 1.7436  data_time: 0.0017  memory: 3960  
11/15 15:16:17 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:35:40  time: 1.8868  data_time: 0.0018  memory: 3985  
11/15 15:17:51 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:33:50  time: 1.8705  data_time: 0.0033  memory: 3987  
11/15 15:19:34 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:32:10  time: 2.0705  data_time: 0.0017  memory: 4033  
11/15 15:21:12 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:30:25  time: 1.8778  data_time: 0.0018  memory: 3975  
11/15 15:22:51 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:28:42  time: 2.0985  data_time: 0.0018  memory: 3968  
11/15 15:24:37 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:27:03  time: 2.0123  data_time: 0.0018  memory: 3998  
11/15 15:26:14 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:25:20  time: 2.0058  data_time: 0.0018  memory: 3955  
11/15 15:27:50 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:23:35  time: 2.0884  data_time: 0.0018  memory: 3929  
11/15 15:29:31 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:21:54  time: 1.8971  data_time: 0.0018  memory: 3930  
11/15 15:31:13 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:20:13  time: 2.1760  data_time: 0.0017  memory: 3987  
11/15 15:32:50 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:18:30  time: 2.1764  data_time: 0.0018  memory: 3986  
11/15 15:34:30 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:16:49  time: 1.9065  data_time: 0.0018  memory: 3929  
11/15 15:36:16 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:15:10  time: 2.0905  data_time: 0.0019  memory: 3976  
11/15 15:37:57 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:13:29  time: 2.0773  data_time: 0.0019  memory: 3927  
11/15 15:39:36 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:11:47  time: 1.8514  data_time: 0.0017  memory: 4109  
11/15 15:41:22 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:10:07  time: 2.0954  data_time: 0.0019  memory: 3984  
11/15 15:43:08 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:08:26  time: 2.0193  data_time: 0.0018  memory: 3992  
11/15 15:44:46 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:06:45  time: 2.1211  data_time: 0.0020  memory: 3943  
11/15 15:46:33 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:05:04  time: 2.1469  data_time: 0.0020  memory: 3889  
11/15 15:48:09 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:03:22  time: 1.9486  data_time: 0.0036  memory: 4014  
11/15 15:49:54 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:41  time: 2.0091  data_time: 0.0019  memory: 4144  
11/15 15:51:32 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 1.8856  data_time: 0.0017  memory: 4022  
11/15 15:51:32 - mmengine - INFO - per class results:
11/15 15:51:32 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 66.27 |  81.3 |
|       building      | 72.57 |  91.6 |
|         sky         | 87.78 | 91.35 |
|        floor        | 67.73 | 83.99 |
|         tree        | 59.13 | 69.53 |
|       ceiling       | 69.79 |  92.3 |
|         road        | 64.35 | 69.48 |
|         bed         | 79.26 | 93.71 |
|      windowpane     | 50.79 | 77.95 |
|        grass        | 59.26 | 73.49 |
|       cabinet       | 52.46 | 65.84 |
|       sidewalk      | 39.59 | 61.76 |
|        person       | 64.01 | 79.78 |
|        earth        | 26.72 | 45.28 |
|         door        | 35.34 | 42.73 |
|        table        |  49.7 | 65.05 |
|       mountain      | 36.17 | 42.13 |
|        plant        | 34.82 | 48.65 |
|       curtain       | 53.53 | 69.19 |
|        chair        | 42.13 | 55.15 |
|         car         | 69.82 | 82.96 |
|        water        |  51.8 | 69.66 |
|       painting      | 54.96 | 67.69 |
|         sofa        |  55.6 | 73.45 |
|        shelf        | 34.27 | 48.26 |
|        house        | 36.68 |  48.5 |
|         sea         |  49.9 | 75.36 |
|        mirror       | 58.78 | 67.01 |
|         rug         | 26.31 | 27.97 |
|        field        | 26.42 | 53.39 |
|       armchair      |  36.3 | 52.53 |
|         seat        | 47.49 | 69.39 |
|        fence        | 27.36 | 40.43 |
|         desk        | 41.37 | 54.45 |
|         rock        | 28.56 | 53.88 |
|       wardrobe      | 37.36 | 45.87 |
|         lamp        | 41.93 | 55.98 |
|       bathtub       | 73.64 | 84.55 |
|       railing       | 27.34 | 43.43 |
|       cushion       | 30.91 | 34.03 |
|         base        | 20.65 | 30.31 |
|         box         | 11.45 | 13.55 |
|        column       | 32.33 | 46.43 |
|      signboard      |  26.7 | 34.95 |
|   chest of drawers  | 42.68 | 60.48 |
|       counter       | 24.61 | 38.87 |
|         sand        | 29.68 | 48.42 |
|         sink        | 58.53 | 72.03 |
|      skyscraper     | 43.53 | 51.51 |
|      fireplace      | 58.74 |  79.9 |
|     refrigerator    | 60.46 | 78.05 |
|      grandstand     | 39.14 | 65.89 |
|         path        |  9.77 | 15.77 |
|        stairs       |  4.24 |  4.79 |
|        runway       | 55.94 | 67.52 |
|         case        | 30.32 | 54.39 |
|      pool table     | 85.57 |  96.8 |
|        pillow       | 46.79 | 62.25 |
|     screen door     | 45.59 | 51.85 |
|       stairway      | 22.68 | 28.43 |
|        river        | 14.31 | 24.67 |
|        bridge       |  46.1 | 51.26 |
|       bookcase      | 34.36 | 52.05 |
|        blind        | 17.25 | 18.82 |
|     coffee table    | 53.28 | 76.29 |
|        toilet       | 71.91 | 88.84 |
|        flower       | 20.13 | 30.16 |
|         book        |  30.4 | 49.19 |
|         hill        |  10.3 | 22.05 |
|        bench        | 36.47 | 46.54 |
|      countertop     | 49.26 | 63.84 |
|        stove        | 61.29 | 75.04 |
|         palm        | 21.56 | 50.11 |
|    kitchen island   | 42.16 | 61.56 |
|       computer      | 58.77 | 71.43 |
|     swivel chair    | 23.82 | 29.39 |
|         boat        | 44.65 |  57.0 |
|         bar         | 45.04 | 56.21 |
|    arcade machine   | 68.25 | 79.19 |
|        hovel        |  9.82 | 13.23 |
|         bus         | 53.98 | 81.26 |
|        towel        | 40.46 |  46.7 |
|        light        | 24.91 | 37.97 |
|        truck        | 23.39 | 35.85 |
|        tower        |  3.63 |  5.2  |
|      chandelier     |  38.8 | 44.26 |
|        awning       | 23.21 | 28.85 |
|     streetlight     |  5.49 |  5.73 |
|        booth        | 23.11 | 50.68 |
| television receiver | 50.87 | 71.78 |
|       airplane      | 46.12 | 57.36 |
|      dirt track     |  8.44 | 26.77 |
|       apparel       | 24.04 | 35.82 |
|         pole        | 12.83 | 15.53 |
|         land        |  0.67 |  0.84 |
|      bannister      |  3.32 |  3.95 |
|      escalator      | 36.46 | 52.18 |
|       ottoman       | 28.33 | 51.57 |
|        bottle       |  9.95 | 10.83 |
|        buffet       | 29.35 | 34.05 |
|        poster       | 22.47 | 37.47 |
|        stage        |  8.77 | 11.68 |
|         van         | 30.38 | 34.88 |
|         ship        | 52.18 | 53.74 |
|       fountain      | 26.83 | 31.95 |
|    conveyer belt    | 51.49 |  57.7 |
|        canopy       | 18.26 | 19.02 |
|        washer       | 81.92 | 91.58 |
|      plaything      |  7.86 | 10.36 |
|    swimming pool    | 63.61 | 86.99 |
|        stool        | 32.63 | 47.17 |
|        barrel       | 27.32 | 40.03 |
|        basket       | 12.44 | 17.57 |
|      waterfall      | 45.39 | 58.55 |
|         tent        | 77.56 | 99.51 |
|         bag         |  5.7  |  8.41 |
|       minibike      |  39.5 | 65.28 |
|        cradle       | 57.85 | 83.78 |
|         oven        | 23.97 | 57.42 |
|         ball        | 19.01 | 29.38 |
|         food        | 30.06 | 33.93 |
|         step        |  7.68 |  8.77 |
|         tank        | 48.91 | 51.28 |
|      trade name     |  14.6 | 16.11 |
|      microwave      | 32.99 | 38.97 |
|         pot         | 12.39 | 13.21 |
|        animal       |  51.1 | 59.73 |
|       bicycle       | 30.32 | 63.85 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 39.54 | 57.01 |
|        screen       |  62.1 | 81.28 |
|       blanket       | 11.05 | 11.45 |
|      sculpture      | 42.82 | 52.27 |
|         hood        |  57.9 | 69.86 |
|        sconce       | 23.27 | 29.68 |
|         vase        | 17.19 | 20.93 |
|    traffic light    | 14.29 | 16.36 |
|         tray        |  3.78 |  7.23 |
|        ashcan       | 18.62 | 29.45 |
|         fan         | 37.66 | 70.52 |
|         pier        | 33.18 | 43.11 |
|      crt screen     |  2.52 |  5.81 |
|        plate        |  35.2 | 44.71 |
|       monitor       |  1.79 |  2.39 |
|    bulletin board   | 31.72 | 39.96 |
|        shower       |  1.24 |  7.4  |
|       radiator      |  35.0 | 56.73 |
|        glass        |  3.01 |  3.09 |
|        clock        | 10.27 | 11.61 |
|         flag        | 41.04 | 46.99 |
+---------------------+-------+-------+
11/15 15:51:32 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 74.0200  mIoU: 36.1400  mAcc: 48.0100  data_time: 0.0024  time: 2.0257
Finished processing corruption type: zoom_blur
Processing corruption type: snow
11/15 15:51:43 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 337004195
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 337004195
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 15:51:43 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='snow',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/snow'

Number of parameters:  441271084
11/15 15:51:56 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 15:51:56 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 15:51:57 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 15:52:05 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 15:53:22 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:49:45  time: 1.3382  data_time: 0.0031  memory: 24548  
11/15 15:54:24 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:44:02  time: 1.2844  data_time: 0.0019  memory: 4003  
11/15 15:55:24 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:40:54  time: 1.2417  data_time: 0.0019  memory: 3937  
11/15 15:56:28 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:39:22  time: 1.2642  data_time: 0.0019  memory: 4098  
11/15 15:57:27 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:37:29  time: 1.2182  data_time: 0.0018  memory: 4154  
11/15 15:58:27 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:36:01  time: 1.2756  data_time: 0.0020  memory: 3995  
11/15 15:59:29 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:34:49  time: 1.1673  data_time: 0.0018  memory: 3994  
11/15 16:00:29 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:33:35  time: 1.2674  data_time: 0.0018  memory: 3999  
11/15 16:01:23 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:32:00  time: 1.1408  data_time: 0.0018  memory: 3934  
11/15 16:02:23 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:30:54  time: 1.1652  data_time: 0.0018  memory: 3938  
11/15 16:03:28 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:29:58  time: 1.3324  data_time: 0.0019  memory: 3990  
11/15 16:04:28 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:28:52  time: 1.2741  data_time: 0.0020  memory: 3998  
11/15 16:05:27 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:27:45  time: 1.2177  data_time: 0.0017  memory: 4018  
11/15 16:06:32 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:26:49  time: 1.2774  data_time: 0.0020  memory: 4014  
11/15 16:07:34 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:25:48  time: 1.2473  data_time: 0.0019  memory: 4029  
11/15 16:08:30 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:24:36  time: 1.2665  data_time: 0.0033  memory: 3940  
11/15 16:09:34 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:23:38  time: 1.2644  data_time: 0.0020  memory: 3929  
11/15 16:10:28 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:22:27  time: 1.0566  data_time: 0.0018  memory: 3960  
11/15 16:11:30 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:21:26  time: 1.1756  data_time: 0.0019  memory: 3985  
11/15 16:12:27 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:20:21  time: 1.1574  data_time: 0.0019  memory: 3987  
11/15 16:13:31 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:19:22  time: 1.3140  data_time: 0.0018  memory: 4033  
11/15 16:14:33 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:18:22  time: 1.1739  data_time: 0.0019  memory: 3975  
11/15 16:15:32 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:17:19  time: 1.2231  data_time: 0.0018  memory: 3968  
11/15 16:16:34 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:16:18  time: 1.1731  data_time: 0.0019  memory: 3998  
11/15 16:17:30 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:15:14  time: 1.1641  data_time: 0.0018  memory: 3955  
11/15 16:18:25 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:14:10  time: 1.2204  data_time: 0.0018  memory: 3929  
11/15 16:19:24 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:13:09  time: 1.1081  data_time: 0.0018  memory: 3930  
11/15 16:20:23 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:12:07  time: 1.2807  data_time: 0.0018  memory: 3987  
11/15 16:21:19 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:11:05  time: 1.2715  data_time: 0.0018  memory: 3986  
11/15 16:22:18 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:10:04  time: 1.1030  data_time: 0.0019  memory: 3929  
11/15 16:23:20 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:09:04  time: 1.2297  data_time: 0.0018  memory: 3976  
11/15 16:24:19 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:08:03  time: 1.2201  data_time: 0.0019  memory: 3927  
11/15 16:25:16 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:07:02  time: 1.0642  data_time: 0.0017  memory: 4109  
11/15 16:26:18 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:06:02  time: 1.2180  data_time: 0.0020  memory: 3984  
11/15 16:27:20 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:05:02  time: 1.1741  data_time: 0.0018  memory: 3992  
11/15 16:28:17 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:04:01  time: 1.2688  data_time: 0.0020  memory: 3943  
11/15 16:29:20 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:03:01  time: 1.2593  data_time: 0.0020  memory: 3889  
11/15 16:30:15 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:02:00  time: 1.1383  data_time: 0.0019  memory: 4014  
11/15 16:31:16 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:01:00  time: 1.1607  data_time: 0.0018  memory: 4144  
11/15 16:32:13 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 1.0974  data_time: 0.0017  memory: 4022  
11/15 16:32:13 - mmengine - INFO - per class results:
11/15 16:32:13 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 77.41 | 90.37 |
|       building      | 82.42 | 94.42 |
|         sky         | 93.06 | 96.18 |
|        floor        | 79.51 | 92.97 |
|         tree        | 73.25 | 87.31 |
|       ceiling       | 82.87 |  91.5 |
|         road        | 79.85 | 87.41 |
|         bed         | 89.78 | 95.32 |
|      windowpane     |  61.3 |  76.0 |
|        grass        | 67.78 | 90.08 |
|       cabinet       | 61.87 | 71.71 |
|       sidewalk      | 60.87 |  74.7 |
|        person       | 82.33 | 92.42 |
|        earth        | 33.63 | 43.85 |
|         door        | 46.56 | 52.66 |
|        table        | 64.63 | 78.12 |
|       mountain      | 55.69 | 68.55 |
|        plant        | 48.58 | 56.71 |
|       curtain       | 68.76 | 79.72 |
|        chair        | 59.89 | 71.08 |
|         car         | 83.42 | 94.52 |
|        water        |  46.9 | 76.39 |
|       painting      | 74.39 | 84.91 |
|         sofa        | 75.28 | 86.55 |
|        shelf        | 42.27 | 59.85 |
|        house        | 46.62 |  54.6 |
|         sea         | 63.81 | 92.12 |
|        mirror       |  68.2 | 86.36 |
|         rug         | 43.11 | 44.58 |
|        field        |  33.8 | 42.76 |
|       armchair      | 52.69 | 71.33 |
|         seat        |  60.2 | 79.49 |
|        fence        | 41.79 |  57.2 |
|         desk        | 57.16 | 74.27 |
|         rock        |  51.4 | 80.15 |
|       wardrobe      | 41.82 | 56.12 |
|         lamp        | 68.13 | 75.68 |
|       bathtub       | 81.67 | 87.33 |
|       railing       | 33.26 | 42.17 |
|       cushion       | 57.52 | 64.85 |
|         base        |  34.4 | 42.94 |
|         box         | 30.32 | 40.03 |
|        column       | 47.46 |  55.5 |
|      signboard      | 36.77 | 46.31 |
|   chest of drawers  | 41.26 | 56.24 |
|       counter       | 34.99 | 48.96 |
|         sand        | 43.87 | 65.19 |
|         sink        | 70.54 | 83.61 |
|      skyscraper     | 44.73 | 56.11 |
|      fireplace      | 74.21 | 80.35 |
|     refrigerator    | 76.24 | 81.51 |
|      grandstand     | 40.17 | 86.56 |
|         path        | 22.47 | 29.56 |
|        stairs       |  33.3 |  43.7 |
|        runway       | 70.22 | 81.92 |
|         case        | 49.59 | 71.28 |
|      pool table     | 94.43 | 96.47 |
|        pillow       |  58.7 | 71.46 |
|     screen door     |  70.3 | 91.56 |
|       stairway      |  29.1 | 34.32 |
|        river        | 12.47 | 19.79 |
|        bridge       | 52.22 | 62.12 |
|       bookcase      | 42.11 | 56.68 |
|        blind        | 38.95 |  41.6 |
|     coffee table    | 68.16 | 82.94 |
|        toilet       | 84.85 | 91.03 |
|        flower       | 40.36 | 59.62 |
|         book        |  49.0 | 61.09 |
|         hill        | 15.87 |  20.0 |
|        bench        | 46.71 | 52.25 |
|      countertop     | 53.83 | 78.34 |
|        stove        | 78.82 | 87.47 |
|         palm        | 57.03 | 69.29 |
|    kitchen island   | 40.81 | 63.32 |
|       computer      | 72.73 | 82.38 |
|     swivel chair    | 45.62 | 60.57 |
|         boat        | 45.61 | 50.43 |
|         bar         | 54.25 | 67.04 |
|    arcade machine   | 45.72 | 47.39 |
|        hovel        | 29.46 | 32.28 |
|         bus         | 87.17 | 96.76 |
|        towel        | 57.72 | 63.12 |
|        light        | 45.96 | 50.62 |
|        truck        | 38.79 | 49.89 |
|        tower        | 20.73 | 33.64 |
|      chandelier     | 69.86 | 81.67 |
|        awning       | 24.94 | 26.14 |
|     streetlight     |  29.4 | 35.25 |
|        booth        | 39.66 | 41.37 |
| television receiver |  67.7 | 72.95 |
|       airplane      | 61.36 | 65.26 |
|      dirt track     |  1.83 |  2.31 |
|       apparel       | 36.78 | 46.78 |
|         pole        | 29.52 | 41.23 |
|         land        |  1.84 |  2.33 |
|      bannister      | 13.88 | 16.45 |
|      escalator      | 56.42 | 84.62 |
|       ottoman       | 50.64 | 64.99 |
|        bottle       | 41.11 | 62.54 |
|        buffet       | 59.33 | 73.19 |
|        poster       | 22.36 | 24.93 |
|        stage        | 12.58 | 16.73 |
|         van         |  50.0 | 63.07 |
|         ship        | 35.71 | 51.49 |
|       fountain      |  30.3 | 35.14 |
|    conveyer belt    | 86.75 |  93.5 |
|        canopy       | 34.71 | 40.46 |
|        washer       | 82.41 | 85.68 |
|      plaything      | 28.08 | 33.37 |
|    swimming pool    | 65.41 | 83.99 |
|        stool        | 41.88 | 62.82 |
|        barrel       | 59.39 | 66.98 |
|        basket       | 35.55 | 43.66 |
|      waterfall      | 47.19 | 49.87 |
|         tent        | 94.75 | 98.02 |
|         bag         |  11.5 | 12.42 |
|       minibike      | 69.81 | 86.92 |
|        cradle       | 81.68 | 97.29 |
|         oven        | 57.18 | 64.78 |
|         ball        | 51.91 | 67.32 |
|         food        | 50.65 | 60.28 |
|         step        | 13.19 | 14.04 |
|         tank        | 58.95 | 64.48 |
|      trade name     | 22.22 | 23.59 |
|      microwave      | 50.25 | 52.45 |
|         pot         |  50.5 | 54.62 |
|        animal       | 63.36 | 65.02 |
|       bicycle       | 57.32 | 80.45 |
|         lake        |  0.0  |  0.0  |
|      dishwasher     | 59.81 | 64.77 |
|        screen       | 67.54 |  74.7 |
|       blanket       | 12.33 | 12.74 |
|      sculpture      | 67.39 |  74.2 |
|         hood        | 50.67 |  58.4 |
|        sconce       | 44.98 |  51.5 |
|         vase        | 44.56 | 57.52 |
|    traffic light    | 33.89 | 42.05 |
|         tray        | 10.53 | 13.18 |
|        ashcan       | 36.02 | 46.88 |
|         fan         | 63.71 | 71.68 |
|         pier        | 35.34 | 51.12 |
|      crt screen     |  3.08 |  7.63 |
|        plate        | 59.81 | 75.74 |
|       monitor       | 22.57 | 28.14 |
|    bulletin board   | 41.65 | 47.64 |
|        shower       |  8.73 | 15.05 |
|       radiator      | 52.69 | 53.38 |
|        glass        | 16.23 | 16.91 |
|        clock        | 42.68 | 53.77 |
|         flag        | 55.96 | 57.52 |
+---------------------+-------+-------+
11/15 16:32:13 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 82.9900  mIoU: 50.0100  mAcc: 60.2000  data_time: 0.0023  time: 1.2037
Finished processing corruption type: snow
Processing corruption type: frost
11/15 16:32:17 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 263106319
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 263106319
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 16:32:17 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='frost',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/frost'

Number of parameters:  441271084
11/15 16:32:27 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 16:32:28 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 16:32:28 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 16:32:30 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 16:33:20 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:32:18  time: 0.8799  data_time: 0.0019  memory: 24548  
11/15 16:34:01 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:28:44  time: 0.8397  data_time: 0.0020  memory: 4003  
11/15 16:34:39 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:26:33  time: 0.8026  data_time: 0.0019  memory: 3937  
11/15 16:35:21 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:25:37  time: 0.8375  data_time: 0.0019  memory: 4098  
11/15 16:35:59 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:24:21  time: 0.8002  data_time: 0.0019  memory: 4154  
11/15 16:36:38 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:26  time: 0.8366  data_time: 0.0020  memory: 3995  
11/15 16:37:19 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:39  time: 0.7585  data_time: 0.0018  memory: 3994  
11/15 16:37:58 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:51  time: 0.8385  data_time: 0.0018  memory: 3999  
11/15 16:38:32 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:20:47  time: 0.7526  data_time: 0.0019  memory: 3934  
11/15 16:39:12 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:20:05  time: 0.7558  data_time: 0.0019  memory: 3938  
11/15 16:39:53 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:19:28  time: 0.8770  data_time: 0.0019  memory: 3990  
11/15 16:40:33 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:18:46  time: 0.8385  data_time: 0.0020  memory: 3998  
11/15 16:41:12 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:18:03  time: 0.7950  data_time: 0.0018  memory: 4018  
11/15 16:41:54 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:17:27  time: 0.8365  data_time: 0.0020  memory: 4014  
11/15 16:42:35 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:16:48  time: 0.8404  data_time: 0.0018  memory: 4029  
11/15 16:43:11 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:16:01  time: 0.8387  data_time: 0.0020  memory: 3940  
11/15 16:43:53 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:15:23  time: 0.8383  data_time: 0.0021  memory: 3929  
11/15 16:44:28 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:14:36  time: 0.6808  data_time: 0.0018  memory: 3960  
11/15 16:45:08 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:13:57  time: 0.7587  data_time: 0.0019  memory: 3985  
11/15 16:45:45 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:13:14  time: 0.7603  data_time: 0.0031  memory: 3987  
11/15 16:46:27 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:12:37  time: 0.8781  data_time: 0.0019  memory: 4033  
11/15 16:47:08 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:11:58  time: 0.7593  data_time: 0.0019  memory: 3975  
11/15 16:47:47 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:11:17  time: 0.8034  data_time: 0.0020  memory: 3968  
11/15 16:48:27 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:10:38  time: 0.7563  data_time: 0.0019  memory: 3998  
11/15 16:49:03 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:09:55  time: 0.7564  data_time: 0.0019  memory: 3955  
11/15 16:49:38 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:09:13  time: 0.7974  data_time: 0.0020  memory: 3929  
11/15 16:50:17 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:08:33  time: 0.7170  data_time: 0.0019  memory: 3930  
11/15 16:50:55 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:07:53  time: 0.8427  data_time: 0.0019  memory: 3987  
11/15 16:51:31 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:07:12  time: 0.8393  data_time: 0.0019  memory: 3986  
11/15 16:52:10 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:06:33  time: 0.7137  data_time: 0.0018  memory: 3929  
11/15 16:52:50 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:05:54  time: 0.7971  data_time: 0.0018  memory: 3976  
11/15 16:53:28 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:14  time: 0.8010  data_time: 0.0019  memory: 3927  
11/15 16:54:05 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:04:34  time: 0.6778  data_time: 0.0017  memory: 4109  
11/15 16:54:46 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:55  time: 0.7964  data_time: 0.0020  memory: 3984  
11/15 16:55:26 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:16  time: 0.7582  data_time: 0.0018  memory: 3992  
11/15 16:56:03 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:36  time: 0.8403  data_time: 0.0020  memory: 3943  
11/15 16:56:45 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:57  time: 0.8399  data_time: 0.0020  memory: 3889  
11/15 16:57:20 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:18  time: 0.7198  data_time: 0.0029  memory: 4014  
11/15 16:58:00 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:39  time: 0.7599  data_time: 0.0018  memory: 4144  
11/15 16:58:37 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7164  data_time: 0.0017  memory: 4022  
11/15 16:58:37 - mmengine - INFO - per class results:
11/15 16:58:37 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 75.89 | 89.92 |
|       building      | 83.39 | 93.53 |
|         sky         | 79.34 | 81.58 |
|        floor        | 80.01 | 91.04 |
|         tree        |  73.7 | 87.82 |
|       ceiling       | 79.32 | 86.13 |
|         road        | 78.88 | 86.09 |
|         bed         | 90.21 | 95.66 |
|      windowpane     | 61.61 | 77.02 |
|        grass        | 65.52 | 83.06 |
|       cabinet       | 61.92 | 70.94 |
|       sidewalk      | 62.52 | 74.57 |
|        person       | 83.36 | 92.91 |
|        earth        | 36.16 | 50.98 |
|         door        | 48.19 | 57.88 |
|        table        | 66.48 | 81.27 |
|       mountain      | 31.97 |  74.7 |
|        plant        | 49.15 | 61.16 |
|       curtain       | 65.28 | 78.36 |
|        chair        | 61.47 | 73.48 |
|         car         | 84.71 | 92.22 |
|        water        | 58.46 | 75.17 |
|       painting      | 72.72 | 85.41 |
|         sofa        | 76.98 | 87.37 |
|        shelf        | 42.93 | 56.33 |
|        house        | 59.19 | 72.29 |
|         sea         | 58.85 |  78.1 |
|        mirror       | 67.76 | 78.54 |
|         rug         | 55.89 | 62.89 |
|        field        | 23.25 | 34.12 |
|       armchair      | 55.22 | 74.22 |
|         seat        | 61.84 | 85.29 |
|        fence        | 44.05 | 56.97 |
|         desk        | 55.96 | 70.79 |
|         rock        | 49.99 | 77.06 |
|       wardrobe      | 51.29 |  62.1 |
|         lamp        | 69.15 | 78.61 |
|       bathtub       | 79.84 | 87.35 |
|       railing       | 35.62 | 45.24 |
|       cushion       | 59.91 | 71.03 |
|         base        | 43.36 | 52.09 |
|         box         | 29.99 | 38.41 |
|        column       | 50.26 | 60.07 |
|      signboard      | 38.49 | 48.37 |
|   chest of drawers  |  35.8 | 59.86 |
|       counter       | 38.52 | 50.18 |
|         sand        | 50.42 | 71.75 |
|         sink        | 69.42 | 80.54 |
|      skyscraper     | 50.94 | 65.69 |
|      fireplace      | 77.76 | 86.04 |
|     refrigerator    |  75.6 | 82.18 |
|      grandstand     | 44.79 | 86.65 |
|         path        | 22.24 | 35.14 |
|        stairs       | 31.98 | 39.73 |
|        runway       | 69.26 | 88.56 |
|         case        | 53.25 | 82.68 |
|      pool table     | 94.01 | 97.17 |
|        pillow       | 59.62 | 70.87 |
|     screen door     | 46.71 | 96.74 |
|       stairway      | 39.37 | 48.44 |
|        river        |  14.7 | 24.66 |
|        bridge       | 40.64 | 51.16 |
|       bookcase      | 45.72 | 66.16 |
|        blind        | 36.26 | 37.96 |
|     coffee table    | 68.14 | 81.29 |
|        toilet       | 77.79 | 85.54 |
|        flower       | 40.15 | 57.41 |
|         book        | 49.77 |  66.2 |
|         hill        | 16.14 | 26.41 |
|        bench        | 51.12 | 61.28 |
|      countertop     | 59.53 | 84.97 |
|        stove        | 76.37 | 80.39 |
|         palm        | 56.51 | 77.19 |
|    kitchen island   | 38.26 | 72.67 |
|       computer      | 66.86 | 74.64 |
|     swivel chair    | 44.81 | 61.26 |
|         boat        | 63.56 | 76.95 |
|         bar         | 57.16 | 63.04 |
|    arcade machine   |  40.6 | 41.17 |
|        hovel        | 62.52 |  69.7 |
|         bus         | 91.25 |  95.6 |
|        towel        | 67.37 | 76.96 |
|        light        |  52.5 | 58.84 |
|        truck        | 37.43 | 48.41 |
|        tower        |  6.57 | 10.68 |
|      chandelier     | 69.12 | 80.54 |
|        awning       |  35.4 | 40.57 |
|     streetlight     | 33.12 |  39.7 |
|        booth        | 48.65 | 53.58 |
| television receiver | 65.96 |  72.2 |
|       airplane      | 62.67 | 68.57 |
|      dirt track     | 23.87 |  42.0 |
|       apparel       | 38.89 | 47.54 |
|         pole        | 33.49 | 48.42 |
|         land        |  0.08 |  0.09 |
|      bannister      | 18.67 | 24.58 |
|      escalator      |  42.0 | 48.47 |
|       ottoman       | 53.53 | 70.85 |
|        bottle       | 42.66 | 62.76 |
|        buffet       | 48.52 | 57.59 |
|        poster       | 22.85 | 25.56 |
|        stage        | 15.89 | 22.36 |
|         van         | 43.59 |  59.0 |
|         ship        | 19.55 |  23.1 |
|       fountain      | 31.54 | 34.17 |
|    conveyer belt    | 75.42 | 95.34 |
|        canopy       |  35.6 | 47.81 |
|        washer       | 76.77 | 78.93 |
|      plaything      | 32.61 | 47.92 |
|    swimming pool    | 83.01 | 90.06 |
|        stool        | 42.35 | 61.82 |
|        barrel       | 54.59 | 70.86 |
|        basket       | 31.66 | 40.81 |
|      waterfall      | 63.15 | 68.89 |
|         tent        | 93.91 | 98.19 |
|         bag         |  14.0 | 15.21 |
|       minibike      | 74.71 | 85.53 |
|        cradle       |  86.4 | 97.23 |
|         oven        | 49.18 | 72.18 |
|         ball        | 53.21 | 70.58 |
|         food        | 54.15 | 67.14 |
|         step        | 11.99 | 13.79 |
|         tank        | 51.86 | 52.58 |
|      trade name     | 22.41 | 24.55 |
|      microwave      | 80.41 |  84.4 |
|         pot         | 52.59 | 59.75 |
|        animal       | 64.36 | 67.53 |
|       bicycle       | 56.49 | 74.83 |
|         lake        | 51.08 |  63.9 |
|      dishwasher     | 58.83 | 63.56 |
|        screen       | 75.18 | 84.79 |
|       blanket       | 23.97 | 25.65 |
|      sculpture      | 53.12 | 87.85 |
|         hood        |  56.3 | 68.06 |
|        sconce       |  47.6 | 58.08 |
|         vase        | 45.38 | 58.91 |
|    traffic light    | 43.17 | 55.18 |
|         tray        | 17.44 | 21.61 |
|        ashcan       | 35.19 | 38.17 |
|         fan         | 62.26 | 68.44 |
|         pier        | 44.26 | 59.98 |
|      crt screen     |  0.31 |  0.68 |
|        plate        | 61.54 | 77.61 |
|       monitor       |  17.5 | 21.36 |
|    bulletin board   | 40.33 |  46.4 |
|        shower       |  5.45 | 16.28 |
|       radiator      | 54.31 | 56.77 |
|        glass        | 19.59 | 20.87 |
|        clock        | 43.96 | 49.09 |
|         flag        | 48.64 | 52.05 |
+---------------------+-------+-------+
11/15 16:58:37 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 81.7400  mIoU: 51.3200  mAcc: 62.7600  data_time: 0.0023  time: 0.7832
Finished processing corruption type: frost
Processing corruption type: fog
11/15 16:58:41 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 2113361210
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 2113361210
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 16:58:41 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='fog',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/fog'

Number of parameters:  441271084
11/15 16:58:52 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 16:58:52 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 16:58:52 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 16:58:54 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 16:59:50 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:36:13  time: 1.0050  data_time: 0.0019  memory: 24548  
11/15 17:00:37 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:32:39  time: 0.9639  data_time: 0.0020  memory: 4003  
11/15 17:01:22 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:30:22  time: 0.9253  data_time: 0.0019  memory: 3937  
11/15 17:02:10 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:29:21  time: 0.9660  data_time: 0.0018  memory: 4098  
11/15 17:02:54 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:28:00  time: 0.9302  data_time: 0.0019  memory: 4154  
11/15 17:03:40 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:27:01  time: 0.9648  data_time: 0.0019  memory: 3995  
11/15 17:04:27 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:26:08  time: 0.8827  data_time: 0.0018  memory: 3994  
11/15 17:05:12 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:25:13  time: 0.9649  data_time: 0.0018  memory: 3999  
11/15 17:05:53 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:24:03  time: 0.8835  data_time: 0.0018  memory: 3934  
11/15 17:06:39 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:23:15  time: 0.8861  data_time: 0.0018  memory: 3938  
11/15 17:07:27 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:22:32  time: 1.0043  data_time: 0.0020  memory: 3990  
11/15 17:08:13 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:21:44  time: 0.9656  data_time: 0.0021  memory: 3998  
11/15 17:08:58 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:20:54  time: 0.9257  data_time: 0.0018  memory: 4018  
11/15 17:09:47 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:20:12  time: 0.9659  data_time: 0.0020  memory: 4014  
11/15 17:10:34 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:19:26  time: 0.9633  data_time: 0.0018  memory: 4029  
11/15 17:11:16 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:18:33  time: 0.9667  data_time: 0.0020  memory: 3940  
11/15 17:12:05 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:17:49  time: 0.9655  data_time: 0.0020  memory: 3929  
11/15 17:12:46 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:16:56  time: 0.8061  data_time: 0.0032  memory: 3960  
11/15 17:13:33 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:16:11  time: 0.8906  data_time: 0.0032  memory: 3985  
11/15 17:14:16 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:15:22  time: 0.8862  data_time: 0.0019  memory: 3987  
11/15 17:15:05 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:14:38  time: 1.0053  data_time: 0.0019  memory: 4033  
11/15 17:15:52 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:13:52  time: 0.8866  data_time: 0.0019  memory: 3975  
11/15 17:16:37 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:13:05  time: 0.9259  data_time: 0.0018  memory: 3968  
11/15 17:17:24 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:12:19  time: 0.8855  data_time: 0.0018  memory: 3998  
11/15 17:18:06 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:11:31  time: 0.8839  data_time: 0.0018  memory: 3955  
11/15 17:18:47 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:10:42  time: 0.9253  data_time: 0.0019  memory: 3929  
11/15 17:19:32 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:09:56  time: 0.8434  data_time: 0.0018  memory: 3930  
11/15 17:20:17 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:09:09  time: 0.9642  data_time: 0.0018  memory: 3987  
11/15 17:20:59 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:08:22  time: 0.9678  data_time: 0.0018  memory: 3986  
11/15 17:21:44 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:07:36  time: 0.8441  data_time: 0.0018  memory: 3929  
11/15 17:22:30 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:06:51  time: 0.9299  data_time: 0.0019  memory: 3976  
11/15 17:23:16 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:06:05  time: 0.9245  data_time: 0.0019  memory: 3927  
11/15 17:23:58 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:05:19  time: 0.8043  data_time: 0.0017  memory: 4109  
11/15 17:24:46 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:04:33  time: 0.9240  data_time: 0.0020  memory: 3984  
11/15 17:25:33 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:48  time: 0.8842  data_time: 0.0018  memory: 3992  
11/15 17:26:16 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:02  time: 0.9657  data_time: 0.0020  memory: 3943  
11/15 17:27:04 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:17  time: 0.9664  data_time: 0.0020  memory: 3889  
11/15 17:27:45 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:31  time: 0.8448  data_time: 0.0018  memory: 4014  
11/15 17:28:32 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:45  time: 0.8851  data_time: 0.0018  memory: 4144  
11/15 17:29:15 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.8423  data_time: 0.0017  memory: 4022  
11/15 17:29:15 - mmengine - INFO - per class results:
11/15 17:29:15 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 81.74 | 90.57 |
|       building      | 84.68 | 93.96 |
|         sky         |  94.9 | 97.68 |
|        floor        | 84.07 | 92.37 |
|         tree        | 75.74 | 88.78 |
|       ceiling       | 87.01 | 94.52 |
|         road        | 86.07 | 91.53 |
|         bed         | 92.15 |  96.9 |
|      windowpane     | 64.37 |  79.3 |
|        grass        | 67.88 | 82.08 |
|       cabinet       | 65.13 | 78.01 |
|       sidewalk      | 71.55 | 84.06 |
|        person       |  85.4 |  94.1 |
|        earth        | 38.58 |  53.5 |
|         door        | 59.56 | 71.86 |
|        table        | 67.97 | 80.62 |
|       mountain      | 60.16 | 75.43 |
|        plant        | 52.32 | 63.71 |
|       curtain       |  77.8 | 87.32 |
|        chair        | 65.16 | 78.21 |
|         car         |  87.1 | 93.79 |
|        water        | 59.97 | 75.81 |
|       painting      | 76.89 | 90.87 |
|         sofa        |  79.1 | 88.99 |
|        shelf        | 47.09 | 62.45 |
|        house        | 52.44 | 64.34 |
|         sea         |  64.6 | 85.75 |
|        mirror       | 74.76 | 82.73 |
|         rug         | 61.13 |  70.5 |
|        field        | 32.63 | 42.37 |
|       armchair      | 56.36 | 73.92 |
|         seat        | 66.78 | 86.11 |
|        fence        | 50.11 | 64.49 |
|         desk        | 57.36 | 74.25 |
|         rock        | 52.59 | 82.44 |
|       wardrobe      | 54.29 | 67.82 |
|         lamp        | 70.72 | 82.52 |
|       bathtub       | 83.35 | 87.63 |
|       railing       | 39.36 |  52.9 |
|       cushion       | 67.69 | 79.07 |
|         base        | 45.65 | 55.76 |
|         box         | 36.64 |  46.7 |
|        column       | 54.96 | 65.82 |
|      signboard      | 41.56 | 55.61 |
|   chest of drawers  | 39.69 | 55.65 |
|       counter       | 47.74 | 57.78 |
|         sand        | 53.41 | 80.48 |
|         sink        | 80.95 | 87.09 |
|      skyscraper     | 46.71 | 59.16 |
|      fireplace      | 82.55 | 92.08 |
|     refrigerator    | 76.49 | 82.21 |
|      grandstand     | 50.76 | 87.67 |
|         path        | 29.12 | 38.48 |
|        stairs       |  27.4 | 33.58 |
|        runway       | 70.31 | 93.64 |
|         case        | 56.66 | 82.46 |
|      pool table     | 95.25 |  98.1 |
|        pillow       | 66.93 | 79.27 |
|     screen door     | 78.15 | 87.67 |
|       stairway      | 34.79 | 47.65 |
|        river        | 11.37 | 20.69 |
|        bridge       | 60.33 | 74.72 |
|       bookcase      | 50.55 | 72.77 |
|        blind        | 42.03 | 46.26 |
|     coffee table    | 65.07 | 83.74 |
|        toilet       |  88.9 | 93.15 |
|        flower       | 43.18 |  59.0 |
|         book        | 53.32 | 72.28 |
|         hill        | 15.89 | 20.81 |
|        bench        | 58.42 | 67.24 |
|      countertop     | 62.68 | 83.97 |
|        stove        | 82.34 | 86.75 |
|         palm        | 57.03 | 82.04 |
|    kitchen island   | 41.57 | 74.87 |
|       computer      | 79.91 | 90.57 |
|     swivel chair    | 47.09 | 66.41 |
|         boat        | 74.08 | 84.47 |
|         bar         | 54.12 | 61.84 |
|    arcade machine   | 86.63 | 89.15 |
|        hovel        | 15.09 | 15.46 |
|         bus         | 92.86 | 97.34 |
|        towel        | 71.24 | 83.47 |
|        light        | 57.46 | 65.92 |
|        truck        | 40.83 | 53.34 |
|        tower        | 12.98 | 20.77 |
|      chandelier     | 66.33 | 77.43 |
|        awning       | 40.68 | 48.16 |
|     streetlight     | 34.86 | 45.94 |
|        booth        |  54.7 | 57.46 |
| television receiver | 76.88 | 87.69 |
|       airplane      |  68.3 | 75.99 |
|      dirt track     | 18.43 | 47.35 |
|       apparel       | 46.64 | 63.57 |
|         pole        | 31.78 | 43.25 |
|         land        |  0.06 |  0.09 |
|      bannister      | 18.69 | 26.51 |
|      escalator      | 55.26 | 71.29 |
|       ottoman       | 56.23 | 75.08 |
|        bottle       | 43.46 | 65.15 |
|        buffet       | 55.84 | 62.39 |
|        poster       | 29.43 | 35.51 |
|        stage        | 20.68 | 29.02 |
|         van         | 43.61 | 61.33 |
|         ship        | 42.63 | 45.52 |
|       fountain      | 32.56 | 32.94 |
|    conveyer belt    | 84.69 |  96.2 |
|        canopy       | 36.98 | 49.48 |
|        washer       | 88.22 | 92.74 |
|      plaything      | 47.01 | 69.65 |
|    swimming pool    | 64.67 | 89.16 |
|        stool        | 50.07 | 65.49 |
|        barrel       | 29.06 | 73.97 |
|        basket       | 37.72 | 47.17 |
|      waterfall      | 52.27 | 59.73 |
|         tent        | 86.43 | 99.03 |
|         bag         | 16.77 | 18.99 |
|       minibike      | 74.68 | 87.06 |
|        cradle       | 85.18 | 97.98 |
|         oven        | 40.06 | 76.34 |
|         ball        | 61.47 | 72.57 |
|         food        | 53.98 | 64.39 |
|         step        |  9.7  | 11.68 |
|         tank        | 63.77 | 66.81 |
|      trade name     | 20.24 | 22.88 |
|      microwave      | 68.23 | 73.15 |
|         pot         | 55.24 | 63.12 |
|        animal       | 67.75 | 69.67 |
|       bicycle       | 59.99 |  77.8 |
|         lake        | 53.24 | 63.82 |
|      dishwasher     | 74.23 | 83.61 |
|        screen       | 69.53 | 88.41 |
|       blanket       | 26.84 | 30.62 |
|      sculpture      |  77.4 | 88.74 |
|         hood        | 60.26 | 72.52 |
|        sconce       | 53.99 | 64.88 |
|         vase        | 44.81 | 64.32 |
|    traffic light    | 41.13 | 61.75 |
|         tray        | 20.02 | 27.22 |
|        ashcan       | 43.92 | 56.24 |
|         fan         | 70.66 | 81.72 |
|         pier        | 37.73 | 52.11 |
|      crt screen     |  7.71 | 20.23 |
|        plate        | 62.07 | 80.19 |
|       monitor       |  3.75 |  4.58 |
|    bulletin board   | 45.32 | 53.55 |
|        shower       | 16.93 | 19.92 |
|       radiator      | 62.81 | 72.19 |
|        glass        | 22.03 | 23.33 |
|        clock        | 54.52 | 66.95 |
|         flag        | 56.94 | 61.19 |
+---------------------+-------+-------+
11/15 17:29:15 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 85.6300  mIoU: 55.1600  mAcc: 67.1500  data_time: 0.0023  time: 0.9104
Finished processing corruption type: fog
Processing corruption type: brightness
11/15 17:29:19 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 652668058
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 652668058
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 17:29:19 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='brightness',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/brightness'

Number of parameters:  441271084
11/15 17:29:30 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 17:29:30 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 17:29:30 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 17:29:32 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 17:30:34 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:40:25  time: 1.1499  data_time: 0.0019  memory: 24548  
11/15 17:31:28 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:36:43  time: 1.1026  data_time: 0.0020  memory: 4003  
11/15 17:32:19 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:34:18  time: 1.0595  data_time: 0.0019  memory: 3937  
11/15 17:33:13 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:33:12  time: 1.0949  data_time: 0.0019  memory: 4098  
11/15 17:34:04 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:31:40  time: 1.0441  data_time: 0.0019  memory: 4154  
11/15 17:34:55 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:30:31  time: 1.0986  data_time: 0.0020  memory: 3995  
11/15 17:35:48 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:29:31  time: 0.9944  data_time: 0.0019  memory: 3994  
11/15 17:36:40 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:28:31  time: 1.0948  data_time: 0.0019  memory: 3999  
11/15 17:37:25 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:27:10  time: 0.9833  data_time: 0.0018  memory: 3934  
11/15 17:38:17 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:26:15  time: 0.9989  data_time: 0.0018  memory: 3938  
11/15 17:39:12 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:25:28  time: 1.1398  data_time: 0.0020  memory: 3990  
11/15 17:40:04 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:24:33  time: 1.0982  data_time: 0.0020  memory: 3998  
11/15 17:40:55 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:23:37  time: 1.0497  data_time: 0.0018  memory: 4018  
11/15 17:41:50 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:22:51  time: 1.0975  data_time: 0.0024  memory: 4014  
11/15 17:42:44 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:21:59  time: 1.0775  data_time: 0.0019  memory: 4029  
11/15 17:43:31 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:20:59  time: 1.0907  data_time: 0.0020  memory: 3940  
11/15 17:44:26 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:20:09  time: 1.0952  data_time: 0.0020  memory: 3929  
11/15 17:45:12 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:19:09  time: 0.8955  data_time: 0.0018  memory: 3960  
11/15 17:46:05 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:18:17  time: 1.0021  data_time: 0.0019  memory: 3985  
11/15 17:46:54 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:17:22  time: 0.9963  data_time: 0.0018  memory: 3987  
11/15 17:47:49 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:16:32  time: 1.1350  data_time: 0.0019  memory: 4033  
11/15 17:48:42 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:15:41  time: 1.0006  data_time: 0.0019  memory: 3975  
11/15 17:49:33 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:14:47  time: 1.0455  data_time: 0.0019  memory: 3968  
11/15 17:50:26 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:13:55  time: 0.9991  data_time: 0.0019  memory: 3998  
11/15 17:51:14 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:13:00  time: 0.9947  data_time: 0.0019  memory: 3955  
11/15 17:52:00 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:12:05  time: 1.0487  data_time: 0.0019  memory: 3929  
11/15 17:52:51 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:11:13  time: 0.9430  data_time: 0.0019  memory: 3930  
11/15 17:53:42 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:10:21  time: 1.0981  data_time: 0.0019  memory: 3987  
11/15 17:54:29 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:09:27  time: 1.0941  data_time: 0.0019  memory: 3986  
11/15 17:55:20 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:08:35  time: 0.9471  data_time: 0.0019  memory: 3929  
11/15 17:56:13 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:07:44  time: 1.0523  data_time: 0.0019  memory: 3976  
11/15 17:57:03 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:06:52  time: 1.0399  data_time: 0.0020  memory: 3927  
11/15 17:57:52 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:06:00  time: 0.9033  data_time: 0.0017  memory: 4109  
11/15 17:58:45 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:05:09  time: 1.0475  data_time: 0.0020  memory: 3984  
11/15 17:59:39 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:04:18  time: 1.0019  data_time: 0.0018  memory: 3992  
11/15 18:00:27 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:03:26  time: 1.0923  data_time: 0.0020  memory: 3943  
11/15 18:01:22 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:02:34  time: 1.0920  data_time: 0.0020  memory: 3889  
11/15 18:02:08 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:42  time: 0.9598  data_time: 0.0019  memory: 4014  
11/15 18:03:01 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:51  time: 0.9929  data_time: 0.0018  memory: 4144  
11/15 18:03:49 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.9443  data_time: 0.0018  memory: 4022  
11/15 18:03:49 - mmengine - INFO - per class results:
11/15 18:03:49 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 82.11 | 90.62 |
|       building      | 84.82 | 93.64 |
|         sky         | 94.72 | 97.76 |
|        floor        |  84.5 | 92.68 |
|         tree        | 76.76 | 88.51 |
|       ceiling       | 87.13 |  94.6 |
|         road        | 86.13 | 91.34 |
|         bed         | 92.04 | 96.87 |
|      windowpane     | 65.28 | 80.37 |
|        grass        |  69.0 | 83.61 |
|       cabinet       | 64.64 | 76.65 |
|       sidewalk      | 71.63 | 84.67 |
|        person       | 85.72 | 94.48 |
|        earth        | 39.86 | 53.42 |
|         door        | 59.12 | 71.88 |
|        table        | 68.38 | 80.82 |
|       mountain      | 60.71 | 75.55 |
|        plant        |  52.5 | 64.35 |
|       curtain       | 78.96 | 88.62 |
|        chair        | 65.96 | 78.22 |
|         car         | 86.84 | 94.03 |
|        water        |  60.7 | 74.55 |
|       painting      | 77.61 | 90.45 |
|         sofa        | 80.87 | 90.43 |
|        shelf        | 46.22 | 61.63 |
|        house        | 55.86 | 71.67 |
|         sea         | 67.46 | 84.37 |
|        mirror       | 75.33 | 83.43 |
|         rug         |  63.9 | 73.75 |
|        field        | 34.88 | 46.45 |
|       armchair      | 59.64 | 77.68 |
|         seat        | 66.53 | 86.76 |
|        fence        | 49.66 | 64.13 |
|         desk        | 59.53 | 76.61 |
|         rock        | 53.24 | 82.82 |
|       wardrobe      | 52.24 | 66.38 |
|         lamp        | 72.29 |  83.0 |
|       bathtub       | 87.47 | 92.15 |
|       railing       | 40.53 | 54.62 |
|       cushion       | 68.31 | 78.59 |
|         base        | 46.98 | 57.49 |
|         box         | 36.77 | 47.12 |
|        column       | 52.56 | 64.38 |
|      signboard      | 42.34 | 56.88 |
|   chest of drawers  | 39.56 | 58.44 |
|       counter       | 49.35 | 59.29 |
|         sand        | 54.97 | 81.74 |
|         sink        | 79.14 | 87.65 |
|      skyscraper     | 45.85 | 57.78 |
|      fireplace      | 80.69 | 91.44 |
|     refrigerator    | 78.43 | 84.42 |
|      grandstand     | 51.84 |  86.7 |
|         path        |  33.9 | 45.26 |
|        stairs       | 27.73 | 34.55 |
|        runway       | 71.78 | 95.36 |
|         case        |  56.9 | 82.28 |
|      pool table     | 95.37 |  98.0 |
|        pillow       | 66.46 | 77.69 |
|     screen door     | 81.14 | 85.36 |
|       stairway      | 40.55 | 54.63 |
|        river        | 11.31 | 26.98 |
|        bridge       | 62.89 | 74.96 |
|       bookcase      | 47.08 | 67.62 |
|        blind        | 46.31 | 50.01 |
|     coffee table    | 64.38 | 83.73 |
|        toilet       | 89.12 | 93.36 |
|        flower       | 44.56 | 62.77 |
|         book        | 52.69 | 73.26 |
|         hill        | 14.72 | 20.75 |
|        bench        | 59.62 | 68.74 |
|      countertop     | 61.97 | 84.24 |
|        stove        | 83.38 | 88.09 |
|         palm        | 55.64 | 82.18 |
|    kitchen island   | 43.75 | 75.51 |
|       computer      | 80.25 | 90.97 |
|     swivel chair    | 48.51 |  67.9 |
|         boat        |  49.6 | 59.55 |
|         bar         | 64.87 | 74.07 |
|    arcade machine   | 87.24 | 90.22 |
|        hovel        | 20.62 | 21.45 |
|         bus         |  92.8 | 97.27 |
|        towel        |  75.3 | 84.46 |
|        light        | 61.49 | 70.97 |
|        truck        | 42.99 | 54.68 |
|        tower        | 12.51 | 20.14 |
|      chandelier     | 71.81 | 82.81 |
|        awning       | 35.34 | 42.45 |
|     streetlight     | 34.84 | 46.18 |
|        booth        | 54.99 | 60.17 |
| television receiver | 73.61 | 84.11 |
|       airplane      | 66.13 | 78.16 |
|      dirt track     |  22.7 | 50.16 |
|       apparel       |  55.1 | 70.42 |
|         pole        | 31.92 | 44.84 |
|         land        |  1.99 |  2.92 |
|      bannister      | 19.38 | 26.93 |
|      escalator      | 50.87 | 64.88 |
|       ottoman       | 54.06 | 75.29 |
|        bottle       | 43.09 | 66.05 |
|        buffet       | 59.07 | 69.78 |
|        poster       | 31.18 | 36.57 |
|        stage        | 17.98 | 25.69 |
|         van         | 46.34 | 60.58 |
|         ship        | 39.32 | 54.51 |
|       fountain      |  35.8 | 36.39 |
|    conveyer belt    | 82.59 | 96.64 |
|        canopy       |  45.1 | 62.74 |
|        washer       | 88.37 | 92.95 |
|      plaything      | 44.34 |  67.1 |
|    swimming pool    | 77.29 | 89.36 |
|        stool        | 51.85 | 67.32 |
|        barrel       | 36.36 | 85.71 |
|        basket       | 41.07 | 51.23 |
|      waterfall      |  61.4 | 69.45 |
|         tent        | 92.75 | 98.86 |
|         bag         |  16.8 | 19.19 |
|       minibike      | 74.73 | 88.09 |
|        cradle       |  84.9 |  98.0 |
|         oven        | 46.07 | 80.83 |
|         ball        | 59.88 | 69.67 |
|         food        | 55.71 | 67.56 |
|         step        |  10.2 | 11.86 |
|         tank        | 63.59 |  66.9 |
|      trade name     | 21.92 | 25.02 |
|      microwave      | 73.99 | 78.73 |
|         pot         | 56.11 | 63.82 |
|        animal       | 66.22 | 68.34 |
|       bicycle       | 60.78 | 78.04 |
|         lake        | 55.87 | 63.84 |
|      dishwasher     | 74.24 | 80.63 |
|        screen       | 69.55 | 89.41 |
|       blanket       | 27.63 | 31.62 |
|      sculpture      | 76.43 | 88.98 |
|         hood        | 60.62 | 73.84 |
|        sconce       | 54.86 | 66.84 |
|         vase        | 46.07 | 64.27 |
|    traffic light    | 45.16 | 62.93 |
|         tray        | 20.46 | 26.49 |
|        ashcan       | 45.16 | 58.51 |
|         fan         | 72.55 | 83.12 |
|         pier        | 37.57 | 50.48 |
|      crt screen     |  3.36 |  8.59 |
|        plate        | 62.13 | 80.26 |
|       monitor       |  4.37 |  5.28 |
|    bulletin board   | 44.23 | 50.63 |
|        shower       | 17.74 | 20.24 |
|       radiator      |  64.3 | 74.91 |
|        glass        | 22.52 | 23.96 |
|        clock        | 54.62 | 65.43 |
|         flag        | 59.85 | 64.95 |
+---------------------+-------+-------+
11/15 18:03:49 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 85.9100  mIoU: 56.0800  mAcc: 68.0900  data_time: 0.0022  time: 1.0286
Finished processing corruption type: brightness
Processing corruption type: contrast
11/15 18:03:54 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 151287497
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 151287497
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 18:03:55 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='contrast',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/contrast'

Number of parameters:  441271084
11/15 18:04:05 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 18:04:05 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 18:04:06 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 18:04:08 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 18:04:57 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:32:06  time: 0.8844  data_time: 0.0019  memory: 24548  
11/15 18:05:39 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:28:42  time: 0.8445  data_time: 0.0020  memory: 4003  
11/15 18:06:17 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:26:32  time: 0.8019  data_time: 0.0019  memory: 3937  
11/15 18:06:59 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:25:37  time: 0.8378  data_time: 0.0018  memory: 4098  
11/15 18:07:37 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:24:21  time: 0.7999  data_time: 0.0021  memory: 4154  
11/15 18:08:16 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:27  time: 0.8435  data_time: 0.0019  memory: 3995  
11/15 18:08:57 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:41  time: 0.7594  data_time: 0.0018  memory: 3994  
11/15 18:09:36 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:53  time: 0.8387  data_time: 0.0018  memory: 3999  
11/15 18:10:11 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:20:49  time: 0.7562  data_time: 0.0018  memory: 3934  
11/15 18:10:50 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:20:06  time: 0.7593  data_time: 0.0018  memory: 3938  
11/15 18:11:32 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:19:30  time: 0.8808  data_time: 0.0019  memory: 3990  
11/15 18:12:12 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:18:48  time: 0.8431  data_time: 0.0020  memory: 3998  
11/15 18:12:50 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:18:05  time: 0.8005  data_time: 0.0018  memory: 4018  
11/15 18:13:33 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:17:29  time: 0.8420  data_time: 0.0020  memory: 4014  
11/15 18:14:14 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:16:50  time: 0.8365  data_time: 0.0018  memory: 4029  
11/15 18:14:50 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:16:03  time: 0.8404  data_time: 0.0020  memory: 3940  
11/15 18:15:32 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:15:25  time: 0.8424  data_time: 0.0020  memory: 3929  
11/15 18:16:07 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:14:38  time: 0.6790  data_time: 0.0018  memory: 3960  
11/15 18:16:47 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:13:59  time: 0.7615  data_time: 0.0019  memory: 3985  
11/15 18:17:25 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:13:16  time: 0.7605  data_time: 0.0019  memory: 3987  
11/15 18:18:07 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:12:39  time: 0.8811  data_time: 0.0019  memory: 4033  
11/15 18:18:48 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:11:59  time: 0.7619  data_time: 0.0020  memory: 3975  
11/15 18:19:27 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:11:19  time: 0.8012  data_time: 0.0018  memory: 3968  
11/15 18:20:07 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:10:39  time: 0.7603  data_time: 0.0018  memory: 3998  
11/15 18:20:43 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:09:57  time: 0.7583  data_time: 0.0019  memory: 3955  
11/15 18:21:18 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:09:14  time: 0.8006  data_time: 0.0018  memory: 3929  
11/15 18:21:57 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:08:34  time: 0.7183  data_time: 0.0019  memory: 3930  
11/15 18:22:35 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:07:54  time: 0.8414  data_time: 0.0019  memory: 3987  
11/15 18:23:11 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:07:13  time: 0.8403  data_time: 0.0018  memory: 3986  
11/15 18:23:50 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:06:33  time: 0.7169  data_time: 0.0019  memory: 3929  
11/15 18:24:30 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:05:54  time: 0.8013  data_time: 0.0018  memory: 3976  
11/15 18:25:09 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:15  time: 0.7995  data_time: 0.0020  memory: 3927  
11/15 18:25:45 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:04:35  time: 0.6761  data_time: 0.0018  memory: 4109  
11/15 18:26:26 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:56  time: 0.8002  data_time: 0.0020  memory: 3984  
11/15 18:27:07 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:16  time: 0.7579  data_time: 0.0019  memory: 3992  
11/15 18:27:44 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:37  time: 0.8399  data_time: 0.0020  memory: 3943  
11/15 18:28:26 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:58  time: 0.8407  data_time: 0.0021  memory: 3889  
11/15 18:29:01 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:18  time: 0.7188  data_time: 0.0019  memory: 4014  
11/15 18:29:41 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:39  time: 0.7589  data_time: 0.0018  memory: 4144  
11/15 18:30:18 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7153  data_time: 0.0017  memory: 4022  
11/15 18:30:18 - mmengine - INFO - per class results:
11/15 18:30:18 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 81.98 | 90.58 |
|       building      | 85.15 | 93.53 |
|         sky         | 94.85 | 97.65 |
|        floor        | 84.43 | 92.67 |
|         tree        | 76.95 | 89.24 |
|       ceiling       | 87.17 | 94.49 |
|         road        | 85.79 | 91.24 |
|         bed         | 92.09 | 97.08 |
|      windowpane     | 65.25 | 80.03 |
|        grass        | 68.21 | 83.23 |
|       cabinet       | 65.88 | 78.64 |
|       sidewalk      | 70.06 | 84.05 |
|        person       | 85.66 | 94.06 |
|        earth        | 39.29 | 53.11 |
|         door        | 58.97 | 71.99 |
|        table        | 67.57 | 80.16 |
|       mountain      | 60.41 | 74.27 |
|        plant        |  52.7 | 64.26 |
|       curtain       | 78.64 | 88.23 |
|        chair        | 65.58 | 78.28 |
|         car         | 87.03 | 93.83 |
|        water        | 61.98 | 76.11 |
|       painting      |  76.7 | 90.94 |
|         sofa        | 80.71 | 89.11 |
|        shelf        |  45.9 | 60.25 |
|        house        | 57.48 | 75.41 |
|         sea         |  67.9 | 84.47 |
|        mirror       | 74.85 | 82.02 |
|         rug         | 62.45 |  71.3 |
|        field        |  35.6 | 50.05 |
|       armchair      | 58.67 | 77.39 |
|         seat        | 66.46 | 86.64 |
|        fence        | 49.25 | 62.11 |
|         desk        | 59.48 | 76.14 |
|         rock        | 54.99 | 84.23 |
|       wardrobe      | 55.57 | 68.19 |
|         lamp        | 71.78 | 82.68 |
|       bathtub       | 83.33 | 88.01 |
|       railing       | 39.33 | 52.85 |
|       cushion       | 67.36 | 78.28 |
|         base        | 47.65 | 59.69 |
|         box         | 37.18 | 46.58 |
|        column       | 53.51 |  64.9 |
|      signboard      | 41.72 |  56.2 |
|   chest of drawers  | 42.49 | 57.09 |
|       counter       | 46.25 | 55.95 |
|         sand        | 57.29 | 78.61 |
|         sink        | 81.02 | 87.43 |
|      skyscraper     |  51.0 |  65.3 |
|      fireplace      | 81.45 | 91.39 |
|     refrigerator    | 76.48 | 81.63 |
|      grandstand     |  51.2 | 87.37 |
|         path        | 30.32 |  42.0 |
|        stairs       | 28.81 | 35.28 |
|        runway       | 71.68 | 95.43 |
|         case        | 55.02 | 83.48 |
|      pool table     |  95.4 |  98.1 |
|        pillow       | 64.53 | 75.26 |
|     screen door     | 79.67 |  86.8 |
|       stairway      | 40.56 |  52.9 |
|        river        | 12.86 | 30.15 |
|        bridge       |  57.4 | 73.48 |
|       bookcase      | 47.68 | 69.01 |
|        blind        |  46.8 | 51.57 |
|     coffee table    |  64.8 | 84.75 |
|        toilet       | 89.09 |  93.5 |
|        flower       | 44.71 | 60.93 |
|         book        | 51.27 | 73.19 |
|         hill        | 14.83 |  21.8 |
|        bench        |  59.3 | 68.93 |
|      countertop     | 59.81 | 83.45 |
|        stove        | 82.96 | 87.16 |
|         palm        | 60.61 | 81.15 |
|    kitchen island   | 43.97 | 75.36 |
|       computer      | 79.96 | 90.39 |
|     swivel chair    | 48.08 | 66.37 |
|         boat        | 44.22 | 53.85 |
|         bar         | 61.45 | 72.24 |
|    arcade machine   | 84.54 | 86.55 |
|        hovel        | 30.73 | 32.66 |
|         bus         | 92.71 | 97.33 |
|        towel        | 73.64 | 84.76 |
|        light        | 60.86 | 70.11 |
|        truck        | 42.18 | 54.73 |
|        tower        | 13.81 | 22.19 |
|      chandelier     | 70.67 | 82.63 |
|        awning       | 40.83 | 49.06 |
|     streetlight     | 35.17 | 47.66 |
|        booth        | 59.44 | 63.56 |
| television receiver |  73.7 | 84.43 |
|       airplane      | 71.87 | 77.54 |
|      dirt track     | 17.07 | 46.32 |
|       apparel       | 52.58 | 68.55 |
|         pole        | 31.23 | 42.15 |
|         land        |  1.68 |  2.24 |
|      bannister      | 18.17 | 26.09 |
|      escalator      | 59.36 | 76.96 |
|       ottoman       | 54.82 | 76.89 |
|        bottle       | 43.38 | 69.31 |
|        buffet       | 59.22 |  68.6 |
|        poster       | 28.65 | 33.85 |
|        stage        | 15.71 | 22.02 |
|         van         | 44.91 | 61.51 |
|         ship        | 39.05 | 57.11 |
|       fountain      | 37.85 | 38.36 |
|    conveyer belt    | 82.27 | 96.19 |
|        canopy       | 44.68 | 61.89 |
|        washer       | 86.76 | 91.56 |
|      plaything      | 45.45 | 68.87 |
|    swimming pool    | 68.84 | 89.59 |
|        stool        | 52.18 |  67.3 |
|        barrel       | 33.59 | 85.21 |
|        basket       | 40.15 | 49.38 |
|      waterfall      | 57.73 | 63.97 |
|         tent        | 92.74 | 98.99 |
|         bag         | 16.06 | 18.04 |
|       minibike      | 75.47 |  88.1 |
|        cradle       | 84.94 | 98.06 |
|         oven        | 41.54 | 75.16 |
|         ball        | 61.64 | 73.17 |
|         food        | 55.25 |  66.7 |
|         step        |  8.75 | 10.14 |
|         tank        |  63.9 | 66.66 |
|      trade name     | 22.26 | 25.36 |
|      microwave      | 73.21 | 77.89 |
|         pot         | 56.51 | 63.94 |
|        animal       | 65.44 |  67.2 |
|       bicycle       | 60.34 |  76.8 |
|         lake        | 55.65 | 63.95 |
|      dishwasher     | 75.34 | 80.11 |
|        screen       | 71.63 |  87.8 |
|       blanket       | 27.42 | 31.57 |
|      sculpture      | 77.24 | 88.08 |
|         hood        | 60.43 | 73.21 |
|        sconce       | 55.61 | 66.17 |
|         vase        | 46.62 | 63.99 |
|    traffic light    | 43.88 | 62.53 |
|         tray        |  20.0 | 24.99 |
|        ashcan       | 44.52 |  56.8 |
|         fan         | 72.05 | 81.85 |
|         pier        | 38.08 | 51.36 |
|      crt screen     |  0.98 |  2.47 |
|        plate        | 62.84 | 79.98 |
|       monitor       |  3.15 |  3.68 |
|    bulletin board   | 44.79 | 53.83 |
|        shower       | 15.46 |  20.2 |
|       radiator      | 64.66 | 75.49 |
|        glass        | 22.49 | 23.77 |
|        clock        | 54.17 | 66.33 |
|         flag        | 56.04 | 60.69 |
+---------------------+-------+-------+
11/15 18:30:18 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 85.8800  mIoU: 55.8900  mAcc: 67.9200  data_time: 0.0023  time: 0.7848
Finished processing corruption type: contrast
Processing corruption type: elastic_transform
11/15 18:30:22 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 819372468
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 819372468
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 18:30:22 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='elastic_transform',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/elastic_transform'

Number of parameters:  441271084
11/15 18:30:32 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 18:30:32 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 18:30:33 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 18:30:35 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 18:32:51 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:28:44  time: 2.7121  data_time: 0.0019  memory: 24548  
11/15 18:34:58 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 1:23:18  time: 2.6187  data_time: 0.0020  memory: 4003  
11/15 18:37:02 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 1:19:32  time: 2.5543  data_time: 0.0019  memory: 3937  
11/15 18:39:10 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 1:17:18  time: 2.5361  data_time: 0.0019  memory: 4098  
11/15 18:41:10 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 1:14:09  time: 2.4647  data_time: 0.0018  memory: 4154  
11/15 18:43:12 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 1:11:31  time: 2.5736  data_time: 0.0020  memory: 3995  
11/15 18:45:16 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 1:09:15  time: 2.3584  data_time: 0.0019  memory: 3994  
11/15 18:47:19 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 1:06:58  time: 2.5565  data_time: 0.0019  memory: 3999  
11/15 18:49:10 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 1:04:01  time: 2.3054  data_time: 0.0019  memory: 3934  
11/15 18:51:13 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 1:01:54  time: 2.3805  data_time: 0.0018  memory: 3938  
11/15 18:53:23 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 1:00:07  time: 2.6454  data_time: 0.0019  memory: 3990  
11/15 18:55:25 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:57:58  time: 2.5728  data_time: 0.0020  memory: 3998  
11/15 18:57:27 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:55:48  time: 2.4828  data_time: 0.0018  memory: 4018  
11/15 18:59:38 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:53:56  time: 2.5765  data_time: 0.0020  memory: 4014  
11/15 19:01:43 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:51:54  time: 2.4774  data_time: 0.0018  memory: 4029  
11/15 19:03:38 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:49:35  time: 2.5211  data_time: 0.0021  memory: 3940  
11/15 19:05:45 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:47:34  time: 2.5424  data_time: 0.0020  memory: 3929  
11/15 19:07:37 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:45:16  time: 2.1793  data_time: 0.0018  memory: 3960  
11/15 19:09:43 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:43:15  time: 2.4082  data_time: 0.0019  memory: 3985  
11/15 19:11:41 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:41:06  time: 2.3679  data_time: 0.0019  memory: 3987  
11/15 19:13:49 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:39:07  time: 2.6264  data_time: 0.0019  memory: 4033  
11/15 19:15:54 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:37:04  time: 2.4107  data_time: 0.0019  memory: 3975  
11/15 19:17:55 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:34:59  time: 2.4838  data_time: 0.0019  memory: 3968  
11/15 19:20:00 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:32:57  time: 2.3970  data_time: 0.0019  memory: 3998  
11/15 19:21:57 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:30:49  time: 2.3830  data_time: 0.0018  memory: 3955  
11/15 19:23:51 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:28:41  time: 2.4814  data_time: 0.0018  memory: 3929  
11/15 19:25:52 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:26:37  time: 2.2677  data_time: 0.0018  memory: 3930  
11/15 19:27:54 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:24:33  time: 2.5922  data_time: 0.0018  memory: 3987  
11/15 19:29:49 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:22:28  time: 2.5732  data_time: 0.0018  memory: 3986  
11/15 19:31:49 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:20:24  time: 2.2803  data_time: 0.0019  memory: 3929  
11/15 19:33:57 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:18:23  time: 2.5102  data_time: 0.0018  memory: 3976  
11/15 19:36:14 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:16:24  time: 2.4488  data_time: 0.0020  memory: 3927  
11/15 19:38:12 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:14:20  time: 2.2190  data_time: 0.0018  memory: 4109  
11/15 19:40:18 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:12:18  time: 2.4768  data_time: 0.0020  memory: 3984  
11/15 19:42:24 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:10:15  time: 2.4194  data_time: 0.0018  memory: 3992  
11/15 19:44:21 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:08:11  time: 2.5410  data_time: 0.0020  memory: 3943  
11/15 19:46:26 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:06:09  time: 2.5185  data_time: 0.0020  memory: 3889  
11/15 19:48:20 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:04:05  time: 2.3451  data_time: 0.0019  memory: 4014  
11/15 19:50:24 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:02:02  time: 2.3775  data_time: 0.0018  memory: 4144  
11/15 19:52:21 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 2.2295  data_time: 0.0017  memory: 4022  
11/15 19:52:21 - mmengine - INFO - per class results:
11/15 19:52:22 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        |  69.1 | 81.45 |
|       building      | 77.27 | 89.21 |
|         sky         | 86.69 | 93.22 |
|        floor        | 73.32 | 85.15 |
|         tree        |  66.8 | 81.92 |
|       ceiling       | 74.87 | 87.16 |
|         road        |  78.7 | 87.49 |
|         bed         | 81.56 | 90.94 |
|      windowpane     | 55.44 | 72.01 |
|        grass        | 61.58 | 78.77 |
|       cabinet       | 55.96 |  70.2 |
|       sidewalk      | 58.16 | 73.47 |
|        person       | 66.62 | 81.57 |
|        earth        | 36.98 | 50.05 |
|         door        | 47.36 |  61.7 |
|        table        | 51.89 |  68.7 |
|       mountain      | 54.67 | 69.57 |
|        plant        | 44.89 | 58.78 |
|       curtain       |  60.8 | 77.19 |
|        chair        | 48.34 |  64.8 |
|         car         | 66.51 | 80.68 |
|        water        | 58.05 | 73.44 |
|       painting      | 55.96 | 73.95 |
|         sofa        | 64.71 | 79.42 |
|        shelf        | 40.09 | 55.92 |
|        house        | 49.45 | 64.92 |
|         sea         | 65.27 | 82.18 |
|        mirror       | 63.96 | 77.37 |
|         rug         | 54.67 | 67.38 |
|        field        |  31.7 | 42.29 |
|       armchair      | 46.77 | 65.97 |
|         seat        | 60.56 | 83.36 |
|        fence        | 42.09 | 60.58 |
|         desk        | 47.94 | 66.91 |
|         rock        | 46.92 |  76.0 |
|       wardrobe      | 45.53 | 60.22 |
|         lamp        | 39.29 | 56.84 |
|       bathtub       | 73.07 | 82.07 |
|       railing       | 33.31 | 48.21 |
|       cushion       |  48.1 | 63.52 |
|         base        | 39.78 |  52.9 |
|         box         | 28.83 | 40.34 |
|        column       | 36.75 | 51.83 |
|      signboard      | 26.52 | 41.73 |
|   chest of drawers  | 38.31 | 51.92 |
|       counter       | 40.55 |  52.9 |
|         sand        | 53.77 | 79.06 |
|         sink        |  58.8 | 71.54 |
|      skyscraper     | 45.42 | 59.47 |
|      fireplace      | 68.17 | 82.32 |
|     refrigerator    |  67.3 | 76.21 |
|      grandstand     | 45.46 | 84.57 |
|         path        | 25.14 | 36.79 |
|        stairs       | 23.88 | 30.48 |
|        runway       | 62.89 | 84.73 |
|         case        | 56.79 | 79.67 |
|      pool table     | 80.53 | 90.95 |
|        pillow       | 50.53 | 64.97 |
|     screen door     |  70.0 | 82.07 |
|       stairway      | 33.73 | 46.72 |
|        river        |  9.37 | 22.15 |
|        bridge       | 49.12 | 63.53 |
|       bookcase      | 38.41 | 60.72 |
|        blind        | 43.43 | 49.37 |
|     coffee table    | 52.64 |  73.1 |
|        toilet       | 60.47 | 74.52 |
|        flower       | 32.33 | 49.69 |
|         book        | 38.08 | 58.95 |
|         hill        |  8.18 | 12.34 |
|        bench        | 47.52 | 58.26 |
|      countertop     | 45.67 | 70.29 |
|        stove        | 70.56 | 80.07 |
|         palm        | 44.33 | 68.94 |
|    kitchen island   | 34.01 |  61.5 |
|       computer      | 66.85 | 83.74 |
|     swivel chair    | 38.71 |  56.7 |
|         boat        | 50.77 | 72.35 |
|         bar         | 59.94 | 71.82 |
|    arcade machine   | 74.13 | 84.56 |
|        hovel        |  11.5 |  12.2 |
|         bus         |  80.6 | 91.11 |
|        towel        | 44.93 | 61.03 |
|        light        | 21.18 | 32.48 |
|        truck        | 30.05 | 44.09 |
|        tower        | 13.25 | 22.24 |
|      chandelier     | 47.56 | 65.65 |
|        awning       | 27.73 | 36.35 |
|     streetlight     | 10.77 | 17.45 |
|        booth        | 44.07 | 49.01 |
| television receiver | 51.74 | 67.34 |
|       airplane      | 43.65 | 55.97 |
|      dirt track     |  9.22 | 28.36 |
|       apparel       | 40.09 | 59.04 |
|         pole        | 13.86 | 22.41 |
|         land        |  0.88 |  1.38 |
|      bannister      | 13.06 | 18.83 |
|      escalator      |  52.6 | 68.53 |
|       ottoman       | 41.55 | 61.31 |
|        bottle       |  30.8 | 54.51 |
|        buffet       | 47.76 | 59.59 |
|        poster       | 21.35 | 27.43 |
|        stage        | 13.43 |  25.8 |
|         van         | 36.81 | 50.87 |
|         ship        | 56.94 | 68.94 |
|       fountain      | 34.04 | 35.43 |
|    conveyer belt    | 72.01 | 88.51 |
|        canopy       | 38.38 | 58.08 |
|        washer       | 81.59 | 89.18 |
|      plaything      | 30.63 | 51.27 |
|    swimming pool    | 75.68 |  87.0 |
|        stool        | 28.97 |  44.7 |
|        barrel       | 56.92 | 88.29 |
|        basket       | 27.01 | 36.83 |
|      waterfall      | 55.24 | 63.88 |
|         tent        | 85.37 |  96.8 |
|         bag         | 12.13 | 14.87 |
|       minibike      | 56.13 | 75.85 |
|        cradle       | 76.01 | 91.79 |
|         oven        | 41.91 | 64.45 |
|         ball        | 42.64 | 55.54 |
|         food        | 49.02 | 64.12 |
|         step        |  9.54 | 10.91 |
|         tank        | 60.75 | 64.77 |
|      trade name     | 14.02 | 16.58 |
|      microwave      | 68.11 | 77.52 |
|         pot         | 32.96 | 44.86 |
|        animal       |  54.5 | 59.66 |
|       bicycle       | 45.04 |  63.5 |
|         lake        | 57.13 | 65.67 |
|      dishwasher     | 64.88 |  74.1 |
|        screen       |  59.0 | 80.82 |
|       blanket       | 23.17 | 27.66 |
|      sculpture      | 52.87 | 77.03 |
|         hood        | 42.36 | 59.89 |
|        sconce       | 27.09 | 41.28 |
|         vase        | 22.16 | 40.12 |
|    traffic light    | 20.48 | 35.42 |
|         tray        | 15.33 | 21.45 |
|        ashcan       | 29.32 | 49.77 |
|         fan         | 36.58 | 53.31 |
|         pier        | 27.34 | 40.19 |
|      crt screen     |  6.4  | 17.07 |
|        plate        | 43.87 |  63.3 |
|       monitor       |  3.07 |  3.87 |
|    bulletin board   | 34.69 | 45.26 |
|        shower       |  6.86 | 11.92 |
|       radiator      | 43.41 | 58.36 |
|        glass        | 14.08 | 15.98 |
|        clock        | 34.45 |  50.7 |
|         flag        | 36.25 | 45.58 |
+---------------------+-------+-------+
11/15 19:52:22 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 78.6000  mIoU: 45.0500  mAcc: 58.9600  data_time: 0.0029  time: 2.4532
Finished processing corruption type: elastic_transform
Processing corruption type: pixelate
11/15 19:54:20 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 2079956785
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 2079956785
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 19:54:20 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='pixelate',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/pixelate'

Number of parameters:  441271084
11/15 19:55:16 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 19:55:17 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 19:55:18 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 19:55:26 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 19:57:14 - mmengine - INFO - Iter(test) [  50/2000]    eta: 1:10:19  time: 0.8514  data_time: 0.0018  memory: 24548  
11/15 19:57:54 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:46:52  time: 0.8158  data_time: 0.0019  memory: 4003  
11/15 19:58:31 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:38:03  time: 0.7759  data_time: 0.0019  memory: 3937  
11/15 19:59:11 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:33:48  time: 0.8117  data_time: 0.0018  memory: 4098  
11/15 19:59:48 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:30:34  time: 0.7729  data_time: 0.0018  memory: 4154  
11/15 20:00:26 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:28:22  time: 0.8150  data_time: 0.0020  memory: 3995  
11/15 20:01:05 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:26:40  time: 0.7327  data_time: 0.0018  memory: 3994  
11/15 20:01:44 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:25:11  time: 0.8114  data_time: 0.0018  memory: 3999  
11/15 20:02:17 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:23:34  time: 0.7303  data_time: 0.0018  memory: 3934  
11/15 20:02:55 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:22:27  time: 0.7344  data_time: 0.0018  memory: 3938  
11/15 20:03:35 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:21:30  time: 0.8539  data_time: 0.0019  memory: 3990  
11/15 20:04:14 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:20:31  time: 0.8136  data_time: 0.0019  memory: 3998  
11/15 20:04:51 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:19:34  time: 0.7743  data_time: 0.0017  memory: 4018  
11/15 20:05:33 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:18:46  time: 0.8153  data_time: 0.0019  memory: 4014  
11/15 20:06:12 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:17:57  time: 0.8123  data_time: 0.0018  memory: 4029  
11/15 20:06:47 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:17:01  time: 0.8161  data_time: 0.0040  memory: 3940  
11/15 20:07:28 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:16:16  time: 0.8144  data_time: 0.0020  memory: 3929  
11/15 20:08:01 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:15:23  time: 0.6541  data_time: 0.0018  memory: 3960  
11/15 20:08:40 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:14:38  time: 0.7361  data_time: 0.0019  memory: 3985  
11/15 20:09:16 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:13:50  time: 0.7342  data_time: 0.0019  memory: 3987  
11/15 20:09:58 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:13:08  time: 0.8536  data_time: 0.0022  memory: 4033  
11/15 20:10:37 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:12:25  time: 0.7347  data_time: 0.0020  memory: 3975  
11/15 20:11:15 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:11:41  time: 0.7752  data_time: 0.0018  memory: 3968  
11/15 20:11:54 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:10:58  time: 0.7351  data_time: 0.0018  memory: 3998  
11/15 20:12:29 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:10:13  time: 0.7342  data_time: 0.0018  memory: 3955  
11/15 20:13:02 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:09:28  time: 0.7741  data_time: 0.0019  memory: 3929  
11/15 20:13:40 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:08:46  time: 0.6938  data_time: 0.0018  memory: 3930  
11/15 20:14:17 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:08:04  time: 0.8161  data_time: 0.0018  memory: 3987  
11/15 20:14:52 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:07:22  time: 0.8140  data_time: 0.0018  memory: 3986  
11/15 20:15:29 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:06:40  time: 0.6928  data_time: 0.0018  memory: 3929  
11/15 20:16:08 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:06:00  time: 0.7739  data_time: 0.0018  memory: 3976  
11/15 20:16:45 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:19  time: 0.7733  data_time: 0.0019  memory: 3927  
11/15 20:17:20 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:04:38  time: 0.6534  data_time: 0.0017  memory: 4109  
11/15 20:18:00 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:58  time: 0.7741  data_time: 0.0020  memory: 3984  
11/15 20:18:40 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:19  time: 0.7337  data_time: 0.0018  memory: 3992  
11/15 20:19:15 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:38  time: 0.8158  data_time: 0.0020  memory: 3943  
11/15 20:19:56 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:59  time: 0.8144  data_time: 0.0020  memory: 3889  
11/15 20:20:30 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:19  time: 0.6958  data_time: 0.0019  memory: 4014  
11/15 20:21:09 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:39  time: 0.7345  data_time: 0.0018  memory: 4144  
11/15 20:21:44 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.6933  data_time: 0.0017  memory: 4022  
11/15 20:21:44 - mmengine - INFO - per class results:
11/15 20:21:44 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 81.54 | 90.17 |
|       building      | 83.87 | 94.33 |
|         sky         | 94.83 | 97.76 |
|        floor        | 84.46 | 92.89 |
|         tree        | 76.54 | 88.17 |
|       ceiling       | 86.83 | 94.52 |
|         road        | 86.17 | 91.82 |
|         bed         | 92.23 | 97.15 |
|      windowpane     | 65.78 | 79.42 |
|        grass        | 69.51 | 85.23 |
|       cabinet       | 64.02 | 75.82 |
|       sidewalk      | 71.06 | 84.41 |
|        person       | 85.34 |  94.1 |
|        earth        | 40.43 | 53.19 |
|         door        | 59.53 | 71.96 |
|        table        | 68.37 | 81.75 |
|       mountain      |  62.1 | 73.98 |
|        plant        | 52.64 | 63.79 |
|       curtain       |  79.7 | 90.48 |
|        chair        | 65.22 |  76.6 |
|         car         | 86.51 | 92.95 |
|        water        | 61.89 | 76.62 |
|       painting      | 77.11 | 89.94 |
|         sofa        | 80.36 | 91.51 |
|        shelf        | 47.75 | 66.02 |
|        house        | 56.22 | 71.03 |
|         sea         | 68.24 | 84.23 |
|        mirror       | 74.75 | 83.17 |
|         rug         | 64.45 | 72.76 |
|        field        | 35.21 | 50.47 |
|       armchair      | 57.71 | 73.96 |
|         seat        | 65.74 | 87.39 |
|        fence        | 49.49 | 61.57 |
|         desk        | 59.12 | 74.52 |
|         rock        | 54.53 | 83.67 |
|       wardrobe      | 49.08 | 64.84 |
|         lamp        | 72.91 | 83.26 |
|       bathtub       | 87.06 | 91.43 |
|       railing       | 40.52 | 54.78 |
|       cushion       | 68.68 | 80.09 |
|         base        | 47.69 | 60.16 |
|         box         | 34.96 | 45.61 |
|        column       | 53.72 | 64.74 |
|      signboard      | 41.36 | 56.03 |
|   chest of drawers  | 40.87 |  57.3 |
|       counter       | 47.73 |  57.9 |
|         sand        | 57.37 |  81.4 |
|         sink        | 76.72 | 87.73 |
|      skyscraper     | 35.96 | 44.88 |
|      fireplace      | 80.16 | 88.35 |
|     refrigerator    | 77.17 | 82.95 |
|      grandstand     | 51.89 | 87.11 |
|         path        | 28.01 | 37.36 |
|        stairs       | 30.88 | 39.79 |
|        runway       | 72.49 |  96.4 |
|         case        | 57.29 | 81.54 |
|      pool table     | 95.11 | 97.82 |
|        pillow       | 67.51 |  77.9 |
|     screen door     | 81.23 | 85.13 |
|       stairway      | 35.14 | 45.69 |
|        river        | 11.07 | 25.56 |
|        bridge       | 61.38 | 69.21 |
|       bookcase      | 50.04 | 69.06 |
|        blind        | 46.25 | 49.95 |
|     coffee table    | 65.44 | 82.55 |
|        toilet       | 89.09 |  93.1 |
|        flower       | 47.88 | 62.18 |
|         book        | 52.12 | 71.14 |
|         hill        | 19.38 | 25.17 |
|        bench        | 58.78 | 68.38 |
|      countertop     |  61.7 | 82.58 |
|        stove        | 81.97 | 87.82 |
|         palm        | 58.31 | 79.77 |
|    kitchen island   | 43.19 | 73.64 |
|       computer      | 78.51 | 88.96 |
|     swivel chair    |  48.9 | 68.16 |
|         boat        | 50.58 | 57.71 |
|         bar         | 67.67 | 76.24 |
|    arcade machine   | 89.43 | 92.98 |
|        hovel        | 11.03 | 11.42 |
|         bus         | 92.47 | 96.95 |
|        towel        | 74.93 |  83.3 |
|        light        | 59.51 | 67.41 |
|        truck        | 40.19 | 56.04 |
|        tower        |  12.0 | 19.43 |
|      chandelier     | 71.49 |  83.4 |
|        awning       | 38.21 | 45.69 |
|     streetlight     | 34.14 | 43.35 |
|        booth        | 49.47 | 52.43 |
| television receiver | 73.01 | 84.29 |
|       airplane      | 68.56 | 74.72 |
|      dirt track     | 22.14 | 41.93 |
|       apparel       | 50.86 | 65.15 |
|         pole        | 31.25 | 44.82 |
|         land        |  1.57 |  2.2  |
|      bannister      | 18.82 | 25.15 |
|      escalator      | 42.16 | 55.16 |
|       ottoman       |  53.3 | 74.26 |
|        bottle       | 41.57 |  62.3 |
|        buffet       | 60.35 | 70.72 |
|        poster       | 27.32 | 32.38 |
|        stage        |  19.0 | 29.26 |
|         van         | 43.42 | 62.84 |
|         ship        |  27.7 | 38.28 |
|       fountain      | 30.63 | 31.39 |
|    conveyer belt    | 80.68 | 96.81 |
|        canopy       |  43.7 | 57.04 |
|        washer       | 82.69 | 85.73 |
|      plaything      | 39.92 | 69.61 |
|    swimming pool    | 82.87 | 89.12 |
|        stool        | 51.76 | 67.49 |
|        barrel       | 39.74 | 78.02 |
|        basket       | 38.65 | 49.29 |
|      waterfall      | 67.65 | 76.37 |
|         tent        |  94.1 | 98.77 |
|         bag         | 15.74 | 17.77 |
|       minibike      | 74.98 | 86.28 |
|        cradle       | 85.31 | 98.15 |
|         oven        | 41.21 | 78.25 |
|         ball        | 60.14 | 69.98 |
|         food        |  52.0 |  61.5 |
|         step        | 11.84 | 13.83 |
|         tank        | 63.43 | 66.47 |
|      trade name     | 25.87 | 29.66 |
|      microwave      | 68.79 | 73.23 |
|         pot         | 57.28 | 65.22 |
|        animal       | 65.74 | 67.72 |
|       bicycle       | 60.35 | 75.33 |
|         lake        | 56.14 | 63.83 |
|      dishwasher     | 73.58 | 79.19 |
|        screen       | 66.27 | 88.63 |
|       blanket       | 24.42 | 27.71 |
|      sculpture      | 79.23 |  88.6 |
|         hood        | 60.45 | 73.52 |
|        sconce       | 55.06 | 66.18 |
|         vase        |  48.8 | 64.16 |
|    traffic light    | 41.71 | 60.31 |
|         tray        | 20.35 | 25.95 |
|        ashcan       | 46.26 | 58.76 |
|         fan         | 71.68 | 81.17 |
|         pier        | 36.74 | 49.82 |
|      crt screen     |  4.7  | 12.06 |
|        plate        |  60.5 | 79.42 |
|       monitor       |  3.19 |  4.07 |
|    bulletin board   | 43.49 | 51.11 |
|        shower       | 15.52 | 18.22 |
|       radiator      | 63.86 |  72.7 |
|        glass        | 20.72 | 22.01 |
|        clock        |  55.0 | 66.58 |
|         flag        | 53.02 | 56.56 |
+---------------------+-------+-------+
11/15 20:21:44 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 85.7700  mIoU: 55.4800  mAcc: 66.9900  data_time: 0.0024  time: 0.7891
Finished processing corruption type: pixelate
Processing corruption type: jpeg_compression
11/15 20:21:48 - mmengine - INFO - 
------------------------------------------------------------
System environment:
    sys.platform: linux
    Python: 3.8.20 (default, Oct  3 2024, 15:24:27) [GCC 11.2.0]
    CUDA available: True
    MUSA available: False
    numpy_random_seed: 189635500
    GPU 0: Tesla V100-SXM2-32GB
    CUDA_HOME: /opt/bwhpc/common/devel/cuda/11.7
    NVCC: Cuda compilation tools, release 11.7, V11.7.99
    GCC: gcc (GCC) 8.5.0 20210514 (Red Hat 8.5.0-18)
    PyTorch: 1.13.1
    PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201402
  - Intel(R) oneAPI Math Kernel Library Version 2021.4-Product Build 20210904 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v2.6.0 (Git Hash 52b5f107dd9cf10910aaa19cb47f3abf9b349815)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX2
  - CUDA Runtime 11.7
  - NVCC architecture flags: -gencode;arch=compute_37,code=sm_37;-gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_37,code=compute_37
  - CuDNN 8.5
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=11.7, CUDNN_VERSION=8.5.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -fabi-version=11 -Wno-deprecated -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -fopenmp -DNDEBUG -DUSE_KINETO -DUSE_FBGEMM -DUSE_QNNPACK -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -DEDGE_PROFILER_USE_KINETO -O2 -fPIC -Wno-narrowing -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wunused-local-typedefs -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-error=deprecated-declarations -Wno-stringop-overflow -Wno-psabi -Wno-error=pedantic -Wno-error=redundant-decls -Wno-error=old-style-cast -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Werror=cast-function-type -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=1.13.1, USE_CUDA=ON, USE_CUDNN=ON, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, 

    TorchVision: 0.14.1
    OpenCV: 3.4.18
    MMEngine: 0.10.5

Runtime environment:
    cudnn_benchmark: True
    mp_cfg: {'mp_start_method': 'fork', 'opencv_num_threads': 0}
    dist_cfg: {'backend': 'nccl'}
    seed: 189635500
    Distributed launcher: none
    Distributed training: False
    GPU number: 1
------------------------------------------------------------

11/15 20:21:48 - mmengine - INFO - Config:
crop_size = (
    640,
    640,
)
data_preprocessor = dict(
    bgr_to_rgb=True,
    mean=[
        123.675,
        116.28,
        103.53,
    ],
    pad_val=0,
    seg_pad_val=255,
    std=[
        58.395,
        57.12,
        57.375,
    ],
    type='SegDataPreProcessor')
data_root = 'data/ade/ADEChallengeData2016'
dataset_type = 'ADE20KDataset'
default_hooks = dict(
    checkpoint=dict(by_epoch=False, interval=32000, type='CheckpointHook'),
    logger=dict(interval=50, log_metric_by_epoch=False, type='LoggerHook'),
    param_scheduler=dict(type='ParamSchedulerHook'),
    sampler_seed=dict(type='DistSamplerSeedHook'),
    timer=dict(type='IterTimerHook'),
    visualization=dict(type='SegVisualizationHook'))
default_scope = 'mmseg'
env_cfg = dict(
    cudnn_benchmark=True,
    dist_cfg=dict(backend='nccl'),
    mp_cfg=dict(mp_start_method='fork', opencv_num_threads=0))
img_ratios = [
    0.5,
    0.75,
    1.0,
    1.25,
    1.5,
    1.75,
]
launcher = 'none'
load_from = '../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth'
log_level = 'INFO'
log_processor = dict(by_epoch=False)
model = dict(
    auxiliary_head=dict(
        align_corners=False,
        channels=256,
        concat_input=False,
        dropout_ratio=0.1,
        in_channels=1024,
        in_index=2,
        loss_decode=dict(
            loss_weight=0.4, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        num_convs=1,
        type='FCNHead'),
    backbone=dict(
        act_cfg=dict(type='GELU'),
        attn_drop_rate=0.0,
        drop_path_rate=0.2,
        embed_dims=1024,
        img_size=(
            640,
            640,
        ),
        in_channels=3,
        init_values=1e-06,
        mlp_ratio=4,
        norm_cfg=dict(eps=1e-06, type='LN'),
        norm_eval=False,
        num_heads=16,
        num_layers=24,
        out_indices=[
            7,
            11,
            15,
            23,
        ],
        patch_size=16,
        qv_bias=True,
        type='BEiT'),
    data_preprocessor=dict(
        bgr_to_rgb=True,
        corruption='jpeg_compression',
        mean=[
            123.675,
            116.28,
            103.53,
        ],
        pad_val=0,
        seg_pad_val=255,
        size=(
            640,
            640,
        ),
        std=[
            58.395,
            57.12,
            57.375,
        ],
        type='SegDataPreProcessor'),
    decode_head=dict(
        align_corners=False,
        channels=1024,
        dropout_ratio=0.1,
        in_channels=[
            1024,
            1024,
            1024,
            1024,
        ],
        in_index=[
            0,
            1,
            2,
            3,
        ],
        loss_decode=dict(
            loss_weight=1.0, type='CrossEntropyLoss', use_sigmoid=False),
        norm_cfg=dict(requires_grad=True, type='SyncBN'),
        num_classes=150,
        pool_scales=(
            1,
            2,
            3,
            6,
        ),
        type='UPerHead'),
    neck=dict(
        embed_dim=1024, rescales=[
            4,
            2,
            1,
            0.5,
        ], type='Feature2Pyramid'),
    pretrained='pretrain/beit_large_patch16_224_pt22k_ft22k.pth',
    test_cfg=dict(crop_size=(
        640,
        640,
    ), mode='slide', stride=(
        426,
        426,
    )),
    train_cfg=dict(),
    type='EncoderDecoder')
norm_cfg = dict(requires_grad=True, type='SyncBN')
optim_wrapper = dict(
    accumulative_counts=2,
    constructor='LayerDecayOptimizerConstructor',
    optimizer=dict(
        betas=(
            0.9,
            0.999,
        ), lr=2e-05, type='AdamW', weight_decay=0.05),
    paramwise_cfg=dict(layer_decay_rate=0.95, num_layers=24),
    type='AmpOptimWrapper')
optimizer = dict(lr=0.01, momentum=0.9, type='SGD', weight_decay=0.0005)
param_scheduler = [
    dict(
        begin=0, by_epoch=False, end=3000, start_factor=1e-06,
        type='LinearLR'),
    dict(
        begin=3000,
        by_epoch=False,
        end=160000,
        eta_min=0.0,
        power=1.0,
        type='PolyLR'),
]
resume = False
test_cfg = dict(type='TestLoop')
test_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
test_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
test_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(keep_ratio=True, scale=(
        2560,
        640,
    ), type='Resize'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(type='PackSegInputs'),
]
train_cfg = dict(
    max_iters=320000, type='IterBasedTrainLoop', val_interval=32000)
train_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/training', seg_map_path='annotations/training'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(
                keep_ratio=True,
                ratio_range=(
                    0.5,
                    2.0,
                ),
                scale=(
                    2560,
                    640,
                ),
                type='RandomResize'),
            dict(
                cat_max_ratio=0.75, crop_size=(
                    640,
                    640,
                ), type='RandomCrop'),
            dict(prob=0.5, type='RandomFlip'),
            dict(type='PhotoMetricDistortion'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=True, type='InfiniteSampler'))
train_pipeline = [
    dict(type='LoadImageFromFile'),
    dict(reduce_zero_label=True, type='LoadAnnotations'),
    dict(
        keep_ratio=True,
        ratio_range=(
            0.5,
            2.0,
        ),
        scale=(
            2560,
            640,
        ),
        type='RandomResize'),
    dict(cat_max_ratio=0.75, crop_size=(
        640,
        640,
    ), type='RandomCrop'),
    dict(prob=0.5, type='RandomFlip'),
    dict(type='PhotoMetricDistortion'),
    dict(type='PackSegInputs'),
]
tta_model = dict(type='SegTTAModel')
tta_pipeline = [
    dict(backend_args=None, type='LoadImageFromFile'),
    dict(
        transforms=[
            [
                dict(keep_ratio=True, scale_factor=0.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=0.75, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.0, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.25, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.5, type='Resize'),
                dict(keep_ratio=True, scale_factor=1.75, type='Resize'),
            ],
            [
                dict(direction='horizontal', prob=0.0, type='RandomFlip'),
                dict(direction='horizontal', prob=1.0, type='RandomFlip'),
            ],
            [
                dict(type='LoadAnnotations'),
            ],
            [
                dict(type='PackSegInputs'),
            ],
        ],
        type='TestTimeAug'),
]
val_cfg = dict(type='ValLoop')
val_dataloader = dict(
    batch_size=1,
    dataset=dict(
        data_prefix=dict(
            img_path='images/validation',
            seg_map_path='annotations/validation'),
        data_root='data/ade/ADEChallengeData2016',
        pipeline=[
            dict(type='LoadImageFromFile'),
            dict(keep_ratio=True, scale=(
                2560,
                640,
            ), type='Resize'),
            dict(reduce_zero_label=True, type='LoadAnnotations'),
            dict(type='PackSegInputs'),
        ],
        type='ADE20KDataset'),
    num_workers=4,
    persistent_workers=True,
    sampler=dict(shuffle=False, type='DefaultSampler'))
val_evaluator = dict(
    iou_metrics=[
        'mIoU',
    ], type='IoUMetric')
vis_backends = [
    dict(type='LocalVisBackend'),
]
visualizer = dict(
    name='visualizer',
    type='SegLocalVisualizer',
    vis_backends=[
        dict(type='LocalVisBackend'),
    ])
work_dir = '../corruptions/work_dirs/ade20k/upernet/beit-large_upernet_8xb1-amp-160k_ade20k-640x640/jpeg_compression'

Number of parameters:  441271084
11/15 20:21:59 - mmengine - INFO - Distributed training is not used, all SyncBatchNorm (SyncBN) layers in the model will be automatically reverted to BatchNormXd layers if they are used.
11/15 20:21:59 - mmengine - INFO - Hooks will be executed in the following order:
before_run:
(VERY_HIGH   ) RuntimeInfoHook                    
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
before_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_train_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) DistSamplerSeedHook                
 -------------------- 
before_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_train_iter:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_train_epoch:
(NORMAL      ) IterTimerHook                      
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_val_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_val_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_val_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_val_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
(LOW         ) ParamSchedulerHook                 
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
after_val:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_train:
(VERY_HIGH   ) RuntimeInfoHook                    
(VERY_LOW    ) CheckpointHook                     
 -------------------- 
before_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
before_test_epoch:
(NORMAL      ) IterTimerHook                      
 -------------------- 
before_test_iter:
(NORMAL      ) IterTimerHook                      
 -------------------- 
after_test_iter:
(NORMAL      ) IterTimerHook                      
(NORMAL      ) SegVisualizationHook               
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test_epoch:
(VERY_HIGH   ) RuntimeInfoHook                    
(NORMAL      ) IterTimerHook                      
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
after_test:
(VERY_HIGH   ) RuntimeInfoHook                    
 -------------------- 
after_run:
(BELOW_NORMAL) LoggerHook                         
 -------------------- 
11/15 20:21:59 - mmengine - WARNING - The prefix is not set in metric class IoUMetric.
Loads checkpoint by local backend from path: ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
11/15 20:22:01 - mmengine - INFO - Load checkpoint from ../checkpoint_files/ade20k/upernet/upernet_beit-large_fp16_8x1_640x640_160k_ade20k-8fc0dd5d.pth
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/benchmarking_robustness/semantic_segmentation/mmsegmentation/mmseg/ops_dcnv3/modules/dcnv3.py:20: UserWarning: Now, we support DCNv4 in InternImage.
  warnings.warn('Now, we support DCNv4 in InternImage.')
/pfs/work7/workspace/scratch/ma_mkacar-team_project_fss2024/miniconda3/envs/py310/lib/python3.8/site-packages/timm/models/layers/__init__.py:48: FutureWarning: Importing from timm.models.layers is deprecated, please import via timm.layers
  warnings.warn(f"Importing from {__name__} is deprecated, please import via timm.layers", FutureWarning)
11/15 20:22:50 - mmengine - INFO - Iter(test) [  50/2000]    eta: 0:31:40  time: 0.8674  data_time: 0.0019  memory: 24548  
11/15 20:23:30 - mmengine - INFO - Iter(test) [ 100/2000]    eta: 0:28:15  time: 0.8287  data_time: 0.0044  memory: 4003  
11/15 20:24:08 - mmengine - INFO - Iter(test) [ 150/2000]    eta: 0:26:05  time: 0.7863  data_time: 0.0019  memory: 3937  
11/15 20:24:49 - mmengine - INFO - Iter(test) [ 200/2000]    eta: 0:25:10  time: 0.8250  data_time: 0.0019  memory: 4098  
11/15 20:25:26 - mmengine - INFO - Iter(test) [ 250/2000]    eta: 0:23:56  time: 0.7855  data_time: 0.0018  memory: 4154  
11/15 20:26:05 - mmengine - INFO - Iter(test) [ 300/2000]    eta: 0:23:02  time: 0.8282  data_time: 0.0024  memory: 3995  
11/15 20:26:45 - mmengine - INFO - Iter(test) [ 350/2000]    eta: 0:22:17  time: 0.7461  data_time: 0.0019  memory: 3994  
11/15 20:27:24 - mmengine - INFO - Iter(test) [ 400/2000]    eta: 0:21:30  time: 0.8263  data_time: 0.0018  memory: 3999  
11/15 20:27:57 - mmengine - INFO - Iter(test) [ 450/2000]    eta: 0:20:27  time: 0.7458  data_time: 0.0040  memory: 3934  
11/15 20:28:36 - mmengine - INFO - Iter(test) [ 500/2000]    eta: 0:19:45  time: 0.7451  data_time: 0.0018  memory: 3938  
11/15 20:29:17 - mmengine - INFO - Iter(test) [ 550/2000]    eta: 0:19:09  time: 0.8668  data_time: 0.0019  memory: 3990  
11/15 20:29:56 - mmengine - INFO - Iter(test) [ 600/2000]    eta: 0:18:28  time: 0.8268  data_time: 0.0020  memory: 3998  
11/15 20:30:34 - mmengine - INFO - Iter(test) [ 650/2000]    eta: 0:17:45  time: 0.7859  data_time: 0.0018  memory: 4018  
11/15 20:31:17 - mmengine - INFO - Iter(test) [ 700/2000]    eta: 0:17:11  time: 0.8273  data_time: 0.0020  memory: 4014  
11/15 20:31:57 - mmengine - INFO - Iter(test) [ 750/2000]    eta: 0:16:32  time: 0.8237  data_time: 0.0018  memory: 4029  
11/15 20:32:32 - mmengine - INFO - Iter(test) [ 800/2000]    eta: 0:15:46  time: 0.8258  data_time: 0.0020  memory: 3940  
11/15 20:33:13 - mmengine - INFO - Iter(test) [ 850/2000]    eta: 0:15:09  time: 0.8275  data_time: 0.0020  memory: 3929  
11/15 20:33:47 - mmengine - INFO - Iter(test) [ 900/2000]    eta: 0:14:22  time: 0.6633  data_time: 0.0018  memory: 3960  
11/15 20:34:27 - mmengine - INFO - Iter(test) [ 950/2000]    eta: 0:13:44  time: 0.7457  data_time: 0.0019  memory: 3985  
11/15 20:35:03 - mmengine - INFO - Iter(test) [1000/2000]    eta: 0:13:02  time: 0.7435  data_time: 0.0018  memory: 3987  
11/15 20:35:45 - mmengine - INFO - Iter(test) [1050/2000]    eta: 0:12:25  time: 0.8670  data_time: 0.0019  memory: 4033  
11/15 20:36:25 - mmengine - INFO - Iter(test) [1100/2000]    eta: 0:11:46  time: 0.7455  data_time: 0.0019  memory: 3975  
11/15 20:37:03 - mmengine - INFO - Iter(test) [1150/2000]    eta: 0:11:06  time: 0.7875  data_time: 0.0019  memory: 3968  
11/15 20:37:43 - mmengine - INFO - Iter(test) [1200/2000]    eta: 0:10:27  time: 0.7460  data_time: 0.0019  memory: 3998  
11/15 20:38:18 - mmengine - INFO - Iter(test) [1250/2000]    eta: 0:09:46  time: 0.7451  data_time: 0.0018  memory: 3955  
11/15 20:38:53 - mmengine - INFO - Iter(test) [1300/2000]    eta: 0:09:04  time: 0.7861  data_time: 0.0019  memory: 3929  
11/15 20:39:31 - mmengine - INFO - Iter(test) [1350/2000]    eta: 0:08:25  time: 0.7033  data_time: 0.0018  memory: 3930  
11/15 20:40:08 - mmengine - INFO - Iter(test) [1400/2000]    eta: 0:07:45  time: 0.8266  data_time: 0.0019  memory: 3987  
11/15 20:40:44 - mmengine - INFO - Iter(test) [1450/2000]    eta: 0:07:05  time: 0.8263  data_time: 0.0018  memory: 3986  
11/15 20:41:21 - mmengine - INFO - Iter(test) [1500/2000]    eta: 0:06:26  time: 0.7034  data_time: 0.0018  memory: 3929  
11/15 20:42:01 - mmengine - INFO - Iter(test) [1550/2000]    eta: 0:05:48  time: 0.7870  data_time: 0.0019  memory: 3976  
11/15 20:42:39 - mmengine - INFO - Iter(test) [1600/2000]    eta: 0:05:09  time: 0.7860  data_time: 0.0020  memory: 3927  
11/15 20:43:14 - mmengine - INFO - Iter(test) [1650/2000]    eta: 0:04:30  time: 0.6636  data_time: 0.0017  memory: 4109  
11/15 20:43:55 - mmengine - INFO - Iter(test) [1700/2000]    eta: 0:03:51  time: 0.7851  data_time: 0.0020  memory: 3984  
11/15 20:44:35 - mmengine - INFO - Iter(test) [1750/2000]    eta: 0:03:13  time: 0.7453  data_time: 0.0018  memory: 3992  
11/15 20:45:11 - mmengine - INFO - Iter(test) [1800/2000]    eta: 0:02:34  time: 0.8269  data_time: 0.0020  memory: 3943  
11/15 20:45:52 - mmengine - INFO - Iter(test) [1850/2000]    eta: 0:01:56  time: 0.8273  data_time: 0.0021  memory: 3889  
11/15 20:46:27 - mmengine - INFO - Iter(test) [1900/2000]    eta: 0:01:17  time: 0.7066  data_time: 0.0018  memory: 4014  
11/15 20:47:06 - mmengine - INFO - Iter(test) [1950/2000]    eta: 0:00:38  time: 0.7457  data_time: 0.0018  memory: 4144  
11/15 20:47:42 - mmengine - INFO - Iter(test) [2000/2000]    eta: 0:00:00  time: 0.7036  data_time: 0.0017  memory: 4022  
11/15 20:47:42 - mmengine - INFO - per class results:
11/15 20:47:42 - mmengine - INFO - 
+---------------------+-------+-------+
|        Class        |  IoU  |  Acc  |
+---------------------+-------+-------+
|         wall        | 81.01 | 91.07 |
|       building      | 84.61 | 93.99 |
|         sky         | 94.62 | 97.68 |
|        floor        | 83.64 |  93.2 |
|         tree        | 75.48 | 88.35 |
|       ceiling       | 86.59 |  94.3 |
|         road        | 84.09 | 89.77 |
|         bed         | 91.32 | 96.88 |
|      windowpane     | 65.41 | 79.52 |
|        grass        | 70.21 | 83.43 |
|       cabinet       | 61.97 |  73.1 |
|       sidewalk      | 68.11 |  84.2 |
|        person       | 84.83 | 93.11 |
|        earth        |  38.3 | 55.22 |
|         door        | 57.34 | 69.79 |
|        table        | 67.97 | 81.63 |
|       mountain      |  61.2 | 73.55 |
|        plant        |  49.0 |  57.6 |
|       curtain       | 79.55 | 88.33 |
|        chair        | 63.37 | 72.78 |
|         car         | 86.51 | 93.31 |
|        water        | 60.34 | 75.05 |
|       painting      | 76.52 | 87.01 |
|         sofa        | 79.38 | 90.17 |
|        shelf        | 45.29 | 61.78 |
|        house        | 56.15 | 72.03 |
|         sea         | 63.05 | 82.14 |
|        mirror       | 72.82 | 80.82 |
|         rug         | 60.52 | 67.97 |
|        field        | 39.58 | 51.16 |
|       armchair      | 60.77 | 78.01 |
|         seat        | 64.01 | 86.89 |
|        fence        | 49.84 | 60.37 |
|         desk        |  57.4 | 74.24 |
|         rock        | 52.18 |  80.9 |
|       wardrobe      | 45.07 | 65.83 |
|         lamp        | 71.08 | 80.29 |
|       bathtub       | 88.81 | 93.56 |
|       railing       | 37.81 | 49.15 |
|       cushion       | 65.92 | 76.03 |
|         base        |  44.0 | 55.04 |
|         box         | 32.01 | 39.13 |
|        column       | 51.73 | 63.03 |
|      signboard      | 40.42 | 52.29 |
|   chest of drawers  | 39.98 | 58.44 |
|       counter       | 44.09 | 55.31 |
|         sand        | 50.87 | 72.53 |
|         sink        | 75.85 | 84.84 |
|      skyscraper     |  50.4 | 64.61 |
|      fireplace      |  80.2 | 90.35 |
|     refrigerator    | 82.04 | 87.53 |
|      grandstand     | 50.77 | 85.67 |
|         path        | 27.37 | 38.11 |
|        stairs       | 25.24 | 30.59 |
|        runway       | 72.26 | 95.47 |
|         case        | 53.02 | 76.46 |
|      pool table     | 94.95 | 97.67 |
|        pillow       | 59.19 |  66.2 |
|     screen door     | 80.91 |  83.9 |
|       stairway      | 42.43 | 58.46 |
|        river        | 12.87 | 27.67 |
|        bridge       | 48.32 | 58.52 |
|       bookcase      | 47.04 |  66.1 |
|        blind        | 39.92 | 41.33 |
|     coffee table    | 63.69 | 81.55 |
|        toilet       | 88.24 | 92.57 |
|        flower       | 42.43 | 54.74 |
|         book        | 51.24 |  69.5 |
|         hill        | 19.22 | 24.06 |
|        bench        | 57.21 | 64.92 |
|      countertop     | 62.95 | 79.92 |
|        stove        | 82.61 | 87.81 |
|         palm        | 54.28 | 75.56 |
|    kitchen island   | 38.85 | 69.64 |
|       computer      | 79.63 | 89.22 |
|     swivel chair    | 47.65 | 66.08 |
|         boat        | 45.29 | 53.39 |
|         bar         | 59.56 | 69.96 |
|    arcade machine   | 87.68 |  90.1 |
|        hovel        | 23.93 | 25.87 |
|         bus         |  91.7 | 97.23 |
|        towel        | 75.07 | 80.73 |
|        light        | 59.56 | 67.03 |
|        truck        | 41.41 | 52.17 |
|        tower        | 18.14 | 30.68 |
|      chandelier     | 69.81 | 82.38 |
|        awning       | 40.71 | 47.58 |
|     streetlight     | 33.68 | 43.38 |
|        booth        | 52.41 | 61.04 |
| television receiver | 70.76 | 81.44 |
|       airplane      |  67.2 | 73.53 |
|      dirt track     | 23.51 | 53.39 |
|       apparel       |  49.8 | 63.79 |
|         pole        | 32.44 | 44.01 |
|         land        |  2.05 |  3.35 |
|      bannister      |  17.9 | 23.45 |
|      escalator      | 48.18 | 62.22 |
|       ottoman       | 54.81 | 74.94 |
|        bottle       | 40.14 | 58.98 |
|        buffet       | 62.42 | 70.02 |
|        poster       | 32.52 | 37.73 |
|        stage        | 18.37 |  27.2 |
|         van         | 48.11 | 66.15 |
|         ship        | 59.53 | 86.47 |
|       fountain      | 37.34 | 37.73 |
|    conveyer belt    |  80.4 |  95.7 |
|        canopy       | 46.86 | 64.37 |
|        washer       | 84.13 | 87.97 |
|      plaything      | 47.49 |  63.7 |
|    swimming pool    | 87.19 | 90.24 |
|        stool        | 51.48 | 63.44 |
|        barrel       | 31.53 | 74.15 |
|        basket       | 40.96 | 49.86 |
|      waterfall      | 60.27 |  66.8 |
|         tent        | 94.83 | 98.94 |
|         bag         | 10.39 | 11.36 |
|       minibike      | 73.35 | 84.19 |
|        cradle       |  85.0 | 98.21 |
|         oven        | 52.13 |  72.5 |
|         ball        | 56.58 | 66.54 |
|         food        | 49.27 |  58.9 |
|         step        | 10.48 |  11.9 |
|         tank        | 63.37 | 65.28 |
|      trade name     | 25.06 | 28.22 |
|      microwave      |  83.5 | 88.72 |
|         pot         | 53.31 | 59.94 |
|        animal       | 65.08 | 67.06 |
|       bicycle       | 60.52 | 73.77 |
|         lake        |  61.4 | 63.72 |
|      dishwasher     |  75.1 | 79.32 |
|        screen       | 73.53 | 87.63 |
|       blanket       | 23.86 | 26.65 |
|      sculpture      | 76.97 | 86.37 |
|         hood        | 59.29 | 70.16 |
|        sconce       | 54.64 | 63.84 |
|         vase        | 46.58 | 59.22 |
|    traffic light    | 42.32 | 56.11 |
|         tray        | 15.37 | 19.62 |
|        ashcan       | 43.12 | 53.43 |
|         fan         | 71.36 | 81.02 |
|         pier        | 30.52 | 51.69 |
|      crt screen     |  1.23 |  3.09 |
|        plate        | 59.32 | 76.61 |
|       monitor       |  4.93 |  6.05 |
|    bulletin board   | 44.39 | 50.15 |
|        shower       |  12.5 | 15.26 |
|       radiator      | 61.14 | 67.97 |
|        glass        | 18.99 | 20.21 |
|        clock        | 53.32 | 63.49 |
|         flag        | 56.83 | 61.81 |
+---------------------+-------+-------+
11/15 20:47:42 - mmengine - INFO - Iter(test) [2000/2000]    aAcc: 85.3200  mIoU: 55.2000  mAcc: 66.2700  data_time: 0.0023  time: 0.7705
Finished processing corruption type: jpeg_compression
Runtime: 1731700063

============================= JOB FEEDBACK =============================

NodeName=uc2n512
Job ID: 24674736
Cluster: uc2
User/Group: ma_mkacar/ma_ma
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 6
CPU Utilized: 14:56:28
CPU Efficiency: 16.37% of 3-19:17:00 core-walltime
Job Wall-clock time: 15:12:50
Memory Utilized: 5.23 GB
Memory Efficiency: 52.27% of 10.00 GB
